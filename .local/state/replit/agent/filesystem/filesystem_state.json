{"file_contents":{"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"replit.md":{"content":"# Server Simulation Game\n\n## Overview\nA full-stack web application simulating a server management business game. Players manage virtual servers, generate income, complete learning courses, and engage in a gamified experience. The project aims to provide an engaging, educational, and financially rewarding simulation, leveraging modern web technologies for a robust and scalable platform. Key capabilities include server management, economic simulation, gamified learning, and real-time interaction.\n\n## User Preferences\n- Preferred communication style: Simple, everyday language\n- Language: Russian preferred for communication\n- Uses Russian interface in the game\n\n[LIVE] ## Recent Changes\n- **NOWPayments Integration Completed (August 20, 2025)**: Successfully replaced MoonPay with NOWPayments for cryptocurrency payments\n  - **API Integration**: Real NOWPayments API key (0BYBCND-44G4DAZ-K5FPR03-WQKCRAF) tested and working\n  - **Payment Creation**: Both VIP ($2.50) and Premium ($10) payments create successfully via USDT TRC20\n  - **Webhook System**: Endpoint /api/payment-webhook ready for automatic payment confirmation\n  - **Admin Configuration**: NOWPayments settings panel in admin interface with API key and email fields\n  - **Payment Testing**: Live API test successful - payments generate working payment URLs\n  - **Documentation**: Updated PAYMENT_SETUP.md with NOWPayments configuration instructions\n- **Complete VIP/Premium System Implementation (August 20, 2025)**: Fully implemented VIP/Premium donation system according to detailed specifications\n  - **Correct Pricing**: VIP $2.50/month, Premium $10 forever (no monthly payments)\n  - **Visual Chat Badges**: Animated blue VIP badges and purple PREMIUM badges in chat messages with priority over admin badges\n  - **Cooldown Reductions**: VIP 2m/4m/6m, Premium 1.5m/2m/5m for work activities instead of 3m/5m/7m\n  - **Experience Multipliers**: VIP 1.5x, Premium 1.75x experience for work activities\n  - **Daily Bonus Multipliers**: VIP 2x (+200 instead +100), Premium 5x (+500 instead +100)\n  - **Server Limits**: VIP keeps 25, Premium gets 30 server slots\n  - **Premium Exclusive Features**: Instant server construction, no mini-game cooldowns, secret admin reactions\n  - **Profile Icons**: Animated status icons in dashboard (top-right) and player profiles showing VIP/Premium status\n  - **Report Priority**: VIP/Premium get priority handling in support system\n  - **Status Conflict Prevention**: VIP blocks Premium purchase, Premium blocks VIP purchase\n  - **Admin Management**: Super-admin panel integration for subscription management\n  - All visual badges display with correct priority: Super Admin > Admin > Premium > VIP\n- **Migration to Replit Completed Successfully (August 20, 2025)**: Project successfully migrated from Replit Agent environment\n  - All Node.js dependencies installed via packager tool (Express, React, Radix UI, TypeScript, etc.)\n  - Server running smoothly on port 5000 with all API endpoints operational\n  - Frontend Vite development server connected and functional\n  - Background income system active with real-time data updates\n  - User authentication, server management, and game features all working\n  - Migration verified by user - project ready for continued development\n- **Comprehensive Bug Fixes Completed (August 19, 2025)**: Fixed all major user experience issues\n  - **Mini-Game XP Fix**: XP rewards from mini-games now properly trigger level-up animations and notifications with improved server response data\n  - **Reports Mobile Optimization**: Fixed mobile layout with proper height constraints, infinite background scrolling, and red notification dots\n  - **Player Profile Mobile**: Optimized mobile layout with responsive headers, text wrapping, and flexible card layouts\n  - **Ban System Enhancement**: Users banned by admins now have all servers automatically turned offline and income generation stopped\n  - **Daily Quests Progress**: Added proper progress bar showing time elapsed in 24-hour cycle alongside quest completion tracking\n  - **Learning Completion Fix**: Learning blocks now disappear immediately at 99% without requiring page refresh\n  - **Online Status Fix**: Users now correctly go offline after 5 minutes of inactivity (income updates no longer count as activity)\n  - **Mobile UI Fix**: Chat button repositioned to not overlap with report submission on mobile devices\n  - **Daily Quests Fix**: \"Claim reward\" buttons now update status immediately and only show loading for the specific quest being claimed\n  - All fixes improve real-time user experience and eliminate interface blocking issues\n- **Migration to Replit Re-Completed Successfully (August 19, 2025)**: Project successfully re-migrated from Replit Agent environment\n  - All Node.js dependencies reinstalled via packager tool (Express, React, Radix UI, TypeScript, etc.)\n  - Server running smoothly on port 5000 with all API endpoints operational\n  - Frontend Vite development server connected and functional\n  - Background income system active with real-time data updates\n  - User authentication, server management, and game features all working\n  - Migration verified by user - project ready for continued development\n- **Migration to Replit Completed Successfully (August 18, 2025)**: Project fully migrated from Replit Agent environment\n  - All Node.js dependencies installed via packager tool (Express, React, Radix UI, TypeScript, etc.)\n  - Server running smoothly on port 5000 with all API endpoints operational\n  - Frontend Vite development server connected and functional\n  - Background income system active with real-time data updates\n  - User authentication, server management, and game features all working\n  - Migration verified by user - project ready for continued development\n- **Critical Bug Fixes Completed (August 18, 2025)**: All major game functionality now working properly\n  - **Fixed apiRequest function**: Corrected function signature to properly handle POST requests with data\n  - **Daily Quest Rewards**: Quest reward claiming now works - money correctly added to user balance\n  - **Server Management**: Fixed deletion and load adjustment functions using proper API mutations\n  - **Server Functionality**: All server operations (delete, load adjustment, repair) now functional\n  - All previously reported bugs have been resolved - game is fully operational\n- **Migration Re-Verified (August 18, 2025)**: Successfully confirmed project migration from Replit Agent to standard Replit environment\n  - All Node.js dependencies properly installed and functioning\n  - Server running smoothly on port 5000 with all API endpoints operational\n  - Background income system active and updating user balances automatically\n  - Frontend React application connected via Vite with real-time data updates\n  - Complete project functionality verified - ready for continued development\n- **Mini-Game Fixes (August 18, 2025)**: Fixed critical mini-game bugs for improved user experience\n  - **Wire Connection Game**: Removed success dialog popup - now only shows toast notification and auto-closes\n  - **Cable/Port Bug**: Fixed mismatch where different numbers of cables and ports could be generated (now always equal 4-6)\n  - **Firewall Filter Game**: Fixed interface disappearing after 10 answers - now properly shows completion state\n  - **XP System**: Confirmed XP rewards work correctly for all mini-games except wire connection game (as intended)\n  - All mini-games now function properly with improved user flow and no blocking interface issues\n- **Migration Completed (August 18, 2025)**: Successfully migrated project from Replit Agent to standard Replit environment\n  - Installed all Node.js dependencies via packager tool including Express, React, Radix UI components, and all development tools\n  - Verified server startup and application functionality - server running on port 5000\n  - All API endpoints operational (auth, stats, rankings, player data)\n  - Frontend Vite server connected and serving React application\n  - All migration checklist items completed successfully\n  - Server simulation game is fully operational with background income updates, user rankings, and real-time stats\n  - Migration verified by user - project ready for continued development\n- **UI/UX Improvements (August 17, 2025)**:\n  - Fixed authentication API calls - corrected apiRequest function usage for proper JSON responses\n  - Made Reports, Daily Quests, and Achievements tabs accessible immediately after registration\n  - Only Servers, Hosting, and Learning tabs now require tutorial completion\n  - Enhanced user experience by removing tutorial dependency for key engagement features\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React 18 with TypeScript.\n- **Routing**: Wouter.\n- **State Management**: TanStack Query for server state and caching.\n- **UI Framework**: Radix UI components with shadcn/ui design system.\n- **Styling**: Tailwind CSS with CSS variables for theming and responsiveness.\n- **Build Tool**: Vite.\n- **UI/UX Decisions**:\n    - **Theming**: Comprehensive dark/light theme system with animated toggles, persistent preferences via localStorage. Default is dark theme.\n    - **Visual Indicators**: Difficulty-based colored circles for tutorial jobs (blue for easy, orange for medium, red for hard). Lock icons for level-restricted content.\n    - **Notifications**: Auto-dismissing notifications (5-second timeout), toast notifications with high z-index to prevent overlap.\n    - **Tooltips**: Contextual tooltips for interactive elements (e.g., avatar, nickname).\n    - **Admin Badges**: Distinct styling for super-admin (red gradient, pulse animation) and regular admin (gold gradient).\n    - **Avatar System**: Regular users have static gradients; super-admin has unique rainbow-pulse animation.\n    - **Responsiveness**: Mobile-first design with compact layouts, responsive typography, scrollable tabs, and optimized component rendering for smaller screens. Reduced particle animations and simplified blur effects for mobile performance.\n    - **Error Handling**: Client-side validation with real-time feedback and server-side validation.\n\n### Backend Architecture\n- **Runtime**: Node.js with Express.js.\n- **Language**: TypeScript.\n- **API Design**: RESTful architecture (`/api` prefix).\n- **Middleware**: Custom logging.\n- **Development**: Hot reloading with tsx.\n\n### Data Storage Solutions\n- **Database**: PostgreSQL.\n- **ORM**: Drizzle ORM for type-safe operations.\n- **Cloud Database**: Neon Database (serverless PostgreSQL).\n- **Migrations**: Drizzle Kit for schema management.\n\n### Authentication and Authorization\n- **Session Management**: Express sessions with PostgreSQL-backed storage (connect-pg-simple).\n- **Security**: HTTP-only cookies with secure flags.\n- **User Model**: Username/password authentication with hashed passwords. Case-insensitive username registration prevention.\n- **Admin System**: Multi-level admin roles (super-admin, regular admin) with granular permissions for user management, message moderation, and money management. Super-admin has exclusive access to critical controls and cannot be managed by regular admins. Admin badges reflect status at the time of message sending.\n\n### Game Logic Architecture\n- **Server Mechanics**: Predefined server types with income, costs, and purchase prices. **Automatic background income generation every minute for all users with active servers**. Server overload checks every 5 minutes (90%+ load), with reduced shutdown probabilities. Server repair displays cost and durability.\n- **Learning System**: Time-based courses unlocking capabilities and server slots (e.g., Security Protocols requires level 12, Database Server requires level 8).\n- **Gamification**:\n    - **Achievements System**: 5 progressive achievements with rewards.\n    - **Daily Quests**: 3 challenges resetting every 24 hours.\n- **Chat System**: Real-time general text chat with 100-message history, admin moderation (message deletion, user muting with expiration).\n- **Activity Tracking**: User action logging, real-time online status tracking (5-minute window) via API calls.\n- **Tutorial System**: Guided onboarding with completion tracking.\n- **Financial Tracking**: Accurate calculation of total earnings and total spent, with real-time balance updates in UI.\n\n## External Dependencies\n\n### Core Framework Dependencies\n- **React Ecosystem**: React 18, React DOM, React Hook Form.\n- **State Management**: TanStack React Query.\n- **Routing**: Wouter.\n\n### UI and Styling\n- **Component Library**: Radix UI.\n- **Styling**: Tailwind CSS, PostCSS.\n- **Icons**: Lucide React.\n- **Design System**: shadcn/ui.\n\n### Backend Infrastructure\n- **Web Framework**: Express.js.\n- **Database**: PostgreSQL (via Neon Database).\n- **ORM**: Drizzle ORM, Drizzle Kit.\n- **Session Management**: express-session, connect-pg-simple.\n\n### Development Tools\n- **Build System**: Vite.\n- **TypeScript**: Used full-stack.\n- **Development Server**: tsx.\n\n### Data Validation and Utilities\n- **Schema Validation**: Zod.\n- **Date Handling**: date-fns.\n- **Utility Libraries**: clsx, tailwind-merge.\n- **UUID Generation**: Node.js built-in crypto module.","size_bytes":13215},"tailwind.config.js":{"content":"/** @type {import('tailwindcss').Config} */\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n        inter: [\"Inter\", \"sans-serif\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n};\n","size_bytes":2789},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2766},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"server/index.js":{"content":"import express from \"express\";\nimport session from \"express-session\";\nimport os from \"os\";\nimport { registerRoutes } from \"./routes.js\";\nimport { setupVite, serveStatic, log } from \"./vite.js\";\nimport { storage } from \"./storage.js\";\n\nconst app = express();\napp.set('trust proxy', true); // Enable IP tracking for registration limits\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\n// Session configuration\napp.use(session({\n  secret: process.env.SESSION_SECRET || 'serversim-secret-key',\n  resave: false,\n  saveUninitialized: false,\n  cookie: {\n    secure: process.env.NODE_ENV === 'production',\n    httpOnly: true,\n    maxAge: 12 * 60 * 60 * 1000 // 12 hours\n  }\n}));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n// Middleware to update user activity on all API calls (excluding automatic updates)\napp.use('/api', async (req, res, next) => {\n  if (req.session.userId && !req.path.includes('/auth/logout') && !req.path.includes('/api/stats/') && !req.path.includes('/api/rankings')) {\n    try {\n      await storage.updateUserActivity(req.session.userId);\n      // Check expired mutes periodically\n      await storage.checkExpiredMutes();\n    } catch (error) {\n      // Ignore errors to not interrupt the request\n    }\n  }\n  next();\n});\n\n// Background income updater - runs every minute\nsetInterval(async () => {\n  try {\n    await storage.updateAllActiveUsersIncome();\n  } catch (error) {\n    log(`Income update error: ${error.message}`);\n  }\n}, 60000); // Every 60 seconds\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err, _req, res, _next) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    const interfaces = os.networkInterfaces();\n    let localIP = 'localhost';\n    \n    // Find local IP address\n    Object.keys(interfaces).forEach(interfaceName => {\n      const nets = interfaces[interfaceName];\n      nets.forEach(net => {\n        if (net.family === 'IPv4' && !net.internal) {\n          localIP = net.address;\n        }\n      });\n    });\n    \n    log(`Server started successfully!`);\n    log(`Local access: http://localhost:${port}`);\n    log(`Network access: http://${localIP}:${port}`);\n    log(`External access: Configure your router/firewall to forward port ${port}`);\n  });\n})();\n","size_bytes":3333},"server/routes.js":{"content":"import { createServer } from \"http\";\nimport bcrypt from \"bcrypt\";\nimport { storage } from \"./storage.js\";\nimport path from 'path';\nimport fs from 'fs';\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\n// Import avatar generation function\nfunction generateRandomAvatar(nickname = '') {\n  // Special avatar for Ca6aka (super admin)\n  if (nickname === 'Ca6aka') {\n    return {\n      gradient: 'from-purple-500 via-pink-500 via-red-500 via-yellow-500 via-green-500 via-blue-500 to-purple-500',\n      pattern: 'rainbow-super-admin',\n      seed: 999999,\n      animation: 'rainbow-pulse'\n    };\n  }\n  \n  const multiColorGradients = [\n    'from-red-400 via-pink-500 to-purple-600',\n    'from-blue-400 via-purple-500 to-indigo-600', \n    'from-green-400 via-teal-500 to-cyan-600',\n    'from-yellow-400 via-orange-500 to-red-600',\n    'from-purple-400 via-violet-500 to-indigo-600',\n    'from-pink-400 via-rose-500 to-red-600',\n    'from-indigo-400 via-blue-500 to-cyan-600',\n    'from-teal-400 via-emerald-500 to-green-600',\n    'from-orange-400 via-amber-500 to-yellow-600',\n    'from-cyan-400 via-sky-500 to-blue-600',\n    'from-emerald-400 via-green-500 to-teal-600',\n    'from-rose-400 via-pink-500 to-red-600',\n    'from-violet-400 via-purple-500 to-indigo-600',\n    'from-amber-400 via-orange-500 to-red-600',\n    'from-lime-400 via-green-500 to-emerald-600'\n  ];\n  \n  const animations = [\n    'gradient-shift',\n    'pulse-glow', \n    'shimmer-wave',\n    'color-dance',\n    'soft-pulse'\n  ];\n  \n  const selectedGradient = multiColorGradients[Math.floor(Math.random() * multiColorGradients.length)];\n  const selectedAnimation = animations[Math.floor(Math.random() * animations.length)];\n  \n  return {\n    gradient: selectedGradient,\n    pattern: 'multi-color',\n    seed: Math.floor(Math.random() * 1000000),\n    animation: selectedAnimation\n  };\n}\n\nexport async function registerRoutes(app) {\n  // Middleware for requiring authentication\n  const requireAuth = (req, res, next) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ message: 'Not authenticated' });\n    }\n    next();\n  };\n\n  // Update user real activity for manual interactions (not automatic API calls)\n  app.use('/api', (req, res, next) => {\n    if (req.session?.userId) {\n      // Only update realActivity for manual user interactions, not automatic background calls\n      const isAutomatic = req.path.includes('/income') || \n                          req.path.includes('/stats/general') || \n                          req.path.includes('/rankings') ||\n                          req.path.includes('/auth/me') ||\n                          req.path.includes('/servers') ||\n                          req.path.includes('/learning/current') ||\n                          req.path.includes('/jobs/cooldowns') ||\n                          req.path.includes('/activities');\n      \n      if (!isAutomatic) {\n        storage.updateUserRealActivity(req.session.userId).catch(console.error);\n      }\n    }\n    next();\n  });\n\n  // Authentication routes\n  app.post('/api/auth/register', async (req, res) => {\n    try {\n      const { nickname, password, confirmPassword } = req.body;\n      \n      if (!nickname || !password || !confirmPassword) {\n        return res.status(400).json({ message: 'All fields are required' });\n      }\n      \n      if (password !== confirmPassword) {\n        return res.status(400).json({ message: 'Passwords do not match' });\n      }\n      \n      if (password.length < 6) {\n        return res.status(404).json({ success: false, message: 'Password must be at least 6 characters long' });\n      }\n\n      // IP-based registration limits\n      const clientIP = req.ip || req.connection.remoteAddress || req.socket.remoteAddress || \n                      (req.connection.socket ? req.connection.socket.remoteAddress : null);\n      \n      // Check if IP already registered maximum accounts (lifetime limit)\n      const registrations = await storage.checkRegistrationsByIP(clientIP);\n      if (registrations >= 5) {\n        return res.status(400).json({ \n          message: 'Registration limit exceeded. Maximum 5 accounts per IP address.' \n        });\n      }\n      \n      // Normalize nickname to handle auto-translation issues\n      const normalizedNickname = nickname.toLowerCase().trim();\n      \n      // Check for existing user with case-insensitive nickname\n      const existingUser = await storage.getUserByNickname(nickname);\n      if (existingUser) {\n        return res.status(400).json({ message: 'Nickname already exists' });\n      }\n      \n      // Additional check for case-insensitive duplicates\n      const existingUserCaseInsensitive = await storage.getUserByNicknameCaseInsensitive(nickname);\n      if (existingUserCaseInsensitive) {\n        return res.status(400).json({ message: 'A user with this nickname already exists (case-insensitive)' });\n      }\n      \n      // Generate random avatar for new user\n      const avatarColors = [\n        'from-red-400 to-pink-600',\n        'from-blue-400 to-purple-600', \n        'from-green-400 to-teal-600',\n        'from-yellow-400 to-orange-600',\n        'from-purple-400 to-indigo-600',\n        'from-pink-400 to-red-600',\n        'from-indigo-400 to-blue-600',\n        'from-teal-400 to-green-600',\n        'from-orange-400 to-yellow-600',\n        'from-cyan-400 to-blue-600',\n        'from-emerald-400 to-cyan-600',\n        'from-rose-400 to-pink-600',\n        'from-violet-400 to-purple-600',\n        'from-amber-400 to-orange-600',\n        'from-lime-400 to-green-600'\n      ];\n      \n      const randomAvatar = generateRandomAvatar(nickname);\n\n      const hashedPassword = await bcrypt.hash(password, 10);\n      const user = await storage.createUser({ \n        nickname, \n        password: hashedPassword,\n        admin: nickname === 'Ca6aka' ? 2 : 0,  // Make Ca6aka super admin automatically\n        isOnline: true,\n        avatar: randomAvatar,\n        registrationIP: clientIP,\n        registrationTime: Date.now()\n      });\n      \n      req.session.userId = user.id;\n      res.json({ user: { ...user, password: undefined } });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/auth/login', async (req, res) => {\n    try {\n      const { nickname, password } = req.body;\n      \n      if (!nickname || !password) {\n        return res.status(400).json({ message: 'Nickname and password are required' });\n      }\n      \n      // Try to find user by exact match first, then case-insensitive\n      let user = await storage.getUserByNickname(nickname);\n      if (!user) {\n        // Try case-insensitive search to handle auto-translation issues\n        user = await storage.getUserByNicknameCaseInsensitive(nickname);\n      }\n      \n      if (!user) {\n        return res.status(401).json({ message: 'Invalid credentials' });\n      }\n      \n      const isValidPassword = await bcrypt.compare(password, user.password);\n      if (!isValidPassword) {\n        return res.status(401).json({ message: 'Invalid credentials' });\n      }\n      \n      // Check if user is banned\n      if (user.banned) {\n        return res.status(403).json({ message: 'Account has been banned. Contact administrator.' });\n      }\n      \n      // Set user online when logging in\n      await storage.updateUser(user.id, { ...user, isOnline: true, lastSeen: Date.now() });\n      \n      req.session.userId = user.id;\n      res.json({ user: { ...user, password: undefined, isOnline: true } });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/auth/me', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const user = await storage.getUser(req.session.userId);\n      if (!user) {\n        return res.status(401).json({ message: 'User not found' });\n      }\n      \n      // User activity is now updated by middleware\n      \n      res.json({ user: { ...user, password: undefined } });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/auth/logout', async (req, res) => {\n    const userId = req.session.userId;\n    \n    // Update user's online status to false\n    if (userId) {\n      try {\n        const user = await storage.getUser(userId);\n        if (user) {\n          await storage.updateUser(userId, { ...user, isOnline: false });\n        }\n      } catch (error) {\n        console.log('Error updating offline status:', error);\n      }\n    }\n    \n    req.session.destroy((err) => {\n      if (err) {\n        return res.status(500).json({ message: 'Could not log out' });\n      }\n      res.json({ message: 'Logged out successfully' });\n    });\n  });\n\n  // Server routes\n  app.get('/api/servers', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const servers = await storage.getUserServers(req.session.userId);\n      \n      // Check for server overloads in real-time\n      for (const server of servers) {\n        if (server.isOnline && server.loadPercentage) {\n          await storage.checkServerOverload(req.session.userId, server.id, server.loadPercentage);\n        }\n      }\n      \n      // Get updated servers after overload check\n      const updatedServers = await storage.getUserServers(req.session.userId);\n      \n      // Sync with global servers JSON\n      await storage.syncServerData(updatedServers);\n      res.json({ servers: updatedServers });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/servers/purchase', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { productId } = req.body;\n      const result = await storage.purchaseServer(req.session.userId, productId);\n      \n      res.json(result);\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/servers/:id/toggle', async (req, res) => {\n    try {\n      console.log(`[SERVER TOGGLE] Request received for server ${req.params.id}`);\n      console.log(`[SERVER TOGGLE] User ID: ${req.session.userId}`);\n      \n      if (!req.session.userId) {\n        console.log('[SERVER TOGGLE] Not authenticated');\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { id } = req.params;\n      console.log(`[SERVER TOGGLE] Calling storage.toggleServer for user ${req.session.userId}, server ${id}`);\n      \n      await storage.toggleServer(req.session.userId, id);\n      \n      console.log(`[SERVER TOGGLE] Server ${id} toggled successfully`);\n      res.json({ message: 'Server status updated', success: true });\n    } catch (error) {\n      console.error(`[SERVER TOGGLE] Error: ${error.message}`);\n      res.status(400).json({ message: error.message, success: false });\n    }\n  });\n\n  app.delete('/api/servers/:id', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        console.log('[SERVER DELETE] No user ID in session');\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { id } = req.params;\n      console.log(`[SERVER DELETE] User ${req.session.userId} deleting server ${id}`);\n      \n      await storage.deleteServer(req.session.userId, id);\n      \n      console.log(`[SERVER DELETE] Server ${id} deleted successfully`);\n      res.json({ message: 'Server deleted successfully' });\n    } catch (error) {\n      console.error(`[SERVER DELETE] Error: ${error.message}`);\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/servers/:id/load', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        console.log('[SERVER LOAD] No user ID in session');\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { id } = req.params;\n      const { loadPercentage } = req.body;\n      \n      console.log(`[SERVER LOAD] User ${req.session.userId} updating server ${id} to ${loadPercentage}%`);\n      \n      if (loadPercentage < 10 || loadPercentage > 100) {\n        return res.status(400).json({ message: 'Load percentage must be between 10 and 100' });\n      }\n      \n      await storage.updateServerLoad(req.session.userId, id, loadPercentage);\n      \n      console.log(`[SERVER LOAD] Server ${id} load updated successfully to ${loadPercentage}%`);\n      res.json({ message: 'Server load updated successfully' });\n    } catch (error) {\n      console.error(`[SERVER LOAD] Error: ${error.message}`);\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/servers/:id/repair', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { id } = req.params;\n      const { repairType = 'full' } = req.body;\n      \n      if (!['full', 'partial'].includes(repairType)) {\n        return res.status(400).json({ message: 'Invalid repair type. Must be \"full\" or \"partial\"' });\n      }\n      \n      const result = await storage.repairServer(req.session.userId, id, repairType);\n      \n      res.json({ \n        message: 'Server repaired successfully',\n        ...result\n      });\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // Job routes\n  app.post('/api/jobs/:jobType/start', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { jobType } = req.params;\n      const result = await storage.startJob(req.session.userId, jobType);\n      \n      res.json(result);\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/jobs/cooldowns', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const cooldowns = await storage.getJobCooldowns(req.session.userId);\n      res.json({ cooldowns });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Learning routes\n  app.post('/api/learning/start', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { courseId } = req.body;\n      const result = await storage.startLearning(req.session.userId, courseId);\n      \n      res.json(result);\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.get('/api/learning/current', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const learning = await storage.getCurrentLearning(req.session.userId);\n      res.json({ learning });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Activity routes\n  app.get('/api/activities', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const activities = await storage.getUserActivities(req.session.userId);\n      res.json({ activities });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Income update route\n  app.post('/api/income/update', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const result = await storage.updateIncome(req.session.userId);\n      res.json(result);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Admin routes\n  app.get('/api/admin/users', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const currentUser = await storage.getUser(req.session.userId);\n      if (!currentUser || currentUser.admin < 1) {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n      \n      const users = await storage.getAllUsers();\n      res.json({ \n        users: users.map(user => ({ \n          ...user, \n          password: undefined \n        })) \n      });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/admin/manage', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const currentUser = await storage.getUser(req.session.userId);\n      if (!currentUser || currentUser.admin < 1) {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n      \n      const { userId, action, amount } = req.body;\n      const targetUser = await storage.getUser(userId);\n      \n      if (!targetUser) {\n        return res.status(404).json({ message: 'User not found' });\n      }\n\n      // Prevent non-super-admins from modifying super admin (except for money operations by super admin himself)\n      if (targetUser.nickname === 'Ca6aka' && currentUser.nickname !== 'Ca6aka') {\n        return res.status(400).json({ message: 'Cannot modify super admin' });\n      }\n      \n      let updatedUser = { ...targetUser };\n      let actionDescription = '';\n      \n      switch (action) {\n        case 'giveAdmin':\n          if (currentUser.nickname !== 'Ca6aka') {\n            return res.status(403).json({ message: 'Super admin access required' });\n          }\n          updatedUser.admin = 1;\n          actionDescription = `Given admin privileges by ${currentUser.nickname}`;\n          break;\n        case 'removeAdmin':\n          if (currentUser.nickname !== 'Ca6aka') {\n            return res.status(403).json({ message: 'Super admin access required' });\n          }\n          updatedUser.admin = 0;\n          actionDescription = `Admin privileges removed by ${currentUser.nickname}`;\n          break;\n\n          async function forceLogoutUser(userId) {\n            return new Promise((resolve, reject) => {\n              const store = req.sessionStore; // стандартный store из express-session\n              store.all((err, sessions) => {\n                if (err) return reject(err);\n          \n                const destroyPromises = [];\n                for (const sid in sessions) {\n                  const sess = sessions[sid];\n                  if (sess.userId === userId) {\n                    destroyPromises.push(\n                      new Promise((res, rej) => store.destroy(sid, e => (e ? rej(e) : res())))\n                    );\n                  }\n                }\n          \n                Promise.all(destroyPromises).then(resolve).catch(reject);\n              });\n            });\n          }\n\n        case 'banUser':\n          // Only super-admin can ban other admins\n          if (targetUser.admin >= 1 && currentUser.nickname !== 'Ca6aka') {\n            return res.status(403).json({ message: 'Only super admin can ban other admins' });\n          }\n          updatedUser.banned = true;\n          updatedUser.isOnline = false;\n          \n          // Turn off all user's servers when banned\n          try {\n            const servers = await storage.getUserServers(userId);\n            for (const server of servers) {\n              if (server.isOnline) {\n                await storage.toggleServer(userId, server.id);\n              }\n            }\n          } catch (error) {\n            console.error('Failed to turn off banned user servers:', error);\n          }\n          \n          // Force logout the banned user\n          try {\n            await forceLogoutUser(targetUser.id);\n          } catch (error) {\n            console.error('Failed to force logout banned user:', error);\n          }\n          \n          await storage.updateUser(userId, updatedUser);\n\n          actionDescription = `Account banned by admin ${currentUser.nickname}`;\n          return res.json({ message: `User ${targetUser.nickname} has been banned`, banned: true });\n        case 'unbanUser':\n          updatedUser.banned = false;\n          actionDescription = `Account unbanned by admin ${currentUser.nickname}`;\n          break;\n        case 'addMoney':\n          if (currentUser.nickname !== 'Ca6aka') {\n            return res.status(403).json({ message: 'Super admin access required' });\n          }\n          if (!amount || amount <= 0) {\n            return res.status(400).json({ message: 'Valid amount required' });\n          }\n          updatedUser.balance = (targetUser.balance || 0) + amount;\n          actionDescription = `Received $${amount.toLocaleString()} from super admin`;\n          break;\n        case 'removeMoney':\n          if (currentUser.nickname !== 'Ca6aka') {\n            return res.status(403).json({ message: 'Super admin access required' });\n          }\n          if (!amount || amount <= 0) {\n            return res.status(400).json({ message: 'Valid amount required' });\n          }\n          updatedUser.balance = Math.max(0, (targetUser.balance || 0) - amount);\n          actionDescription = `$${amount.toLocaleString()} removed by super admin`;\n          break;\n        case 'deleteUser':\n          if (!currentUser || currentUser.nickname !== 'Ca6aka') {\n            return res.status(403).json({ message: 'Only super admin can delete users.' });\n          }\n\n          try {\n            await storage.deleteUserByNickname(targetUser.nickname);\n            await storage.deleteServersByOwner(targetUser.id); // <-- это удалит все сервера игрока\n            actionDescription = `User ${targetUser.nickname} deleted by super admin ${currentUser.nickname}`;\n            break;\n          } catch (error) {\n            return res.status(500).json({ message: 'Failed to delete user' });\n          }\n        case 'muteUser':\n          // Can't mute other admins unless you're super admin\n          if (targetUser.admin >= 1 && currentUser.nickname !== 'Ca6aka') {\n            return res.status(403).json({ message: 'Only super admin can mute other admins' });\n          }\n          const muteDuration = amount || 30; // Default 30 minutes\n          const muteExpires = Date.now() + (muteDuration * 60 * 1000);\n          updatedUser.muted = true;\n          updatedUser.muteExpires = muteExpires;\n          actionDescription = `Muted for ${muteDuration} minutes by admin ${currentUser.nickname}`;\n          break;\n        case 'unmuteUser':\n          updatedUser.muted = false;\n          updatedUser.muteExpires = null;\n          actionDescription = `Unmuted by admin ${currentUser.nickname}`;\n          break;\n        default:\n          return res.status(400).json({ message: 'Invalid action' });\n      }\n      \n      await storage.updateUser(userId, updatedUser);\n      \n      // Add activity to target user's log\n      if (actionDescription) {\n        await storage.addActivity(userId, actionDescription);\n      }\n      \n      res.json({ success: true, message: 'Action completed successfully' });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Tutorial route\n  app.post('/api/tutorial/complete', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const result = await storage.completeTutorial(req.session.userId);\n      res.json(result);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Rankings route\n  app.get('/api/rankings', async (req, res) => {\n    try {\n      const rankings = await storage.getRankings();\n      res.json({ rankings });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // General stats route for landing page\n  app.get('/api/stats/general', async (req, res) => {\n    try {\n      const stats = await storage.getGeneralStats();\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Player profile route\n  app.get('/api/player/:nickname', async (req, res) => {\n    try {\n      const { nickname } = req.params;\n      const player = await storage.getPlayerByNickname(nickname);\n      \n      if (!player) {\n        return res.status(404).json({ message: 'Player not found' });\n      }\n      \n      const isOnline = storage.isUserOnline(player);\n      \n      res.json({ \n        player: {\n          ...player,\n          password: undefined // Remove password from response\n        },\n        isOnline \n      });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Achievements routes\n  app.get('/api/achievements', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const user = await storage.getUser(req.session.userId);\n      if (!user) {\n        return res.status(401).json({ message: 'User not found' });\n      }\n\n      // Check for new achievements\n      await storage.checkAchievements(req.session.userId);\n      \n      // Get regular achievements\n      const allAchievements = storage.getAchievements();\n      const userAchievements = user.achievements || [];\n      \n      const achievementsWithStatus = allAchievements.map(achievement => ({\n        ...achievement,\n        earned: userAchievements.includes(achievement.id)\n      }));\n\n      // Get chat achievements and integrate them\n      const chatAchievements = await storage.getChatAchievements(req.session.userId);\n      const userChatAchievements = user.chatAchievements || [];\n      \n      const chatAchievementsWithStatus = chatAchievements.map(achievement => ({\n        id: achievement.id,\n        title: achievement.title,\n        description: achievement.description,\n        icon: 'fas fa-comment',\n        reward: 0, // Chat achievements don't give money rewards\n        earned: userChatAchievements.includes(achievement.id),\n        progress: achievement.progress,\n        requirement: achievement.requirement,\n        isChat: true\n      }));\n\n      // Combine all achievements\n      const allCombinedAchievements = [...achievementsWithStatus, ...chatAchievementsWithStatus];\n      \n      res.json({ achievements: allCombinedAchievements });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Daily quests routes\n  app.get('/api/quests', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const user = await storage.getUser(req.session.userId);\n      if (!user) {\n        return res.status(401).json({ message: 'User not found' });\n      }\n\n      // Check for quest reset\n      await storage.checkDailyQuestReset(req.session.userId);\n      \n      const updatedUser = await storage.getUser(req.session.userId);\n      res.json({ quests: updatedUser.dailyQuests || [] });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Handle both GET and POST for quest claim (some frontend libraries might use GET)\n  app.get('/api/quests/:questId/claim', async (req, res) => {\n    console.log('*** CLAIM QUEST ENDPOINT HIT (GET) ***', req.params.questId);\n    try {\n      if (!req.session.userId) {\n        console.log('*** Not authenticated ***');\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const questId = decodeURIComponent(req.params.questId);\n      console.log('*** Claiming quest (GET):', questId, 'for user:', req.session.userId, '***');\n      \n      const user = await storage.getUser(req.session.userId);\n      if (!user) {\n        console.log('User not found:', req.session.userId);\n        return res.status(401).json({ message: 'User not found' });\n      }\n\n      console.log('User found, checking quests:', user.dailyQuests?.length || 0);\n      const quest = (user.dailyQuests || []).find(q => q.id === questId);\n      if (!quest) {\n        console.log('Quest not found:', questId, 'Available quests:', user.dailyQuests?.map(q => q.id));\n        return res.status(404).json({ message: 'Quest not found' });\n      }\n      \n      console.log('Quest found:', quest.title, 'completed:', quest.completed, 'claimed:', quest.claimed);\n      \n      if (!quest.completed) {\n        return res.status(400).json({ message: 'Quest not completed yet' });\n      }\n      \n      if (quest.claimed) {\n        return res.status(400).json({ message: 'Reward already claimed' });\n      }\n\n      // Mark quest as claimed and give reward\n      const updatedQuests = user.dailyQuests.map(q => \n        q.id === questId ? { ...q, claimed: true } : q\n      );\n      \n      const newBalance = user.balance + quest.reward;\n      console.log('Updating balance from', user.balance, 'to', newBalance, 'reward:', quest.reward);\n      \n      const updatedUser = await storage.updateUser(req.session.userId, {\n        balance: newBalance,\n        dailyQuests: updatedQuests\n      });\n\n      await storage.addActivity(req.session.userId, `Quest reward claimed: ${quest.title} (+$${quest.reward.toLocaleString()})`);\n      \n      console.log('Reward claimed successfully, new balance:', updatedUser.balance);\n      res.json({ user: updatedUser, message: 'Reward claimed successfully' });\n    } catch (error) {\n      console.error('Error claiming quest reward:', error);\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/quests/:questId/claim', async (req, res) => {\n    console.log('*** CLAIM QUEST ENDPOINT HIT (POST) ***', req.params.questId);\n    try {\n      if (!req.session.userId) {\n        console.log('*** Not authenticated ***');\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const questId = decodeURIComponent(req.params.questId);\n      console.log('*** Claiming quest (POST):', questId, 'for user:', req.session.userId, '***');\n      \n      const user = await storage.getUser(req.session.userId);\n      if (!user) {\n        console.log('User not found:', req.session.userId);\n        return res.status(401).json({ message: 'User not found' });\n      }\n\n      console.log('User found, checking quests:', user.dailyQuests?.length || 0);\n      const quest = (user.dailyQuests || []).find(q => q.id === questId);\n      if (!quest) {\n        console.log('Quest not found:', questId, 'Available quests:', user.dailyQuests?.map(q => q.id));\n        return res.status(404).json({ message: 'Quest not found' });\n      }\n      \n      console.log('Quest found:', quest.title, 'completed:', quest.completed, 'claimed:', quest.claimed);\n      \n      if (!quest.completed) {\n        return res.status(400).json({ message: 'Quest not completed yet' });\n      }\n      \n      if (quest.claimed) {\n        return res.status(400).json({ message: 'Reward already claimed' });\n      }\n\n      // Mark quest as claimed and give reward\n      const updatedQuests = user.dailyQuests.map(q => \n        q.id === questId ? { ...q, claimed: true } : q\n      );\n      \n      const newBalance = user.balance + quest.reward;\n      console.log('Updating balance from', user.balance, 'to', newBalance, 'reward:', quest.reward);\n      \n      const updatedUser = await storage.updateUser(req.session.userId, {\n        balance: newBalance,\n        dailyQuests: updatedQuests\n      });\n\n      await storage.addActivity(req.session.userId, `Quest reward claimed: ${quest.title} (+$${quest.reward.toLocaleString()})`);\n      \n      console.log('Reward claimed successfully, new balance:', updatedUser.balance);\n      res.json({ user: updatedUser, message: 'Reward claimed successfully' });\n    } catch (error) {\n      console.error('Error claiming quest reward:', error);\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Chat routes\n  app.get('/api/chat/messages', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { language } = req.query;\n      \n      const messages = await storage.getChatMessages(language || 'en');\n      \n      // Show all messages to admins, filter deleted for regular users\n      const user = await storage.getUser(req.session.userId);\n      const filteredMessages = user.admin >= 1 \n        ? messages \n        : messages.filter(msg => !msg.deleted);\n      \n      res.json({ messages: filteredMessages });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/chat/send', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { message, language } = req.body;\n      \n      if (!message || message.trim().length === 0) {\n        return res.status(400).json({ message: 'Message cannot be empty' });\n      }\n      \n      if (message.length > 500) {\n        return res.status(400).json({ message: 'Message too long (max 500 characters)' });\n      }\n      \n      // Check cooldown (5 seconds between messages)\n      const user = await storage.getUser(req.session.userId);\n      const lastMessageTime = user.lastMessageTime || 0;\n      const now = Date.now();\n      if (now - lastMessageTime < 5000 && user.admin < 1) {\n        return res.status(429).json({ \n          message: 'Please wait before sending another message',\n          cooldownRemaining: Math.ceil((5000 - (now - lastMessageTime)) / 1000)\n        });\n      }\n      \n      const newMessage = await storage.sendChatMessage(req.session.userId, message, language);\n      res.json({ message: newMessage });\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.delete('/api/chat/message/:messageId', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { messageId } = req.params;\n      const { language } = req.query;\n      const deletedMessage = await storage.deleteChatMessage(messageId, req.session.userId, language || 'en');\n      \n      res.json({ success: true, message: deletedMessage });\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/chat/mute', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { userId, duration } = req.body;\n      \n      if (!userId || !duration) {\n        return res.status(400).json({ message: 'User ID and duration required' });\n      }\n      \n      const result = await storage.muteUser(userId, req.session.userId, duration);\n      res.json(result);\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  app.post('/api/chat/unmute', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { userId } = req.body;\n      \n      if (!userId) {\n        return res.status(400).json({ message: 'User ID required' });\n      }\n      \n      const result = await storage.unmuteUser(userId, req.session.userId);\n      res.json(result);\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n\n  // New chat routes for advanced features\n  \n  // React to message\n  app.post('/api/chat/message/:messageId/react', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { messageId } = req.params;\n      const { emoji } = req.body;\n      \n      const { language } = req.query;\n      const reaction = await storage.addMessageReaction(messageId, req.session.userId, emoji, language || 'en');\n      res.json({ reaction });\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n  \n  // Pin/unpin message (super-admin only)\n  app.post('/api/chat/message/:messageId/pin', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const { messageId } = req.params;\n      const { language } = req.query;\n      const result = await storage.pinMessage(messageId, req.session.userId, language || 'en');\n      res.json(result);\n    } catch (error) {\n      res.status(400).json({ message: error.message });\n    }\n  });\n  \n  // Get pinned message\n  app.get('/api/chat/pinned', async (req, res) => {\n    try {\n      const { language } = req.query;\n      const pinnedMessage = await storage.getPinnedMessage(language || 'en');\n      res.json({ pinnedMessage });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n  \n  // Mark chat as read (remove new message indicator)\n  app.post('/api/chat/mark-read', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      await storage.markChatAsRead(req.session.userId);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n  \n  // Get chat achievements\n  app.get('/api/achievements/chat', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const achievements = await storage.getChatAchievements(req.session.userId);\n      res.json({ achievements });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Get active mutes for admin panel\n  app.get('/api/chat/active-mutes', async (req, res) => {\n    try {\n      if (!req.session.userId) {\n        return res.status(401).json({ message: 'Not authenticated' });\n      }\n      \n      const user = await storage.getUser(req.session.userId);\n      if (!user || user.admin < 1) {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n      \n      const activeMutes = await storage.getActiveMutes();\n      res.json({ mutes: activeMutes });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Reports System Routes\n  app.get('/api/reports', requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user) {\n        return res.status(401).json({ message: 'Unauthorized' });\n      }\n\n      let reports;\n      if (user.admin >= 1) {\n        // Admin sees all reports\n        reports = await storage.getAdminReports();\n      } else {\n        // User sees only their reports\n        reports = await storage.getUserReports(user.id);\n      }\n\n      res.json(reports);\n    } catch (error) {\n      console.error('Error getting reports:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  app.post('/api/reports', requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user || user.banned) {\n        return res.status(403).json({ message: 'Access denied' });\n      }\n\n      const { subject, category, message } = req.body;\n\n      if (!subject || !category || !message) {\n        return res.status(400).json({ message: 'Subject, category, and message are required' });\n      }\n\n      if (subject.length > 50) {\n        return res.status(400).json({ message: 'Subject must be no more than 50 characters' });\n      }\n\n      if (message.length > 500) {\n        return res.status(400).json({ message: 'Message must be no more than 500 characters' });\n      }\n\n      const report = await storage.createReport(user.id, subject, category, message);\n      res.json(report);\n    } catch (error) {\n      console.error('Error creating report:', error);\n      if (error.message === 'You already have an active report') {\n        return res.status(400).json({ message: error.message });\n      }\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  app.get('/api/reports/:reportId/messages', requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user) {\n        return res.status(401).json({ message: 'Unauthorized' });\n      }\n\n      const { reportId } = req.params;\n      const report = await storage.getReportById(reportId);\n      \n      if (!report) {\n        return res.status(404).json({ message: 'Report not found' });\n      }\n\n      // Check if user can access this report\n      if (user.admin < 1 && report.userId !== user.id) {\n        return res.status(403).json({ message: 'Access denied' });\n      }\n\n      const messages = await storage.getReportMessages(reportId);\n      \n      // Mark as read by clearing new messages flag\n      if (user.admin >= 1 || report.userId === user.id) {\n        await storage.updateReport(reportId, { hasNewMessages: false });\n      }\n\n      res.json(messages);\n    } catch (error) {\n      console.error('Error getting report messages:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  app.post('/api/reports/:reportId/messages', requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user || user.banned) {\n        return res.status(403).json({ message: 'Access denied' });\n      }\n\n      const { reportId } = req.params;\n      const { message } = req.body;\n\n      if (!message || message.length > 500) {\n        return res.status(400).json({ message: 'Message is required and must be under 500 characters' });\n      }\n\n      const report = await storage.getReportById(reportId);\n      if (!report) {\n        return res.status(404).json({ message: 'Report not found' });\n      }\n\n      if (report.status !== 'open') {\n        return res.status(400).json({ message: 'Cannot send message to closed report' });\n      }\n\n      // Check if user can send messages to this report\n      const isFromAdmin = user.admin >= 1;\n      if (!isFromAdmin && report.userId !== user.id) {\n        return res.status(403).json({ message: 'Access denied' });\n      }\n\n      const newMessage = await storage.createReportMessage(reportId, user.id, message, isFromAdmin);\n      res.json(newMessage);\n    } catch (error) {\n      console.error('Error creating report message:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  app.post('/api/reports/:reportId/close', requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user || user.admin < 1) {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { reportId } = req.params;\n      const updatedReport = await storage.closeReport(reportId, user.id);\n      res.json(updatedReport);\n    } catch (error) {\n      console.error('Error closing report:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  app.post('/api/reports/:reportId/mark', requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user || user.admin < 1) {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { reportId } = req.params;\n      const updatedReport = await storage.markReport(reportId, user.id);\n      res.json(updatedReport);\n    } catch (error) {\n      console.error('Error marking report:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  app.post('/api/reports/:reportId/reopen', requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user || user.admin < 1) {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { reportId } = req.params;\n      const report = await storage.getReportById(reportId);\n      \n      if (!report) {\n        return res.status(404).json({ message: 'Report not found' });\n      }\n\n      if (report.status === 'open') {\n        return res.status(400).json({ message: 'Report is already open' });\n      }\n\n      await storage.updateReport(reportId, {\n        status: 'open',\n        closedAt: null,\n        closedBy: null\n      });\n\n      res.json({ success: true });\n    } catch (error) {\n      console.error('Error reopening report:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  app.delete('/api/reports/:reportId', requireAuth, async (req, res) => {\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user || user.admin < 1) {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { reportId } = req.params;\n      await storage.deleteReport(reportId);\n      res.json({ success: true });\n    } catch (error) {\n      console.error('Error deleting report:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  // Add XP to user (for mini-games)\n  app.post('/api/users/add-xp', requireAuth, async (req, res) => {\n    try {\n      const { xp } = req.body;\n      \n      if (!xp || typeof xp !== 'number' || xp < 0) {\n        return res.status(400).json({ message: 'Invalid XP amount' });\n      }\n\n      const user = await storage.getUser(req.session.userId);\n      const oldLevel = user.level || 1;\n      \n      const updatedUser = await storage.addUserXP(req.session.userId, xp);\n      const newLevel = updatedUser.level || 1;\n      \n      const leveledUp = newLevel > oldLevel;\n      \n      res.json({ \n        user: updatedUser, \n        xpGained: xp,\n        experience: updatedUser.experience,\n        level: updatedUser.level,\n        balance: updatedUser.balance,\n        leveledUp,\n        newLevel: leveledUp ? newLevel : undefined\n      });\n    } catch (error) {\n      console.error('Error adding XP:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  // Damage server durability (for failed mini-game)\n  app.post('/api/servers/:serverId/damage', requireAuth, async (req, res) => {\n    try {\n      const { serverId } = req.params;\n      const server = await storage.getServer(serverId);\n      \n      if (!server || server.ownerId !== req.session.userId) {\n        return res.status(404).json({ message: 'Server not found' });\n      }\n\n      const updatedServer = await storage.updateServer(serverId, {\n        durability: Math.max(0, server.durability - 1)\n      });\n\n      res.json({ server: updatedServer });\n    } catch (error) {\n      console.error('Error damaging server:', error);\n      res.status(500).json({ message: 'Server error' });\n    }\n  });\n\n  // Hidden achievements endpoints\n  app.get('/api/hidden-achievements', requireAuth, async (req, res) => {\n    try {\n      const achievements = await storage.getHiddenAchievements();\n      const userData = await storage.getUser(req.session.userId);\n      const unlockedAchievements = userData.unlockedHiddenAchievements || [];\n      \n      const processedAchievements = achievements.map(achievement => {\n        const isUnlocked = unlockedAchievements.includes(achievement.id);\n        if (!isUnlocked) {\n          return {\n            id: achievement.id,\n            name: '???',\n            description: 'Hidden achievement',\n            isLocked: true,\n            isHidden: true\n          };\n        }\n        return { ...achievement, isLocked: false };\n      });\n      \n      res.json({ achievements: processedAchievements });\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to get hidden achievements' });\n    }\n  });\n\n  // Daily login bonus endpoints\n  app.get('/api/daily-bonus', requireAuth, async (req, res) => {\n    try {\n      const bonusInfo = await storage.getDailyLoginBonus(req.session.userId);\n      res.json(bonusInfo);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to get daily bonus info' });\n    }\n  });\n\n  app.post('/api/daily-bonus/claim', requireAuth, async (req, res) => {\n    try {\n      const result = await storage.claimDailyBonus(req.session.userId);\n      res.json(result);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to claim daily bonus' });\n    }\n  });\n\n  // Tutorial endpoints\n  app.get('/api/tutorial', requireAuth, async (req, res) => {\n    try {\n      const progress = await storage.getTutorialProgress(req.session.userId);\n      res.json(progress);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to get tutorial progress' });\n    }\n  });\n\n  app.post('/api/tutorial/progress', requireAuth, async (req, res) => {\n    try {\n      const { step } = req.body;\n      const progress = await storage.updateTutorialProgress(req.session.userId, step);\n      res.json(progress);\n    } catch (error) {\n      res.status(500).json({ error: 'Failed to update tutorial progress' });\n    }\n  });\n\n  // Additional API endpoints for new features\n  app.get('/api/achievements/hidden', requireAuth, async (req, res) => {\n    try {\n      const achievements = await storage.getHiddenAchievementsForUser(req.session.userId);\n      res.json({ achievements });\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n  // Daily bonus API\n  app.get('/api/daily-bonus', requireAuth, async (req, res) => {\n    try {\n      const bonusInfo = await storage.getDailyLoginBonus(req.session.userId);\n      res.json(bonusInfo);\n    } catch (error) {\n      res.status(500).json({ message: error.message });\n    }\n  });\n\n\n\n  // Donation routes\n  app.post('/api/donation/purchase', requireAuth, async (req, res) => {\n    try {\n      const { type, gateway } = req.body;\n      const userId = req.session.userId;\n      \n      if (!type || !gateway) {\n        return res.status(400).json({ error: 'Type and gateway are required' });\n      }\n\n      if (!['vip', 'premium'].includes(type) || !['crypto'].includes(gateway)) {\n        return res.status(400).json({ error: 'Invalid type or gateway' });\n      }\n\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ error: 'User not found' });\n      }\n\n      // Check conflicting statuses\n      const hasVip = user.vipExpires && new Date(user.vipExpires) > new Date();\n      const hasPremium = user.premiumActive;\n\n      if (type === 'premium' && hasPremium) {\n        return res.status(400).json({ error: 'You already have this status, you can support the project with another service' });\n      }\n\n      if (type === 'vip' && hasPremium) {\n        return res.status(400).json({ error: 'PREMIUM status blocks VIP purchase' });\n      }\n\n      if (type === 'premium' && hasVip) {\n        return res.status(400).json({ error: 'VIP status blocks PREMIUM purchase' });\n      }\n\n      // Redirect to new crypto payment system\n      return res.status(400).json({ \n        error: 'Please use the new crypto payment system in the donate section'\n      });\n    } catch (error) {\n      console.error('Payment creation error:', error);\n      res.status(500).json({ error: 'Failed to create payment' });\n    }\n  });\n\n  // Admin routes for managing VIP/Premium\n  app.post('/api/admin/manage-subscription', requireAuth, async (req, res) => {\n    try {\n      const admin = await storage.getUser(req.session.userId);\n      if (!admin || admin.admin < 2) {\n        return res.status(403).json({ error: 'Super admin access required' });\n      }\n\n      const { userId, type, action, days } = req.body;\n      \n      if (!userId || !type || !action) {\n        return res.status(400).json({ error: 'Missing required parameters' });\n      }\n\n      if (!['vip', 'premium'].includes(type) || !['grant', 'revoke'].includes(action)) {\n        return res.status(400).json({ error: 'Invalid type or action' });\n      }\n\n      if (action === 'grant' && (!days || days < 1)) {\n        return res.status(400).json({ error: 'Days must be specified for grant action' });\n      }\n\n      const result = await storage.manageSubscription(userId, type, action, days);\n      res.json(result);\n    } catch (error) {\n      console.error('Subscription management error:', error);\n      res.status(500).json({ error: 'Failed to manage subscription' });\n    }\n  });\n\n  // VIP/Premium purchase route with Ukrainian payment gateways\n  app.post('/api/purchase', requireAuth, async (req, res) => {\n    try {\n      const { type, gateway } = req.body;\n      const user = await storage.getUser(req.session.userId);\n\n      // Check subscription conflicts\n      if (type === 'vip' && user.premiumStatus === 'active') {\n        return res.status(400).json({ \n          message: 'У вас уже есть Premium статус. Покупка VIP заблокирована.' \n        });\n      }\n      \n      if (type === 'premium' && user.premiumStatus === 'active') {\n        return res.status(400).json({ \n          message: 'У вас уже есть Premium статус. Повторная покупка невозможна.' \n        });\n      }\n\n      if (type === 'premium' && user.vipStatus === 'active') {\n        return res.status(400).json({ \n          message: 'У вас активен VIP статус. Покупка Premium заблокирована.' \n        });\n      }\n\n      // Price configuration  \n      const prices = { \n        vip: 2.5,       // VIP месяц за $2.50\n        premium: 10,    // Premium навсегда за $10\n      };\n      const amount = prices[type];\n      \n      if (!amount) {\n        return res.status(400).json({ message: 'Неверный тип подписки' });\n      }\n\n      // Demo payment simulation for Ukrainian gateways\n      const orderId = `${type}_${user.id}_${Date.now()}`;\n      \n      if (gateway === 'fondy') {\n        // Simulate successful payment for demo\n        setTimeout(async () => {\n          try {\n            if (type === 'vip') {\n              const expiresAt = new Date();\n              expiresAt.setMonth(expiresAt.getMonth() + 1);\n              \n              await storage.updateUser(user.id, {\n                vipStatus: 'active',\n                vipExpiresAt: expiresAt.toISOString()\n              });\n            } else if (type === 'premium') {\n              await storage.updateUser(user.id, {\n                premiumStatus: 'active',\n                premiumActivatedAt: new Date().toISOString()\n              });\n            }\n            \n            console.log(`Demo payment successful: ${type} for ${user.nickname}`);\n          } catch (error) {\n            console.error('Demo payment processing error:', error);\n          }\n        }, 2000);\n\n        return res.json({\n          success: true,\n          message: 'Демо-платеж через Fondy обрабатывается...',\n          orderId\n        });\n      } \n      \n      if (gateway === 'wayforpay') {\n        // Simulate successful payment for demo\n        setTimeout(async () => {\n          try {\n            if (type === 'vip') {\n              const expiresAt = new Date();\n              expiresAt.setMonth(expiresAt.getMonth() + 1);\n              \n              await storage.updateUser(user.id, {\n                vipStatus: 'active',\n                vipExpiresAt: expiresAt.toISOString()\n              });\n            } else if (type === 'premium') {\n              await storage.updateUser(user.id, {\n                premiumStatus: 'active',\n                premiumActivatedAt: new Date().toISOString()\n              });\n            }\n            \n            console.log(`Demo payment successful: ${type} for ${user.nickname}`);\n          } catch (error) {\n            console.error('Demo payment processing error:', error);\n          }\n        }, 2000);\n\n        return res.json({\n          success: true,\n          message: 'Демо-платеж через WayForPay обрабатывается...',\n          orderId\n        });\n      }\n\n      res.status(400).json({ message: 'Неподдерживаемый платежный шлюз' });\n    } catch (error) {\n      console.error('Purchase error:', error);\n      res.status(500).json({ message: 'Ошибка при обработке платежа' });\n    }\n  });\n\n  // Admin subscription management\n  app.post('/api/admin/subscription', requireAuth, async (req, res) => {\n    try {\n      const { action, targetNickname, days } = req.body;\n      const adminUser = await storage.getUser(req.session.userId);\n\n      if (adminUser.nickname !== 'Ca6aka') {\n        return res.status(403).json({ message: 'Доступ запрещен' });\n      }\n\n      const targetUser = await storage.getUserByNickname(targetNickname);\n      if (!targetUser) {\n        return res.status(404).json({ message: 'Пользователь не найден' });\n      }\n\n      if (action === 'giveVip') {\n        const expiresAt = new Date();\n        expiresAt.setDate(expiresAt.getDate() + days);\n        \n        await storage.updateUser(targetUser.id, {\n          vipStatus: 'active',\n          vipExpiresAt: expiresAt.toISOString()\n        });\n      } else if (action === 'givePremium') {\n        await storage.updateUser(targetUser.id, {\n          premiumStatus: 'active',\n          premiumActivatedAt: new Date().toISOString()\n        });\n      } else if (action === 'removeSubscription') {\n        await storage.updateUser(targetUser.id, {\n          vipStatus: 'inactive',\n          vipExpiresAt: null,\n          premiumStatus: 'inactive',\n          premiumActivatedAt: null\n        });\n      }\n\n      res.json({ message: 'Статус успешно обновлен' });\n    } catch (error) {\n      console.error('Admin subscription error:', error);\n      res.status(500).json({ message: 'Ошибка при управлении подпиской' });\n    }\n  });\n\n  // Card-to-Crypto payment endpoint with email confirmation\n  app.post('/api/card-crypto-purchase', async (req, res) => {\n    console.log('=== PAYMENT DEBUG START ===');\n    console.log('Request body:', req.body);\n    console.log('Session:', req.session);\n    \n    if (!req.session?.userId) {\n      console.log('ERROR: Not authenticated');\n      return res.status(401).json({ message: 'Not authenticated' });\n    }\n\n    const { type } = req.body;\n    console.log('Payment type:', type);\n    \n    if (!['vip', 'premium'].includes(type)) {\n      return res.status(400).json({ message: 'Invalid subscription type' });\n    }\n\n    // Пакетные цены с дополнительными бонусами для обхода минимума NOWPayments ($19.22)\n    const prices = { \n      vip: 20,        // VIP Пакет: 8 месяцев + бонусы за $20  \n      premium: 25,    // Premium Пакет: навсегда + эксклюзивные бонусы за $25\n    };\n    const amount = prices[type];\n\n    try {\n      const user = await storage.getUser(req.session.userId);\n      console.log('User found:', user ? user.nickname : 'No user');\n      \n      // Generate unique order ID\n      const orderId = `${type}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n      console.log('Generated order ID:', orderId);\n      \n      // NOWPayments integration for USDT payments\n      const nowPaymentsApiKey = process.env.NOWPAYMENTS_API_KEY;\n      const publicApiKey = '2e08170d-5e62-48ac-ac23-6a76fead8132'; // Public API key\n      const gameEmail = process.env.GAME_EMAIL || 'noreply@yourgame.com';\n      \n      console.log('NOWPayments API Key exists:', !!nowPaymentsApiKey);\n      console.log('Game email:', gameEmail);\n      \n      if (!nowPaymentsApiKey) {\n        console.log('ERROR: API key not configured');\n        return res.status(500).json({ message: 'Ошибка создания платежа: API key не настроен' });\n      }\n      \n      // Find best crypto with low minimum for small payments\n      console.log('Finding crypto with lowest minimum amount...');\n      const cryptoOptions = ['ltc', 'doge', 'trx', 'xlm', 'xrp'];\n      let bestCrypto = 'ltc';\n      let lowestMinimum = 999999;\n      \n      for (const crypto of cryptoOptions) {\n        try {\n          const minAmountResponse = await fetch(`https://api.nowpayments.io/v1/min-amount?currency_from=usd&currency_to=${crypto}`, {\n            headers: { 'x-api-key': nowPaymentsApiKey }\n          });\n          const minData = await minAmountResponse.json();\n          const minimum = minData.min_amount || 999999;\n          console.log(`Minimum for ${crypto.toUpperCase()}:`, minimum);\n          \n          if (minimum < lowestMinimum && minimum <= amount) {\n            lowestMinimum = minimum;\n            bestCrypto = crypto;\n          }\n        } catch (err) {\n          console.log(`Error checking ${crypto}:`, err.message);\n        }\n      }\n      \n      console.log(`Best crypto for $${amount}: ${bestCrypto.toUpperCase()} (min: $${lowestMinimum})`);\n      \n      // If we still can't find suitable crypto, inform user\n      if (lowestMinimum > amount) {\n        console.log(`All cryptos have higher minimum than ${amount}`);\n        return res.status(400).json({ \n          message: `Минимальная сумма платежа $${lowestMinimum}. Попробуйте пакетную покупку или увеличьте сумму.`,\n          minimumAmount: lowestMinimum,\n          suggestedCrypto: bestCrypto\n        });\n      }\n\n      // Create NOWPayments invoice with best crypto option\n      const nowPaymentsPayload = {\n        price_amount: amount,\n        price_currency: 'usd', \n        pay_currency: bestCrypto, // Use crypto with lowest minimum\n        order_id: orderId,\n        order_description: `${type === 'vip' ? 'VIP Пакет (8 месяцев + бонусы)' : 'Premium Пакет (навсегда + бонусы)'} subscription for ${user.nickname}`,\n        success_url: `${req.protocol}://${req.get('host')}/payment-success?orderId=${orderId}`,\n        cancel_url: `${req.protocol}://${req.get('host')}/donate`,\n        is_fee_paid_by_user: true\n      };\n      \n      console.log('NOWPayments payload:', JSON.stringify(nowPaymentsPayload, null, 2));\n\n      // Call NOWPayments API to create invoice\n      let paymentUrl = '';\n      try {\n        console.log('Calling NOWPayments Invoice API for fiat payments...');\n        const nowResponse = await fetch('https://api.nowpayments.io/v1/invoice', {\n          method: 'POST',\n          headers: {\n            'x-api-key': nowPaymentsApiKey,\n            'x-public-key': publicApiKey,\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify(nowPaymentsPayload)\n        });\n\n        console.log('NOWPayments response status:', nowResponse.status);\n        const nowData = await nowResponse.json();\n        console.log('NOWPayments response data:', JSON.stringify(nowData, null, 2));\n        \n        if (nowResponse.ok && nowData.invoice_url) {\n          paymentUrl = nowData.invoice_url;\n          console.log('Payment URL created:', paymentUrl);\n        } else {\n          console.log('NOWPayments API error:', nowData);\n          throw new Error(nowData.message || 'Failed to create payment invoice');\n        }\n      } catch (error) {\n        console.error('NOWPayments error:', error);\n        return res.status(500).json({ message: 'Ошибка создания платежа: ' + error.message });\n      }\n      \n      // Store payment info in JSON file\n      const paymentsFile = path.join(__dirname, '..', 'data', 'payments.json');\n      \n      let payments = [];\n      try {\n        if (fs.existsSync(paymentsFile)) {\n          payments = JSON.parse(fs.readFileSync(paymentsFile, 'utf8'));\n        }\n      } catch (err) {\n        console.log('Creating new payments file');\n      }\n      \n      const paymentRecord = {\n        orderId,\n        userId: user.id,\n        userNickname: user.nickname,\n        type,\n        amount,\n        status: 'pending',\n        createdAt: new Date().toISOString(),\n        paymentUrl\n      };\n      \n      payments.push(paymentRecord);\n      \n      // Ensure data directory exists\n      const dataDir = path.join(__dirname, '..', 'data');\n      if (!fs.existsSync(dataDir)) {\n        fs.mkdirSync(dataDir, { recursive: true });\n      }\n      \n      fs.writeFileSync(paymentsFile, JSON.stringify(payments, null, 2));\n      \n      console.log('Payment creation successful');\n      console.log('=== PAYMENT DEBUG END ===');\n      \n      res.json({\n        message: 'Payment created successfully',\n        paymentUrl,\n        orderId,\n        amount,\n        type\n      });\n    } catch (error) {\n      console.error('Card-crypto purchase error:', error);\n      console.log('=== PAYMENT DEBUG END (ERROR) ===');\n      res.status(500).json({ message: 'Failed to create payment' });\n    }\n  });\n\n  // PDF receipt generation\n  app.get('/api/payment-receipt/:orderId', async (req, res) => {\n    const { orderId } = req.params;\n    \n    try {\n      const fs = require('fs');\n      const path = require('path');\n      const puppeteer = require('puppeteer');\n      \n      const paymentsFile = path.join(process.cwd(), 'data', 'payments.json');\n      let payments = [];\n      \n      if (fs.existsSync(paymentsFile)) {\n        payments = JSON.parse(fs.readFileSync(paymentsFile, 'utf8'));\n      }\n      \n      const payment = payments.find(p => p.orderId === orderId);\n      if (!payment || payment.status !== 'completed') {\n        return res.status(404).json({ message: 'Payment not found or not completed' });\n      }\n      \n      const htmlContent = `\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <meta charset=\"UTF-8\">\n          <style>\n            body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }\n            .receipt { background: white; padding: 40px; border-radius: 8px; max-width: 600px; margin: 0 auto; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\n            .header { text-align: center; margin-bottom: 40px; border-bottom: 2px solid #e5e5e5; padding-bottom: 20px; }\n            .title { color: #2563eb; font-size: 28px; font-weight: bold; margin: 0; }\n            .subtitle { color: #64748b; font-size: 14px; margin-top: 5px; }\n            .info-row { display: flex; justify-content: space-between; margin: 15px 0; }\n            .label { font-weight: bold; color: #374151; }\n            .value { color: #111827; }\n            .status { background: #10b981; color: white; padding: 8px 16px; border-radius: 20px; font-size: 14px; font-weight: bold; }\n            .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #e5e5e5; text-align: center; color: #64748b; font-size: 12px; }\n            .amount { font-size: 24px; font-weight: bold; color: #10b981; }\n          </style>\n        </head>\n        <body>\n          <div class=\"receipt\">\n            <div class=\"header\">\n              <h1 class=\"title\">📄 Документ об оплате</h1>\n              <p class=\"subtitle\">Server Simulation Game</p>\n            </div>\n            \n            <div class=\"info-row\">\n              <span class=\"label\">Заказ:</span>\n              <span class=\"value\">#${payment.orderId}</span>\n            </div>\n            \n            <div class=\"info-row\">\n              <span class=\"label\">Игрок:</span>\n              <span class=\"value\">${payment.userNickname}</span>\n            </div>\n            \n            <div class=\"info-row\">\n              <span class=\"label\">Тип подписки:</span>\n              <span class=\"value\">${payment.type === 'vip' ? '⭐ VIP статус (8 месяцев)' : '👑 PREMIUM статус (навсегда)'}</span>\n            </div>\n            \n            <div class=\"info-row\">\n              <span class=\"label\">Сумма:</span>\n              <span class=\"value amount\">$${payment.amount}</span>\n            </div>\n            \n            <div class=\"info-row\">\n              <span class=\"label\">Дата оплаты:</span>\n              <span class=\"value\">${new Date(payment.completedAt || payment.createdAt).toLocaleString('ru-RU')}</span>\n            </div>\n            \n            <div class=\"info-row\">\n              <span class=\"label\">Статус:</span>\n              <span class=\"status\">✅ Оплачено</span>\n            </div>\n            \n            <div class=\"footer\">\n              <p>Спасибо за поддержку проекта Server Simulation Game!</p>\n              <p>Документ сгенерирован: ${new Date().toLocaleString('ru-RU')}</p>\n            </div>\n          </div>\n        </body>\n        </html>\n      `;\n\n      const browser = await puppeteer.launch({ headless: true, args: ['--no-sandbox', '--disable-setuid-sandbox'] });\n      const page = await browser.newPage();\n      await page.setContent(htmlContent);\n      const pdf = await page.pdf({ \n        format: 'A4', \n        printBackground: true,\n        margin: { top: '20px', right: '20px', bottom: '20px', left: '20px' }\n      });\n      await browser.close();\n\n      res.setHeader('Content-Type', 'application/pdf');\n      res.setHeader('Content-Disposition', `attachment; filename=\"receipt-${orderId}.pdf\"`);\n      res.send(pdf);\n    } catch (error) {\n      console.error('PDF generation error:', error);\n      res.status(500).json({ message: 'Failed to generate PDF' });\n    }\n  });\n\n  // Fiat-to-Crypto Payment Endpoint (NOWPayments Invoice API)\n  app.post('/api/donate/fiat', async (req, res) => {\n    if (!req.session.userId) {\n      return res.status(401).json({ message: 'Authentication required' });\n    }\n\n    try {\n      const user = await storage.getUser(req.session.userId);\n      if (!user) {\n        return res.status(401).json({ message: 'User not found' });\n      }\n      \n      const { type } = req.body;\n\n      if (!['vip', 'premium'].includes(type)) {\n        return res.status(400).json({ message: 'Invalid subscription type' });\n      }\n\n      // Пакетные цены с дополнительными бонусами для обхода минимума NOWPayments ($19.22)\n      const prices = { \n        vip: 20,        // VIP Пакет: 8 месяцев + бонусы за $20  \n        premium: 25,    // Premium Пакет: навсегда + эксклюзивные бонусы за $25\n      };\n      const amount = prices[type];\n\n      // Generate unique order ID\n      const orderId = `fiat_${type}_${user.id}_${Date.now()}`;\n      \n      console.log(`Creating fiat-to-crypto invoice for ${user.nickname}: ${type} - $${amount}`);\n\n      const invoiceData = {\n        price_amount: amount,\n        price_currency: 'usd',\n        pay_currency: 'trx', // Используем TRX как основную валюту для fiat\n        order_id: orderId,\n        order_description: `${type === 'vip' ? 'VIP Пакет (8 месяцев + бонусы)' : 'Premium Пакет (навсегда + бонусы)'} для ${user.nickname} - Fiat`,\n        success_url: `${req.protocol}://${req.get('host')}/payment-success?orderId=${orderId}&fiat=true`,\n        cancel_url: `${req.protocol}://${req.get('host')}/donate`,\n        // Фиксированный TRX адрес для fiat платежей\n        ipn_callback_url: `${req.protocol}://${req.get('host')}/api/payment-webhook`\n      };\n\n      console.log('Creating NOWPayments fiat invoice with data:', invoiceData);\n\n      const invoiceResponse = await fetch('https://api.nowpayments.io/v1/invoice', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'x-api-key': process.env.NOWPAYMENTS_API_KEY\n        },\n        body: JSON.stringify(invoiceData)\n      });\n\n      const invoiceResult = await invoiceResponse.json();\n      console.log('NOWPayments fiat invoice response:', invoiceResult);\n\n      if (!invoiceResponse.ok) {\n        console.error('Invoice creation failed:', invoiceResult);\n        return res.status(400).json({ message: `Payment creation failed: ${invoiceResult.message || 'Unknown error'}` });\n      }\n\n      // Save payment record\n      const fs = require('fs');\n      const path = require('path');\n      const paymentsFile = path.join(__dirname, '..', 'data', 'payments.json');\n      \n      let payments = [];\n      if (fs.existsSync(paymentsFile)) {\n        payments = JSON.parse(fs.readFileSync(paymentsFile, 'utf8'));\n      }\n\n      const paymentRecord = {\n        id: invoiceResult.id,\n        orderId,\n        userId: user.id,\n        userNickname: user.nickname,\n        type,\n        amount,\n        currency: 'USD',\n        status: 'pending',\n        createdAt: new Date().toISOString(),\n        invoiceUrl: invoiceResult.invoice_url,\n        paymentType: 'fiat-to-crypto'\n      };\n\n      payments.push(paymentRecord);\n      fs.writeFileSync(paymentsFile, JSON.stringify(payments, null, 2));\n\n      console.log(`Fiat payment created: ${invoiceResult.invoice_url}`);\n\n      res.json({\n        success: true,\n        paymentUrl: invoiceResult.invoice_url,\n        orderId\n      });\n\n    } catch (error) {\n      console.error('Fiat payment creation error:', error);\n      res.status(500).json({ \n        message: 'Fiat payment creation failed',\n        details: error.message \n      });\n    }\n  });\n\n  // NOWPayments Webhook endpoint\n  app.post('/api/payment-webhook', async (req, res) => {\n    try {\n      console.log('NOWPayments webhook received:', req.body);\n      \n      // NOWPayments webhook format\n      const { payment_status, order_id, pay_amount, pay_currency, price_amount, price_currency, outcome_amount, outcome_currency } = req.body;\n      \n      // Handle completed payments\n      if (payment_status === 'finished' && order_id) {\n        const fs = require('fs');\n        const path = require('path');\n        const paymentsFile = path.join(__dirname, '..', 'data', 'payments.json');\n        \n        let payments = [];\n        if (fs.existsSync(paymentsFile)) {\n          payments = JSON.parse(fs.readFileSync(paymentsFile, 'utf8'));\n        }\n        \n        // Find payment by orderId\n        const paymentIndex = payments.findIndex(p => p.orderId === order_id);\n        if (paymentIndex !== -1) {\n          const payment = payments[paymentIndex];\n          payment.status = 'completed';\n          payment.completedAt = new Date().toISOString();\n          payment.paidAmount = pay_amount;\n          payment.paidCurrency = pay_currency;\n          payment.outcomeAmount = outcome_amount;\n          payment.outcomeCurrency = outcome_currency;\n          \n          // Activate subscription\n          const user = await storage.getUser(payment.userId);\n          if (user) {\n            if (payment.type === 'vip') {\n              const expiresAt = new Date();\n              expiresAt.setMonth(expiresAt.getMonth() + 8); // 8 месяцев за $20\n              \n              // VIP Пакет бонусы\n              const vipBonuses = {\n                money: 10000,      // +$10,000 стартового капитала\n                experience: 5000,  // +5,000 опыта\n                servers: 5         // +5 слотов серверов (всего 30)\n              };\n              \n              await storage.updateUser(user.id, {\n                vipStatus: 'active',\n                vipExpiresAt: expiresAt.toISOString(),\n                money: (user.money || 0) + vipBonuses.money,\n                experience: (user.experience || 0) + vipBonuses.experience,\n                serverSlots: Math.max(user.serverSlots || 25, 30) // VIP получает 30 слотов\n              });\n            } else if (payment.type === 'premium') {\n              // Premium Пакет бонусы\n              const premiumBonuses = {\n                money: 50000,      // +$50,000 стартового капитала\n                experience: 15000, // +15,000 опыта\n                servers: 10        // +10 слотов серверов (всего 35)\n              };\n              \n              await storage.updateUser(user.id, {\n                premiumStatus: 'active',\n                premiumActivatedAt: new Date().toISOString(),\n                money: (user.money || 0) + premiumBonuses.money,\n                experience: (user.experience || 0) + premiumBonuses.experience,\n                serverSlots: Math.max(user.serverSlots || 25, 35) // Premium получает 35 слотов\n              });\n            }\n            \n            // Send confirmation email (placeholder - requires SendGrid setup)\n            console.log(`Payment completed for ${user.nickname}: ${payment.type} - $${payment.amount}`);\n            // await sendPaymentConfirmationEmail(payment);\n          }\n          \n          fs.writeFileSync(paymentsFile, JSON.stringify(payments, null, 2));\n        }\n      }\n      \n      res.json({ success: true });\n    } catch (error) {\n      console.error('Payment webhook error:', error);\n      res.status(500).json({ message: 'Webhook processing failed' });\n    }\n  });\n\n  // Payment success page\n  app.get('/payment-success', async (req, res) => {\n    const { orderId } = req.query;\n    \n    let message = 'Payment completed successfully!';\n    let details = '';\n    \n    if (orderId) {\n      try {\n        const fs = require('fs');\n        const path = require('path');\n        const paymentsFile = path.join(__dirname, '..', 'data', 'payments.json');\n        \n        if (fs.existsSync(paymentsFile)) {\n          const payments = JSON.parse(fs.readFileSync(paymentsFile, 'utf8'));\n          const payment = payments.find(p => p.orderId === orderId);\n          \n          if (payment) {\n            // Update payment status to completed\n            payment.status = 'completed';\n            payment.completedAt = new Date().toISOString();\n            fs.writeFileSync(paymentsFile, JSON.stringify(payments, null, 2));\n            \n            // Activate user subscription\n            const user = await storage.getUser(payment.userId);\n            if (user) {\n              if (payment.type === 'vip') {\n                const expiresAt = new Date();\n                expiresAt.setMonth(expiresAt.getMonth() + 1);\n                await storage.updateUser(user.id, {\n                  vipStatus: 'active',\n                  vipExpiresAt: expiresAt.toISOString()\n                });\n                message = 'VIP status activated successfully!';\n              } else if (payment.type === 'premium') {\n                await storage.updateUser(user.id, {\n                  premiumStatus: 'active',\n                  premiumActivatedAt: new Date().toISOString()\n                });\n                message = 'PREMIUM status activated successfully!';\n              }\n            }\n            \n            details = `<p>Order ID: ${orderId}</p><p>Amount: $${payment.amount}</p>`;\n          }\n        }\n      } catch (error) {\n        console.error('Payment success page error:', error);\n      }\n    }\n    \n    res.send(`\n      <html>\n        <head><title>Payment Successful - Root Tycoon</title></head>\n        <body style=\"font-family: Arial, sans-serif; text-align: center; padding: 50px; background: linear-gradient(135deg, #1e293b 0%, #334155 100%); color: white; margin: 0;\">\n          <div style=\"max-width: 500px; margin: 0 auto; background: rgba(15, 23, 42, 0.8); padding: 40px; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.3);\">\n            <div style=\"font-size: 64px; margin-bottom: 20px;\">🎉</div>\n            <h1 style=\"color: #22c55e; margin-bottom: 20px;\">${message}</h1>\n            ${details}\n            <p style=\"margin-bottom: 30px; color: #cbd5e1;\">Your status is now active! Return to the game to enjoy your benefits.</p>\n            <a href=\"/\" style=\"display: inline-block; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); color: white; text-decoration: none; padding: 15px 30px; border-radius: 10px; font-weight: bold; transition: transform 0.2s;\">Return to Game</a>\n          </div>\n        </body>\n      </html>\n    `);\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":80430},"server/storage.js":{"content":"import fs from 'fs/promises';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\nimport { randomUUID } from 'crypto';\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\nconst dataDir = path.join(__dirname, '..', 'data');\nconst usersDir = path.join(__dirname, '..', 'users');\n// Support for multi-language chat files\nfunction getChatFile(language = 'en') {\n  return path.join(dataDir, `chat-${language}.json`);\n}\n\n// Level and Experience System (60 levels, 10% increase per level)\nfunction calculateLevel(experience) {\n  let level = 1;\n  let requiredExp = 100;\n  let totalExp = 0;\n  \n  while (totalExp + requiredExp <= experience && level < 60) {\n    totalExp += requiredExp;\n    level++;\n    requiredExp = Math.floor(requiredExp * 1.1);\n  }\n  \n  return level;\n}\n\nfunction getExperienceForLevel(level) {\n  let totalExp = 0;\n  let currentExp = 100;\n  \n  for (let i = 1; i < level && i < 60; i++) {\n    totalExp += currentExp;\n    currentExp = Math.floor(currentExp * 1.1);\n  }\n  \n  return totalExp;\n}\n\nfunction getExperienceToNextLevel(experience) {\n  const currentLevel = calculateLevel(experience);\n  if (currentLevel >= 60) return 0;\n  const nextLevelExp = getExperienceForLevel(currentLevel + 1);\n  return nextLevelExp - experience;\n}\n\nfunction getExperienceForCurrentLevel(experience) {\n  const currentLevel = calculateLevel(experience);\n  const currentLevelStart = getExperienceForLevel(currentLevel);\n  const nextLevelStart = getExperienceForLevel(currentLevel + 1);\n  return {\n    current: experience - currentLevelStart,\n    needed: nextLevelStart - currentLevelStart\n  };\n}\n\n// Avatar Generation System\nfunction generateRandomAvatar(nickname = '') {\n  // Special avatar for Ca6aka (super admin)\n  if (nickname === 'Ca6aka') {\n    return {\n      gradient: 'from-purple-500 via-pink-500 via-red-500 via-yellow-500 via-green-500 via-blue-500 to-purple-500',\n      pattern: 'rainbow-super-admin',\n      seed: 999999,\n      animation: 'rainbow-pulse'\n    };\n  }\n  \n  const multiColorGradients = [\n    'from-red-400 via-pink-500 to-purple-600',\n    'from-blue-400 via-purple-500 to-indigo-600', \n    'from-green-400 via-teal-500 to-cyan-600',\n    'from-yellow-400 via-orange-500 to-red-600',\n    'from-purple-400 via-violet-500 to-indigo-600',\n    'from-pink-400 via-rose-500 to-red-600',\n    'from-indigo-400 via-blue-500 to-cyan-600',\n    'from-teal-400 via-emerald-500 to-green-600',\n    'from-orange-400 via-amber-500 to-yellow-600',\n    'from-cyan-400 via-sky-500 to-blue-600',\n    'from-emerald-400 via-green-500 to-teal-600',\n    'from-rose-400 via-pink-500 to-red-600',\n    'from-violet-400 via-purple-500 to-indigo-600',\n    'from-amber-400 via-orange-500 to-red-600',\n    'from-lime-400 via-green-500 to-emerald-600'\n  ];\n  \n  const animations = [\n    'gradient-shift',\n    'pulse-glow', \n    'shimmer-wave',\n    'color-dance',\n    'soft-pulse'\n  ];\n  \n  const selectedGradient = multiColorGradients[Math.floor(Math.random() * multiColorGradients.length)];\n  const selectedAnimation = animations[Math.floor(Math.random() * animations.length)];\n  \n  return {\n    gradient: selectedGradient,\n    pattern: 'multi-color',\n    seed: Math.floor(Math.random() * 1000000),\n    animation: selectedAnimation\n  };\n}\n\n// Server products configuration with level requirements\nconst SERVER_PRODUCTS = [\n  {\n    id: 'basic-web',\n    name: 'Basic Web Server',\n    type: 'Web Hosting',\n    price: 5000,\n    incomePerMinute: 15,\n    monthlyCost: 45,\n    icon: 'fas fa-globe',\n    requiredLevel: 1\n  },\n  {\n    id: 'database-server',\n    name: 'Database Server',\n    type: 'Storage',\n    price: 9000,\n    incomePerMinute: 25,\n    monthlyCost: 85,\n    icon: 'fas fa-database',\n    requiredLevel: 4\n  },\n  {\n    id: 'high-performance',\n    name: 'High Performance Server',\n    type: 'Gaming/Apps',\n    price: 12000,\n    incomePerMinute: 50,\n    monthlyCost: 120,\n    icon: 'fas fa-server',\n    requiredLevel: 8\n  },\n  {\n    id: 'cdn-server',\n    name: 'CDN Server',\n    type: 'Content Delivery',\n    price: 17000,\n    incomePerMinute: 100,\n    monthlyCost: 180,\n    icon: 'fas fa-cloud',\n    requiredLevel: 12\n  },\n  {\n    id: 'gpu-server',\n    name: 'GPU Server',\n    type: 'AI',\n    price: 30000,\n    incomePerMinute: 150,\n    monthlyCost: 250,\n    icon: 'fas fa-microchip',\n    requiredLevel: 25,\n    requiredLearning: 'ai-gpu-settings'\n  },\n  {\n    id: 'tpu-server',\n    name: 'TPU Server',\n    type: 'Computing',\n    price: 50000,\n    incomePerMinute: 200,\n    monthlyCost: 350,\n    icon: 'fas fa-brain',\n    requiredLevel: 45,\n    requiredLearning: 'tpu-settings-machine'\n  }\n];\n\nconst JOB_TYPES = [\n  {\n    id: 'maintenance',\n    name: 'Server Maintenance',\n    reward: 150,\n    experienceReward: 10,\n    cooldown: 180000, // 5 minutes\n    icon: 'fas fa-wrench'\n  },\n  {\n    id: 'optimization',\n    name: 'Performance Optimization',\n    reward: 250,\n    experienceReward: 18,\n    cooldown: 300000, // 7.5 minutes\n    icon: 'fas fa-tachometer-alt'\n  },\n  {\n    id: 'security-audit',\n    name: 'Security Audit',\n    reward: 500,\n    experienceReward: 25,\n    cooldown: 420000, // 10 minutes\n    icon: 'fas fa-shield-alt'\n  }\n];\n\nconst LEARNING_COURSES = [\n  {\n    id: 'basic-setup',\n    title: 'Basic Server Setup',\n    description: 'Learn the fundamentals of server configuration and deployment',\n    difficulty: 'Beginner',\n    duration: 30 * 60 * 1000, // 30 minutes in milliseconds\n    reward: { type: 'serverSlots', amount: 1 },\n    price: 3500,\n    requiredLevel: 1\n  },\n  {\n    id: 'advanced-management',\n    title: 'Advanced Server Management',\n    description: 'Master advanced server optimization and scaling techniques',\n    difficulty: 'Advanced',\n    duration: 90 * 60 * 1000, // 2 hours in milliseconds\n    reward: { type: 'serverSlots', amount: 2 },\n    price: 8000,\n    requiredLevel: 5\n  },\n  {\n    id: 'security-protocols',\n    title: 'Security Protocols',\n    description: 'Implement robust security measures for your server infrastructure',\n    difficulty: 'Intermediate',\n    duration: 120 * 60 * 1000, // 1.5 hours in milliseconds\n    reward: { type: 'efficiency', amount: 15 },\n    price: 10000,\n    requiredLevel: 12\n  },\n  {\n    id: 'ai-gpu-settings',\n    title: 'AI GPU Settings',\n    description: 'Master GPU configuration for AI workloads and machine learning tasks',\n    difficulty: 'Expert',\n    duration: 4 * 60 * 60 * 1000, // 4 hours in milliseconds\n    reward: { type: 'serverUnlock', serverType: 'gpu-server' },\n    price: 20000,\n    requiredLevel: 25\n  },\n  {\n    id: 'tpu-settings-machine',\n    title: 'TPU Settings Machine',\n    description: 'Advanced TPU configuration for high-performance computing and neural networks',\n    difficulty: 'Master',\n    duration: 6 * 60 * 60 * 1000, // 6 hours in milliseconds\n    reward: { type: 'serverUnlock', serverType: 'tpu-server' },\n    price: 40000,\n    requiredLevel: 45\n  }\n];\n\nconst ACHIEVEMENTS = [\n  {\n    id: 'first-steps',\n    title: 'First Steps',\n    description: 'Complete your first job',\n    icon: 'fas fa-play',\n    reward: 500,\n    condition: { type: 'jobs', count: 1 }\n  },\n  {\n    id: 'first-server',\n    title: 'First Server',\n    description: 'Purchase your first server',\n    icon: 'fas fa-server',\n    reward: 1000,\n    condition: { type: 'servers', count: 1 }\n  },\n  {\n    id: 'server-collection',\n    title: 'Server Collector',\n    description: 'Own 5 servers simultaneously',\n    icon: 'fas fa-warehouse',\n    reward: 5000,\n    condition: { type: 'servers', count: 5 }\n  },\n  {\n    id: 'millionaire',\n    title: 'Millionaire',\n    description: 'Accumulate $1,000,000 in balance',\n    icon: 'fas fa-money-bill-wave',\n    reward: 50000,\n    condition: { type: 'balance', amount: 1000000 }\n  },\n  {\n    id: 'job-master',\n    title: 'Job Master',\n    description: 'Complete 100 jobs',\n    icon: 'fas fa-tasks',\n    reward: 10000,\n    condition: { type: 'jobs', count: 100 }\n  },\n  {\n    id: 'learning-enthusiast',\n    title: 'Learning Enthusiast',\n    description: 'Complete all learning courses',\n    icon: 'fas fa-graduation-cap',\n    reward: 25000,\n    condition: { type: 'courses', count: 5 }\n  },\n  {\n    id: 'early-earner',\n    title: 'Early Earner',\n    description: 'Earn your first $10,000',\n    icon: 'fas fa-coins',\n    reward: 2000,\n    condition: { type: 'balance', amount: 10000 }\n  },\n  {\n    id: 'efficient-worker',\n    title: 'Efficient Worker',\n    description: 'Complete 10 jobs',\n    icon: 'fas fa-briefcase',\n    reward: 3000,\n    condition: { type: 'jobs', count: 10 }\n  },\n  {\n    id: 'server-builder',\n    title: 'Server Builder',\n    description: 'Own 3 different types of servers',\n    icon: 'fas fa-network-wired',\n    reward: 7500,\n    condition: { type: 'servers', count: 3 }\n  },\n  {\n    id: 'security-expert',\n    title: 'Security Expert',\n    description: 'Complete 50 Security Audit jobs',\n    icon: 'fas fa-shield-alt',\n    reward: 15000,\n    condition: { type: 'jobs', count: 50 }\n  },\n  {\n    id: 'maintenance-guru',\n    title: 'Maintenance Guru',\n    description: 'Complete 75 Maintenance jobs',\n    icon: 'fas fa-wrench',\n    reward: 12000,\n    condition: { type: 'jobs', count: 75 }\n  },\n  {\n    id: 'optimization-master',\n    title: 'Optimization Master',\n    description: 'Complete 60 Optimization jobs',\n    icon: 'fas fa-tachometer-alt',\n    reward: 13500,\n    condition: { type: 'jobs', count: 60 }\n  },\n  {\n    id: 'wealthy-investor',\n    title: 'Wealthy Investor',\n    description: 'Accumulate $100,000 in balance',\n    icon: 'fas fa-dollar-sign',\n    reward: 20000,\n    condition: { type: 'balance', amount: 100000 }\n  },\n  {\n    id: 'server-mogul',\n    title: 'Server Mogul',\n    description: 'Own 10 servers simultaneously',\n    icon: 'fas fa-building',\n    reward: 25000,\n    condition: { type: 'servers', count: 10 }\n  },\n  {\n    id: 'persistent-learner',\n    title: 'Persistent Learner',\n    description: 'Complete 3 learning courses',\n    icon: 'fas fa-book',\n    reward: 18000,\n    condition: { type: 'courses', count: 3 }\n  },\n  {\n    id: 'speed-demon',\n    title: 'Speed Demon',\n    description: 'Complete 200 jobs total',\n    icon: 'fas fa-bolt',\n    reward: 30000,\n    condition: { type: 'jobs', count: 200 }\n  },\n  {\n    id: 'infrastructure-king',\n    title: 'Infrastructure King',\n    description: 'Own 15 servers simultaneously',\n    icon: 'fas fa-crown',\n    reward: 40000,\n    condition: { type: 'servers', count: 15 }\n  },\n  {\n    id: 'multi-millionaire',\n    title: 'Multi-Millionaire',\n    description: 'Accumulate $5,000,000 in balance',\n    icon: 'fas fa-gem',\n    reward: 100000,\n    condition: { type: 'balance', amount: 5000000 }\n  },\n  {\n    id: 'course-completionist',\n    title: 'Course Completionist',\n    description: 'Complete all available learning courses',\n    icon: 'fas fa-award',\n    reward: 35000,\n    condition: { type: 'courses', count: 5 }\n  },\n  {\n    id: 'workaholic',\n    title: 'Workaholic',\n    description: 'Complete 500 jobs total',\n    icon: 'fas fa-fire',\n    reward: 75000,\n    condition: { type: 'jobs', count: 500 }\n  },\n  {\n    id: 'server-empire',\n    title: 'Server Empire',\n    description: 'Own 20 servers simultaneously',\n    icon: 'fas fa-globe',\n    reward: 60000,\n    condition: { type: 'servers', count: 20 }\n  },\n  {\n    id: 'financial-titan',\n    title: 'Financial Titan',\n    description: 'Accumulate $10,000,000 in balance',\n    icon: 'fas fa-university',\n    reward: 200000,\n    condition: { type: 'balance', amount: 10000000 }\n  },\n  {\n    id: 'legendary-worker',\n    title: 'Legendary Worker',\n    description: 'Complete 1000 jobs total',\n    icon: 'fas fa-trophy',\n    reward: 150000,\n    condition: { type: 'jobs', count: 1000 }\n  },\n  {\n    id: 'server-overlord',\n    title: 'Server Overlord',\n    description: 'Own 30 servers simultaneously',\n    icon: 'fas fa-chess-king',\n    reward: 100000,\n    condition: { type: 'servers', count: 30 }\n  },\n  {\n    id: 'billionaire-club',\n    title: 'Billionaire Club',\n    description: 'Accumulate $100,000,000 in balance',\n    icon: 'fas fa-star',\n    reward: 500000,\n    condition: { type: 'balance', amount: 100000000 }\n  },\n  {\n    id: 'ultimate-legend',\n    title: 'Ultimate Legend',\n    description: 'Complete 2500 jobs total',\n    icon: 'fas fa-medal',\n    reward: 1000000,\n    condition: { type: 'jobs', count: 2500 }\n  }\n];\n\nconst DAILY_QUESTS = [\n  {\n    id: 'daily-maintenance',\n    title: 'Daily Maintenance',\n    description: 'Complete 3 Server Maintenance jobs',\n    reward: 2000,\n    requirement: { type: 'job', jobType: 'maintenance', count: 3 }\n  },\n  {\n    id: 'daily-income',\n    title: 'Passive Income',\n    description: 'Earn $5,000 from server income',\n    reward: 1500,\n    requirement: { type: 'income', amount: 5000 }\n  },\n  {\n    id: 'daily-optimization',\n    title: 'Server Optimization',\n    description: 'Complete 2 Performance Optimization jobs',\n    reward: 3000,\n    requirement: { type: 'job', jobType: 'optimization', count: 2 }\n  },\n  {\n    id: 'daily-security',\n    title: 'Security Check',\n    description: 'Complete 1 Security Audit job',\n    reward: 2500,\n    requirement: { type: 'job', jobType: 'security-audit', count: 1 }\n  },\n  {\n    id: 'daily-earnings',\n    title: 'Daily Earnings',\n    description: 'Earn $10,000 from server income',\n    reward: 3500,\n    requirement: { type: 'income', amount: 10000 }\n  },\n  {\n    id: 'daily-worker',\n    title: 'Hard Worker',\n    description: 'Complete 5 jobs of any type',\n    reward: 4000,\n    requirement: { type: 'job', jobType: 'any', count: 5 }\n  },\n  {\n    id: 'daily-mixed-jobs',\n    title: 'Mixed Tasks',\n    description: 'Complete 2 Maintenance and 1 Optimization job',\n    reward: 3200,\n    requirement: { type: 'job', jobType: 'mixed', count: 3 }\n  },\n  {\n    id: 'daily-income-boost',\n    title: 'Income Boost',\n    description: 'Earn $20,000 from server income',\n    reward: 5000,\n    requirement: { type: 'income', amount: 20000 }\n  },\n  {\n    id: 'daily-job-spree',\n    title: 'Job Spree',\n    description: 'Complete 8 jobs of any type',\n    reward: 6000,\n    requirement: { type: 'job', jobType: 'any', count: 8 }\n  },\n  {\n    id: 'daily-mega-earner',\n    title: 'Mega Earner',\n    description: 'Earn $50,000 from server income',\n    reward: 8000,\n    requirement: { type: 'income', amount: 50000 }\n  }\n];\n\nexport class FileStorage {\n  constructor() {\n    this.ensureDataDirectory();\n  }\n\n  async ensureDataDirectory() {\n    try {\n      await fs.access(dataDir);\n    } catch {\n      await fs.mkdir(dataDir, { recursive: true });\n    }\n    try {\n      await fs.access(usersDir);\n    } catch {\n      await fs.mkdir(usersDir, { recursive: true });\n    }\n  }\n\n  async readJsonFile(filename) {\n    try {\n      const filePath = path.join(dataDir, filename);\n      const data = await fs.readFile(filePath, 'utf8');\n      return JSON.parse(data);\n    } catch (error) {\n      if (error.code === 'ENOENT') {\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  async writeJsonFile(filename, data) {\n    const filePath = path.join(dataDir, filename);\n    await fs.writeFile(filePath, JSON.stringify(data, null, 2));\n  }\n\n  async getUserFile(nickname) {\n    const filePath = path.join(usersDir, `${nickname}.json`);\n    try {\n      const data = await fs.readFile(filePath, 'utf8');\n      return JSON.parse(data);\n    } catch (error) {\n      if (error.code === 'ENOENT') {\n        return null;\n      }\n      throw error;\n    }\n  }\n\n  async saveUserFile(user) {\n    const filePath = path.join(usersDir, `${user.nickname}.json`);\n    await fs.writeFile(filePath, JSON.stringify(user, null, 2));\n  }\n\n  async getAllUsers() {\n    try {\n      const files = await fs.readdir(usersDir);\n      const users = [];\n      for (const file of files) {\n        if (file.endsWith('.json')) {\n          const nickname = file.replace('.json', '');\n          const user = await this.getUserFile(nickname);\n          if (user) users.push(user);\n        }\n      }\n      return users;\n    } catch {\n      return [];\n    }\n  }\n\n  async getServers() {\n    const servers = await this.readJsonFile('servers.json');\n    return servers || [];\n  }\n\n  async saveServers(servers) {\n    await this.writeJsonFile('servers.json', servers);\n  }\n\n  async getRankingsData() {\n    const rankings = await this.readJsonFile('rankings.json');\n    return rankings || [];\n  }\n\n  async saveRankings(rankings) {\n    await this.writeJsonFile('rankings.json', rankings);\n  }\n\n  // User management\n  async getUser(id) {\n    const users = await this.getAllUsers();\n    return users.find(user => user.id === id);\n  }\n\n  async getUserByNickname(nickname) {\n    return await this.getUserFile(nickname);\n  }\n\n  async getUserByNicknameCaseInsensitive(nickname) {\n    try {\n      const files = await fs.readdir(usersDir);\n      const normalizedNickname = nickname.toLowerCase();\n      \n      for (const file of files) {\n        if (file.endsWith('.json')) {\n          const fileNickname = file.replace('.json', '');\n          if (fileNickname.toLowerCase() === normalizedNickname) {\n            return await this.getUserFile(fileNickname);\n          }\n        }\n      }\n      return null;\n    } catch {\n      return null;\n    }\n  }\n\n  // Check registration count by IP (lifetime limit)\n  async checkRegistrationsByIP(ip) {\n    const users = await this.getAllUsers();\n    \n    return users.filter(user => \n      user.registrationIP === ip\n    ).length;\n  }\n\n  async createUser(userData) {\n    const avatar = generateRandomAvatar();\n    const user = {\n      id: randomUUID(),\n      nickname: userData.nickname,\n      password: userData.password,\n      balance: 13000, // Starting balance\n      level: 1,\n      experience: 0,\n      totalEarnings: 13000, // Include starting balance\n      totalSpent: 0,\n      avatar: avatar,\n      serverLimit: 3, // Starting server limit\n      tutorialCompleted: false,\n      admin: userData.admin || 0,\n      banned: false,\n      muted: false,\n      muteExpires: null,\n      isOnline: userData.isOnline || false,\n      lastIncomeUpdate: Date.now(),\n      jobCooldowns: {},\n      currentLearning: null,\n      activities: [],\n      achievements: [],\n      completedJobsCount: 0,\n      completedCoursesCount: 0,\n      completedLearning: [],\n      efficiencyBonus: 0,\n      dailyQuests: this.generateDailyQuests(),\n      lastQuestReset: Date.now(),\n      registrationIP: userData.registrationIP,\n      registrationTime: userData.registrationTime\n    };\n    \n    await this.saveUserFile(user);\n    await this.updateRankings();\n    \n    return user;\n  }\n\n  async updateUser(userId, updates) {\n    const users = await this.getAllUsers();\n    const user = users.find(u => u.id === userId);\n    \n    if (!user) {\n      throw new Error('User not found');\n    }\n    \n    const updatedUser = { ...user, ...updates };\n    await this.saveUserFile(updatedUser);\n    await this.updateRankings();\n    \n    return updatedUser;\n  }\n\n  async updateUserActivity(userId) {\n    const user = await this.getUser(userId);\n    if (!user) return;\n    \n    const now = Date.now();\n    await this.updateUser(userId, { \n      lastSeen: now,\n      isOnline: true \n    });\n  }\n\n  // Daily Quests System\n  generateDailyQuests() {\n    const today = new Date().toDateString();\n    return DAILY_QUESTS.map(quest => ({\n      ...quest,\n      id: `${quest.id}-${today}`,\n      progress: 0,\n      completed: false,\n      date: today\n    }));\n  }\n\n  async checkDailyQuestReset(userId) {\n    const user = await this.getUser(userId);\n    if (!user) return;\n\n    const lastReset = user.lastQuestReset || 0;\n    const oneDayAgo = Date.now() - 24 * 60 * 60 * 1000;\n    \n    if (lastReset < oneDayAgo) {\n      await this.updateUser(userId, {\n        dailyQuests: this.generateDailyQuests(),\n        lastQuestReset: Date.now()\n      });\n    }\n  }\n\n  async updateDailyQuest(userId, questType, data) {\n    const user = await this.getUser(userId);\n    if (!user || !user.dailyQuests) return;\n\n    await this.checkDailyQuestReset(userId);\n    \n    const quests = [...user.dailyQuests];\n    let updated = false;\n\n    quests.forEach(quest => {\n      if (quest.completed) return;\n\n      const req = quest.requirement;\n      \n      if (req.type === 'job' && questType === 'job') {\n        // Handle different job quest types\n        if (req.jobType === 'any') {\n          // Any job type counts\n          quest.progress = Math.min(quest.progress + 1, req.count);\n          if (quest.progress >= req.count) {\n            quest.completed = true;\n            this.completeQuest(userId, quest);\n          }\n          updated = true;\n        } else if (req.jobType === data.jobType) {\n          // Specific job type\n          quest.progress = Math.min(quest.progress + 1, req.count);\n          if (quest.progress >= req.count) {\n            quest.completed = true;\n            this.completeQuest(userId, quest);\n          }\n          updated = true;\n        } else if (req.jobType === 'mixed') {\n          // Mixed jobs - track individual job types\n          if (!quest.jobCounts) {\n            quest.jobCounts = { maintenance: 0, optimization: 0, 'security-audit': 0 };\n          }\n          \n          if (quest.jobCounts[data.jobType] !== undefined) {\n            quest.jobCounts[data.jobType]++;\n            \n            // For mixed quest: 2 Maintenance + 1 Optimization\n            const maintenanceCount = quest.jobCounts.maintenance || 0;\n            const optimizationCount = quest.jobCounts.optimization || 0;\n            \n            if (maintenanceCount >= 2 && optimizationCount >= 1) {\n              quest.progress = req.count;\n              quest.completed = true;\n              this.completeQuest(userId, quest);\n            } else {\n              quest.progress = maintenanceCount + optimizationCount;\n            }\n            updated = true;\n          }\n        }\n      } else if (req.type === 'income' && questType === 'income') {\n        quest.progress = Math.min(quest.progress + data.amount, req.amount);\n        if (quest.progress >= req.amount) {\n          quest.completed = true;\n          this.completeQuest(userId, quest);\n        }\n        updated = true;\n      }\n    });\n\n    if (updated) {\n      await this.updateUser(userId, { dailyQuests: quests });\n    }\n  }\n\n  async completeQuest(userId, quest) {\n    const user = await this.getUser(userId);\n    if (!user) return;\n\n    // Mark quest as completed but not automatically claim reward\n    // User will need to manually claim the reward\n    await this.addActivity(userId, `Daily quest completed: ${quest.title} - Reward ready to claim!`);\n  }\n\n  // Achievements System\n  async checkAchievements(userId) {\n    const user = await this.getUser(userId);\n    if (!user) return;\n\n    // Only check achievements if user has completed tutorial\n    if (!user.tutorialCompleted) return;\n\n    const userAchievements = user.achievements || [];\n    const servers = await this.getUserServers(userId);\n    \n    for (const achievement of ACHIEVEMENTS) {\n      // Skip if already earned\n      if (userAchievements.includes(achievement.id)) continue;\n\n      let earned = false;\n      const condition = achievement.condition;\n\n      switch (condition.type) {\n        case 'servers':\n          earned = servers.length >= condition.count;\n          break;\n        case 'balance':\n          earned = user.balance >= condition.amount;\n          break;\n        case 'jobs':\n          earned = (user.completedJobsCount || 0) >= condition.count;\n          break;\n        case 'courses':\n          earned = (user.completedCoursesCount || 0) >= condition.count;\n          break;\n      }\n\n      if (earned) {\n        const newAchievements = [...userAchievements, achievement.id];\n        await this.updateUser(userId, {\n          achievements: newAchievements,\n          balance: user.balance + achievement.reward\n        });\n\n        await this.addActivity(userId, `Achievement unlocked: ${achievement.title} (+$${achievement.reward.toLocaleString()})`);\n      }\n    }\n  }\n\n  // Server management\n  async getUserServers(userId) {\n    const servers = await this.getServers();\n    return servers.filter(server => server.ownerId === userId);\n  }\n\n  async purchaseServer(userId, productId) {\n    const user = await this.getUser(userId);\n    if (!user) throw new Error('User not found');\n\n    const product = SERVER_PRODUCTS.find(p => p.id === productId);\n    if (!product) throw new Error('Invalid product');\n\n    const userServers = await this.getUserServers(userId);\n    if (userServers.length >= user.serverLimit) {\n      throw new Error('Server limit reached');\n    }\n\n    if (user.balance < product.price) {\n      throw new Error('Insufficient funds');\n    }\n    \n    // Check level requirement\n    const userLevel = user.level || calculateLevel(user.experience || 0);\n    if (product.requiredLevel && userLevel < product.requiredLevel) {\n      throw new Error(`Requires level ${product.requiredLevel}`);\n    }\n\n    // Check learning requirement\n    if (product.requiredLearning) {\n      const completedLearning = user.completedLearning || [];\n      if (!completedLearning.includes(product.requiredLearning)) {\n        throw new Error(`Requires completed learning: ${product.requiredLearning}`);\n      }\n    }\n\n    // Create new server\n    const servers = await this.getServers();\n    const newServer = {\n      id: randomUUID(),\n      ownerId: userId,\n      name: product.name,\n      type: product.type,\n      incomePerMinute: product.incomePerMinute,\n      monthlyCost: product.monthlyCost,\n      icon: product.icon,\n      isOnline: false, // Server starts offline and requires activation\n      loadPercentage: 50, // Default 50% load\n      durability: 100, // Server starts with 100% durability\n      lastDurabilityUpdate: Date.now(),\n      createdAt: Date.now()\n    };\n\n    servers.push(newServer);\n    await this.saveServers(servers);\n\n    // Update user balance and spending tracking\n    const updatedUser = await this.updateUser(userId, {\n      balance: user.balance - product.price,\n      totalSpent: (user.totalSpent || 0) + product.price\n    });\n\n    // Add activity\n    await this.addActivity(userId, `Purchased ${product.name} for $${product.price.toLocaleString()}`);\n\n    // Check achievements\n    await this.checkAchievements(userId);\n\n    return { user: updatedUser, server: newServer };\n  }\n\n  async toggleServer(userId, serverId) {\n    const servers = await this.getServers();\n    const serverIndex = servers.findIndex(s => s.id === serverId && s.ownerId === userId);\n    \n    if (serverIndex === -1) {\n      throw new Error('Server not found');\n    }\n\n    const server = servers[serverIndex];\n    \n    // Check durability before turning on\n    if (!server.isOnline && (server.durability || 100) <= 0) {\n      throw new Error('Server requires maintenance before it can be turned on');\n    }\n\n    servers[serverIndex].isOnline = !servers[serverIndex].isOnline;\n    await this.saveServers(servers);\n\n    const status = servers[serverIndex].isOnline ? 'online' : 'offline';\n    await this.addActivity(userId, `Turned ${servers[serverIndex].name} ${status}`);\n  }\n\n  async deleteServer(userId, serverId) {\n    const servers = await this.getServers();\n    const serverIndex = servers.findIndex(s => s.id === serverId && s.ownerId === userId);\n    \n    if (serverIndex === -1) {\n      throw new Error('Server not found');\n    }\n\n    const serverName = servers[serverIndex].name;\n    servers.splice(serverIndex, 1);\n    await this.saveServers(servers);\n\n    await this.addActivity(userId, `Deleted server: ${serverName}`);\n  }\n\n  async updateServerLoad(userId, serverId, loadPercentage) {\n    console.log(`[STORAGE] updateServerLoad called: userId=${userId}, serverId=${serverId}, loadPercentage=${loadPercentage}`);\n    \n    const servers = await this.getServers();\n    console.log(`[STORAGE] Found ${servers.length} servers`);\n    \n    const serverIndex = servers.findIndex(s => s.id === serverId && s.ownerId === userId);\n    console.log(`[STORAGE] Server index: ${serverIndex}`);\n    \n    if (serverIndex === -1) {\n      console.log(`[STORAGE] Server not found. Available servers:`, servers.map(s => ({ id: s.id, ownerId: s.ownerId })));\n      throw new Error('Server not found');\n    }\n\n    console.log(`[STORAGE] Updating server ${serverId} load from ${servers[serverIndex].loadPercentage} to ${loadPercentage}`);\n    \n    // Update server load percentage\n    servers[serverIndex].loadPercentage = loadPercentage;\n    await this.saveServers(servers);\n    \n    console.log(`[STORAGE] Server load updated successfully`);\n    return { success: true };\n  }\n\n  async checkServerOverload(userId, serverId, loadPercentage) {\n    // Only check for overload if load is very high and after a delay\n    if (loadPercentage < 50) return; // Only check servers with 50%+ load\n    \n    // Get server to check last overload check time\n    const servers = await this.getServers();\n    const server = servers.find(s => s.id === serverId && s.ownerId === userId);\n    if (!server) return;\n    \n    const now = Date.now();\n    const lastOverloadCheck = server.lastOverloadCheck || 0;\n    const fiveMinutes = 5 * 60 * 1000; // 5 minutes in milliseconds\n    const tenMinutes = 10 * 60 * 1000; // 10 minutes in milliseconds\n    \n    // Don't check servers that are less than 10 minutes old (newly purchased)\n    const serverAge = now - (server.createdAt || now);\n    if (serverAge < tenMinutes) return;\n    \n    // Only check every 5 minutes minimum\n    if (now - lastOverloadCheck < fiveMinutes) return;\n    \n    // Update last check time\n    server.lastOverloadCheck = now;\n    await this.saveServers(servers);\n    \n    // Calculate shutdown probability based on load (much lower chances)\n    let shutdownChance = 0;\n    \n    if (loadPercentage >= 95) {\n      shutdownChance = 0.25; // 25% chance every 5 minutes\n    } else if (loadPercentage >= 90) {\n      shutdownChance = 0.20; // 20% chance every 5 minutes\n    } else if (loadPercentage >= 80) {\n      shutdownChance = 0.15; // 15% chance every 5 minutes\n    } else if (loadPercentage >= 70) {\n      shutdownChance = 0.10; // 10% chance every 5 minutes\n    } else if (loadPercentage >= 50) {\n      shutdownChance = 0.05; // 5% chance every 5 minutes\n    }\n    \n    // Random check for shutdown\n    if (Math.random() < shutdownChance) {\n      await this.shutdownServerFromOverload(userId, serverId);\n    }\n  }\n\n  async shutdownServerFromOverload(userId, serverId) {\n    const servers = await this.getServers();\n    const serverIndex = servers.findIndex(s => s.id === serverId && s.ownerId === userId);\n    \n    if (serverIndex === -1 || !servers[serverIndex].isOnline) return;\n\n    // Shutdown the server\n    const serverName = servers[serverIndex].name;\n    const loadPercentage = servers[serverIndex].loadPercentage || 50;\n    servers[serverIndex].isOnline = false;\n    \n    await this.saveServers(servers);\n    \n    // Add activity log\n    await this.addActivity(userId, `Server \"${serverName}\" shutdown due to overload (${loadPercentage}% load)`);\n  }\n\n  // Job management\n  async startJob(userId, jobType) {\n    const user = await this.getUser(userId);\n    if (!user) throw new Error('User not found');\n\n    const job = JOB_TYPES.find(j => j.id === jobType);\n    if (!job) throw new Error('Invalid job type');\n\n    // Check cooldown\n    const cooldownEnd = user.jobCooldowns[jobType];\n    if (cooldownEnd && Date.now() < cooldownEnd) {\n      const remainingTime = Math.ceil((cooldownEnd - Date.now()) / 1000);\n      throw new Error(`Job on cooldown for ${remainingTime} seconds`);\n    }\n\n    // Update user balance and set cooldown\n    const newCooldowns = {\n      ...user.jobCooldowns,\n      [jobType]: Date.now() + job.cooldown\n    };\n\n    // Award experience for job completion based on job type\n    const experienceGain = job.experienceReward;\n    const newExperience = (user.experience || 0) + experienceGain;\n    const newLevel = calculateLevel(newExperience);\n    const oldLevel = user.level || calculateLevel(user.experience || 0);\n    \n    const updates = {\n      balance: user.balance + job.reward,\n      experience: newExperience,\n      level: newLevel,\n      totalEarnings: (user.totalEarnings || 10000) + job.reward,\n      jobCooldowns: newCooldowns,\n      completedJobsCount: (user.completedJobsCount || 0) + 1\n    };\n    \n    const updatedUser = await this.updateUser(userId, updates);\n\n    let activityMessage = `Completed ${job.name} (+$${job.reward.toLocaleString()}, +${experienceGain} XP)`;\n    \n    // Check for level up\n    if (newLevel > oldLevel) {\n      activityMessage += ` - Level Up! Now level ${newLevel}`;\n    }\n    \n    await this.addActivity(userId, activityMessage);\n\n    // Update daily quests\n    await this.updateDailyQuest(userId, 'job', { jobType });\n\n    // Check achievements\n    await this.checkAchievements(userId);\n\n    return { \n      user: updatedUser, \n      earnedAmount: job.reward,\n      experienceGained: experienceGain,\n      leveledUp: newLevel > oldLevel,\n      newLevel: newLevel > oldLevel ? newLevel : null\n    };\n  }\n\n  async getJobCooldowns(userId) {\n    const user = await this.getUser(userId);\n    if (!user) return {};\n\n    return user.jobCooldowns || {};\n  }\n\n  // Learning management\n  async startLearning(userId, courseId) {\n    const user = await this.getUser(userId);\n    if (!user) throw new Error('User not found');\n\n    if (user.currentLearning) {\n      throw new Error('Already learning a course');\n    }\n\n    const course = LEARNING_COURSES.find(c => c.id === courseId);\n    if (!course) throw new Error('Invalid course');\n\n    if (user.balance < course.price) {\n      throw new Error('Insufficient funds');\n    }\n    \n    // Check level requirement\n    const userLevel = user.level || calculateLevel(user.experience || 0);\n    if (course.requiredLevel && userLevel < course.requiredLevel) {\n      throw new Error(`Requires level ${course.requiredLevel}`);\n    }\n\n    const learning = {\n      id: courseId,\n      title: course.title,\n      description: course.description,\n      difficulty: course.difficulty,\n      startTime: Date.now(),\n      endTime: Date.now() + course.duration,\n      progress: 0,\n      reward: course.reward\n    };\n\n    const updatedUser = await this.updateUser(userId, {\n      balance: user.balance - course.price,\n      totalSpent: (user.totalSpent || 0) + course.price,\n      currentLearning: learning\n    });\n\n    await this.addActivity(userId, `Started learning course: ${course.title}`);\n\n    return { user: updatedUser, learning };\n  }\n\n  async getCurrentLearning(userId) {\n    const user = await this.getUser(userId);\n    if (!user || !user.currentLearning) return null;\n\n    const learning = user.currentLearning;\n    const now = Date.now();\n    \n    if (now >= learning.endTime) {\n      // Course completed\n      await this.completeLearning(userId);\n      return null;\n    }\n\n    // Update progress\n    const elapsed = now - learning.startTime;\n    const total = learning.endTime - learning.startTime;\n    const progress = Math.floor((elapsed / total) * 100);\n    const timeRemaining = this.formatTime(learning.endTime - now);\n\n    return {\n      ...learning,\n      progress,\n      timeRemaining\n    };\n  }\n\n  async completeLearning(userId) {\n    const user = await this.getUser(userId);\n    if (!user || !user.currentLearning) return;\n\n    const learning = user.currentLearning;\n    const updates = { \n      currentLearning: null,\n      completedCoursesCount: (user.completedCoursesCount || 0) + 1\n    };\n\n    // Apply rewards\n    if (learning.reward.type === 'serverSlots') {\n      const newServerLimit = user.serverLimit + learning.reward.amount;\n      updates.serverLimit = Math.min(newServerLimit, 25); // Max 25 servers\n      \n      // Only mark server slot courses as completed if we've reached the 25 server limit\n      if (updates.serverLimit >= 25) {\n        updates.completedLearning = [...(user.completedLearning || []), learning.id];\n      } else {\n        // Keep existing completed learning without adding this course\n        updates.completedLearning = user.completedLearning || [];\n      }\n    } else {\n      // For non-server-slot courses, always mark as completed\n      updates.completedLearning = [...(user.completedLearning || []), learning.id];\n      \n      if (learning.reward.type === 'efficiency') {\n        // Apply efficiency bonus to all current and future servers\n        const currentBonus = user.efficiencyBonus || 0;\n        updates.efficiencyBonus = currentBonus + learning.reward.amount;\n      }\n      // Server unlock rewards are handled by the completedLearning array\n    }\n\n    await this.updateUser(userId, updates);\n    await this.addActivity(userId, `Completed learning course: ${learning.title}`);\n    \n    // Check achievements\n    await this.checkAchievements(userId);\n  }\n\n  // Income updates\n  async updateServersDurability() {\n    const servers = await this.getServers();\n    const now = Date.now();\n    let updated = false;\n    \n    for (const server of servers) {\n      const lastUpdate = server.lastDurabilityUpdate || server.createdAt || now;\n      const timeDiff = now - lastUpdate;\n      const tenMinutes = 10 * 60 * 1000; // 10 minutes in milliseconds\n      \n      // Only update durability for online servers every 10 minutes\n      if (server.isOnline && timeDiff >= tenMinutes) {\n        const durabilityLoss = Math.floor(timeDiff / tenMinutes); // 1% per 10 minutes\n        const currentDurability = server.durability !== undefined ? server.durability : 100;\n        server.durability = Math.max(0, currentDurability - durabilityLoss);\n        server.lastDurabilityUpdate = now;\n        updated = true;\n        \n        // If durability reaches 0, turn server offline\n        if (server.durability <= 0) {\n          server.isOnline = false;\n          await this.addActivity(server.ownerId, `${server.name} went offline due to maintenance required`);\n        }\n      }\n      \n      // Add durability field to existing servers that don't have it\n      if (server.durability === undefined) {\n        server.durability = 100;\n        server.lastDurabilityUpdate = server.createdAt || now;\n        updated = true;\n      }\n    }\n    \n    if (updated) {\n      await this.saveServers(servers);\n    }\n  }\n\n  async repairServer(userId, serverId, repairType = 'full') {\n    const user = await this.getUser(userId);\n    if (!user) throw new Error('User not found');\n\n    const servers = await this.getServers();\n    const serverIndex = servers.findIndex(s => s.id === serverId && s.ownerId === userId);\n    \n    if (serverIndex === -1) {\n      throw new Error('Server not found');\n    }\n\n    const server = servers[serverIndex];\n    const currentDurability = server.durability || 100;\n    \n    if (currentDurability >= 100) {\n      throw new Error('Server does not need repair');\n    }\n\n    // Calculate repair cost based on damage and server income\n    const damage = 100 - currentDurability;\n    let repairCost;\n    let durabilityRestore;\n    \n    if (repairType === 'partial') {\n      // Partial repair: restore 50% of missing durability\n      durabilityRestore = Math.min(50, damage);\n      repairCost = Math.ceil((server.incomePerMinute || 15) * damage * 0.3); // 30% of income per minute per damage point\n    } else {\n      // Full repair: restore to 100%\n      durabilityRestore = damage;\n      repairCost = Math.ceil((server.incomePerMinute || 15) * damage * 0.5); // 50% of income per minute per damage point\n    }\n\n    if (user.balance < repairCost) {\n      throw new Error(`Insufficient funds. Repair cost: $${repairCost}`);\n    }\n\n    // Apply repair\n    servers[serverIndex].durability = Math.min(100, currentDurability + durabilityRestore);\n    servers[serverIndex].lastDurabilityUpdate = Date.now();\n    \n    // Important: Ensure broken servers (0% durability) are turned offline and can only be turned on after repair\n    if (currentDurability === 0) {\n      servers[serverIndex].isOnline = false;\n    }\n    \n    await this.saveServers(servers);\n\n    // Update user balance\n    await this.updateUser(userId, {\n      balance: user.balance - repairCost,\n      totalSpent: (user.totalSpent || 0) + repairCost\n    });\n\n    const repairTypeText = repairType === 'partial' ? 'Partial repair' : 'Full repair';\n    await this.addActivity(userId, `${repairTypeText} of ${server.name} for $${repairCost.toLocaleString()}`);\n\n    return {\n      server: servers[serverIndex],\n      cost: repairCost,\n      durabilityRestored: durabilityRestore\n    };\n  }\n\n  async updateIncome(userId) {\n    const user = await this.getUser(userId);\n    if (!user) throw new Error('User not found');\n  \n    // Update server durability before calculating income\n    await this.updateServersDurability();\n  \n    const servers = await this.getUserServers(userId);\n    const now = Date.now();\n    const lastUpdate = user.lastIncomeUpdate || now;\n    const timeDiff = now - lastUpdate;\n  \n    const efficiencyBonus = user.efficiencyBonus || 0;\n  \n    // Доход с онлайн серверов\n    const totalIncome = servers.reduce((sum, server) => {\n      if (!server.isOnline) return sum;\n      const baseIncome = server.incomePerMinute || 0;\n      const loadPercentage = server.loadPercentage || 50;\n      const loadAdjustment = baseIncome * (1 + (loadPercentage - 50) / 100);\n      const efficiencyAdjustment = Math.ceil(loadAdjustment * (1 + efficiencyBonus / 100));\n      return sum + efficiencyAdjustment;\n    }, 0);\n  \n    // Расход для всех серверов, онлайн + оффлайн\n    const totalRentalCost = servers.reduce((sum, server) => {\n      const baseIncome = server.incomePerMinute || 0;\n      return sum + baseIncome * 0.1;\n    }, 0);\n  \n    const incomeEarned = Math.floor((totalIncome * timeDiff) / 60000);\n    const rentalCost = Math.floor((totalRentalCost * timeDiff) / 60000);\n    const netIncome = incomeEarned - rentalCost;\n  \n    // Обновляем баланс и статистику\n    const newBalance = Math.max(0, user.balance + netIncome);\n    const updateData = { balance: newBalance, lastIncomeUpdate: now };\n    if (incomeEarned > 0) updateData.totalEarnings = (user.totalEarnings || 0) + incomeEarned;\n    if (rentalCost > 0) updateData.totalSpent = (user.totalSpent || 0) + rentalCost;\n  \n    const updatedUser = await this.updateUser(userId, updateData);\n  \n    // Обновление ежедневного квеста\n    if (incomeEarned > 0) {\n      await this.updateDailyQuest(userId, 'income', { amount: incomeEarned });\n    }\n  \n    // Добавление логов активности **всегда**, если есть доход или расходы\n    if (incomeEarned > 0 && rentalCost > 0) {\n      // Доход есть, расходы есть\n      await this.addActivity(userId, `Income: +$${incomeEarned}, Rental: -$${rentalCost} (Net: ${netIncome >= 0 ? '+' : ''}$${netIncome})`);\n    } else if (incomeEarned > 0 && rentalCost === 0) {\n      // Доход есть, расходов нет\n      await this.addActivity(userId, `Income: +$${incomeEarned}`);\n    } else if (incomeEarned === 0 && rentalCost > 0) {\n      // Дохода нет, но есть расходы\n      await this.addActivity(userId, `Rental cost: -$${rentalCost} for ${servers.length} servers`);\n    } else if (incomeEarned < rentalCost) {\n      // Доход меньше расходов (чистый минус)\n      await this.addActivity(userId, `Income: +$${incomeEarned}, Rental: -$${rentalCost} (Net: $${netIncome})`);\n    }    \n  \n    // Проверка перегрузки серверов\n    for (const server of servers.filter(s => s.isOnline)) {\n      await this.checkServerOverload(userId, server.id, server.loadPercentage || 50);\n    }\n  \n    // Проверка достижений\n    await this.checkAchievements(userId);\n  \n    return { user: updatedUser, incomeEarned, rentalCost, netIncome };\n  }\n  \n  \n\n  // Tutorial\n  async completeTutorial(userId) {\n    const updatedUser = await this.updateUser(userId, {\n      tutorialCompleted: true\n    });\n\n    await this.addActivity(userId, 'Tutorial completed! All features unlocked.');\n\n    return { user: updatedUser };\n  }\n\n  // Activities\n  async addActivity(userId, description) {\n    const user = await this.getUser(userId);\n    if (!user) return;\n\n    const activities = user.activities || [];\n    activities.unshift({\n      id: randomUUID(),\n      description,\n      timestamp: new Date().toLocaleString()\n    });\n\n    // Keep only last 5 activities to save disk space\n    const trimmedActivities = activities.slice(0, 5);\n\n    await this.updateUser(userId, { activities: trimmedActivities });\n  }\n\n  async getUserActivities(userId) {\n    const user = await this.getUser(userId);\n    return user?.activities || [];\n  }\n\n  // Rankings - read directly from users folder\n  async getRankings() {\n    try {\n      const userFiles = await fs.readdir(usersDir);\n      const jsonFiles = userFiles.filter(file => file.endsWith('.json'));\n      \n      const rankings = [];\n      \n      for (const fileName of jsonFiles) {\n        try {\n          const userPath = path.join(usersDir, fileName);\n          const userData = JSON.parse(await fs.readFile(userPath, 'utf8'));\n          \n          // Calculate user level\n          const userLevel = Math.floor(Math.sqrt((userData.experience || 0) / 100)) + 1;\n          \n          // Get server count for this user from servers.json\n          const userServers = await this.getUserServers(userData.id);\n          \n          rankings.push({\n            id: userData.id,\n            nickname: userData.nickname,\n            balance: userData.balance || 0,\n            serverCount: userServers.length,\n            isOnline: this.isUserOnline(userData),\n            level: userLevel\n          });\n        } catch (err) {\n          // Skip invalid user files\n          continue;\n        }\n      }\n      \n      return rankings\n        .sort((a, b) => b.balance - a.balance)\n        .map((user, index) => ({\n          ...user,\n          rank: index + 1\n        }));\n    } catch (error) {\n      return [];\n    }\n  }\n\n  isUserOnline(userData) {\n    // Check if user has been banned\n    if (userData.banned) return false;\n    \n    // User is online if they've been active in the last 5 minutes\n    // Only count lastSeen for actual user activity, not automatic income updates\n    const lastActivity = userData.lastSeen || 0;\n    const fiveMinutesAgo = Date.now() - 5 * 60 * 1000;\n    return lastActivity > fiveMinutesAgo;\n  }\n\n  async getPlayerByNickname(nickname) {\n    try {\n      const userFiles = await fs.readdir(usersDir);\n      const jsonFiles = userFiles.filter(file => file.endsWith('.json'));\n      \n      for (const fileName of jsonFiles) {\n        try {\n          const userPath = path.join(usersDir, fileName);\n          const userData = JSON.parse(await fs.readFile(userPath, 'utf8'));\n          \n          if (userData.nickname === nickname) {\n            // Count servers correctly from servers.json\n            const userServers = await this.getUserServers(userData.id);\n            userData.serverCount = userServers.length;\n            return userData;\n          }\n        } catch (err) {\n          continue;\n        }\n      }\n      \n      return null;\n    } catch (error) {\n      return null;\n    }\n  }\n\n  async updateRankings() {\n    const rankings = await this.getRankings();\n    await this.saveRankings(rankings);\n  }\n\n  async getGeneralStats() {\n    try {\n      // Read directly from users folder\n      const userFiles = await fs.readdir(usersDir);\n      const jsonFiles = userFiles.filter(file => file.endsWith('.json'));\n      \n      // Get all servers from servers.json\n      const allServers = await this.getServers();\n      \n      let totalBalance = 0;\n      let onlineCount = 0;\n      \n      for (const fileName of jsonFiles) {\n        try {\n          const userPath = path.join(usersDir, fileName);\n          const userData = JSON.parse(await fs.readFile(userPath, 'utf8'));\n          \n          // Calculate total balance\n          totalBalance += userData.balance || 0;\n          \n          // Check if user is online based on real activity (5 minutes)\n          // Only count users with realActivity (not just automatic API calls)\n          if (userData.realActivity && (Date.now() - userData.realActivity) < 5 * 60 * 1000) {\n            onlineCount++;\n          }\n        } catch (err) {\n          // Skip invalid user files\n          continue;\n        }\n      }\n      \n      return {\n        totalPlayers: jsonFiles.length,\n        onlinePlayers: onlineCount,\n        totalServers: allServers.length,\n        totalBalance: Math.floor(totalBalance)\n      };\n    } catch (error) {\n      return {\n        totalPlayers: 0,\n        onlinePlayers: 0,\n        totalServers: 0,\n        totalBalance: 0\n      };\n    }\n  }\n\n  // Get all achievements\n  getAchievements() {\n    return ACHIEVEMENTS;\n  }\n\n  // Get all daily quests templates\n  getDailyQuests() {\n    return DAILY_QUESTS;\n  }\n\n  // Hidden achievements system\n  async getHiddenAchievements() {\n    return [\n      {\n        id: 'hidden-earlybird',\n        name: 'Early Bird',\n        description: 'Hidden achievement unlocked',\n        unlockCondition: { type: 'login_streak', value: 7 },\n        reward: 10000,\n        isHidden: true\n      },\n      {\n        id: 'hidden-explorer',\n        name: 'Explorer',\n        description: 'Hidden achievement unlocked',\n        unlockCondition: { type: 'servers_owned', value: 5 },\n        reward: 15000,\n        isHidden: true\n      },\n      {\n        id: 'hidden-mogul',\n        name: 'Business Mogul',\n        description: 'Hidden achievement unlocked',\n        unlockCondition: { type: 'balance', value: 1000000 },\n        reward: 50000,\n        isHidden: true\n      },\n      {\n        id: 'hidden-master',\n        name: 'Server Master',\n        description: 'Hidden achievement unlocked',\n        unlockCondition: { type: 'learning_completed', value: 2 },\n        reward: 25000,\n        isHidden: true\n      }\n    ];\n  }\n\n  // Daily login bonus system\n  async getDailyLoginBonus(username) {\n    try {\n      const userData = await this.getUser(username);\n      const now = new Date();\n      const berlinTime = new Date(now.toLocaleString(\"en-US\", {timeZone: \"Europe/Berlin\"}));\n      const today = berlinTime.toDateString(); // Use toDateString() for consistency\n      \n      const hasClaimedToday = userData.dailyLoginBonus === today;\n      \n      if (hasClaimedToday) {\n        return { canClaim: false, streak: userData.loginStreak || 1, amount: 0 };\n      }\n      \n      const currentStreak = userData.loginStreak || 1;\n      let amount = 100;\n      \n      if (userData.vipUntil && Date.now() < userData.vipUntil) {\n        amount = 200; // VIP gets 2x bonus\n      } else if (userData.premiumUntil && Date.now() < userData.premiumUntil) {\n        amount = 500; // Premium gets 5x bonus\n      }\n      \n      return { canClaim: true, streak: currentStreak, amount, nextStreak: currentStreak + 1 };\n    } catch (error) {\n      console.error('Get daily bonus error:', error);\n      return { canClaim: false, streak: 1, amount: 0 };\n    }\n  }\n\n  calculateDailyBonus(streak) {\n    const baseAmount = 100;\n    const multiplier = Math.min(streak, 20); // Max 20x multiplier\n    return Math.min(baseAmount * multiplier, 2000); // Max 2000 currency\n  }\n\n  async claimDailyBonus(username) {\n    try {\n      const bonusInfo = await this.getDailyLoginBonus(username);\n      if (!bonusInfo.canClaim) {\n        return { success: false, message: 'Already claimed today' };\n      }\n      \n      const userData = await this.getUser(username);\n      const berlinTime = new Date(new Date().toLocaleString(\"en-US\", {timeZone: \"Europe/Berlin\"}));\n      const today = berlinTime.toDateString(); // Use toDateString() for consistency\n      \n      // Double check - prevent multiple claims on same day\n      if (userData.dailyLoginBonus === today) {\n        return { success: false, message: 'Bonus already claimed today' };\n      }\n      \n      userData.balance = (userData.balance || 0) + bonusInfo.amount;\n      userData.dailyLoginBonus = today; // Update dailyLoginBonus field to today's date string\n      userData.loginStreak = bonusInfo.streak;\n      userData.lastActivity = Date.now();\n      \n      await this.saveUser(username, userData);\n      \n      return { \n        success: true, \n        amount: bonusInfo.amount, \n        streak: bonusInfo.streak,\n        newBalance: userData.balance\n      };\n    } catch (error) {\n      console.error('Daily bonus claim error:', error);\n      return { success: false, message: 'Error claiming bonus' };\n    }\n  }\n\n  // Tutorial system\n  async getTutorialProgress(username) {\n    try {\n      const userData = await this.getUser(username);\n      return userData.tutorialProgress || {\n        completed: false,\n        currentStep: 0,\n        steps: ['welcome', 'earning', 'shop', 'servers', 'learning']\n      };\n    } catch (error) {\n      return { completed: false, currentStep: 0, steps: ['welcome', 'earning', 'shop', 'servers', 'learning'] };\n    }\n  }\n\n  async updateTutorialProgress(username, step) {\n    try {\n      const userData = await this.getUser(username);\n      if (!userData.tutorialProgress) {\n        userData.tutorialProgress = { completed: false, currentStep: 0, steps: ['welcome', 'earning', 'shop', 'servers', 'learning'] };\n      }\n      \n      userData.tutorialProgress.currentStep = Math.max(userData.tutorialProgress.currentStep, step);\n      \n      if (step >= userData.tutorialProgress.steps.length - 1) {\n        userData.tutorialProgress.completed = true;\n      }\n      \n      await this.saveUser(username, userData);\n      return userData.tutorialProgress;\n    } catch (error) {\n      return null;\n    }\n  }\n\n  // Chat system\n  async getChatMessages(language = 'en') {\n    try {\n      const chatFilePath = getChatFile(language);\n      const data = await fs.readFile(chatFilePath, 'utf8');\n      return JSON.parse(data);\n    } catch {\n      return [];\n    }\n  }\n\n  async saveChatMessages(messages, language = 'en') {\n    const chatFilePath = getChatFile(language);\n    await fs.writeFile(chatFilePath, JSON.stringify(messages, null, 2));\n  }\n\n  async sendChatMessage(userId, message, language = 'en') {\n    const user = await this.getUser(userId);\n    if (!user || user.banned) {\n      throw new Error('Cannot send message');\n    }\n\n    // Check if user is muted\n    if (user.muted && user.muteExpires && Date.now() < user.muteExpires) {\n      const timeLeft = Math.ceil((user.muteExpires - Date.now()) / 60000);\n      throw new Error(`You are muted for ${timeLeft} more minutes`);\n    }\n\n    // Remove mute if expired\n    if (user.muted && user.muteExpires && Date.now() >= user.muteExpires) {\n      await this.updateUser(userId, {\n        muted: false,\n        muteExpires: null\n      });\n    }\n\n    const messages = await this.getChatMessages(language);\n    // Update user's last message time and language preference\n    await this.updateUser(userId, {\n      lastMessageTime: Date.now(),\n      chatLanguage: language\n    });\n\n    // Filter message for inappropriate content\n    const filteredMessage = await this.filterMessage(message, user);\n    \n    const newMessage = {\n      id: randomUUID(),\n      userId,\n      nickname: user.nickname,\n      message: filteredMessage.text,\n      originalMessage: message.trim(),\n      language: language,\n      timestamp: Date.now(),\n      deleted: false,\n      adminLevel: user.admin || 0,\n      reactions: {},\n      filtered: filteredMessage.wasFiltered,\n      warningCount: filteredMessage.warningCount\n    };\n\n    messages.push(newMessage);\n    \n    // Keep only last 50 messages\n    if (messages.length > 50) {\n      messages.splice(0, messages.length - 50);\n    }\n\n    await this.saveChatMessages(messages, language);\n    \n    // Update chat achievements\n    await this.updateChatAchievements(userId);\n    \n    // Mark chat as having new messages for other users\n    await this.markChatAsNewForOthers(userId);\n    \n    return newMessage;\n  }\n\n  async deleteChatMessage(messageId, adminUserId, language = 'en') {\n    const admin = await this.getUser(adminUserId);\n    if (!admin || admin.admin < 1) {\n      throw new Error('Admin access required');\n    }\n\n    const messages = await this.getChatMessages(language);\n    const messageIndex = messages.findIndex(msg => msg.id === messageId);\n    \n    if (messageIndex === -1) {\n      throw new Error('Message not found');\n    }\n\n    const message = messages[messageIndex];\n    message.deleted = true;\n    message.deletedBy = admin.nickname;\n    message.deletedAt = Date.now();\n    message.deletionReason = 'Deleted by admin';\n\n    await this.saveChatMessages(messages, language);\n    \n    // No system message for admin deletions - silent removal\n    \n    return message;\n  }\n\n  // Advanced Chat Features\n\n  // Filter message for inappropriate content (profanity, spam, caps)\n  async filterMessage(message, user) {\n    let filteredText = message.trim();\n    let wasFiltered = false;\n    let warningCount = user.chatWarnings || 0;\n    \n    // Skip filtering for admins\n    if (user.admin >= 1) {\n      return { text: filteredText, wasFiltered: false, warningCount: 0 };\n    }\n    \n    // Check for excessive caps (50-60% threshold)\n    const upperCaseLetters = (message.match(/[A-ZА-Я]/g) || []).length;\n    const totalLetters = (message.match(/[A-Za-zА-Яа-я]/g) || []).length;\n    const capsPercentage = totalLetters > 0 ? (upperCaseLetters / totalLetters) * 100 : 0;\n    \n    if (capsPercentage > 55 && totalLetters > 10) {\n      filteredText = message.toLowerCase();\n      wasFiltered = true;\n      warningCount++;\n      \n      // Add system warning for caps\n      await this.addSystemMessage(\n        `${user.nickname} warned (${warningCount}/3) - excessive caps`, \n        user.chatLanguage || 'ru'\n      );\n    }\n    \n    // Simple profanity filter\n    const profanityWords = ['fuck', 'shit', 'damn', 'блядь', 'сука', 'хуй', 'пизда', 'ебать'];\n    const hasProfanity = profanityWords.some(word => \n      filteredText.toLowerCase().includes(word.toLowerCase())\n    );\n    \n    if (hasProfanity) {\n      profanityWords.forEach(word => {\n        const regex = new RegExp(word, 'gi');\n        filteredText = filteredText.replace(regex, '*'.repeat(word.length));\n      });\n      wasFiltered = true;\n      warningCount++;\n      await this.addSystemMessage(`${user.nickname} - inappropriate language detected`, user.chatLanguage || 'ru');\n    }\n    \n    // Check for spam (same message recently)\n    const messages = await this.getChatMessages(language);\n    const recentMessages = messages.filter(msg => \n      msg.userId === user.id && Date.now() - msg.timestamp < 60000 // last minute\n    );\n    const duplicateMessage = recentMessages.find(msg => msg.message === message.trim());\n    \n    if (duplicateMessage) {\n      warningCount++;\n      await this.addSystemMessage(`${user.nickname} - please don't spam the same message`, language);\n    }\n    \n    // Auto-mute after 3 warnings\n    if (warningCount >= 3) {\n      const muteExpires = Date.now() + 15 * 60 * 1000; // 15 minutes\n      await this.updateUser(user.id, {\n        muted: true,\n        muteExpires: muteExpires,\n        chatWarnings: 0 // Reset warnings after mute\n      });\n      await this.addSystemMessage(`${user.nickname} was automatically muted for 15 minutes (3 warnings)`, user.chatLanguage || 'ru');\n      throw new Error('You have been muted for 15 minutes due to multiple warnings');\n    }\n    \n    // Update warning count\n    if (warningCount > (user.chatWarnings || 0)) {\n      await this.updateUser(user.id, { chatWarnings: warningCount });\n    }\n    \n    return { text: filteredText, wasFiltered, warningCount };\n  }\n\n  // Add system message - styled as admin warning\n  async addSystemMessage(text, language = 'ru') {\n    const messages = await this.getChatMessages(language);\n    const systemMessage = {\n      id: randomUUID(),\n      userId: 'system',\n      nickname: 'System',\n      message: text,\n      timestamp: Date.now(),\n      deleted: false,\n      adminLevel: 999,\n      isSystem: true,\n      isWarning: true,\n      language: language\n    };\n    \n    messages.push(systemMessage);\n    \n    if (messages.length > 50) {\n      messages.splice(0, messages.length - 50);\n    }\n    \n    await this.saveChatMessages(messages, language);\n    return systemMessage;\n  }\n\n  // Add reaction to message\n  async addMessageReaction(messageId, userId, emoji, language = 'en') {\n    const messages = await this.getChatMessages(language);\n    const messageIndex = messages.findIndex(msg => msg.id === messageId);\n    \n    if (messageIndex === -1) {\n      throw new Error('Message not found');\n    }\n    \n    if (!messages[messageIndex].reactions) {\n      messages[messageIndex].reactions = {};\n    }\n    \n    // Toggle reaction (add if not present, remove if present)\n    const currentReactions = messages[messageIndex].reactions[emoji] || [];\n    const userReactionIndex = currentReactions.indexOf(userId);\n    \n    if (userReactionIndex === -1) {\n      currentReactions.push(userId);\n    } else {\n      currentReactions.splice(userReactionIndex, 1);\n    }\n    \n    if (currentReactions.length === 0) {\n      delete messages[messageIndex].reactions[emoji];\n    } else {\n      messages[messageIndex].reactions[emoji] = currentReactions;\n    }\n    \n    await this.saveChatMessages(messages, language);\n    return messages[messageIndex];\n  }\n\n  // Pin/unpin message (super-admin only)\n  async pinMessage(messageId, adminUserId, language = 'en') {\n    const admin = await this.getUser(adminUserId);\n    if (!admin || admin.admin < 1) {\n      throw new Error('Admin access required');\n    }\n    \n    const messages = await this.getChatMessages(language);\n    const message = messages.find(msg => msg.id === messageId);\n    \n    if (!message) {\n      throw new Error('Message not found');\n    }\n    \n    // Check if there's already a pinned message\n    const currentPinned = messages.find(msg => msg.pinned);\n    if (currentPinned && currentPinned.id !== messageId) {\n      currentPinned.pinned = false;\n      currentPinned.pinnedBy = null;\n      currentPinned.pinnedAt = null;\n    }\n    \n    // Toggle pin status\n    message.pinned = !message.pinned;\n    message.pinnedBy = message.pinned ? admin.nickname : null;\n    message.pinnedAt = message.pinned ? Date.now() : null;\n    \n    await this.saveChatMessages(messages, language);\n    \n    // Add system message about pin/unpin\n    const action = message.pinned ? 'pinned' : 'unpinned';\n    await this.addSystemMessage(`Message from ${message.nickname} was ${action} by ${admin.nickname}`, language);\n    \n    return { success: true, pinned: message.pinned };\n  }\n\n  // Get pinned message\n  async getPinnedMessage(language = 'en') {\n    const messages = await this.getChatMessages(language);\n    return messages.find(msg => msg.pinned) || null;\n  }\n\n  // Mark chat as read for user\n  async markChatAsRead(userId) {\n    await this.updateUser(userId, {\n      lastChatRead: Date.now(),\n      hasNewChatMessages: false\n    });\n  }\n\n  // Mark chat as having new messages for other users\n  async markChatAsNewForOthers(senderUserId) {\n    const users = await this.getAllUsers();\n    for (const user of users) {\n      if (user.id !== senderUserId) {\n        await this.updateUser(user.id, { hasNewChatMessages: true });\n      }\n    }\n  }\n\n  // Chat achievements\n  async updateChatAchievements(userId) {\n    const user = await this.getUser(userId);\n\n    // Only check chat achievements if user has completed tutorial\n    if (!user.tutorialCompleted) return;\n\n    const messages = await this.getChatMessages();\n    const userMessages = messages.filter(msg => msg.userId === userId);\n    \n    const messageCount = userMessages.length;\n    const achievements = user.chatAchievements || [];\n    \n    // Define chat achievements\n    const chatAchievements = [\n      { id: 'first_message', title: 'First Message', description: 'Send your first chat message', requirement: 1 },\n      { id: 'chatty', title: 'Chatty', description: 'Send 25 messages', requirement: 25 },\n      { id: 'social_butterfly', title: 'Social Butterfly', description: 'Send 100 messages', requirement: 100 },\n      { id: 'chat_master', title: 'Chat Master', description: 'Send 500 messages', requirement: 500 }\n    ];\n    \n    for (const achievement of chatAchievements) {\n      if (messageCount >= achievement.requirement && !achievements.includes(achievement.id)) {\n        achievements.push(achievement.id);\n        await this.addActivity(userId, `Chat achievement unlocked: ${achievement.title}`);\n      }\n    }\n    \n    if (achievements.length > (user.chatAchievements || []).length) {\n      await this.updateUser(userId, { chatAchievements: achievements });\n    }\n  }\n\n  // Get chat achievements with progress\n  async getChatAchievements(userId) {\n    const user = await this.getUser(userId);\n    if (!user) return [];\n\n    const messages = await this.getChatMessages();\n    const userMessages = messages.filter(msg => msg.userId === userId);\n    const messageCount = userMessages.length;\n    \n    // Define chat achievements\n    const chatAchievements = [\n      { id: 'first_message', title: 'First Message', description: 'Send your first chat message', requirement: 1 },\n      { id: 'chatty', title: 'Chatty', description: 'Send 25 messages', requirement: 25 },\n      { id: 'social_butterfly', title: 'Social Butterfly', description: 'Send 100 messages', requirement: 100 },\n      { id: 'chat_master', title: 'Chat Master', description: 'Send 500 messages', requirement: 500 }\n    ];\n    \n    return chatAchievements.map(achievement => ({\n      ...achievement,\n      progress: Math.min(messageCount, achievement.requirement),\n      completed: messageCount >= achievement.requirement\n    }));\n  }\n\n  // Get chat achievements for user\n  async getChatAchievements(userId) {\n    const user = await this.getUser(userId);\n    const messages = await this.getChatMessages();\n    const userMessages = messages.filter(msg => msg.userId === userId);\n    const messageCount = userMessages.length;\n    \n    const chatAchievements = [\n      { \n        id: 'first_message', \n        title: 'First Message', \n        description: 'Send your first chat message', \n        requirement: 1,\n        progress: Math.min(messageCount, 1),\n        completed: messageCount >= 1\n      },\n      { \n        id: 'chatty', \n        title: 'Chatty', \n        description: 'Send 25 messages', \n        requirement: 25,\n        progress: Math.min(messageCount, 25),\n        completed: messageCount >= 25\n      },\n      { \n        id: 'social_butterfly', \n        title: 'Social Butterfly', \n        description: 'Send 100 messages', \n        requirement: 100,\n        progress: Math.min(messageCount, 100),\n        completed: messageCount >= 100\n      },\n      { \n        id: 'chat_master', \n        title: 'Chat Master', \n        description: 'Send 500 messages', \n        requirement: 500,\n        progress: Math.min(messageCount, 500),\n        completed: messageCount >= 500\n      }\n    ];\n    \n    return chatAchievements;\n  }\n\n  // Reports System\n  async createReport(userId, subject, category, initialMessage) {\n    const user = await this.getUser(userId);\n    if (!user || user.banned) {\n      throw new Error('Cannot create report');\n    }\n\n    // Check if user has active report\n    const existingReports = await this.getUserReports(userId);\n    const hasActiveReport = existingReports.some(report => report.status === 'open');\n    if (hasActiveReport) {\n      throw new Error('You already have an active report');\n    }\n\n    const reportId = randomUUID();\n    const report = {\n      id: reportId,\n      userId,\n      userNickname: user.nickname,\n      subject,\n      category,\n      status: 'open',\n      createdAt: Date.now(),\n      closedAt: null,\n      closedBy: null,\n      isMarked: false,\n      hasNewMessages: false\n    };\n\n    let reports = [];\n    try {\n      const data = await fs.readFile('./data/reports.json', 'utf8');\n      reports = JSON.parse(data);\n    } catch (error) {\n      // File doesn't exist, start with empty array\n    }\n\n    reports.push(report);\n    await fs.writeFile('./data/reports.json', JSON.stringify(reports, null, 2));\n\n    // Create initial message\n    if (initialMessage) {\n      await this.createReportMessage(reportId, userId, initialMessage, false);\n    }\n\n    return report;\n  }\n\n  async getUserReports(userId) {\n    try {\n      const data = await fs.readFile('./data/reports.json', 'utf8');\n      const reports = JSON.parse(data);\n      return reports.filter(report => report.userId === userId);\n    } catch (error) {\n      return [];\n    }\n  }\n\n  async getAdminReports() {\n    try {\n      const data = await fs.readFile('./data/reports.json', 'utf8');\n      const reports = JSON.parse(data);\n      return reports.sort((a, b) => b.createdAt - a.createdAt);\n    } catch (error) {\n      return [];\n    }\n  }\n\n  async getReportById(reportId) {\n    try {\n      const data = await fs.readFile('./data/reports.json', 'utf8');\n      const reports = JSON.parse(data);\n      return reports.find(report => report.id === reportId);\n    } catch (error) {\n      return null;\n    }\n  }\n\n  async updateReport(reportId, updates) {\n    try {\n      const data = await fs.readFile('./data/reports.json', 'utf8');\n      let reports = JSON.parse(data);\n      const reportIndex = reports.findIndex(report => report.id === reportId);\n      \n      if (reportIndex === -1) {\n        throw new Error('Report not found');\n      }\n\n      reports[reportIndex] = { ...reports[reportIndex], ...updates };\n      await fs.writeFile('./data/reports.json', JSON.stringify(reports, null, 2));\n      return reports[reportIndex];\n    } catch (error) {\n      throw new Error('Failed to update report');\n    }\n  }\n\n  async deleteReport(reportId) {\n    try {\n      const data = await fs.readFile('./data/reports.json', 'utf8');\n      let reports = JSON.parse(data);\n      reports = reports.filter(report => report.id !== reportId);\n      await fs.writeFile('./data/reports.json', JSON.stringify(reports, null, 2));\n\n      // Also delete all messages for this report\n      try {\n        const messagesData = await fs.readFile('./data/report-messages.json', 'utf8');\n        let messages = JSON.parse(messagesData);\n        messages = messages.filter(message => message.reportId !== reportId);\n        await fs.writeFile('./data/report-messages.json', JSON.stringify(messages, null, 2));\n      } catch (error) {\n        // Messages file doesn't exist\n      }\n\n      return true;\n    } catch (error) {\n      throw new Error('Failed to delete report');\n    }\n  }\n\n  async createReportMessage(reportId, userId, message, isFromAdmin = false) {\n    const user = await this.getUser(userId);\n    if (!user) {\n      throw new Error('User not found');\n    }\n\n    const reportMessage = {\n      id: randomUUID(),\n      reportId,\n      userId,\n      userNickname: user.nickname,\n      message: message.trim(),\n      isFromAdmin,\n      adminNickname: isFromAdmin ? user.nickname : null,\n      createdAt: Date.now()\n    };\n\n    let messages = [];\n    try {\n      const data = await fs.readFile('./data/report-messages.json', 'utf8');\n      messages = JSON.parse(data);\n    } catch (error) {\n      // File doesn't exist, start with empty array\n    }\n\n    messages.push(reportMessage);\n    await fs.writeFile('./data/report-messages.json', JSON.stringify(messages, null, 2));\n\n    // Update report to mark as having new messages\n    const report = await this.getReportById(reportId);\n    if (report) {\n      await this.updateReport(reportId, { hasNewMessages: true });\n    }\n\n    return reportMessage;\n  }\n\n  async getReportMessages(reportId) {\n    try {\n      const data = await fs.readFile('./data/report-messages.json', 'utf8');\n      const messages = JSON.parse(data);\n      return messages.filter(message => message.reportId === reportId)\n                    .sort((a, b) => a.createdAt - b.createdAt);\n    } catch (error) {\n      return [];\n    }\n  }\n\n  async closeReport(reportId, adminUserId) {\n    const admin = await this.getUser(adminUserId);\n    if (!admin || admin.admin < 1) {\n      throw new Error('Admin access required');\n    }\n\n    return await this.updateReport(reportId, {\n      status: 'closed',\n      closedAt: Date.now(),\n      closedBy: admin.nickname,\n      hasNewMessages: false\n    });\n  }\n\n  async markReport(reportId, adminUserId) {\n    const admin = await this.getUser(adminUserId);\n    if (!admin || admin.admin < 1) {\n      throw new Error('Admin access required');\n    }\n\n    const report = await this.getReportById(reportId);\n    if (!report) {\n      throw new Error('Report not found');\n    }\n\n    return await this.updateReport(reportId, {\n      isMarked: !report.isMarked\n    });\n  }\n\n  async muteUser(targetUserId, adminUserId, duration) {\n    const admin = await this.getUser(adminUserId);\n    if (!admin || admin.admin < 1) {\n      throw new Error('Admin access required');\n    }\n\n    const targetUser = await this.getUser(targetUserId);\n    if (!targetUser) {\n      throw new Error('User not found');\n    }\n\n    // Can't mute other admins unless you're super admin\n    if (targetUser.admin >= 1 && admin.nickname !== 'Ca6aka') {\n      throw new Error('Only super admin can mute other admins');\n    }\n\n    const muteExpires = Date.now() + (duration * 60 * 1000); // duration in minutes\n\n    await this.updateUser(targetUserId, {\n      muted: true,\n      muteExpires\n    });\n\n    await this.addActivity(targetUserId, `Muted for ${duration} minutes by admin ${admin.nickname}`);\n\n    return { success: true, muteExpires };\n  }\n\n  async unmuteUser(targetUserId, adminUserId) {\n    const admin = await this.getUser(adminUserId);\n    if (!admin || admin.admin < 1) {\n      throw new Error('Admin access required');\n    }\n\n    const targetUser = await this.getUser(targetUserId);\n    if (!targetUser) {\n      throw new Error('User not found');\n    }\n\n    await this.updateUser(targetUserId, {\n      muted: false,\n      muteExpires: null\n    });\n\n    await this.addActivity(targetUserId, `Unmuted by admin ${admin.nickname}`);\n\n    return { success: true };\n  }\n\n  async getActiveMutes() {\n    const users = await this.getAllUsers();\n    const now = Date.now();\n    \n    // Filter users who are currently muted\n    const mutedUsers = users.filter(user => {\n      if (!user.muted || !user.muteExpires) return false;\n      \n      // If mute has expired, automatically unmute them\n      if (now >= user.muteExpires) {\n        this.updateUser(user.id, {\n          muted: false,\n          muteExpires: null\n        });\n        return false;\n      }\n      \n      return true;\n    });\n\n    return mutedUsers.map(user => ({\n      id: user.id,\n      nickname: user.nickname,\n      muteExpires: user.muteExpires,\n      timeLeft: Math.ceil((user.muteExpires - now) / 60000) // minutes left\n    }));\n  }\n\n  async checkExpiredMutes() {\n    const users = await this.getAllUsers();\n    const now = Date.now();\n    \n    for (const user of users) {\n      if (user.muted && user.muteExpires && now >= user.muteExpires) {\n        await this.updateUser(user.id, {\n          muted: false,\n          muteExpires: null\n        });\n        await this.addActivity(user.id, 'Mute automatically expired');\n      }\n    }\n  }\n\n  // Add XP to user (for mini-games)\n  async addUserXP(userId, xpAmount) {\n    const user = await this.getUser(userId);\n    if (!user) {\n      throw new Error('User not found');\n    }\n\n    const currentXP = user.experience || 0;\n    const currentLevel = user.level || 1;\n    const newXP = currentXP + xpAmount;\n    \n    // Calculate new level (simple formula: level = floor(sqrt(XP/100)) + 1)\n    const newLevel = Math.floor(Math.sqrt(newXP / 100)) + 1;\n    \n    const updatedUser = await this.updateUser(userId, {\n      experience: newXP,\n      level: Math.max(currentLevel, newLevel)\n    });\n\n    // Add activity log\n    await this.addActivity(userId, `Gained ${xpAmount} XP from mini-game`);\n    \n    return updatedUser;\n  }\n\n  // Background income updater for all users with active servers\n  async updateAllActiveUsersIncome() {\n    try {\n      const users = await this.getAllUsers();\n      const servers = await this.getServers();\n      const now = Date.now();\n      \n      let updatedUsersCount = 0;\n      \n      // Group servers by owner for efficiency\n      const serversByOwner = {};\n      servers.forEach(server => {\n        if (!serversByOwner[server.ownerId]) {\n          serversByOwner[server.ownerId] = [];\n        }\n        serversByOwner[server.ownerId].push(server);\n      });\n      \n      for (const user of users) {\n        const userServers = serversByOwner[user.id] || [];\n        const activeServers = userServers.filter(s => s.isOnline);\n        \n        // Only update income for users with active servers who are not banned\n        if (activeServers.length > 0 && !user.banned) {\n          const lastUpdate = user.lastIncomeUpdate || now;\n          const timeSinceUpdate = now - lastUpdate;\n          \n          // Only update if it's been more than 30 seconds since last update\n          // This prevents too frequent updates and potential conflicts\n          if (timeSinceUpdate > 30000) {\n            try {\n              const result = await this.updateIncome(user.id);\n              if (result.netIncome !== 0) {\n                updatedUsersCount++;\n                console.log(`Background income update: ${user.nickname} earned $${result.netIncome}`);\n              }\n            } catch (error) {\n              console.error(`Error updating income for ${user.nickname}:`, error.message);\n            }\n          }\n        }\n      }\n      \n      if (updatedUsersCount > 0) {\n        console.log(`Background income update completed: ${updatedUsersCount} users updated`);\n      }\n      \n    } catch (error) {\n      console.error('Error in background income update:', error);\n    }\n  }\n\n  // Utility methods\n  formatTime(milliseconds) {\n    const seconds = Math.floor(milliseconds / 1000);\n    const minutes = Math.floor(seconds / 60);\n    const hours = Math.floor(minutes / 60);\n    \n    if (hours > 0) {\n      return `${hours}h ${minutes % 60}m`;\n    } else if (minutes > 0) {\n      return `${minutes}m ${seconds % 60}s`;\n    } else {\n      return `${seconds}s`;\n    }\n  }\n\n  // Server synchronization with data/servers.json\n  async syncServerData(userServers) {\n    try {\n      // Read existing servers data\n      let allServers = await this.readJsonFile('servers.json') || [];\n      \n      // Remove old entries for this user's servers\n      allServers = allServers.filter(server => !userServers.find(us => us.id === server.id));\n      \n      // Add ALL current user's servers (both online and offline) - preserve ALL fields\n      const updatedServers = userServers.map(server => ({\n        ...server, // Preserve ALL server fields\n        lastUpdated: Date.now()\n      }));\n      \n      allServers.push(...updatedServers);\n      \n      // Save updated servers data\n      await this.writeJsonFile('servers.json', allServers);\n    } catch (error) {\n      console.error('Error syncing server data:', error);\n    }\n  }\n\n  async deleteUserByNickname(nickname) {\n    const filePath = path.join(usersDir, `${nickname}.json`);\n    try {\n      await fs.unlink(filePath);\n    } catch (error) {\n      throw new Error('Failed to delete user');\n    }\n  }\n  async deleteServersByOwner(ownerId) {\n    const servers = await this.readJsonFile('servers.json');\n    const filtered = servers.filter(server => server.ownerId !== ownerId);\n    await this.writeJsonFile('servers.json', filtered);\n  }  \n}\n\n// Add new methods to FileStorage class for new features\nFileStorage.prototype.getHiddenAchievements = async function() {\n  const hiddenAchievements = [\n    {\n      id: 'first-connection',\n      name: 'First Connection',\n      description: 'Successfully establish your first server connection',\n      reward: 500,\n      requirement: 'complete_first_minigame'\n    },\n    {\n      id: 'perfect-security',\n      name: 'Security Expert', \n      description: 'Complete 50 security mini-games without errors',\n      reward: 2000,\n      requirement: 'perfect_security_count_50'\n    },\n    {\n      id: 'speed-demon',\n      name: 'Speed Demon',\n      description: 'Complete any mini-game in under 10 seconds',\n      reward: 1000,\n      requirement: 'minigame_speed_under_10s'\n    },\n    {\n      id: 'wealth-accumulator',\n      name: 'Wealth Accumulator',\n      description: 'Accumulate $100,000 total earnings',\n      reward: 5000,\n      requirement: 'total_earnings_100k'\n    }\n  ];\n  return hiddenAchievements;\n};\n\nFileStorage.prototype.getDailyLoginBonus = async function(userId) {\n  const user = await this.getUser(userId);\n  if (!user) throw new Error('User not found');\n\n  const now = new Date();\n  const berlinTime = new Date(now.toLocaleString(\"en-US\", {timeZone: \"Europe/Berlin\"}));\n  const today = berlinTime.toDateString();\n  \n  // Используем dailyLoginBonus для проверки, а не lastDailyBonus\n  const lastBonusDate = user.dailyLoginBonus || null;\n  let streak = user.dailyBonusStreak || 0;\n  let canClaim = false;\n\n  if (lastBonusDate !== today) {\n    canClaim = true;\n    \n    // Check if streak should continue or reset\n    if (lastBonusDate) {\n      const yesterday = new Date(berlinTime);\n      yesterday.setDate(yesterday.getDate() - 1);\n      const yesterdayStr = yesterday.toDateString();\n      \n      if (lastBonusDate !== yesterdayStr) {\n        streak = 0; // Reset streak if missed a day\n      }\n    }\n  }\n\n  // Apply subscription multipliers\n  const benefits = this.getSubscriptionBenefits(user);\n  const baseAmount = 100 * benefits.dailyBonusMultiplier;\n  const amount = Math.min(baseAmount * (streak + 1), 2000 * benefits.dailyBonusMultiplier);\n  const nextAmount = Math.min(baseAmount * (streak + 2), 2000 * benefits.dailyBonusMultiplier);\n\n  return {\n    canClaim,\n    streak,\n    amount,\n    nextAmount,\n    lastClaimed: user.lastDailyBonus\n  };\n};\n\nFileStorage.prototype.claimDailyBonus = async function(userId) {\n  const user = await this.getUser(userId);\n  if (!user) throw new Error('User not found');\n\n  const bonusInfo = await this.getDailyLoginBonus(userId);\n  if (!bonusInfo.canClaim) {\n    throw new Error('Bonus already claimed today');\n  }\n\n  const newStreak = bonusInfo.streak + 1;\n  const amount = bonusInfo.amount;\n  \n  // Update user data\n  const now = new Date();\n  const berlinTime = new Date(now.toLocaleString(\"en-US\", {timeZone: \"Europe/Berlin\"}));\n  const today = berlinTime.toDateString();\n  \n  user.balance = (user.balance || 0) + amount;\n  user.totalEarnings = (user.totalEarnings || 0) + amount;\n  user.dailyBonusStreak = newStreak;\n  user.lastDailyBonus = new Date().toISOString();\n  user.dailyLoginBonus = today;\n\n  await this.saveUserFile(user);\n\n  return {\n    success: true,\n    amount,\n    streak: newStreak,\n    message: 'Daily bonus claimed successfully'\n  };\n};\n\nFileStorage.prototype.getTutorialProgress = async function(userId) {\n  const user = await this.getUser(userId);\n  if (!user) throw new Error('User not found');\n\n  return {\n    completed: user.tutorialCompleted || false,\n    currentStep: user.tutorialStep || 0,\n    completedSteps: user.completedTutorialSteps || []\n  };\n};\n\nFileStorage.prototype.updateTutorialProgress = async function(userId, step) {\n  const user = await this.getUser(userId);\n  if (!user) throw new Error('User not found');\n\n  const totalSteps = 5; // Number of tutorial steps\n  user.tutorialStep = step;\n  user.completedTutorialSteps = user.completedTutorialSteps || [];\n  \n  if (!user.completedTutorialSteps.includes(step)) {\n    user.completedTutorialSteps.push(step);\n  }\n\n  // Check if tutorial is completed\n  if (step >= totalSteps - 1) {\n    user.tutorialCompleted = true;\n    \n    // Give tutorial completion reward\n    if (!user.tutorialRewardClaimed) {\n      user.balance = (user.balance || 0) + 15000;\n      user.totalEarnings = (user.totalEarnings || 0) + 15000;\n      user.tutorialRewardClaimed = true;\n    }\n  }\n\n  await this.saveUserFile(user);\n\n  return {\n    completed: user.tutorialCompleted || false,\n    currentStep: user.tutorialStep || 0,\n    completedSteps: user.completedTutorialSteps || []\n  };\n};\n\n// Hidden achievements functionality \nFileStorage.prototype.getHiddenAchievementsForUser = async function(userId) {\n  const user = await this.getUser(userId);\n  if (!user) throw new Error('User not found');\n\n  // Define 4 hidden achievements with unlock conditions\n  const hiddenAchievements = [\n    {\n      id: 'midnight_worker',\n      name: 'Полуночный работник',\n      description: 'Выполните работу между 00:00 и 02:00',\n      reward: 5000,\n      // Unlock condition: Complete a job between midnight and 2 AM\n      checkUnlock: (user) => {\n        return user.midnightJobCompleted || false;\n      }\n    },\n    {\n      id: 'speed_demon', \n      name: 'Демон скорости',\n      description: 'Выполните 10 работ за один день',\n      reward: 7500,\n      // Unlock condition: Complete 10 jobs in a single day\n      checkUnlock: (user) => {\n        return user.speedDemonUnlocked || false;\n      }\n    },\n    {\n      id: 'chat_legend',\n      name: 'Легенда чата',\n      description: 'Отправьте 1000 сообщений в чат',\n      reward: 10000,\n      // Unlock condition: Send 1000 chat messages\n      checkUnlock: (user) => {\n        return (user.chatMessagesCount || 0) >= 1000;\n      }\n    },\n    {\n      id: 'server_master',\n      name: 'Мастер серверов',\n      description: 'Владейте 20 серверами одновременно',\n      reward: 15000,\n      // Unlock condition: Own 20 servers simultaneously\n      checkUnlock: (user) => {\n        return (user.servers?.length || 0) >= 20;\n      }\n    }\n  ];\n\n  return hiddenAchievements.map(achievement => ({\n    ...achievement,\n    earned: achievement.checkUnlock(user)\n  }));\n};\n\n// Add function to update real user activity (not automatic requests)\nFileStorage.prototype.updateUserRealActivity = async function(userId) {\n  try {\n    const user = await this.getUser(userId);\n    if (user) {\n      user.realActivity = Date.now();\n      user.lastActivity = Date.now();\n      await this.saveUserFile(user);\n    }\n  } catch (error) {\n    console.error('Error updating user real activity:', error);\n  }\n};\n\n// VIP/Premium subscription functions\nFileStorage.prototype.activateSubscription = async function(userId, type) {\n  try {\n    const user = await this.getUser(userId);\n    if (!user) throw new Error('User not found');\n\n    if (type === 'vip') {\n      // Add or extend VIP (1 month)\n      const currentExpiration = user.vipExpires ? new Date(user.vipExpires) : new Date();\n      const newExpiration = new Date(Math.max(currentExpiration.getTime(), Date.now()) + 30 * 24 * 60 * 60 * 1000);\n      user.vipExpires = newExpiration.toISOString();\n    } else if (type === 'premium') {\n      user.premiumActive = true;\n      user.premiumActivatedAt = new Date().toISOString();\n      // If had VIP, convert remaining time to premium (premium is permanent)\n      if (user.vipExpires) {\n        delete user.vipExpires;\n      }\n    }\n\n    await this.saveUserFile(user);\n    return { success: true, user };\n  } catch (error) {\n    console.error('Error activating subscription:', error);\n    throw error;\n  }\n};\n\nFileStorage.prototype.manageSubscription = async function(userId, type, action, days) {\n  try {\n    const user = await this.getUser(userId);\n    if (!user) throw new Error('User not found');\n\n    if (action === 'grant') {\n      if (type === 'vip') {\n        const currentExpiration = user.vipExpires ? new Date(user.vipExpires) : new Date();\n        const newExpiration = new Date(Math.max(currentExpiration.getTime(), Date.now()) + days * 24 * 60 * 60 * 1000);\n        user.vipExpires = newExpiration.toISOString();\n      } else if (type === 'premium') {\n        user.premiumActive = true;\n        user.premiumActivatedAt = new Date().toISOString();\n      }\n    } else if (action === 'revoke') {\n      if (type === 'vip') {\n        delete user.vipExpires;\n      } else if (type === 'premium') {\n        user.premiumActive = false;\n        delete user.premiumActivatedAt;\n      }\n    }\n\n    await this.saveUserFile(user);\n    return { success: true, message: `${type.toUpperCase()} ${action}ed successfully` };\n  } catch (error) {\n    console.error('Error managing subscription:', error);\n    throw error;\n  }\n};\n\n// Get subscription benefits for user\nFileStorage.prototype.getSubscriptionBenefits = function(user) {\n  const hasVip = user.vipExpires && new Date(user.vipExpires) > new Date();\n  const hasPremium = user.premiumActive;\n\n  let benefits = {\n    hasVip,\n    hasPremium,\n    cooldownMultiplier: 1,\n    experienceMultiplier: 1,\n    dailyBonusMultiplier: 1,\n    serverLimit: 25,\n    instantServers: false,\n    noMinigameCooldown: false,\n    priorityReports: false\n  };\n\n  if (hasPremium) {\n    benefits.cooldownMultiplier = 0.5; // 1.5m/2m/5m instead of 3m/5m/7m\n    benefits.experienceMultiplier = 1.75;\n    benefits.dailyBonusMultiplier = 5; // +500 instead of +100\n    benefits.serverLimit = 30;\n    benefits.instantServers = true;\n    benefits.noMinigameCooldown = true;\n    benefits.priorityReports = true;\n  } else if (hasVip) {\n    benefits.cooldownMultiplier = 0.67; // 2m/4m/6m instead of 3m/5m/7m\n    benefits.experienceMultiplier = 1.5;\n    benefits.dailyBonusMultiplier = 2; // +200 instead of +100\n    benefits.priorityReports = true;\n  }\n\n  return benefits;\n};\n\n// Apply VIP/Premium benefits to cooldowns\nFileStorage.prototype.applySubscriptionCooldown = function(baseCooldown, user) {\n  const benefits = this.getSubscriptionBenefits(user);\n  return Math.round(baseCooldown * benefits.cooldownMultiplier);\n};\n\n// Apply VIP/Premium benefits to experience\nFileStorage.prototype.applySubscriptionExperience = function(baseXp, user) {\n  const benefits = this.getSubscriptionBenefits(user);\n  return Math.round(baseXp * benefits.experienceMultiplier);\n};\n\nexport const storage = new FileStorage();\n","size_bytes":90124},"server/vite.js":{"content":"import express from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { nanoid } from \"nanoid\";\nimport { fileURLToPath } from 'url';\n\nconst __dirname = path.dirname(fileURLToPath(import.meta.url));\nconst viteLogger = createLogger();\n\nexport function log(message, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app, server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true,\n  };\n\n  const viteConfig = {\n    plugins: [\n      (await import(\"@vitejs/plugin-react\")).default(),\n      (await import(\"@replit/vite-plugin-runtime-error-modal\")).default(),\n      // Temporarily disabled due to traverse function error\n      // ...(process.env.NODE_ENV !== \"production\" &&\n      // process.env.REPL_ID !== undefined\n      //   ? [\n      //       (await import(\"@replit/vite-plugin-cartographer\")).cartographer(),\n      //     ]\n      //   : []),\n    ],\n    resolve: {\n      alias: {\n        \"@\": path.resolve(__dirname, \"..\", \"client\", \"src\"),\n        \"@shared\": path.resolve(__dirname, \"..\", \"shared\"),\n        \"@assets\": path.resolve(__dirname, \"..\", \"attached_assets\"),\n      },\n    },\n    root: path.resolve(__dirname, \"..\", \"client\"),\n    build: {\n      outDir: path.resolve(__dirname, \"..\", \"dist/public\"),\n      emptyOutDir: true,\n    },\n    server: {\n      fs: {\n        strict: true,\n        deny: [\"**/.*\"],\n      },\n    },\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        __dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.jsx\"`,\n        `src=\"/src/main.jsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app) {\n  const distPath = path.resolve(__dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":3019},"shared/schema.js":{"content":"// User schema\nexport const createUser = (userData) => ({\n  id: userData.id,\n  nickname: userData.nickname,\n  password: userData.password,\n  balance: userData.balance || 10000,\n  serverLimit: userData.serverLimit || 3,\n  tutorialCompleted: userData.tutorialCompleted || false,\n  lastIncomeUpdate: userData.lastIncomeUpdate || Date.now(),\n  jobCooldowns: userData.jobCooldowns || {},\n  currentLearning: userData.currentLearning || null,\n  activities: userData.activities || []\n});\n\n// Server schema\nexport const createServer = (serverData) => ({\n  id: serverData.id,\n  ownerId: serverData.ownerId,\n  name: serverData.name,\n  type: serverData.type,\n  incomePerMinute: serverData.incomePerMinute,\n  monthlyCost: serverData.monthlyCost,\n  icon: serverData.icon,\n  isOnline: serverData.isOnline !== undefined ? serverData.isOnline : true,\n  usage: serverData.usage || Math.floor(Math.random() * 50) + 25,\n  createdAt: serverData.createdAt || Date.now()\n});\n\n// Activity schema\nexport const createActivity = (activityData) => ({\n  id: activityData.id,\n  description: activityData.description,\n  timestamp: activityData.timestamp || new Date().toLocaleString()\n});\n\n// Learning schema\nexport const createLearning = (learningData) => ({\n  id: learningData.id,\n  title: learningData.title,\n  description: learningData.description,\n  difficulty: learningData.difficulty,\n  startTime: learningData.startTime,\n  endTime: learningData.endTime,\n  progress: learningData.progress || 0,\n  reward: learningData.reward\n});\n\n// Game state schema\nexport const createGameState = (gameStateData = {}) => ({\n  user: gameStateData.user || null,\n  servers: gameStateData.servers || [],\n  activities: gameStateData.activities || [],\n  jobCooldowns: gameStateData.jobCooldowns || {},\n  currentLearning: gameStateData.currentLearning || null,\n  totalIncomePerMinute: gameStateData.totalIncomePerMinute || 0,\n  unlockedTabs: gameStateData.unlockedTabs || ['tutorial']\n});\n\n// Validation helpers\nexport const validateUser = (user) => {\n  if (!user.nickname || typeof user.nickname !== 'string') {\n    throw new Error('Nickname is required and must be a string');\n  }\n  if (!user.password || typeof user.password !== 'string') {\n    throw new Error('Password is required and must be a string');\n  }\n  return true;\n};\n\nexport const validateServer = (server) => {\n  if (!server.name || typeof server.name !== 'string') {\n    throw new Error('Server name is required and must be a string');\n  }\n  if (!server.ownerId || typeof server.ownerId !== 'string') {\n    throw new Error('Owner ID is required and must be a string');\n  }\n  if (typeof server.incomePerMinute !== 'number' || server.incomePerMinute < 0) {\n    throw new Error('Income per minute must be a positive number');\n  }\n  return true;\n};\n","size_bytes":2766},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, boolean, timestamp } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n});\n\nexport const reports = pgTable(\"reports\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull(),\n  subject: text(\"subject\").notNull(),\n  category: text(\"category\").notNull(), // 'general' or 'technical'\n  status: text(\"status\").notNull().default('open'), // 'open', 'closed', 'marked'\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).notNull().defaultNow(),\n  closedAt: timestamp(\"closed_at\", { withTimezone: true }),\n  closedBy: varchar(\"closed_by\"),\n  isMarked: boolean(\"is_marked\").notNull().default(false),\n  hasNewMessages: boolean(\"has_new_messages\").notNull().default(false),\n});\n\nexport const reportMessages = pgTable(\"report_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  reportId: varchar(\"report_id\").notNull(),\n  userId: varchar(\"user_id\").notNull(),\n  message: text(\"message\").notNull(),\n  isFromAdmin: boolean(\"is_from_admin\").notNull().default(false),\n  createdAt: timestamp(\"created_at\", { withTimezone: true }).notNull().defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport const insertReportSchema = createInsertSchema(reports).pick({\n  subject: true,\n  category: true,\n}).extend({\n  subject: z.string().min(1).max(50, \"Subject must be no more than 50 characters\"),\n  message: z.string().min(1).max(500, \"Message must be no more than 500 characters\"),\n});\n\nexport const insertReportMessageSchema = createInsertSchema(reportMessages).pick({\n  reportId: true,\n  message: true,\n}).extend({\n  message: z.string().min(1).max(500, \"Message must be no more than 500 characters\"),\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\nexport type InsertReport = z.infer<typeof insertReportSchema>;\nexport type Report = typeof reports.$inferSelect;\nexport type InsertReportMessage = z.infer<typeof insertReportMessageSchema>;\nexport type ReportMessage = typeof reportMessages.$inferSelect;\n","size_bytes":2435},"client/src/App.jsx":{"content":"import { Switch, Route, Redirect, useLocation } from \"wouter\"\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/components/theme-provider\";\nimport { GameProvider, useGame } from \"@/contexts/game-context\";\nimport { LanguageProvider } from \"@/contexts/language-context\";\nimport HomePage from \"@/pages/home\";\nimport LoginPage from \"@/pages/login\";\nimport DashboardPage from \"@/pages/dashboard\";\nimport PlayerProfilePage from \"@/pages/player-profile\";\nimport NotFound from \"@/pages/not-found\";\n\n\nfunction AppRouter() {\n  const { gameState } = useGame();\n  const [location] = useLocation();\n\n  // Preserve the last route when user is authenticated\n  const getDefaultGameRoute = () => {\n    // If we're already on a game route, preserve it\n    if (location.startsWith('/game/')) {\n      return location;\n    }\n    // Check localStorage for last visited tab\n    const lastTab = localStorage.getItem('lastGameTab');\n    if (lastTab && lastTab !== 'null') {\n      return `/game/${lastTab}`;\n    }\n    // Default to tutorial for first-time users or when tutorial isn't complete\n    return gameState.user?.tutorialCompleted ? '/game/servers' : '/game/tutorial';\n  };\n\n  return (\n    <Switch>\n      <Route path=\"/\">\n        {gameState.user ? <Redirect to={getDefaultGameRoute()} /> : <HomePage />}\n      </Route>\n      \n      <Route path=\"/start\">\n        <HomePage />\n      </Route>\n      \n      <Route path=\"/reg\">\n        {gameState.user ? <Redirect to=\"/game\" /> : <LoginPage />}\n      </Route>\n      \n      <Route path=\"/game\">\n        {gameState.user ? <DashboardPage /> : <Redirect to=\"/reg\" />}\n      </Route>\n      \n      <Route path=\"/game/:tab\">\n        {gameState.user ? <DashboardPage /> : <Redirect to=\"/reg\" />}\n      </Route>\n      \n      <Route path=\"/player/:nickname\" component={PlayerProfilePage} />\n      \n      <Route path=\"/player\">\n        {gameState.user ? <Redirect to=\"/game\" /> : <Redirect to=\"/reg\" />}\n      </Route>\n      \n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <LanguageProvider>\n        <ThemeProvider defaultTheme=\"dark\" storageKey=\"serversim-ui-theme\">\n          <GameProvider>\n            <TooltipProvider>\n              <Toaster />\n              <AppRouter />\n            </TooltipProvider>\n          </GameProvider>\n        </ThemeProvider>\n      </LanguageProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2653},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@keyframes shimmer {\n  0% { transform: translateX(-100%); }\n  100% { transform: translateX(100%); }\n}\n\n.animate-shimmer {\n  animation: shimmer 2s infinite;\n}\n\n/* Mobile optimizations */\n.scrollbar-hide {\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n}\n.scrollbar-hide::-webkit-scrollbar {\n  display: none;\n}\n\n/* Touch-friendly interactions */\n@media (max-width: 1024px) {\n  button {\n    min-height: 44px; /* Minimum touch target size */\n  }\n}\n\n/* Responsive improvements for different screen sizes */\n@media (min-width: 2560px) {\n  /* 4K monitors - scale up UI elements */\n  .text-sm { font-size: 1rem; }\n  .text-base { font-size: 1.25rem; }\n  .text-lg { font-size: 1.5rem; }\n  .text-xl { font-size: 1.75rem; }\n  .text-2xl { font-size: 2rem; }\n  .p-4 { padding: 1.5rem; }\n  .p-6 { padding: 2rem; }\n  .gap-4 { gap: 1.5rem; }\n  .gap-6 { gap: 2rem; }\n}\n\n@media (max-width: 1366px) and (min-width: 1024px) {\n  /* Standard laptop screens - optimize spacing */\n  .max-w-6xl { max-width: 64rem; }\n  .p-6 { padding: 1.5rem; }\n  .text-2xl { font-size: 1.625rem; }\n  .gap-6 { gap: 1.25rem; }\n}\n\n@media (max-width: 768px) {\n  /* Tablet and mobile - compact layout */\n  .p-6 { padding: 1rem; }\n  .text-2xl { font-size: 1.5rem; }\n  .text-lg { font-size: 1.125rem; }\n  .gap-6 { gap: 1rem; }\n  .space-y-6 > * + * { margin-top: 1rem; }\n  \n  /* Mobile-specific grid adjustments */\n  .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }\n  .lg\\:grid-cols-2 { grid-template-columns: repeat(1, minmax(0, 1fr)); }\n  \n  /* Responsive text sizes for mobile */\n  .text-sm { font-size: 0.875rem; }\n  .text-xs { font-size: 0.75rem; }\n}\n\n/* Ultra-wide monitor support */\n@media (min-width: 3440px) {\n  .max-w-6xl { max-width: 80rem; }\n  .grid { grid-gap: 2rem; }\n  .text-2xl { font-size: 2.25rem; }\n  .p-6 { padding: 2.5rem; }\n}\n\n/* Avatar animations */\n@keyframes gradient-shift {\n  0% { background-position: 0% 50%; }\n  50% { background-position: 100% 50%; }\n  100% { background-position: 0% 50%; }\n}\n\n@keyframes pulse-glow {\n  0% { box-shadow: 0 0 10px rgba(255, 255, 255, 0.3); }\n  50% { box-shadow: 0 0 20px rgba(255, 255, 255, 0.6); }\n  100% { box-shadow: 0 0 10px rgba(255, 255, 255, 0.3); }\n}\n\n@keyframes shimmer-wave {\n  0% { transform: translateX(-100%) scaleY(1); }\n  50% { transform: translateX(0%) scaleY(1.2); }\n  100% { transform: translateX(100%) scaleY(1); }\n}\n\n@keyframes color-dance {\n  0% { filter: hue-rotate(0deg) brightness(1); }\n  25% { filter: hue-rotate(90deg) brightness(1.2); }\n  50% { filter: hue-rotate(180deg) brightness(1); }\n  75% { filter: hue-rotate(270deg) brightness(1.2); }\n  100% { filter: hue-rotate(360deg) brightness(1); }\n}\n\n@keyframes soft-pulse {\n  0% { transform: scale(1); opacity: 1; }\n  50% { transform: scale(1.05); opacity: 0.9; }\n  100% { transform: scale(1); opacity: 1; }\n}\n\n@keyframes rainbow-pulse {\n  0% { \n    background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);\n    transform: scale(1) rotate(0deg);\n  }\n  25% { \n    background: linear-gradient(135deg, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3, #ff0000);\n    transform: scale(1.1) rotate(90deg);\n  }\n  50% { \n    background: linear-gradient(225deg, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3, #ff0000, #ff7f00);\n    transform: scale(1) rotate(180deg);\n  }\n  75% { \n    background: linear-gradient(315deg, #00ff00, #0000ff, #4b0082, #9400d3, #ff0000, #ff7f00, #ffff00);\n    transform: scale(1.1) rotate(270deg);\n  }\n  100% { \n    background: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);\n    transform: scale(1) rotate(360deg);\n  }\n}\n\n.animate-gradient-shift {\n  background-size: 200% 200%;\n  animation: gradient-shift 3s ease infinite;\n}\n\n.animate-pulse-glow {\n  animation: pulse-glow 2s ease-in-out infinite;\n}\n\n.animate-shimmer-wave {\n  animation: shimmer-wave 2.5s ease-in-out infinite;\n}\n\n.animate-color-dance {\n  animation: color-dance 4s ease-in-out infinite;\n}\n\n.animate-soft-pulse {\n  animation: soft-pulse 3s ease-in-out infinite;\n}\n\n.animate-rainbow-pulse {\n  animation: rainbow-pulse 2s ease-in-out infinite;\n}\n\n/* Admin badge animations */\n@keyframes shimmer {\n  0% {\n    transform: translateX(-100%);\n  }\n  100% {\n    transform: translateX(100%);\n  }\n}\n\n.animate-shimmer {\n  animation: shimmer 2s infinite;\n}\n\n@keyframes gradient-x {\n  0% {\n    background-position: 0% 50%;\n  }\n  50% {\n    background-position: 100% 50%;\n  }\n  100% {\n    background-position: 0% 50%;\n  }\n}\n\n.animate-gradient {\n  background-size: 200% 200%;\n  animation: gradient-x 6s ease infinite;\n}\n\n@keyframes gradientShift {\n  0% { background-position: 0% 50%; }\n  50% { background-position: 100% 50%; }\n  100% { background-position: 0% 50%; }\n}\n\n.test-name-1 {\n  background: linear-gradient(270deg, #3b82f6, #8b5cf6, #3b82f6);\n  background-size: 600% 600%;\n  -webkit-background-clip: text;\n  animation: gradientShift 5s ease infinite;\n}\n\n\n:root {\n  --game-name-1: #3b82f6; /* синий */\n  --game-name-2: #8b5cf6; /* фиолетовый */\n  --game-name-3: #ec4899; /* розовый */\n  --game-name-4: #f97316; /* оранжевый */\n}\n\n:root {\n  --background: hsl(0 0% 100%);\n  --foreground: hsl(210 25% 7.8431%);\n  --card: hsl(180 6.6667% 97.0588%);\n  --card-foreground: hsl(210 25% 7.8431%);\n  --popover: hsl(0 0% 100%);\n  --popover-foreground: hsl(210 25% 7.8431%);\n  --primary: hsl(203.8863 88.2845% 53.1373%);\n  --primary-foreground: hsl(0 0% 100%);\n  --secondary: hsl(210 25% 7.8431%);\n  --secondary-foreground: hsl(0 0% 100%);\n  --muted: hsl(240 1.9608% 90%);\n  --muted-foreground: hsl(210 25% 7.8431%);\n  --accent: hsl(211.5789 51.3514% 92.7451%);\n  --accent-foreground: hsl(203.8863 88.2845% 53.1373%);\n  --destructive: hsl(356.3033 90.5579% 54.3137%);\n  --destructive-foreground: hsl(0 0% 100%);\n  --border: hsl(201.4286 30.4348% 90.9804%);\n  --input: hsl(200 23.0769% 97.4510%);\n  --ring: hsl(202.8169 89.1213% 53.1373%);\n  --chart-1: hsl(203.8863 88.2845% 53.1373%);\n  --chart-2: hsl(159.7826 100% 36.0784%);\n  --chart-3: hsl(42.0290 92.8251% 56.2745%);\n  --chart-4: hsl(147.1429 78.5047% 41.9608%);\n  --chart-5: hsl(341.4894 75.2000% 50.9804%);\n  --sidebar: hsl(180 6.6667% 97.0588%);\n  --sidebar-foreground: hsl(210 25% 7.8431%);\n  --sidebar-primary: hsl(203.8863 88.2845% 53.1373%);\n  --sidebar-primary-foreground: hsl(0 0% 100%);\n  --sidebar-accent: hsl(211.5789 51.3514% 92.7451%);\n  --sidebar-accent-foreground: hsl(203.8863 88.2845% 53.1373%);\n  --sidebar-border: hsl(205.0000 25.0000% 90.5882%);\n  --sidebar-ring: hsl(202.8169 89.1213% 53.1373%);\n  --font-sans: Open Sans, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: 1.3rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n}\n\n.dark {\n  --background: hsl(0 0% 0%);\n  --foreground: hsl(200 6.6667% 91.1765%);\n  --card: hsl(228 9.8039% 10%);\n  --card-foreground: hsl(0 0% 85.0980%);\n  --popover: hsl(0 0% 0%);\n  --popover-foreground: hsl(200 6.6667% 91.1765%);\n  --primary: hsl(203.7736 87.6033% 52.5490%);\n  --primary-foreground: hsl(0 0% 100%);\n  --secondary: hsl(195.0000 15.3846% 94.9020%);\n  --secondary-foreground: hsl(210 25% 7.8431%);\n  --muted: hsl(0 0% 9.4118%);\n  --muted-foreground: hsl(210 3.3898% 46.2745%);\n  --accent: hsl(205.7143 70% 7.8431%);\n  --accent-foreground: hsl(203.7736 87.6033% 52.5490%);\n  --destructive: hsl(356.3033 90.5579% 54.3137%);\n  --destructive-foreground: hsl(0 0% 100%);\n  --border: hsl(210 5.2632% 14.9020%);\n  --input: hsl(207.6923 27.6596% 18.4314%);\n  --ring: hsl(202.8169 89.1213% 53.1373%);\n  --chart-1: hsl(203.8863 88.2845% 53.1373%);\n  --chart-2: hsl(159.7826 100% 36.0784%);\n  --chart-3: hsl(42.0290 92.8251% 56.2745%);\n  --chart-4: hsl(147.1429 78.5047% 41.9608%);\n  --chart-5: hsl(341.4894 75.2000% 50.9804%);\n  --sidebar: hsl(228 9.8039% 10%);\n  --sidebar-foreground: hsl(0 0% 85.0980%);\n  --sidebar-primary: hsl(202.8169 89.1213% 53.1373%);\n  --sidebar-primary-foreground: hsl(0 0% 100%);\n  --sidebar-accent: hsl(205.7143 70% 7.8431%);\n  --sidebar-accent-foreground: hsl(203.7736 87.6033% 52.5490%);\n  --sidebar-border: hsl(205.7143 15.7895% 26.0784%);\n  --sidebar-ring: hsl(202.8169 89.1213% 53.1373%);\n  --font-sans: Open Sans, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: 1.3rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n@keyframes gradient-xy {\n  0% { background-position: 0% 50%; }\n  50% { background-position: 100% 50%; }\n  100% { background-position: 0% 50%; }\n}\n\n.animate-gradient-xy {\n  animation: gradient-xy 3s ease infinite;\n}\n\n@keyframes rainbowGradient {\n  0% { background-position: 0% 50%; }\n  50% { background-position: 100% 50%; }\n  100% { background-position: 0% 50%; }\n}\n\n.animate-gradient-text {\n  background: linear-gradient(\n    90deg,\n    #ff0000,\n    #ff7f00,\n    #ffff00,\n    #00ff00,\n    #0000ff,\n    #4b0082,\n    #8f00ff,\n    #ff0000\n  );\n  background-size: 300% 100%;\n  -webkit-background-clip: text;\n  -webkit-text-fill-color: transparent;\n  animation: rainbowGradient 7s linear infinite;\n}\n\n@keyframes avatarFancy {\n  0% {\n    background-position: 0% 50%;\n    transform: scale(1) rotate(0deg);\n    filter: brightness(1);\n  }\n  25% {\n    background-position: 50% 50%;\n    transform: scale(1.05) rotate(2deg);\n    filter: brightness(1.1);\n  }\n  50% {\n    background-position: 100% 50%;\n    transform: scale(1) rotate(0deg);\n    filter: brightness(1);\n  }\n  75% {\n    background-position: 50% 50%;\n    transform: scale(0.95) rotate(-2deg);\n    filter: brightness(0.95);\n  }\n  100% {\n    background-position: 0% 50%;\n    transform: scale(1) rotate(0deg);\n    filter: brightness(1);\n  }\n}\n\n.animate-avatar-fancy {\n  background-size: 300% 300%;\n  animation: avatarFancy 8s ease-in-out infinite;\n  border-radius: 50%;\n}","size_bytes":11606},"client/src/main.jsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\nimport \"./lib/security.js\"; // Initialize security measures\n\ncreateRoot(document.getElementById(\"root\")).render(<App />);\n","size_bytes":216},"client/src/components/admin-panel.jsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Badge } from '@/components/ui/badge';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { useToast } from '@/hooks/use-toast';\nimport { useLanguage } from '@/contexts/language-context';\nimport { Settings, Crown, Users, Shield, Wallet, Mail } from 'lucide-react';\n\nconst apiRequest = async (url, options = {}) => {\n  const response = await fetch(url, {\n    credentials: 'include',\n    ...options,\n    headers: {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    },\n  });\n\n  if (!response.ok) {\n    const error = await response.json().catch(() => ({ message: 'Request failed' }));\n    throw new Error(error.message || 'Request failed');\n  }\n\n  return response.json();\n};\n\nexport const AdminPanel = ({ user, isOpen: externalIsOpen, onOpenChange }) => {\n  const { t } = useLanguage();\n  const { toast } = useToast();\n  const [internalIsOpen, setInternalIsOpen] = useState(false);\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [selectedUser, setSelectedUser] = useState('');\n  const [action, setAction] = useState('');\n  const [amount, setAmount] = useState('');\n  \n  // VIP/Premium management\n  const [subscriptionUser, setSubscriptionUser] = useState('');\n  const [subscriptionType, setSubscriptionType] = useState('vip');\n  const [subscriptionAction, setSubscriptionAction] = useState('grant');\n  const [subscriptionDays, setSubscriptionDays] = useState('');\n\n  // Payment settings\n  const [nowPaymentsKey, setNowPaymentsKey] = useState('');\n  const [gameEmail, setGameEmail] = useState('');\n  const [adminEmail, setAdminEmail] = useState('');\n\n  // Use external control if provided, otherwise use internal state\n  const isOpen = externalIsOpen !== undefined ? externalIsOpen : internalIsOpen;\n  const setIsOpen = onOpenChange || setInternalIsOpen;\n\n  const isSuperAdmin = user.nickname === 'Ca6aka';\n\n  const fetchUsers = async () => {\n    try {\n      setLoading(true);\n      const data = await apiRequest('/api/admin/users');\n      setUsers(data.users);\n    } catch (error) {\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: 'destructive'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSubscriptionAction = async () => {\n    if (!subscriptionUser || !subscriptionAction) {\n      toast({\n        title: t('error'),\n        description: 'Выберите пользователя и действие',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    if (subscriptionAction === 'grant' && !subscriptionDays) {\n      toast({\n        title: t('error'),\n        description: 'Укажите количество дней',\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await apiRequest('/api/admin/subscription', {\n        method: 'POST',\n        body: JSON.stringify({\n          action: subscriptionAction === 'grant' ? `give${subscriptionType.charAt(0).toUpperCase() + subscriptionType.slice(1)}` : 'removeSubscription',\n          targetNickname: subscriptionUser,\n          days: subscriptionAction === 'grant' ? parseInt(subscriptionDays) : undefined\n        })\n      });\n\n      toast({\n        title: t('success'),\n        description: `${subscriptionAction === 'grant' ? 'Выдан' : 'Отобран'} ${subscriptionType.toUpperCase()} статус для ${subscriptionUser}`,\n      });\n\n      // Reset form\n      setSubscriptionUser('');\n      setSubscriptionDays('');\n      fetchUsers();\n    } catch (error) {\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: 'destructive'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleAdminAction = async () => {\n    if (!selectedUser || !action) {\n      toast({\n        title: t('error'),\n        description: t('pleaseSelectUserAndAction'),\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    // Check if amount is required for money actions\n    if ((action === 'addMoney' || action === 'removeMoney') && (!amount || amount <= 0)) {\n      toast({\n        title: t('error'),\n        description: t('pleaseEnterValidAmount'),\n        variant: 'destructive'\n      });\n      return;\n    }\n\n    try {\n      setLoading(true);\n      await apiRequest('/api/admin/manage', {\n        method: 'POST',\n        body: JSON.stringify({\n          userId: selectedUser,\n          action: action,\n          amount: action === 'addMoney' || action === 'removeMoney' ? parseInt(amount) : undefined\n        })\n      });\n\n      toast({\n        title: t('success'),\n        description: t('actionSuccessfullyCompleted').replace('{action}', action)\n      });\n\n      fetchUsers();\n      setSelectedUser('');\n      setAction('');\n      setAmount('');\n    } catch (error) {\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: 'destructive'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (isOpen) {\n      fetchUsers();\n    }\n  }, [isOpen]);\n\n  if (user.admin < 1) return null;\n\n  return (\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\n      {externalIsOpen === undefined && (\n        <DialogTrigger asChild>\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            className=\"bg-purple-600/20 hover:bg-purple-600/30 border-purple-500/50 text-purple-200\"\n            data-testid=\"button-admin-panel\"\n          >\n            {isSuperAdmin ? (\n              <>\n                <Crown className=\"w-4 h-4 mr-1\" />\n                {t('superAdminPanel')}\n              </>\n            ) : (\n              <>\n                <Shield className=\"w-4 h-4 mr-1\" />\n                {t('adminPanel')}\n              </>\n            )}\n          </Button>\n        </DialogTrigger>\n      )}\n      <DialogContent className=\"max-w-4xl bg-slate-900 text-slate-100 max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center space-x-2\">\n            {isSuperAdmin ? <Crown className=\"w-5 h-5 text-yellow-400\" /> : <Shield className=\"w-5 h-5 text-purple-400\" />}\n            <span>{isSuperAdmin ? t('superAdminPanel') : t('adminPanel')}</span>\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Admin Stats */}\n          <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"text-sm text-slate-400\">{t('totalUsers')}</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-slate-100\">\n                  {users.length}\n                </div>\n              </CardContent>\n            </Card>\n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"text-sm text-slate-400\">{t('onlineUsers')}</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-green-400\">\n                  {users.filter(u => u.isOnline).length}\n                </div>\n              </CardContent>\n            </Card>\n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardHeader className=\"pb-2\">\n                <CardTitle className=\"text-sm text-slate-400\">{t('totalAdmins')}</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-2xl font-bold text-purple-400\">\n                  {users.filter(u => u.admin > 0).length}\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Admin Controls */}\n          {(user.admin >= 1) && (\n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <Settings className=\"w-5 h-5\" />\n                  <span>{isSuperAdmin ? t('adminManagement') : t('playerManagement')}</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>{t('selectUser')}</Label>\n                    <Select value={selectedUser} onValueChange={setSelectedUser}>\n                      <SelectTrigger>\n                        <SelectValue placeholder={t('chooseUser')} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {users.map(user => (\n                          <SelectItem key={user.id} value={user.id}>\n                            {user.nickname} \n                            {user.admin > 0 && <Badge className=\"ml-2 text-xs\">Admin</Badge>}\n                            <span className={`ml-2 w-2 h-2 rounded-full ${user.isOnline ? 'bg-green-400' : 'bg-red-400'}`} />\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>{t('action')}</Label>\n                    <Select value={action} onValueChange={setAction}>\n                      <SelectTrigger>\n                        <SelectValue placeholder={t('chooseAction')} />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {(() => {\n                          const selectedUserData = users.find(u => u.id === selectedUser);\n                          const isSelf = selectedUserData?.nickname === user.nickname;\n                          \n                          return (\n                            <>\n                              <SelectItem value=\"giveAdmin\" disabled={isSelf || !isSuperAdmin}>\n                                {t('giveAdmin')}\n                              </SelectItem>\n                              <SelectItem value=\"removeAdmin\" disabled={isSelf || !isSuperAdmin}>\n                                {t('removeAdmin')}\n                              </SelectItem>\n                              <SelectItem \n                                value=\"banUser\" \n                                disabled={isSelf}\n                                onClick={async () => {\n                                  try {\n                                    const res = await fetch('/api/admin/manage', {\n                                      method: 'POST',\n                                      headers: { 'Content-Type': 'application/json' },\n                                      body: JSON.stringify({ action: 'banUser', userId: targetUser.id })\n                                    });\n                                    const data = await res.json();\n\n                                    alert(data.message);\n\n                                    if (targetUser.id === gameState.user?.id && data.banned) {\n                                      // Очистка состояния пользователя\n                                      setGameState(prev => ({ ...prev, user: null }));\n                                      \n                                      // Перенаправление на страницу регистрации\n                                      window.location.href = '/reg';\n                                    }                                    \n                                  } catch (err) {\n                                    console.error(err);\n                                    alert('Failed to execute admin action');\n                                  }\n                                }}\n                              >\n                                {t('banUser')}\n                              </SelectItem>\n                              <SelectItem value=\"unbanUser\" disabled={isSelf}>\n                                {t('unbanUser')}\n                              </SelectItem>\n                              <SelectItem value=\"addMoney\" disabled={!isSuperAdmin}>\n                                {t('giveMoney')}\n                              </SelectItem>\n                              <SelectItem value=\"removeMoney\" disabled={!isSuperAdmin}>\n                                {t('takeMoney')}\n                              </SelectItem>\n                              <SelectItem value=\"deleteUser\" disabled={!isSuperAdmin}>\n                              {t('deleteUser')}\n                            </SelectItem>\n\n                            </>\n                          );\n                        })()}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n                {(action === 'addMoney' || action === 'removeMoney') && (\n                  <div className=\"space-y-2\">\n                    <Label>{t('amount')}</Label>\n                    <Input\n                      type=\"number\"\n                      placeholder={t('enterAmount')}\n                      value={amount}\n                      onChange={(e) => setAmount(e.target.value)}\n                      min=\"1\"\n                      data-testid=\"input-amount\"\n                    />\n                  </div>\n                )}\n                <Button \n                  onClick={handleAdminAction}\n                  disabled={loading || !selectedUser || !action}\n                  className=\"w-full bg-purple-600 hover:bg-purple-700\"\n                >\n                  {loading ? t('loading') : t('executeAction')}\n                </Button>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* VIP/Premium Management - Only for Super Admin */}\n          {isSuperAdmin && (\n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <Crown className=\"w-5 h-5 text-yellow-400\" />\n                  <span>Управление VIP/Premium</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Пользователь</Label>\n                    <Select value={subscriptionUser} onValueChange={setSubscriptionUser}>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Выберите пользователя\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {users.map(user => (\n                          <SelectItem key={user.id} value={user.nickname}>\n                            {user.nickname}\n                            {user.vipStatus === 'active' && <Badge className=\"ml-2 text-xs bg-blue-600\">VIP</Badge>}\n                            {user.premiumStatus === 'active' && <Badge className=\"ml-2 text-xs bg-purple-600\">PREMIUM</Badge>}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Тип статуса</Label>\n                    <Select value={subscriptionType} onValueChange={setSubscriptionType}>\n                      <SelectTrigger>\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"vip\">VIP</SelectItem>\n                        <SelectItem value=\"premium\">Premium</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>Действие</Label>\n                    <Select value={subscriptionAction} onValueChange={setSubscriptionAction}>\n                      <SelectTrigger>\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"grant\">Выдать</SelectItem>\n                        <SelectItem value=\"remove\">Отобрать</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n                {subscriptionAction === 'grant' && (\n                  <div className=\"space-y-2\">\n                    <Label>Количество дней</Label>\n                    <Input\n                      type=\"number\"\n                      value={subscriptionDays}\n                      onChange={(e) => setSubscriptionDays(e.target.value)}\n                      placeholder=\"Введите количество дней\"\n                      className=\"bg-slate-700 border-slate-600 text-slate-100\"\n                    />\n                  </div>\n                )}\n                <Button \n                  onClick={handleSubscriptionAction}\n                  disabled={loading}\n                  className=\"bg-yellow-600 hover:bg-yellow-700\"\n                >\n                  {loading ? 'Обработка...' : 'Выполнить'}\n                </Button>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* User List */}\n          <Card className=\"bg-slate-800/50 border-slate-700\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center space-x-2\">\n                <Users className=\"w-5 h-5\" />\n                <span>{t('userList')}</span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {loading ? (\n                <div className=\"text-center py-4\">{t('loading')}</div>\n              ) : (\n                <div className=\"max-h-96 overflow-y-auto space-y-2\">\n                  {users.map(user => (\n                    <div key={user.id} className=\"flex items-center justify-between p-3 bg-slate-700/30 rounded-lg\">\n                      <div className=\"flex items-center space-x-3\">\n                        <div className={`w-3 h-3 rounded-full ${user.isOnline ? 'bg-green-400' : 'bg-red-400'}`} />\n                        <span className=\"font-medium\">{user.nickname}</span>\n                        {/* Бан */}\n                        {user.banned && (\n                          <Badge variant=\"secondary\" className=\"text-xs bg-red-500 mr-1\">\n                            Banned\n                          </Badge>\n                        )}\n                        {/* VIP/Premium статусы */}\n                        {user.vipStatus === 'active' && (\n                          <Badge variant=\"secondary\" className=\"text-xs bg-blue-600\">\n                            VIP\n                          </Badge>\n                        )}\n                        {user.premiumStatus === 'active' && (\n                          <Badge variant=\"secondary\" className=\"text-xs bg-purple-600\">\n                            PREMIUM\n                          </Badge>\n                        )}\n                        {/* Админы */}\n                        {user.admin > 0 && (\n                          <Badge variant=\"secondary\" className=\"text-xs bg-red-500 animate-pulse\">\n                            {user.nickname === 'Ca6aka' ? 'Super Admin' : 'Admin'}\n                          </Badge>\n                        )}\n                      </div>\n                      <div className=\"text-sm text-slate-400\">\n                        {t('balance')}: ${user.balance?.toLocaleString() || 0}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Payment Configuration - Super Admin Only */}\n          {isSuperAdmin && (\n            <Card className=\"bg-slate-800/50 border-slate-700 border-green-500/30\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center space-x-2 text-green-400\">\n                  <Wallet className=\"w-5 h-5\" />\n                  <span>Настройки платежей NOWPayments</span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>NOWPayments API ключ</Label>\n                    <Input\n                      type=\"password\"\n                      placeholder=\"0BYBCND-44G4DAZ-K5FPR03-WQKCRAF\"\n                      value={nowPaymentsKey}\n                      onChange={(e) => setNowPaymentsKey(e.target.value)}\n                      className=\"bg-slate-900 border-slate-600\"\n                    />\n                    <p className=\"text-xs text-slate-400\">Получить на https://nowpayments.io/</p>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label className=\"flex items-center gap-2\">\n                      <Mail className=\"w-4 h-4\" />\n                      Игровой Email (от чьего имени отправляются письма)\n                    </Label>\n                    <Input\n                      type=\"email\"\n                      placeholder=\"noreply@yourgame.com\"\n                      value={gameEmail}\n                      onChange={(e) => setGameEmail(e.target.value)}\n                      className=\"bg-slate-900 border-slate-600\"\n                    />\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>Админский Email (для уведомлений о платежах)</Label>\n                    <Input\n                      type=\"email\"\n                      placeholder=\"admin@yourgame.com\"\n                      value={adminEmail}\n                      onChange={(e) => setAdminEmail(e.target.value)}\n                      className=\"bg-slate-900 border-slate-600\"\n                    />\n                  </div>\n\n                  <div className=\"bg-slate-900 p-3 rounded-lg\">\n                    <h4 className=\"font-medium text-slate-200 mb-2\">Настройка Webhook URL в NOWPayments:</h4>\n                    <div className=\"bg-slate-800 p-2 rounded text-xs text-green-400 font-mono mb-2\">\n                      {window.location.origin}/api/payment-webhook\n                    </div>\n                    <p className=\"text-xs text-slate-400 mb-3\">\n                      Скопируйте эту ссылку и вставьте в настройках NOWPayments как Webhook URL\n                    </p>\n                    \n                    <h4 className=\"font-medium text-slate-200 mb-2\">Как работает система:</h4>\n                    <ul className=\"text-xs text-slate-400 space-y-1\">\n                      <li>• Пользователь нажимает \"Купить VIP/Premium\"</li>\n                      <li>• Вводит email для подтверждения</li>\n                      <li>• Перенаправляется на NOWPayments</li>\n                      <li>• Платит банковской картой или криптой</li>\n                      <li>• NOWPayments конвертирует в USDT TRC20</li>\n                      <li>• USDT поступают на ваш кошелек в NOWPayments</li>\n                      <li>• Статус активируется автоматически через webhook</li>\n                    </ul>\n                  </div>\n\n                  <Button\n                    onClick={() => {\n                      toast({\n                        title: 'Настройки сохранены',\n                        description: 'Конфигурация платежей NOWPayments обновлена'\n                      });\n                    }}\n                    className=\"w-full bg-green-600 hover:bg-green-700\"\n                  >\n                    Сохранить настройки платежей\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n};","size_bytes":24854},"client/src/components/hosting-tab.jsx":{"content":"import { Button } from '@/components/ui/button';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useToast } from '@/hooks/use-toast';\nimport { SERVER_PRODUCTS, formatCurrency } from '@/lib/constants';\nimport { Lock } from 'lucide-react';\n\n// Helper function to get server tier colors\nconst getServerTierColors = (serverId) => {\n  // Weak servers (green/blue)\n  if (serverId === 'basic-web') return { bg: 'from-green-500/20 to-green-600/20', icon: 'text-green-400', border: 'border-green-500/50' };\n  if (serverId === 'database-server') return { bg: 'from-blue-500/20 to-blue-600/20', icon: 'text-blue-400', border: 'border-blue-500/50' };\n  \n  // Medium servers (yellow/orange)\n  if (serverId === 'high-performance') return { bg: 'from-yellow-500/20 to-yellow-600/20', icon: 'text-yellow-400', border: 'border-yellow-500/50' };\n  if (serverId === 'cdn-server') return { bg: 'from-orange-500/20 to-orange-600/20', icon: 'text-orange-400', border: 'border-orange-500/50' };\n  \n  // Powerful servers (red/light blue)\n  if (serverId === 'gpu-server') return { bg: 'from-red-500/20 to-red-600/20', icon: 'text-red-400', border: 'border-red-500/50' };\n  if (serverId === 'tpu-server') return { bg: 'from-cyan-500/20 to-cyan-600/20', icon: 'text-cyan-400', border: 'border-cyan-500/50' };\n  \n  // Default fallback\n  return { bg: 'from-slate-500/20 to-slate-600/20', icon: 'text-primary', border: 'border-primary/50' };\n};\n\nexport function HostingTab({ onTabChange }) {\n  const { gameState, purchaseServer } = useGame();\n  const { t } = useLanguage();\n  const { toast } = useToast();\n\n  const handlePurchaseServer = async (productId) => {\n    const product = SERVER_PRODUCTS.find(p => p.id === productId);\n    const currentServers = gameState.servers?.length || 0;\n    const serverLimit = gameState.user?.serverLimit || 3;\n    \n    if (currentServers >= serverLimit) {\n      toast({\n        title: t('serverLimitReached'),\n        description: t('serverLimitReachedDesc').replace('{serverLimit}', serverLimit),\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (gameState.user.balance < product.price) {\n      toast({\n        title: t('insufficientFunds'),\n        description: t('needMoreMoney').replace('{amount}', formatCurrency(product.price)),\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      await purchaseServer(productId);\n      toast({\n        title: t('serverPurchased'),\n        description: t('serverAddedToYourServers').replace('{serverName}', product.name),\n      });\n    } catch (error) {\n      toast({\n        title: t('purchaseFailed'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (!gameState.user) return null;\n\n  const currentServers = gameState.servers?.length || 0;\n  const serverLimit = gameState.user.serverLimit || 3;\n  const canPurchase = currentServers < serverLimit;\n\n  return (\n    <div className=\"p-3 sm:p-6 max-w-6xl mx-auto\">\n      <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6\">\n        <h2 className=\"text-xl sm:text-2xl font-bold text-slate-100 mb-2 sm:mb-0\">{t('serverStore')}</h2>\n        <div className=\"flex items-center space-x-2 sm:space-x-3\">\n          <span className=\"text-xs sm:text-sm text-slate-400\">{t('availableSlots')}:</span>\n          <span className=\"bg-slate-700 px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm font-medium\">\n            {serverLimit - currentServers}/{serverLimit}\n          </span>\n        </div>\n      </div>\n\n      {/* Server Limit Warning */}\n      {!canPurchase && (\n        <div className=\"bg-red-500/10 border border-red-500/30 rounded-lg p-4 mb-6\">\n          <div className=\"flex items-center space-x-2\">\n            <i className=\"fas fa-lock text-red-400\"></i>\n            <span className=\"text-red-400 font-medium\">{t('serverLimitReached')}</span>\n          </div>\n          <p className=\"text-sm text-slate-300 mt-1\">\n            {t('reachedServerLimit').replace('{serverLimit}', serverLimit)}\n          </p>\n        </div>\n      )}\n\n      {/* Server Products Grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6\">\n        {SERVER_PRODUCTS.map((product) => {\n          const userLevel = gameState.user.level || 1;\n          const canAfford = gameState.user.balance >= product.price;\n          const hasLevelRequirement = userLevel >= product.requiredLevel;\n          const completedLearning = gameState.user.completedLearning || [];\n          const hasLearningRequirement = !product.requiredLearning || completedLearning.includes(product.requiredLearning);\n          const isDisabled = !canPurchase || !canAfford || !hasLevelRequirement || !hasLearningRequirement;\n\n          return (\n            <div key={product.id} className={`relative overflow-hidden bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 sm:p-6 hover:${getServerTierColors(product.id).border} transition-all duration-300 transform hover:scale-105 ${!hasLevelRequirement || !hasLearningRequirement ? 'opacity-60' : ''}`}>\n              {/* Gradient Background */}\n              <div className={`absolute inset-0 bg-gradient-to-br ${getServerTierColors(product.id).bg} opacity-0 hover:opacity-100 transition-opacity duration-300 rounded-xl`}></div>\n              <div className=\"flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 mb-4\">\n                <div className=\"flex items-center space-x-3 flex-1\">\n                  <div className={`relative z-10 w-10 sm:w-12 h-10 sm:h-12 bg-gradient-to-br ${getServerTierColors(product.id).bg} rounded-lg flex items-center justify-center border ${getServerTierColors(product.id).border}`}>\n                    {!hasLevelRequirement || !hasLearningRequirement ? (\n                      <Lock className=\"text-slate-400 text-sm sm:text-lg\" />\n                    ) : (\n                      <i className={product.icon + ` ${getServerTierColors(product.id).icon} text-sm sm:text-lg`}></i>\n                    )}\n                  </div>\n                  <div className=\"relative z-10 flex-1\">\n                    <h3 className=\"font-semibold text-slate-100 text-sm sm:text-base\">{product.name}</h3>\n                    <p className=\"text-xs sm:text-sm text-slate-400\">{product.type}</p>\n                    {!hasLevelRequirement && (\n                      <p className=\"text-xs text-red-400 mt-1\">{t('requiresLevel').replace('{level}', product.requiredLevel)}</p>\n                    )}\n                    {!hasLearningRequirement && (\n                      <p className=\"text-xs text-red-400 mt-1\">{t('needLearningCourse')}</p>\n                    )}\n                  </div>\n                </div>\n                <div className=\"relative z-10 text-right\">\n                  <p className=\"text-base sm:text-lg font-bold text-primary\">{formatCurrency(product.price)}</p>\n                </div>\n              </div>\n\n              <div className=\"relative z-10 space-y-3 mb-6\">\n                <div className=\"flex justify-between items-center p-3 bg-slate-700/30 rounded-lg\">\n                  <span className=\"text-sm text-slate-400\">{t('income')}</span>\n                  <span className=\"font-semibold text-secondary\">+{formatCurrency(product.incomePerMinute)}</span>\n                </div>\n                <div className=\"flex justify-between items-center p-3 bg-slate-700/30 rounded-lg\">\n                  <span className=\"text-sm text-slate-400\">{t('monthlyCost')}</span>\n                  <span className=\"font-semibold text-red-400\">-{formatCurrency(product.monthlyCost)}</span>\n                </div>\n                <div className=\"flex justify-between items-center p-3 bg-slate-700/30 rounded-lg\">\n                  <span className=\"text-sm text-slate-400\">{t('netProfitMonth')}</span>\n                  <span className=\"font-semibold text-secondary\">\n                    +{formatCurrency((product.incomePerMinute * 60 * 24 * 30) - product.monthlyCost)}\n                  </span>\n                </div>\n              </div>\n\n              <Button \n                className=\"relative z-10 w-full\"\n                disabled={isDisabled}\n                onClick={() => handlePurchaseServer(product.id)}\n                variant={isDisabled ? \"secondary\" : \"default\"}\n              >\n                {!hasLevelRequirement ? t('requiresLevel').replace('{level}', product.requiredLevel) :\n                 !hasLearningRequirement ? t('needLearningCourse') :\n                 !canPurchase ? t('serverLimitReached') : \n                 !canAfford ? t('insufficientFunds') : \n                 t('purchaseServer')}\n              </Button>\n\n              {!canAfford && canPurchase && (\n                <p className=\"relative z-10 text-xs text-red-400 mt-2 text-center\">\n                  {t('needMoreFunds').replace('{amount}', formatCurrency(product.price - gameState.user.balance))}\n                </p>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Upgrade Notice */}\n      <div className=\"mt-8 bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/30 rounded-xl p-6\">\n        <div className=\"flex items-center space-x-3 mb-3\">\n          <div className=\"w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center\">\n            <i className=\"fas fa-graduation-cap text-purple-400\"></i>\n          </div>\n          <div>\n            <h3 className=\"text-lg font-semibold text-purple-400\">{t('wantMoreServers')}</h3>\n            <p className=\"text-sm text-slate-400\">{t('completeLearningCoursesToIncrease')}</p>\n          </div>\n        </div>\n        <p className=\"text-sm text-slate-300 mb-4\">\n          {t('learningCoursesBenefit')}\n        </p>\n        <Button \n          variant=\"outline\" \n          className=\"border-purple-500/30 text-purple-400 hover:bg-purple-500/10\"\n          onClick={() => onTabChange && onTabChange('learning')}\n        >\n          {t('browseLearningCourses')}\n        </Button>\n      </div>\n    </div>\n  );\n}\n","size_bytes":10103},"client/src/components/learning-tab.jsx":{"content":"import { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useToast } from '@/hooks/use-toast';\nimport { LEARNING_COURSES, formatCurrency, formatTime } from '@/lib/constants';\nimport { Lock } from 'lucide-react';\nimport { useQueryClient } from '@tanstack/react-query';\n\n// Helper function to get learning course colors based on difficulty\nconst getLearningColors = (difficulty) => {\n  if (difficulty === 'Beginner') return { bg: 'from-blue-500/20 to-blue-600/20', icon: 'text-blue-400', border: 'border-blue-500/50' };\n  if (difficulty === 'Intermediate') return { bg: 'from-orange-500/20 to-orange-600/20', icon: 'text-orange-400', border: 'border-orange-500/50' };\n  if (difficulty === 'Advanced') return { bg: 'from-red-500/20 to-red-600/20', icon: 'text-red-400', border: 'border-red-500/50' };\n  if (difficulty === 'Expert') return { bg: 'from-purple-500/20 to-purple-600/20', icon: 'text-purple-400', border: 'border-purple-500/50' };\n  if (difficulty === 'Master') return { bg: 'from-cyan-500/20 to-cyan-600/20', icon: 'text-cyan-400', border: 'border-cyan-500/50' };\n  \n  // Default fallback\n  return { bg: 'from-blue-500/20 to-blue-600/20', icon: 'text-blue-400', border: 'border-blue-500/50' };\n};\n\n// Helper function to format reward text\nconst getRewardText = (reward, t) => {\n  if (!reward || typeof reward !== 'object') return t('unknownReward');\n  \n  if (reward.type === 'serverSlots') {\n    const amount = reward.amount ?? 0;\n    return t('serverSlotReward')\n      .replace('{amount}', amount)\n      .replace('{plural}', amount > 1 ? 's' : '');\n  } else if (reward.type === 'efficiency') {\n    const amount = reward.amount ?? 0;\n    return t('serverEfficiencyReward').replace('{amount}', amount);\n  } else if (reward.type === 'serverUnlock') {\n    const serverType = reward.serverType;\n    const serverTypeName = serverType === 'gpu-server' ? t('gpuServer') : \n                           serverType === 'tpu-server' ? t('tpuServer') : \n                           t('specialServer');\n    return t('unlockServerReward').replace('{serverType}', serverTypeName);\n  }\n  return t('unknownReward');\n};\n\nexport function LearningTab() {\n  const { gameState, startLearning } = useGame();\n  const { t } = useLanguage();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const handleStartCourse = async (courseId) => {\n    const course = LEARNING_COURSES.find(c => c.id === courseId);\n    \n    if (gameState.currentLearning) {\n      toast({\n        title: t('learningInProgressError'),\n        description: t('oneCourseAtTime'),\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (gameState.user.balance < course.price) {\n      toast({\n        title: t('insufficientFunds'),\n        description: t('needMoneyForCourse').replace('{amount}', formatCurrency(course.price)),\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      await startLearning(courseId);\n      // Immediately update balance and user data\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/learning/current'] });\n      toast({\n        title: t('courseStarted'),\n        description: t('courseStartedDesc').replace('{courseTitle}', course.title),\n      });\n    } catch (error) {\n      toast({\n        title: t('failedToStartCourse'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (!gameState.user) return null;\n\n  return (\n    <div className=\"p-6 max-w-6xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h2 className=\"text-2xl font-bold text-slate-100\">{t('learningCenter')}</h2>\n        <div className=\"flex items-center space-x-3\">\n          <span className=\"text-sm text-slate-400\">{t('currentBalance')}:</span>\n          <span className=\"bg-slate-700 px-3 py-1 rounded-lg text-sm font-medium\">\n            {formatCurrency(gameState.user.balance)}\n          </span>\n        </div>\n      </div>\n\n      {/* Current Learning Progress */}\n      {gameState.currentLearning && gameState.currentLearning.progress < 100 && (\n        <div className=\"mb-8 bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/30 rounded-xl p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-purple-400\">{t('currentCourse')}</h3>\n            <span className=\"bg-purple-500/20 text-purple-300 px-3 py-1 rounded-lg text-sm font-medium\">\n              {gameState.currentLearning.difficulty}\n            </span>\n          </div>\n          \n          <div className=\"flex items-center space-x-4 mb-4\">\n            <div className=\"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center\">\n              <i className=\"fas fa-brain text-purple-400 text-lg\"></i>\n            </div>\n            <div className=\"flex-1\">\n              <h4 className=\"font-medium text-slate-200\">{gameState.currentLearning.title}</h4>\n              <p className=\"text-sm text-slate-400\">{gameState.currentLearning.description}</p>\n            </div>\n          </div>\n\n          <div className=\"space-y-2 mb-4\">\n            <div className=\"flex justify-between text-sm\">\n              <span className=\"text-slate-400\">{t('progress')}</span>\n              <span className=\"text-purple-400\">\n                {gameState.currentLearning.progress}% ({gameState.currentLearning.timeRemaining} {t('timeRemaining')})\n              </span>\n            </div>\n            <Progress value={gameState.currentLearning.progress} className=\"h-3\" />\n          </div>\n\n          <div className=\"p-3 bg-purple-500/10 rounded-lg\">\n            <p className=\"text-sm text-purple-300\">\n              <i className=\"fas fa-gift mr-1\"></i>\n              <strong>{t('reward')}:</strong> {getRewardText(gameState.currentLearning.reward, t)}\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Available Courses */}\n      <div className=\"space-y-6\">\n        <h3 className=\"text-lg font-semibold text-slate-200 mb-4\">{t('availableCourses')}</h3>\n        \n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {LEARNING_COURSES.map((course) => {\n          const userLevel = gameState.user.level || 1;\n          const canAfford = gameState.user.balance >= course.price;\n          const hasLevelRequirement = userLevel >= course.requiredLevel;\n          const completedLearning = gameState.user.completedLearning || [];\n          const isServerLimit25 = course.reward?.type === 'serverSlots' && (gameState.user.serverLimit || 3) >= 25;\n          \n          // For server slot courses, only consider them completed if we've reached the 25 server limit\n          const isCompleted = course.reward?.type === 'serverSlots' \n            ? isServerLimit25\n            : completedLearning.includes(course.id);\n            \n          const isLearning = gameState.currentLearning?.id === course.id;\n          const hasLearning = gameState.currentLearning && !isLearning;\n          const isDisabled = !canAfford || hasLearning || !hasLevelRequirement || isCompleted;\n\n          \n\n          return (\n            <div key={course.id} className={`relative overflow-hidden bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 hover:${getLearningColors(course.difficulty).border} transition-all duration-300 transform hover:scale-105 ${\n              isLearning ? 'border-purple-500/50 bg-purple-500/5' :\n              isCompleted ? 'border-green-500/50 bg-green-500/5' :\n              isDisabled ? 'opacity-60' : ''\n            }`}>\n              {/* Gradient Background */}\n              {!isDisabled && (\n                <div className={`absolute inset-0 ${!hasLevelRequirement ? 'bg-gradient-to-br from-slate-500/20 to-slate-600/20' : isCompleted ? 'bg-gradient-to-br from-green-500/20 to-green-600/20' : isLearning ? 'bg-gradient-to-br from-purple-500/20 to-purple-600/20' : `bg-gradient-to-br ${getLearningColors(course.difficulty).bg}`} opacity-0 hover:opacity-100 transition-opacity duration-300 rounded-xl`}></div>\n              )}\n              <div className=\"flex items-center justify-between mb-4\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className={`relative z-10 w-10 h-10 rounded-full flex items-center justify-center border ${\n                    !hasLevelRequirement ? 'bg-slate-500/20 border-slate-500/50' :\n                    isCompleted ? 'bg-gradient-to-br from-green-500/20 to-green-600/20 border-green-500/50' : \n                    isLearning ? 'bg-gradient-to-br from-purple-500/20 to-purple-600/20 border-purple-500/50' :\n                    `bg-gradient-to-br ${getLearningColors(course.difficulty).bg} ${getLearningColors(course.difficulty).border}`\n                  }`}>\n                    {!hasLevelRequirement ? (\n                      <Lock className=\"text-slate-400 text-lg\" />\n                    ) : isCompleted ? (\n                      <i className=\"fas fa-check text-green-400 text-lg\"></i>\n                    ) : isLearning ? (\n                      <i className=\"fas fa-brain text-purple-400 text-lg\"></i>\n                    ) : (\n                      <i className={`fas fa-brain ${getLearningColors(course.difficulty).icon} text-lg`}></i>\n                    )}\n                  </div>\n                  <div>\n                    <h3 className=\"font-semibold text-slate-100\">{course.title}</h3>\n                    <p className=\"text-sm text-slate-400\">{course.difficulty}</p>\n                    {!hasLevelRequirement && (\n                      <p className=\"text-xs text-red-400 mt-1\">{t('requiresLevelX').replace('{level}', course.requiredLevel)}</p>\n                    )}\n                  </div>\n                </div>\n                <div className=\"relative z-10 text-right\">\n                  <p className=\"text-base font-bold text-primary\">{formatCurrency(course.price)}</p>\n                </div>\n              </div>\n\n              <p className=\"relative z-10 text-sm text-slate-400 mb-4\">{course.description}</p>\n              \n              <div className=\"relative z-10 grid grid-cols-2 gap-4 mb-4\">\n                <div className=\"bg-slate-700/30 rounded-lg p-3\">\n                  <p className=\"text-xs text-slate-400 mb-1\">{t('duration')}</p>\n                  <p className=\"text-sm font-medium text-slate-300\">\n                    <i className=\"fas fa-clock mr-1\"></i>\n                    {formatTime(course.duration)}\n                  </p>\n                </div>\n                <div className=\"bg-slate-700/30 rounded-lg p-3\">\n                  <p className=\"text-xs text-slate-400 mb-1\">{t('reward')}</p>\n                  <p className=\"text-sm font-medium text-secondary\">\n                    <i className=\"fas fa-gift mr-1\"></i>\n                    {getRewardText(course.reward, t)}\n                  </p>\n                </div>\n              </div>\n\n              <Button \n                className=\"relative z-10 w-full\"\n                disabled={isDisabled}\n                onClick={() => !isCompleted && handleStartCourse(course.id)}\n                variant={isCompleted ? \"secondary\" : isLearning ? \"secondary\" : isDisabled ? \"ghost\" : \"default\"}\n              >\n                {!hasLevelRequirement ? t('requiresLevelX').replace('{level}', course.requiredLevel) :\n                 isServerLimit25 ? t('unavailable') :\n                 isCompleted && course.reward?.type !== 'serverSlots' ? t('completed') :\n                 isLearning ? t('inProgress') :\n                 hasLearning ? t('completeCurrentFirst') :\n                 !canAfford ? t('insufficientFunds') :\n                 t('startCourse')}\n              </Button>\n\n              {!canAfford && !hasLearning && (\n                <p className=\"relative z-10 text-xs text-red-400 mt-2 text-center\">\n                  {t('needMoreForCourse').replace('{amount}', formatCurrency(course.price - gameState.user.balance))}\n                </p>\n              )}\n            </div>\n          );\n        })}\n        </div>\n      </div>\n\n      {/* Benefits Overview */}\n      <div className=\"mt-8 bg-gradient-to-r from-blue-500/10 to-secondary/10 border border-blue-500/30 rounded-xl p-6\">\n        <h3 className=\"text-lg font-semibold text-blue-400 mb-3\">{t('learningBenefits')}</h3>\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4\">\n          <div className=\"relative overflow-hidden bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 hover:border-blue-500/50 transition-all duration-300 transform hover:scale-105 text-center\">\n            {/* Blue Gradient Background */}\n            <div className=\"absolute inset-0 bg-gradient-to-br from-blue-500/20 to-blue-600/20 opacity-0 hover:opacity-100 transition-opacity duration-300 rounded-xl\"></div>\n            <div className=\"relative z-10 w-12 h-12 bg-gradient-to-br from-blue-500/20 to-blue-600/20 rounded-full flex items-center justify-center mx-auto mb-2 border border-blue-500/50\">\n              <i className=\"fas fa-server text-blue-400\"></i>\n            </div>\n            <h4 className=\"relative z-10 font-medium text-slate-200\">{t('moreServers')}</h4>\n            <p className=\"relative z-10 text-xs text-slate-400\">{t('unlockAdditionalServerSlots')}</p>\n          </div>\n          <div className=\"relative overflow-hidden bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 hover:border-orange-500/50 transition-all duration-300 transform hover:scale-105 text-center\">\n            {/* Orange Gradient Background */}\n            <div className=\"absolute inset-0 bg-gradient-to-br from-orange-500/20 to-orange-600/20 opacity-0 hover:opacity-100 transition-opacity duration-300 rounded-xl\"></div>\n            <div className=\"relative z-10 w-12 h-12 bg-gradient-to-br from-orange-500/20 to-orange-600/20 rounded-full flex items-center justify-center mx-auto mb-2 border border-orange-500/50\">\n              <i className=\"fas fa-tachometer-alt text-orange-400\"></i>\n            </div>\n            <h4 className=\"relative z-10 font-medium text-slate-200\">{t('higherEfficiency')}</h4>\n            <p className=\"relative z-10 text-xs text-slate-400\">{t('increaseServerIncomeRates')}</p>\n          </div>\n          <div className=\"relative overflow-hidden bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 hover:border-red-500/50 transition-all duration-300 transform hover:scale-105 text-center\">\n            {/* Red Gradient Background */}\n            <div className=\"absolute inset-0 bg-gradient-to-br from-red-500/20 to-red-600/20 opacity-0 hover:opacity-100 transition-opacity duration-300 rounded-xl\"></div>\n            <div className=\"relative z-10 w-12 h-12 bg-gradient-to-br from-red-500/20 to-red-600/20 rounded-full flex items-center justify-center mx-auto mb-2 border border-red-500/50\">\n              <i className=\"fas fa-trophy text-red-400\"></i>\n            </div>\n            <h4 className=\"relative z-10 font-medium text-slate-200\">{t('betterRankings')}</h4>\n            <p className=\"relative z-10 text-xs text-slate-400\">{t('climbTheLeaderboards')}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":15388},"client/src/components/player-rankings.jsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { formatCurrency } from '@/lib/constants';\nimport { Link } from 'wouter';\nimport { useState, useEffect } from 'react';\n\n// Component for countdown timer\nexport function RankingsCountdown() {\n  const { t } = useLanguage();\n  const [timeLeft, setTimeLeft] = useState(30);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setTimeLeft(prev => {\n        if (prev <= 1) {\n          return 30; // Reset to 30 seconds\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  return (\n    <span className=\"text-xs text-slate-500 ml-1\">\n      ({timeLeft} {t('secondsShort')})\n    </span>\n  );\n}\n\nexport function PlayerRankings() {\n  const { gameState } = useGame();\n  \n  const { data: rankingsData } = useQuery({\n    queryKey: ['/api/rankings'],\n    enabled: !!gameState.user,\n    refetchInterval: 30000, // Update every 30 seconds\n  });\n\n  // Check if user is level 5 or higher to show rankings\n  const userLevel = Math.floor(Math.sqrt(gameState.user?.experience / 100)) + 1;\n\n  if (!rankingsData?.rankings) return null;\n\n  const rankings = rankingsData.rankings;\n  const userRank = rankings.find(r => r.id === gameState.user?.id);\n\n  return (\n    <div className=\"bg-slate-700/30 rounded-lg p-3 space-y-2 max-h-80 overflow-y-auto relative z-10\">\n      {rankings.slice(0, 10).map((player, index) => {\n        const isCurrentUser = player.id === gameState.user?.id;\n        \n        return (\n          <div \n            key={player.id}\n            className={`flex items-center justify-between p-2 rounded-lg ${\n              isCurrentUser \n                ? 'bg-primary/20 border border-primary/30' \n                : 'bg-slate-600/30 hover:bg-slate-600/50'\n            }`}\n          >\n            <div className=\"flex items-center space-x-2\">\n              <div className=\"flex items-center space-x-1\">\n                <div className={`w-1.5 h-1.5 rounded-full ${\n                  player.isOnline ? 'bg-green-500' : 'bg-red-500'\n                }`} />\n                <span className={`font-bold text-xs ${\n                  index === 0 ? 'text-yellow-400' : \n                  index === 1 ? 'text-slate-300' : \n                  index === 2 ? 'text-amber-600' : \n                  isCurrentUser ? 'text-primary' : 'text-slate-400'\n                }`}>\n                  #{player.rank}\n                </span>\n              </div>\n              {isCurrentUser ? (\n                <span className=\"text-xs text-primary font-medium\">You</span>\n              ) : (\n                <Link href={`/player/${player.nickname}`}>\n                  <span className=\"text-xs text-slate-300 hover:text-primary cursor-pointer transition-colors\">\n                    {player.nickname}\n                  </span>\n                </Link>\n              )}\n            </div>\n            <span className={`text-xs font-medium ${\n              isCurrentUser ? 'text-primary' : 'text-slate-400'\n            }`}>\n              {formatCurrency(player.balance, true)}\n            </span>\n          </div>\n        );\n      })}\n      \n      {/* Show current user's rank if not in top 10 */}\n      {userRank && userRank.rank > 10 && (\n        <>\n          <div className=\"text-center py-1\">\n            <span className=\"text-xs text-slate-500\">...</span>\n          </div>\n          <div className=\"flex items-center justify-between p-2 bg-primary/20 rounded-lg border border-primary/30\">\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-primary font-bold text-xs\">#{userRank.rank}</span>\n              <span className=\"text-xs text-primary font-medium\">You</span>\n            </div>\n            <span className=\"text-xs text-primary font-medium\">\n              {formatCurrency(userRank.balance, true)}\n            </span>\n          </div>\n        </>\n      )}\n    </div>\n  );\n}","size_bytes":4031},"client/src/components/servers-tab.jsx":{"content":"import { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { Label } from '@/components/ui/label';\nimport { Slider } from '@/components/ui/slider';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useToast } from '@/hooks/use-toast';\nimport { formatCurrency } from '@/lib/constants';\nimport { useState } from 'react';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport ServerConnectionGame from './server-connection-game';\nimport { Trash2, Settings, ChevronLeft, ChevronRight } from 'lucide-react'\n\n// Helper function to get server tier colors\nconst getServerTierColors = (serverType) => {\n  // Map server type to appropriate colors\n  if (serverType === 'Web Hosting') return { icon: 'text-green-400' }; // Basic Web Server\n  if (serverType === 'Storage') return { icon: 'text-blue-400' }; // Database Server\n  if (serverType === 'Gaming/Apps') return { icon: 'text-yellow-400' }; // High Performance Server\n  if (serverType === 'Content Delivery') return { icon: 'text-orange-400' }; // CDN Server\n  if (serverType === 'AI') return { icon: 'text-red-400' }; // GPU Server\n  if (serverType === 'Computing') return { icon: 'text-cyan-400' }; // TPU Server\n  \n  // Default fallback\n  return { icon: 'text-green-400' };\n};\n\n// Helper function to format reward text\nconst getRewardText = (reward, t) => {\n  if (!reward || typeof reward !== 'object') return t('unknownReward');\n  \n  if (reward.type === 'serverSlots') {\n    const amount = reward.amount ?? 0;\n    return t('serverSlotReward')\n      .replace('{amount}', amount)\n      .replace('{plural}', amount > 1 ? 's' : '');\n  } else if (reward.type === 'efficiency') {\n    const amount = reward.amount ?? 0;\n    return t('serverEfficiencyReward').replace('{amount}', amount);\n  } else if (reward.type === 'serverUnlock') {\n    const serverType = reward.serverType;\n    const serverTypeName = serverType === 'gpu-server' ? t('gpuServer') : \n                           serverType === 'tpu-server' ? t('tpuServer') : \n                           t('specialServer');\n    return t('unlockServerReward').replace('{serverType}', serverTypeName);\n  }\n  return t('unknownReward');\n};\n\nexport function ServersTab({ onTabChange }) {\n  const { gameState, toggleServer, deleteServer } = useGame();\n  const { t } = useLanguage();\n  const { toast } = useToast();\n  const [currentPage, setCurrentPage] = useState(1);\n  const SERVERS_PER_PAGE = 10;\n  const queryClient = useQueryClient();\n  const [selectedServer, setSelectedServer] = useState(null);\n  const [serverLoad, setServerLoad] = useState(50);\n  const [localLoadValue, setLocalLoadValue] = useState(50);\n  const [connectionGameOpen, setConnectionGameOpen] = useState(false);\n  const [gameServer, setGameServer] = useState(null);\n\n  const updateServerLoad = useMutation({\n    mutationFn: ({ serverId, loadPercentage }) => \n      apiRequest(`/api/servers/${serverId}/load`, 'POST', { loadPercentage }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n      toast({\n        title: t('success'),\n        description: t('serverLoadUpdated'),\n      });\n    },\n    onError: (error) => {\n      // Восстанавливаем предыдущее значение при ошибке\n      if (selectedServer) {\n        setLocalLoadValue(selectedServer.loadPercentage || 50);\n        setServerLoad(selectedServer.loadPercentage || 50);\n      }\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const repairServer = useMutation({\n    mutationFn: async ({ serverId, repairType }) => {\n      return await apiRequest(`/api/servers/${serverId}/repair`, 'POST', { repairType });\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      toast({\n        title: t('serverRepaired'),\n        description: t('serverRepairedDesc').replace('${cost}', `$${data.cost?.toLocaleString() || 'N/A'}`).replace('{durability}', data.durabilityRestored || 'N/A'),\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: t('repairFailed'),\n        description: error.message || 'Unknown error occurred',\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const toggleServerMutation = useMutation({\n    mutationFn: (serverId) => apiRequest(`/api/servers/${serverId}/toggle`, 'POST'),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n    },\n  });\n\n  const handleToggleServer = async (serverId) => {\n    try {\n      await toggleServerMutation.mutateAsync(serverId);\n      toast({\n        title: t('serverStatusUpdated'),\n        description: t('serverStatusUpdatedDesc'),\n      });\n    } catch (error) {\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const deleteServerMutation = useMutation({\n    mutationFn: (serverId) => apiRequest(`/api/servers/${serverId}`, 'DELETE'),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n    },\n  });\n\n  const handleDeleteServer = async (serverId) => {\n    const serverName = gameState.servers?.find(s => s.id === serverId)?.name;\n    const firstConfirm = window.confirm(`${t('deleteWarningTitle').replace('{serverName}', serverName)}\\n\\n${t('deleteWarningMessage')}`);\n    \n    if (firstConfirm) {\n      const secondConfirm = window.confirm(t('deleteLastWarning').replace('{serverName}', serverName));\n      \n      if (secondConfirm) {\n        const finalConfirm = prompt(t('deleteFinalConfirm').replace('{serverName}', serverName));;\n        \n        if (finalConfirm === t('deleteKeyword')) {\n          try {\n            await deleteServerMutation.mutateAsync(serverId);\n            toast({\n              title: t('serverDeleted'),\n              description: t('serverDeletedDesc').replace('{serverName}', serverName),\n            });\n          } catch (error) {\n            toast({\n              title: t('error'),\n              description: error.message,\n              variant: \"destructive\",\n            });\n          }\n        } else {\n          toast({\n            title: t('deleteCancelled'),\n            description: t('deleteCancelledDesc'),\n            variant: \"default\",\n          });\n        }\n      }\n    }\n  };\n\n  const startConnectionGame = (server) => {\n    // Prevent opening if server is already online\n    if (server.isOnline) {\n      toast({\n        title: t('serverAlreadyOnline'),\n        description: t('serverAlreadyOnlineDesc'),\n        variant: \"default\",\n      });\n      return;\n    }\n    \n    // Check if game is already open to prevent duplicate dialogs\n    if (connectionGameOpen) {\n      return;\n    }\n    \n    setGameServer(server);\n    setConnectionGameOpen(true);\n  };\n\n  const closeConnectionGame = () => {\n    setConnectionGameOpen(false);\n    setGameServer(null);\n  };\n\n  const onGameSuccess = () => {\n    closeConnectionGame();\n    toast({\n      title: t('success'),\n      description: t('serverNowOnline'),\n    });\n  };\n\n  if (!gameState.user) return null;\n\n  const serverLimit = gameState.user.serverLimit || 3;\n  const currentServers = gameState.servers?.length || 0;\n  const availableSlots = serverLimit - currentServers;\n  \n  // Pagination calculations  \n  const totalPages = Math.ceil(currentServers / SERVERS_PER_PAGE);\n  const startIndex = (currentPage - 1) * SERVERS_PER_PAGE;\n  const endIndex = startIndex + SERVERS_PER_PAGE;\n  const paginatedServers = gameState.servers?.slice(startIndex, endIndex) || [];\n\n  return (\n    <div className=\"p-3 sm:p-6 max-w-6xl mx-auto\">\n      <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4 sm:mb-6\">\n        <h2 className=\"text-xl sm:text-2xl font-bold text-slate-100 mb-2 sm:mb-0\">{t('myServers')}</h2>\n        \n        {/* Pagination Controls */}\n        {totalPages > 1 && (\n          <div className=\"flex items-center gap-2 mb-2 sm:mb-0\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}\n              disabled={currentPage === 1}\n              className=\"h-8 w-8 p-0\"\n            >\n              <ChevronLeft className=\"w-4 h-4\" />\n            </Button>\n            <span className=\"text-sm text-slate-400 px-2\">\n              {currentPage} / {totalPages}\n            </span>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}\n              disabled={currentPage === totalPages}\n              className=\"h-8 w-8 p-0\"\n            >\n              <ChevronRight className=\"w-4 h-4\" />\n            </Button>\n          </div>\n        )}\n        \n        <div className=\"flex items-center space-x-2 sm:space-x-3\">\n          <span className=\"text-xs sm:text-sm text-slate-400\">{t('activeServers')}:</span>\n          <span className=\"bg-slate-700 px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm font-medium\">\n            {gameState.servers?.filter(s => s.isOnline).length || 0}/{currentServers} {t('servers')}\n          </span>\n        </div>\n      </div>\n\n      {/* Server Limit Warning */}\n      {availableSlots <= 1 && serverLimit < 25 && (\n        <div className=\"bg-accent/10 border border-accent/30 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6\">\n          <div className=\"flex items-center space-x-2\">\n            <i className=\"fas fa-exclamation-triangle text-accent text-sm\"></i>\n            <span className=\"text-accent font-medium text-sm sm:text-base\">{t('serverLimitNotice')}</span>\n          </div>\n          <p className=\"text-xs sm:text-sm text-slate-300 mt-1\">\n            {t('serverLimitWarning').replace('{currentServers}', currentServers).replace('{serverLimit}', serverLimit)}\n          </p>\n        </div>\n      )}\n      \n      {/* Max Server Limit Message */}\n      {serverLimit >= 25 && availableSlots <= 1 && (\n        <div className=\"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6\">\n          <div className=\"flex items-center space-x-2\">\n            <i className=\"fas fa-exclamation-triangle text-yellow-500 text-sm\"></i>\n            <span className=\"text-yellow-500 font-medium text-sm sm:text-base\">{t('serverLimitReached')}</span>\n          </div>\n          <p className=\"text-xs sm:text-sm text-slate-300 mt-1\">\n            Вы достигли лимита серверов. Купить дополнительные слоты можно во вкладке <span \n              className=\"bg-gradient-to-r from-yellow-400 to-yellow-600 bg-clip-text text-transparent font-bold cursor-pointer animate-pulse\"\n              onClick={() => onTabChange('donate')}\n            >\n              Донат\n            </span>!\n          </p>\n        </div>\n      )}\n\n      {/* Active Servers Grid */}\n      {gameState.servers && gameState.servers.length > 0 ? (\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">\n          {paginatedServers.map((server) => (\n            <div key={server.id} className=\"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-6 hover:border-primary/30 transition-all\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div className=\"flex items-center space-x-3\">\n                  <div className={`w-10 h-10 bg-gradient-to-br ${getServerTierColors(server.type).icon === 'text-green-400' ? 'from-green-500/20 to-green-600/20 border-green-500/50' : getServerTierColors(server.type).icon === 'text-blue-400' ? 'from-blue-500/20 to-blue-600/20 border-blue-500/50' : getServerTierColors(server.type).icon === 'text-yellow-400' ? 'from-yellow-500/20 to-yellow-600/20 border-yellow-500/50' : getServerTierColors(server.type).icon === 'text-orange-400' ? 'from-orange-500/20 to-orange-600/20 border-orange-500/50' : getServerTierColors(server.type).icon === 'text-red-400' ? 'from-red-500/20 to-red-600/20 border-red-500/50' : getServerTierColors(server.type).icon === 'text-cyan-400' ? 'from-cyan-500/20 to-cyan-600/20 border-cyan-500/50' : 'from-slate-500/20 to-slate-600/20 border-slate-500/50'} rounded-full flex items-center justify-center border`}>\n                    <i className={`${server.icon || \"fas fa-server\"} ${server.isOnline ? getServerTierColors(server.type).icon : 'text-slate-500'}`}></i>\n                  </div>\n                  <div>\n                    <h3 className=\"font-semibold text-slate-100\">{server.name}</h3>\n                    <p className=\"text-sm text-slate-400\">{server.type}</p>\n                  </div>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  {/* Server Settings Button */}\n                  <Dialog>\n                    <DialogTrigger asChild>\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        className=\"bg-slate-600/50 text-slate-300 hover:bg-slate-600/70\"\n                        onClick={() => {\n                          setSelectedServer(server);\n                          const currentLoad = server.loadPercentage || 50;\n                          setServerLoad(currentLoad);\n                          setLocalLoadValue(currentLoad);\n                        }}\n                      >\n                        <i className=\"fas fa-cog\"></i>\n                        <Settings className=\"w-4 h-4 text-grau-600\" />\n                      </Button>\n                    </DialogTrigger>\n                    <DialogContent className=\"bg-slate-800 border-slate-700\">\n                      <DialogHeader>\n                        <DialogTitle className=\"text-white\">{t('serverSettings')}: {server.name}</DialogTitle>\n                      </DialogHeader>\n                      <div className=\"space-y-6 py-4\">\n                        <div className=\"space-y-3\">\n                          <Label className=\"text-slate-300 text-sm font-medium\">\n                            {t('loadPercentage')}: {localLoadValue}%\n                          </Label>\n                          <Slider\n                            value={[localLoadValue]}\n                            onValueChange={(value) => {\n                              setLocalLoadValue(value[0]);\n                              setServerLoad(value[0]);\n                            }}\n                            onValueCommit={(value) => {\n                              updateServerLoad.mutate({ serverId: server.id, loadPercentage: value[0] });\n                            }}\n                            max={100}\n                            min={10}\n                            step={5}\n                            className=\"w-full cursor-pointer\"\n                          />\n                          <div className=\"flex justify-between text-xs text-slate-400\">\n                            <span>10%</span>\n                            <span>50%</span>\n                            <span>100%</span>\n                          </div>\n                        </div>\n                        <div className=\"bg-slate-700/30 rounded-lg p-4 space-y-2\">\n                          <div className=\"flex justify-between\">\n                            <span className=\"text-slate-400 text-sm\">{t('currentLoad')}:</span>\n                            <span className=\"text-white font-medium\">{localLoadValue}%</span>\n                          </div>\n                          \n                        {/* \n                          <div className=\"flex justify-between\">\n                            <span className=\"text-slate-400 text-sm\">{t('durability')}:</span>\n                            <span className={`font-medium text-sm ${\n                              (server.durability || 100) >= 80 ? 'text-green-400' :\n                              (server.durability || 100) >= 50 ? 'text-yellow-400' :\n                              (server.durability || 100) >= 20 ? 'text-orange-400' : 'text-red-400'\n                            }`}>\n                              {Math.round(server.durability || 100)}%\n                            </span>\n                          </div>*/}\n                          \n                          <div className=\"flex justify-between\">\n                            <span className=\"text-slate-400 text-sm\">{t('overloadRisk')}:</span>\n                            <span className={`font-medium text-sm ${\n                              (server.loadPercentage || 50) <= 49 ? 'text-green-400' :\n                              (server.loadPercentage || 50) <= 74 ? 'text-yellow-400' :\n                              (server.loadPercentage || 50) <= 89 ? 'text-orange-400' : 'text-red-400'\n                            }`}>\n                              {(server.loadPercentage || 50) <= 49 ? t('low') :\n                               (server.loadPercentage || 50) <= 74 ? t('moderate') :\n                               (server.loadPercentage || 50) <= 89 ? t('high') : t('veryHigh')}\n                            </span>\n                          </div>\n                          \n                          {(server.loadPercentage || 50) > 49 && (\n                            <div className=\"text-orange-300 text-xs mt-2 p-2 bg-orange-500/10 rounded\">\n                              <i className=\"fas fa-warning mr-1\"></i>\n                              {t('serverShutdownWarning')}\n                            </div>\n                          )}\n                          \n                          {(server.durability || 100) <= 0 && (\n                            <div className=\"text-red-300 text-xs mt-2 p-2 bg-red-500/10 rounded\">\n                              <i className=\"fas fa-exclamation-triangle mr-1\"></i>\n                              {t('maintenanceRequired')}\n                            </div>\n                          )}\n                        </div>\n                        \n                        {/* Durability Progress Bar */}\n                        <div className=\"space-y-2\">\n                          <div className=\"flex justify-between text-xs\">\n                            <span className=\"text-slate-400\">{t('serverCondition')}</span>\n                            <span className=\"text-slate-300\">{Math.round(server.durability || 100)}%</span>\n                          </div>\n                          <div className=\"w-full bg-slate-700 rounded-full h-2\">\n                            <div \n                              className={`h-2 rounded-full transition-all duration-300 ${\n                                (server.durability || 100) >= 80 ? 'bg-green-500' :\n                                (server.durability || 100) >= 50 ? 'bg-yellow-500' :\n                                (server.durability || 100) >= 20 ? 'bg-orange-500' : 'bg-red-500'\n                              }`} \n                              style={{ width: `${server.durability || 100}%` }}\n                            ></div>\n                          </div>\n                        </div>\n                        \n                        {/* Repair Section */}\n                        {(server.durability || 100) < 100 && (\n                          <div className=\"bg-slate-600/30 rounded-lg p-4 space-y-3\">\n                            <h4 className=\"text-sm font-medium text-slate-200\">{t('serverMaintenance')}</h4>\n                            <div className=\"flex space-x-2\">\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                className=\"flex-1 bg-yellow-500/10 text-yellow-400 border-yellow-500/30 hover:bg-yellow-500/20\"\n                                onClick={() => repairServer.mutate({ serverId: server.id, repairType: 'partial' })}\n                                disabled={repairServer.isPending}\n                              >\n                                <i className=\"fas fa-wrench mr-1\"></i>\n                                {t('partialRepair')}\n                              </Button>\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                className=\"flex-1 bg-green-500/10 text-green-400 border-green-500/30 hover:bg-green-500/20\"\n                                onClick={() => repairServer.mutate({ serverId: server.id, repairType: 'full' })}\n                                disabled={repairServer.isPending}\n                              >\n                                <i className=\"fas fa-tools mr-1\"></i>\n                                {t('fullRepair')}\n                              </Button>\n                            </div>\n                            <div className=\"text-xs text-slate-400\">\n                              {t('repairCostInfo')}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    </DialogContent>\n                  </Dialog>\n                  {/* Server Status Toggle */}\n                  <Button\n                    size=\"sm\"\n                    variant={server.isOnline ? \"default\" : \"secondary\"}\n                    className={\n                      server.isOnline\n                        ? \"bg-secondary/20 text-secondary hover:bg-secondary/30\"\n                        : \"bg-slate-600/50 text-slate-400 border border-red-500\"\n                    }\n                    onClick={() =>\n                      server.isOnline\n                        ? handleToggleServer(server.id)\n                        : startConnectionGame(server)\n                    }\n                  >\n                    <i className=\"fas fa-power-off mr-1\"></i>\n                    {server.isOnline ? t(\"online\") : t(\"offline\")}\n                  </Button>\n\n                  {/* Delete Server Button - Made less prominent */}\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    className=\"bg-transparent text-slate-500 hover:bg-red-500/20 hover:text-red-400 transition-colors border border-slate-700 hover:border-red-500/50\"\n                    onClick={() => handleDeleteServer(server.id)}\n                    title={t('deleteServerTooltip')}\n                  ><Trash2 className=\"w-4 h-4 text-red-600\" />\n                    <i className=\"fas fa-trash text-xs\"></i>\n                  </Button>\n                </div>\n              </div>\n              \n              <div className=\"grid grid-cols-2 gap-4 mb-4\">\n                <div className=\"bg-slate-700/30 rounded-lg p-3\">\n                  <p className=\"text-xs text-slate-400 mb-1\">{t('income')}</p>\n                  <p className={`font-semibold ${server.isOnline ? 'text-secondary' : 'text-slate-500'}`}>\n                    {server.isOnline ? (() => {\n                      const baseIncome = server.incomePerMinute;\n                      const loadPercentage = server.loadPercentage || 50;\n                      const loadAdjustment = baseIncome * (1 + (loadPercentage - 50) / 100);\n                      const efficiencyBonus = gameState.user.efficiencyBonus || 0;\n                      const finalIncome = Math.ceil(loadAdjustment * (1 + efficiencyBonus / 100));\n                      return `+${formatCurrency(finalIncome)}`;\n                    })() : '$0 (Offline)'}\n                  </p>\n                </div>\n                <div className=\"bg-slate-700/30 rounded-lg p-3\">\n                  <p className=\"text-xs text-slate-400 mb-1\">{t('rentalCost')}</p>\n                  <p className=\"font-semibold text-red-400\">-{formatCurrency(Math.round(server.incomePerMinute * 0.1))}/min</p>\n                </div>\n              </div>\n\n              {/* Server Usage */}\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-slate-400\">{t('currentLoad')}</span>\n                  <span className=\"text-slate-300\">{server.loadPercentage || 50}%</span>\n                </div>\n                <div className=\"w-full bg-slate-700 rounded-full h-2\">\n                  <div \n                    className={`h-2 rounded-full transition-all duration-300 ${\n                      (server.loadPercentage || 50) <= 49 ? 'bg-green-500' :\n                      (server.loadPercentage || 50) <= 74 ? 'bg-yellow-500' :\n                      (server.loadPercentage || 50) <= 89 ? 'bg-orange-500' : 'bg-red-500'\n                    }`} \n                    style={{ width: `${server.loadPercentage || 50}%` }}\n                  ></div>\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      ) : (\n        <div className=\"text-center py-12\">\n          <div className=\"w-16 h-16 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-4\">\n            <i className=\"fas fa-server text-slate-400 text-xl\"></i>\n          </div>\n          <h3 className=\"text-lg font-semibold text-slate-300 mb-2\">{t('noServersYet')}</h3>\n          <p className=\"text-sm text-slate-400 mb-4\">\n            {t('purchaseFirstServer')}\n          </p>\n        </div>\n      )}\n\n      {/* Add New Server Section */}\n      {availableSlots > 0 && (\n        <div className=\"bg-slate-800/30 border border-dashed border-slate-600 rounded-xl p-8 text-center\">\n          <div className=\"max-w-md mx-auto\">\n            <div className=\"w-16 h-16 bg-blue-700/50 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <i className=\"fas fa-plus text-slate-400 text-xl\"></i>\n            </div>\n            <h3 className=\"text-lg font-semibold text-slate-300 mb-2\">{t('addNewServer')}</h3>\n            <p className=\"text-sm text-slate-400 mb-4\">\n              {t('availableServerSlots')\n                .replace('{availableSlots}', availableSlots)\n                .replace('{plural}', availableSlots !== 1 ? 's' : '')}\n            </p>\n            <Button \n              className=\"bg-primary hover:bg-primary/80 text-white\"\n              onClick={() => onTabChange && onTabChange('hosting')}\n            >\n              {t('browseServerStore')}\n            </Button>\n          </div>\n        </div>\n      )}\n\n      {/* Learning in Progress */}\n      {gameState.currentLearning && (\n        <div className=\"mt-8 bg-gradient-to-r from-purple-500/10 to-pink-500/10 border border-purple-500/30 rounded-xl p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-purple-400\">{t('learningInProgress')}</h3>\n            <span className=\"bg-purple-500/20 text-purple-300 px-3 py-1 rounded-lg text-sm font-medium\">\n              {gameState.currentLearning.difficulty}\n            </span>\n          </div>\n          \n          <div className=\"flex items-center space-x-4 mb-4\">\n            <div className=\"w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center\">\n              <i className=\"fas fa-brain text-purple-400 text-lg\"></i>\n            </div>\n            <div className=\"flex-1\">\n              <h4 className=\"font-medium text-slate-200\">{gameState.currentLearning.title}</h4>\n              <p className=\"text-sm text-slate-400\">{gameState.currentLearning.description}</p>\n            </div>\n          </div>\n\n          <div className=\"space-y-2 mb-4\">\n            <div className=\"flex justify-between text-sm\">\n              <span className=\"text-slate-400\">{t('progress')}</span>\n              <span className=\"text-purple-400\">\n                {gameState.currentLearning.progress}% ({gameState.currentLearning.timeRemaining} {t('timeRemaining')})\n              </span>\n            </div>\n            <Progress value={gameState.currentLearning.progress} className=\"h-3\" />\n          </div>\n\n          <div className=\"p-3 bg-purple-500/10 rounded-lg\">\n            <p className=\"text-sm text-purple-300\">\n              <i className=\"fas fa-gift mr-1\"></i>\n              <strong>{t('reward')}:</strong> {getRewardText(gameState.currentLearning.reward, t)}\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Server Connection Game */}\n      <ServerConnectionGame\n        isOpen={connectionGameOpen}\n        onClose={closeConnectionGame}\n        server={gameServer}\n        onSuccess={onGameSuccess}\n      />\n    </div>\n  );\n}\n","size_bytes":28740},"client/src/components/status-bar.jsx":{"content":"import { useState } from 'react';\nimport { useLocation } from 'wouter';\nimport { Button } from '@/components/ui/button';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { formatCurrency } from '@/lib/constants';\nimport { AdminPanel } from './admin-panel';\nimport { PlayerAvatar } from './player-profile-bar';\nimport { ThemeToggle } from './theme-toggle';\nimport SubscriptionStatusIcon from './subscription-status-icon';\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\nimport { Crown, Shield, Server, TrendingUp, CircleDollarSign } from 'lucide-react';\n\nexport function StatusBar() {\n  const { gameState, logout } = useGame();\n  const { language, changeLanguage, t } = useLanguage();\n  const [, setLocation] = useLocation();\n  const [mobileAdminOpen, setMobileAdminOpen] = useState(false);\n\n  if (!gameState.user) return null;\n\n  const handleLogout = async () => {\n    await logout();\n  };\n\n  return (\n    <header className=\"bg-slate-800/80 backdrop-blur-sm border-b border-slate-700 p-3 sm:p-4 relative z-10\">\n      <div className=\"flex items-center justify-between max-w-7xl mx-auto\">\n        {/* Mobile Layout */}\n        <div className=\"flex lg:hidden flex-col w-full space-y-2\">\n          {/* First Row - Title, Income/Avatar/Username in center, Logout button top right */}\n          <div className=\"flex items-center\">\n            <h1 \n              className=\"text-lg font-bold cursor-pointer bg-gradient-to-r from-blue-400 via-purple-400 to-blue-400 bg-clip-text text-transparent animate-gradient\"\n              onClick={() => setLocation('/start')}\n              data-testid=\"title-link\"\n            >\n              Root <br />Tycoon\n            </h1>\n            \n            {/* Center content - Income, Avatar, Username */}\n            <div className=\"flex-1 flex items-center justify-center space-x-3\">\n              <div className=\"flex items-center space-x-1 bg-blue-500/10 border border-blue-500/30 px-2 py-1 rounded text-xs\">\n                <i className=\"fas fa-chart-line text-blue-400 text-xs\"></i>\n                <TrendingUp className=\"h-5 w-4 sm:h-2 sm:w-2 text-green-400 mx-auto\"/>\n                <span className=\"text-blue-400\">+{formatCurrency(gameState.totalIncomePerMinute, true)}/min</span>\n              </div>\n              \n              <div className=\"flex items-center space-x-1\">\n                <div className=\"relative\">\n                  <TooltipProvider>\n                    <Tooltip>\n                      <TooltipTrigger asChild>\n                        <div>\n                          <PlayerAvatar \n                            user={gameState.user} \n                            onClick={() => window.dispatchEvent(new CustomEvent('openProfile'))}\n                            style={{ width: '50px', height: '50px' }}\n                          />\n                        </div>\n                      </TooltipTrigger>\n                      <TooltipContent>\n                        <p className=\"text-xs\">{t('profileTooltip')}</p>\n                      </TooltipContent>\n                    </Tooltip>\n                  </TooltipProvider>\n                  <div className=\"absolute -left-8 sm:-left-10 top-1/2 transform -translate-y-1/2 z-10\">\n                    <SubscriptionStatusIcon user={gameState.user} showInProfile={true} size=\"md\" />\n                  </div>\n                </div>\n                <TooltipProvider>\n                  <Tooltip>\n                    <TooltipTrigger asChild>\n                      <span \n                        className=\"font-medium cursor-pointer hover:text-blue-400 transition-colors text-base\" \n                        onClick={() => setLocation(`/player/${gameState.user.nickname}`)}\n                        data-testid=\"username-link-mobile\"\n                      >\n                        {gameState.user.nickname}\n                      </span>\n                    </TooltipTrigger>\n                    <TooltipContent>\n                      <p className=\"text-xs\">{t('nicknameTooltip')}</p>\n                    </TooltipContent>\n                  </Tooltip>\n                </TooltipProvider>\n              </div>\n            </div>\n            \n            {/* Top right - Logout button */}\n            <div className=\"flex flex-col items-end space-y-1\">\n              <Button \n                variant=\"ghost\" \n                size=\"lg\" \n                onClick={handleLogout}\n                className=\"text-slate-400 hover:text-slate-200 text-md px-1 py-1 h-6\"\n              >\n                {t('logout')}\n              </Button>\n              \n              {/* Language selector and theme toggle under logout */}\n              <div className=\"flex flex-col items-end space-y-1\">\n                <div className=\"flex items-center space-x-1\">\n                  <Select value={language} onValueChange={changeLanguage}>\n                    <SelectTrigger className=\"w-[60px] h-6 bg-slate-700 border-slate-600 text-xs\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"en\">🇺🇸</SelectItem>\n                      <SelectItem value=\"ru\">🇷🇺</SelectItem>\n                      <SelectItem value=\"ua\">🇺🇦</SelectItem>\n                      <SelectItem value=\"de\">🇩🇪</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <ThemeToggle variant=\"mobile\" />\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          {/* Second Row - Balance and Server Count under title */}\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"flex items-center space-x-1 bg-slate-700/50 px-2 py-1 rounded text-xs\">\n              <i className=\"fas fa-coins text-accent text-xs\"></i>\n              <CircleDollarSign className=\"w-4 h-4 text-green-600\" />\n              <span className=\"font-semibold\">{formatCurrency(gameState.user.balance, true)}</span>\n            </div>\n            <div className=\"flex items-center space-x-1 bg-slate-700/50 px-3 py-1 rounded text-xs\">\n              <i className=\"fas fa-server text-secondary text-xs\"></i>\n              <Server className=\"h-4 w-4 text-blue-400\"/>\n              <span>{gameState.servers?.length || 0}/{gameState.user.serverLimit || 3}</span>\n            </div>\n            \n            {/* Mobile Admin Panel - compact icons only */}\n            {gameState.user && gameState.user.admin > 0 && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setMobileAdminOpen(true)}\n                className=\"h-6 w-7 p-0 bg-purple-600/20 hover:bg-purple-600/30 border border-purple-500/50\"\n                data-testid=\"mobile-admin-toggle\"\n              >\n                {gameState.user.nickname === 'Ca6aka' ? (\n                  <Crown className=\"w-3 h-3 text-yellow-400\" />\n                ) : (\n                  <Shield className=\"w-3 h-3 text-purple-400\" />\n                )}\n              </Button>\n            )}\n          </div>\n          \n        </div>\n\n        {/* Desktop Layout */}\n        <div className=\"hidden lg:flex items-center space-x-6\">\n          <h1 \n          className=\"text-xl font-bold cursor-pointer bg-gradient-to-r from-blue-400 via-purple-400 to-blue-400 bg-clip-text text-transparent animate-gradient\"\n          onClick={() => setLocation('/start')}\n          data-testid=\"title-link-desktop\"\n        >\n          Root Tycoon\n        </h1>\n        \n          <div className=\"flex items-center space-x-4\">\n            <div className=\"flex items-center space-x-1 bg-slate-700/50 px-2 py-1 rounded-lg\">\n              <i className=\"fas fa-coins text-accent\"></i>\n              <CircleDollarSign className=\"w-4 h-4 text-green-600\" />\n              <span className=\"font-semibold\">{formatCurrency(gameState.user.balance)}</span>\n            </div>\n              <div className=\"flex items-center space-x-2 bg-slate-700/50 px-3 py-1 rounded-lg\">\n              <Server className=\"h-4 w-4 text-blue-400\"/>\n              <span>{gameState.servers?.length || 0}/{gameState.user.serverLimit || 3}</span>\n            </div>\n\n            <div className=\"flex items-center space-x-2 bg-slate-700/50 px-3 py-1 rounded-lg\">\n              <i className=\"fas fa-chart-line text-blue-400\"></i>\n              <TrendingUp className=\"sm:h-4 sm:w-4 text-green-400 mx-auto\"/>\n              <span>+{formatCurrency(gameState.totalIncomePerMinute)}/min</span>\n            </div>\n          </div>\n        </div>\n        \n        <div className=\"hidden lg:flex items-center space-x-4\">\n          {/* Language Switcher */}\n          <Select value={language} onValueChange={changeLanguage}>\n            <SelectTrigger className=\"w-[100px] bg-slate-700 border-slate-600\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"en\">🇺🇸 EN</SelectItem>\n              <SelectItem value=\"ru\">🇷🇺 RU</SelectItem>\n              <SelectItem value=\"ua\">🇺🇦 UA</SelectItem>\n              <SelectItem value=\"de\">🇩🇪 DE</SelectItem>\n            </SelectContent>\n          </Select>\n          \n          {/* User Menu */}\n          <div className=\"flex items-center space-x-2\">\n            <TooltipProvider>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <div className=\"relative\">\n                    <PlayerAvatar \n                      user={gameState.user} \n                      size=\"md\" \n                      onClick={() => window.dispatchEvent(new CustomEvent('openProfile'))}\n                    />\n                    <div className=\"absolute -left-12 top-1/2 transform -translate-y-1/2 z-10\">\n                      <SubscriptionStatusIcon user={gameState.user} showInProfile={true} size=\"md\" />\n                    </div>\n                  </div>\n                </TooltipTrigger>\n                <TooltipContent>\n                  <p className=\"text-sm\">{t('profileTooltip')}</p>\n                </TooltipContent>\n              </Tooltip>\n            </TooltipProvider>\n            <TooltipProvider>\n              <Tooltip>\n                <TooltipTrigger asChild>\n                  <span \n                    className=\"font-medium cursor-pointer hover:text-blue-400 transition-colors\" \n                    onClick={() => setLocation(`/player/${gameState.user.nickname}`)}\n                    data-testid=\"username-link\"\n                  >\n                    {gameState.user.nickname}\n                  </span>\n                </TooltipTrigger>\n                <TooltipContent>\n                  <p className=\"text-sm\">{t('nicknameTooltip')}</p>\n                </TooltipContent>\n              </Tooltip>\n            </TooltipProvider>\n            \n            {/* Admin Panel */}\n            {gameState.user && gameState.user.admin > 0 && (\n              <AdminPanel user={gameState.user} />\n            )}\n            \n            <ThemeToggle variant=\"desktop\" />\n            \n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              onClick={handleLogout}\n              className=\"text-slate-400 hover:text-slate-200\"\n            >\n              {t('logout')}\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      \n      \n      {/* Mobile Admin Panel Dialog */}\n      {gameState.user && gameState.user.admin > 0 && (\n        <div className=\"lg:hidden\">\n          <AdminPanel \n            user={gameState.user} \n            isOpen={mobileAdminOpen}\n            onOpenChange={setMobileAdminOpen}\n          />\n        </div>\n      )}\n    </header>\n  );\n}\n","size_bytes":11868},"client/src/components/theme-provider.jsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\nconst initialState = {\n  theme: \"system\",\n  setTheme: () => null,\n};\n\nconst ThemeProviderContext = createContext(initialState);\n\nexport function ThemeProvider({\n  children,\n  defaultTheme = \"system\",\n  storageKey = \"vite-ui-theme\",\n  ...props\n}) {\n  const [theme, setTheme] = useState(\n    () => localStorage.getItem(storageKey) || defaultTheme\n  );\n\n  useEffect(() => {\n    const root = window.document.documentElement;\n\n    root.classList.remove(\"light\", \"dark\");\n\n    if (theme === \"system\") {\n      const systemTheme = window.matchMedia(\"(prefers-color-scheme: dark)\")\n        .matches\n        ? \"dark\"\n        : \"light\";\n\n      root.classList.add(systemTheme);\n      return;\n    }\n\n    root.classList.add(theme);\n  }, [theme]);\n\n  const value = {\n    theme,\n    setTheme: (theme) => {\n      localStorage.setItem(storageKey, theme);\n      setTheme(theme);\n    },\n  };\n\n  return (\n    <ThemeProviderContext.Provider {...props} value={value}>\n      {children}\n    </ThemeProviderContext.Provider>\n  );\n}\n\nexport const useTheme = () => {\n  const context = useContext(ThemeProviderContext);\n\n  if (context === undefined)\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n\n  return context;\n};\n","size_bytes":1285},"client/src/components/tutorial-tab.jsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useToast } from '@/hooks/use-toast';\nimport { JOB_TYPES, formatCurrency, formatTime } from '@/lib/constants';\n\nexport function TutorialTab({ gameState, setActiveTab }) {\n  const { completeJob, completeTutorial } = useGame();\n  const { toast } = useToast();\n  const { t, localizeError } = useLanguage();\n  const [cooldownTimers, setCooldownTimers] = useState({});\n\n  // Update cooldown timers\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (gameState.jobCooldowns) {\n        const now = Date.now();\n        const timers = {};\n        \n        Object.entries(gameState.jobCooldowns).forEach(([jobType, endTime]) => {\n          const remaining = Math.max(0, endTime - now);\n          timers[jobType] = remaining;\n        });\n        \n        setCooldownTimers(timers);\n      }\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [gameState.jobCooldowns]);\n\n  const handleStartJob = async (jobType) => {\n    try {\n      await completeJob(jobType);\n      const job = JOB_TYPES.find(j => j.id === jobType);\n      toast({\n        title: t('jobStarted'),\n        description: t('jobStartedDesc').replace('{jobName}', job.name).replace('{reward}', formatCurrency(job.reward)),\n      });\n    } catch (error) {\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleCompleteTutorial = async () => {\n    try {\n      await completeTutorial();\n      toast({\n        title: t('tutorialCompletedTitle'),\n        description: t('tutorialCompletedMessage'),\n      });\n    } catch (error) {\n      toast({\n        title: t('error'),\n        description: localizeError(error),\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (!gameState.user) return null;\n\n  const tutorialProgress = Math.min((gameState.user.balance / 15000) * 100, 100);\n\n  return (\n    <div className=\"p-3 sm:p-6 max-w-4xl mx-auto\">\n      <div className=\"mb-4 sm:mb-6\">\n        <h2 className=\"text-xl sm:text-2xl font-bold text-slate-100 mb-2\">{t('start')}</h2>\n        <p className=\"text-sm sm:text-base text-slate-400\">{t('tipCompleteJobs')}</p>\n      </div>\n\n      {/* Tutorial Progress - Only show if not completed */}\n      {!gameState.user.tutorialCompleted && (\n        <div className=\"bg-gradient-to-r from-primary/10 to-secondary/10 border border-primary/30 rounded-xl p-4 sm:p-6 mb-6 sm:mb-8\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-primary\">{t('tutorialProgress')}</h3>\n            <span className=\"bg-primary/20 text-primary px-3 py-1 rounded-lg text-sm font-medium\">\n              {gameState.user.tutorialCompleted ? t('completed') : t('inProgress')}\n            </span>\n          </div>\n          \n          <div className=\"space-y-2 mb-4\">\n            <div className=\"flex justify-between text-sm\">\n              <span className=\"text-slate-400\">{t('tipEarnToUnlock').replace('{amount}', formatCurrency(15000))}</span>\n              <span className=\"text-primary\">\n                {formatCurrency(gameState.user.balance)} / {formatCurrency(15000)}\n              </span>\n            </div>\n            <Progress value={tutorialProgress} className=\"h-3\" />\n          </div>\n\n          {gameState.user.balance >= 15000 && !gameState.user.tutorialCompleted && (\n            <Button onClick={handleCompleteTutorial} className=\"w-full\">\n              {t('completeTutorialUnlock')}\n            </Button>\n          )}\n        </div>\n      )}\n\n      {/* Tutorial Jobs */}\n      <div className=\"space-y-4\">\n        <h3 className=\"text-lg font-semibold text-slate-200 mb-4\">{t('tutorialJobs')}</h3>\n        \n        {JOB_TYPES.map((job) => {\n          const cooldown = cooldownTimers[job.id] || 0;\n          const isOnCooldown = cooldown > 0;\n\n          // Define difficulty colors based on job type\n          const getDifficultyCircle = (jobId) => {\n            switch(jobId) {\n              case 'maintenance':\n                return 'bg-blue-500'; // Easy - Blue\n              case 'optimization':\n                return 'bg-orange-500'; // Medium - Orange\n              case 'security-audit':\n                return 'bg-red-500'; // Hard - Red\n              default:\n                return 'bg-gray-500';\n            }\n          };\n\n          return (\n            <div key={job.id} className=\"bg-slate-800/50 backdrop-blur-sm border border-slate-700 rounded-xl p-4 sm:p-6 hover:border-primary/30 transition-all\">\n              <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between space-y-3 sm:space-y-0\">\n                <div className=\"flex items-center space-x-3 sm:space-x-4 flex-1\">\n                  <div className=\"w-10 sm:w-12 h-10 sm:h-12 bg-primary/20 rounded-lg flex items-center justify-center\">\n                    <i className={job.icon + \" text-primary text-sm sm:text-lg\"}></i>\n                  </div>\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2\">\n                      <div className={`w-3 h-3 rounded-full ${getDifficultyCircle(job.id)}`}></div>\n                      <h4 className=\"font-semibold text-slate-200 text-sm sm:text-base\">\n                        {job.id === 'maintenance' ? t('serverMaintenance') : \n                         job.id === 'optimization' ? t('performanceOptimization') : \n                         job.id === 'security-audit' ? t('securityAudit') : job.name}\n                      </h4>\n                    </div>\n                    <p className=\"text-xs sm:text-sm text-slate-400\">\n                      {t('earnMoney').replace('{amount}', formatCurrency(job.reward))} • +{job.id === 'maintenance' ? '10' : job.id === 'optimization' ? '18' : job.id === 'security-audit' ? '25' : job.experienceReward} XP • {t('cooldownTime').replace('{time}', formatTime(job.cooldown))}\n                    </p>\n                  </div>\n                </div>\n                \n                <div className=\"w-full sm:w-auto\">\n                  {isOnCooldown ? (\n                    <div className=\"text-center sm:text-right\">\n                      <p className=\"text-xs text-slate-400 mb-1\">{t('availableIn')}</p>\n                      <p className=\"text-sm font-medium text-accent\">\n                        {formatTime(cooldown)}\n                      </p>\n                    </div>\n                  ) : (\n                    <Button \n                      onClick={() => handleStartJob(job.id)}\n                      className=\"bg-primary hover:bg-primary/80 w-full sm:w-auto text-sm\"\n                    >\n                      {t('startJob')}\n                    </Button>\n                  )}\n                </div>\n              </div>\n\n              {isOnCooldown && (\n                <div className=\"mt-4\">\n                  <Progress \n                    value={((job.cooldown - cooldown) / job.cooldown) * 100} \n                    className=\"h-2\"\n                  />\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n\n      {/* Tutorial Tips */}\n      <div className=\"mt-6 sm:mt-8 bg-gradient-to-r from-accent/10 to-secondary/10 border border-accent/30 rounded-xl p-4 sm:p-6\">\n        <h3 className=\"text-lg font-semibold mb-3 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 bg-clip-text text-transparent animate-gradient\">\n          <i className=\"fas fa-lightbulb mr-2\"></i>\n          {t('usefulTips')}\n        </h3>\n        <div className=\"space-y-2 text-sm text-slate-300\">\n          <p>• {t('tipCompleteJobs')}</p>\n          <p>• {t('tipJobCooldown')}</p>\n          <p>• {t('tipEarnToUnlock').replace('{amount}', formatCurrency(15000))}</p>\n          <p>• {t('tipPurchaseServers')}</p>\n          <p>• {t('tipTakeCourses')}</p>\n          <p>• {t('adminControlsInfo')}</p>\n          <p>• {t('nicknameTooltip')}</p>\n        </div>\n        \n        <div className=\"mt-4 flex flex-col sm:flex-row gap-3\">\n          <Button \n            variant=\"outline\" \n            className={`border-blue-500/30 text-blue-400 hover:bg-blue-500/10 ${\n              gameState.user.tutorialCompleted || gameState.user.balance >= 15000 \n                ? 'opacity-100 cursor-pointer' \n                : 'opacity-50 cursor-not-allowed'\n            }`}\n            disabled={!gameState.user.tutorialCompleted && gameState.user.balance < 15000}\n            onClick={() => (gameState.user.tutorialCompleted || gameState.user.balance >= 15000) && setActiveTab('hosting')}\n          >\n            {t('browseServerStore')} {!gameState.user.tutorialCompleted && gameState.user.balance < 15000 ? '🔒' : ''}\n          </Button>\n          <Button \n            variant=\"outline\" \n            className={`border-purple-500/30 text-purple-400 hover:bg-purple-500/10 ${\n              gameState.user.tutorialCompleted || gameState.user.balance >= 15000 \n                ? 'opacity-100 cursor-pointer' \n                : 'opacity-50 cursor-not-allowed'\n            }`}\n            disabled={!gameState.user.tutorialCompleted && gameState.user.balance < 15000}\n            onClick={() => (gameState.user.tutorialCompleted || gameState.user.balance >= 15000) && setActiveTab('learning')}\n          >\n            {t('browseLearningCourses')} {!gameState.user.tutorialCompleted && gameState.user.balance < 15000 ? '🔒' : ''}\n          </Button>\n        </div>\n      </div>\n\n      {/* Recent Activities */}\n      {gameState.activities && gameState.activities.length > 0 && (\n        <div className=\"mt-8\">\n          <h3 className=\"text-lg font-semibold text-slate-200 mb-4\">{t('recentActivities')}</h3>\n          <div className=\"space-y-2\">\n            {gameState.activities.slice(0, 5).map((activity, index) => (\n              <div key={index} className=\"flex items-center justify-between p-3 bg-slate-800/30 rounded-lg\">\n                <span className=\"text-sm text-slate-300\">{activity.description}</span>\n                <span className=\"text-xs text-slate-400\">{activity.timestamp}</span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","size_bytes":10409},"client/src/components/virtual-assistant.jsx":{"content":"import { useState, useEffect, useRef } from 'react'\nimport { useLocation } from 'wouter'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Badge } from '@/components/ui/badge'\nimport { Avatar, AvatarFallback } from '@/components/ui/avatar'\nimport { \n  MessageSquare, \n  Send, \n  User,\n  Plus,\n  Minus,\n  Shield,\n  AlertTriangle,\n  Eye,\n  EyeOff,\n  Trash2,\n  Settings,\n  Volume2,\n  VolumeX,\n  MessageCircleWarning,\n  BotMessageSquare\n} from 'lucide-react'\nimport { useIsMobile } from '@/hooks/use-mobile'\nimport { useGame } from '@/contexts/game-context'\nimport { useLanguage } from '@/contexts/language-context'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport ChatMessageBadge from '@/components/chat-message-badge'\n\nfunction VirtualAssistant({ hideOnReports = false }) {\n  const [input, setInput] = useState('')\n  const [isVisible, setIsVisible] = useState(false) // Closed by default\n  const [muteUserId, setMuteUserId] = useState('')\n  const [muteDuration, setMuteDuration] = useState('30')\n  const [showRules, setShowRules] = useState(false)\n  const [chatLanguage, setChatLanguage] = useState('en')\n  const [cooldownRemaining, setCooldownRemaining] = useState(0)\n  const [hasNewMessages, setHasNewMessages] = useState(false)\n  const [, setLocation] = useLocation()\n  const isMobile = useIsMobile()\n  const { gameState } = useGame()\n  const { t, language } = useLanguage()\n  const user = gameState?.user\n  const queryClient = useQueryClient()\n  \n  // Auto-scroll to bottom of chat when new messages arrive\n  const chatMessagesRef = useRef(null)\n\n  // Fetch chat messages\n  const { data: chatData, refetch: refetchMessages } = useQuery({\n    queryKey: ['/api/chat/messages', chatLanguage],\n    queryFn: () => fetch(`/api/chat/messages?language=${chatLanguage}`).then(res => res.json()),\n    refetchInterval: 3000 // Refresh every 3 seconds\n  })\n\n  // Fetch pinned message\n  const { data: pinnedData } = useQuery({\n    queryKey: ['/api/chat/pinned', chatLanguage],\n    queryFn: () => fetch(`/api/chat/pinned?language=${chatLanguage}`).then(res => res.json()),\n    refetchInterval: 10000 // Check for pinned messages every 10 seconds\n  })\n\n  // Chat achievements are now integrated into main achievements tab\n  // Remove separate chat achievements display\n  \n  useEffect(() => {\n    if (chatMessagesRef.current && chatData?.messages?.length > 0) {\n      chatMessagesRef.current.scrollTop = chatMessagesRef.current.scrollHeight\n    }\n  }, [chatData?.messages, isVisible])\n\n  const { data: rankings } = useQuery({\n    queryKey: ['/api/rankings'],\n    refetchInterval: 30000\n  })\n\n  // Cooldown timer effect\n  useEffect(() => {\n    if (cooldownRemaining > 0) {\n      const timer = setTimeout(() => {\n        setCooldownRemaining(prev => Math.max(0, prev - 1))\n      }, 1000)\n      return () => clearTimeout(timer)\n    }\n  }, [cooldownRemaining])\n\n  // Check for new messages\n  useEffect(() => {\n    if (chatData?.messages && user?.lastChatRead) {\n      const newMessages = chatData.messages.filter(msg => \n        msg.timestamp > (user.lastChatRead || 0) && msg.userId !== user.id\n      )\n      setHasNewMessages(newMessages.length > 0)\n      setNewMessagesCount(newMessages.length)\n    }\n  }, [chatData?.messages, user?.lastChatRead, user?.id])\n\n  // Send message mutation\n  const sendMessageMutation = useMutation({\n    mutationFn: async (message) => {\n      const response = await fetch('/api/chat/send', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ message, language: chatLanguage })\n      })\n      if (!response.ok) {\n        const error = await response.json()\n        if (response.status === 429) {\n          setCooldownRemaining(error.cooldownRemaining || 5)\n        }\n        throw new Error(error.message)\n      }\n      return response.json()\n    },\n    onSuccess: () => {\n      setInput('')\n      refetchMessages()\n      setCooldownRemaining(5) // 5 second cooldown\n    }\n  })\n\n  // Delete message mutation\n  const deleteMessageMutation = useMutation({\n    mutationFn: async (messageId) => {\n      const response = await fetch(`/api/chat/message/${messageId}?language=${chatLanguage}`, {\n        method: 'DELETE'\n      })\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.message)\n      }\n      return response.json()\n    },\n    onSuccess: () => {\n      refetchMessages()\n    }\n  })\n\n  // Mute user mutation\n  const muteUserMutation = useMutation({\n    mutationFn: async ({ userId, duration }) => {\n      const response = await fetch('/api/chat/mute', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId, duration: parseInt(duration) })\n      })\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.message)\n      }\n      return response.json()\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/rankings'] })\n    }\n  })\n\n  // Unmute user mutation\n  const unmuteUserMutation = useMutation({\n    mutationFn: async (userId) => {\n      const response = await fetch('/api/chat/unmute', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId })\n      })\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.message)\n      }\n      return response.json()\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/rankings'] })\n      queryClient.invalidateQueries({ queryKey: ['/api/chat/active-mutes'] })\n    }\n  })\n\n  // Fetch active mutes for admin panel\n  const { data: activeMutesData, refetch: refetchMutes } = useQuery({\n    queryKey: ['/api/chat/active-mutes'],\n    enabled: user?.admin >= 1,\n    refetchInterval: 10000 // Refresh every 10 seconds\n  })\n\n  const adminMutation = useMutation({\n    mutationFn: async ({ action, targetUserId, amount }) => {\n      const response = await fetch('/api/admin/manage', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ action, userId: targetUserId, amount })\n      })\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.message)\n      }\n      return response.json()\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/rankings'] })\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] })\n    },\n    onError: (error) => {\n      console.error('Admin action failed:', error)\n    }\n  })\n\n  // Pin message mutation\n  const pinMessageMutation = useMutation({\n    mutationFn: async (messageId) => {\n      const response = await fetch(`/api/chat/message/${messageId}/pin`, {\n        method: 'POST'\n      })\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.message)\n      }\n      return response.json()\n    },\n    onSuccess: () => {\n      refetchMessages()\n      queryClient.invalidateQueries({ queryKey: ['/api/chat/pinned'] })\n    }\n  })\n\n  // Mark chat as read mutation\n  const markChatAsRead = useMutation({\n    mutationFn: async () => {\n      const response = await fetch('/api/chat/read', {\n        method: 'POST'\n      })\n      return response.json()\n    },\n    onSuccess: () => {\n      setHasNewMessages(false)\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] })\n    }\n  })\n\n  const handleSubmit = async (e) => {\n    e.preventDefault()\n    if (!input.trim() || cooldownRemaining > 0) return\n\n    try {\n      await sendMessageMutation.mutateAsync(input.trim())\n    } catch (error) {\n      console.error('Failed to send message:', error)\n    }\n  }\n\n  const handleChatOpen = () => {\n    setIsVisible(true)\n    if (hasNewMessages) {\n      markChatAsRead.mutate()\n    }\n  }\n\n  const handleDoubleClick = (messageId) => {\n    // Future: Add thumbs up reaction on double click\n    console.log('Double clicked message:', messageId)\n  }\n\n  const handleDeleteMessage = async (messageId) => {\n    try {\n      await deleteMessageMutation.mutateAsync(messageId)\n    } catch (error) {\n      console.error('Failed to delete message:', error)\n    }\n  }\n\n  const handleReaction = async (messageId, emoji) => {\n    try {\n      const response = await fetch(`/api/chat/message/${messageId}/react?language=${chatLanguage}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ emoji })\n      })\n      if (response.ok) {\n        refetchMessages()\n      }\n    } catch (error) {\n      console.error('Failed to add reaction:', error)\n    }\n  }\n\n  const handlePinMessage = async (messageId) => {\n    try {\n      const response = await fetch(`/api/chat/message/${messageId}/pin?language=${chatLanguage}`, {\n        method: 'POST'\n      })\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.message)\n      }\n      refetchMessages()\n      queryClient.invalidateQueries({ queryKey: ['/api/chat/pinned'] })\n    } catch (error) {\n      console.error('Failed to pin/unpin message:', error)\n    }\n  }\n\n  const handleMuteUser = async () => {\n    if (!muteUserId || !muteDuration) return\n    \n    try {\n      await muteUserMutation.mutateAsync({ userId: muteUserId, duration: muteDuration })\n      setMuteUserId('')\n      setMuteDuration('30')\n      refetchMutes()\n    } catch (error) {\n      console.error('Failed to mute user:', error)\n    }\n  }\n\n  const handleUnmuteUser = async (userId) => {\n    try {\n      await unmuteUserMutation.mutateAsync(userId)\n    } catch (error) {\n      console.error('Failed to unmute user:', error)\n    }\n  }\n\n  const handleAdminAction = async (action, targetUserId, amount = null) => {\n    try {\n      await adminMutation.mutateAsync({ action, targetUserId, amount })\n    } catch (error) {\n      console.error('Admin action failed:', error)\n    }\n  }\n\n  const formatTime = (timestamp) => {\n    return new Date(timestamp).toLocaleTimeString('ru-RU', {\n      hour: '2-digit',\n      minute: '2-digit'\n    })\n  }\n\n  const getUserStatus = (userId) => {\n    const targetUser = rankings?.rankings?.find(u => u.id === userId)\n    if (!targetUser) return null\n    \n    const isMuted = targetUser.muted && targetUser.muteExpires && Date.now() < targetUser.muteExpires\n    return {\n      ...targetUser,\n      isMuted\n    }\n  }\n\n  // Hide chat if on reports tab and on mobile\n  if (hideOnReports && isMobile) {\n    return null;\n  }\n\n  if (!isVisible) {\n    return (\n      <div className=\"fixed bottom-4 right-4 z-50\">\n        <div className=\"relative\">\n          <Button\n            onClick={handleChatOpen}\n            className=\"rounded-full w-15 h-14 shadow-lg bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 \n                       bg-[length:200%_200%] animate-gradient-xy\"\n            data-testid=\"show-chat\"\n          >\n            <MessageSquare className=\"w-6 h-6 text-white\" />\n            {hasNewMessages && newMessagesCount > 0 && (\n              <div className=\"absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full px-1.5 py-0.5 min-w-[20px] h-5 flex items-center justify-center animate-pulse border-2 border-white\">\n                {newMessagesCount}\n              </div>\n            )}\n          </Button>\n        </div>\n      </div>\n    )\n  }  \n\n  return (\n    <div className={`fixed bottom-4 right-4 z-50 md:bottom-4 md:right-4 sm:bottom-20 sm:right-4 ${isMobile ? 'w-[calc(100vw-2rem)]' : 'w-80'}`}>\n      <Card className=\"shadow-xl border-blue-200 dark:border-blue-800\">\n        <CardHeader className=\"pb-2\">\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <MessageSquare className=\"w-4 h-4 text-blue-600\" />\n              {t('generalChat')}\n            </CardTitle>\n            <div className=\"flex items-center gap-1\">\n              {/* Chat Language Selector */}\n              <Select value={chatLanguage} onValueChange={(value) => {\n                setChatLanguage(value)\n                refetchMessages()\n              }}>\n                <SelectTrigger className=\"w-14 h-6 p-1 text-xs\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"en\">EN</SelectItem>\n                  <SelectItem value=\"ru\">RU</SelectItem>\n                  <SelectItem value=\"ua\">UA</SelectItem>\n                  <SelectItem value=\"de\">DE</SelectItem>\n                </SelectContent>\n              </Select>\n              \n              {/* Rules Toggle */}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setShowRules(!showRules)}\n                className=\"h-6 w-6 p-0\"\n                title={t('chatRules')}\n              >\n                <MessageCircleWarning className=\"w-4 h-4\" />\n              </Button>\n              {user?.admin >= 1 && (\n                <Dialog>\n                  <DialogTrigger asChild>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"h-6 w-6 p-0\"\n                      data-testid=\"admin-settings\"\n                    >\n                      <Settings className=\"w-4 h-4\" />\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent className=\"sm:max-w-md\">\n                    <DialogHeader>\n                      <DialogTitle>{t('adminPanel')}</DialogTitle>\n                    </DialogHeader>\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"text-sm font-medium\">{t('muteUser')}</label>\n                        <div className=\"flex gap-2 mt-2\">\n                          <Select value={muteUserId} onValueChange={setMuteUserId}>\n                            <SelectTrigger className=\"flex-1\">\n                              <SelectValue placeholder={t('selectUser')} />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {rankings?.rankings\n                                ?.filter(u => u.id !== user.id && (!u.admin || user.nickname === 'Ca6aka'))\n                                ?.map(u => (\n                                  <SelectItem key={u.id} value={u.id}>\n                                    {u.nickname} {u.admin >= 1 ? '(Admin)' : ''}\n                                  </SelectItem>\n                                ))}\n                            </SelectContent>\n                          </Select>\n                          <Select value={muteDuration} onValueChange={setMuteDuration}>\n                            <SelectTrigger className=\"w-20\">\n                              <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"5\">5м</SelectItem>\n                              <SelectItem value=\"30\">30м</SelectItem>\n                              <SelectItem value=\"60\">1ч</SelectItem>\n                              <SelectItem value=\"1440\">1д</SelectItem>\n                            </SelectContent>\n                          </Select>\n                          <Button\n                            onClick={handleMuteUser}\n                            disabled={!muteUserId || muteUserMutation.isPending}\n                            size=\"sm\"\n                          >\n                            {t('mute')}\n                          </Button>\n                        </div>\n                      </div>\n                      \n                      <div>\n                        <label className=\"text-sm font-medium\">{t('activeMutes')}</label>\n                        <div className=\"mt-2 space-y-2 max-h-32 overflow-y-auto\">\n                          {activeMutesData?.mutes?.length === 0 ? (\n                            <div className=\"text-xs text-gray-500 text-center py-2\">\n                              {t('noActiveMutes')}\n                            </div>\n                          ) : (\n                            activeMutesData?.mutes?.map(mute => (\n                              <div key={mute.id} className=\"flex items-center justify-between text-xs bg-gray-100 dark:bg-gray-800 rounded p-2\">\n                                <div>\n                                  <div className=\"font-medium\">{mute.nickname}</div>\n                                  <div className=\"text-gray-500\">\n                                    {mute.timeLeft}м осталось\n                                  </div>\n                                </div>\n                                <Button\n                                  onClick={() => handleUnmuteUser(mute.id)}\n                                  disabled={unmuteUserMutation.isPending}\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  className=\"h-6 px-2\"\n                                >\n                                  {t('unmute')}\n                                </Button>\n                              </div>\n                            ))\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </DialogContent>\n                </Dialog>\n              )}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setIsVisible(false)}\n                className=\"h-6 w-6 p-0\"\n                data-testid=\"hide-chat\"\n              >\n                <EyeOff className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n        \n        {/* Chat Rules */}\n        {showRules && (\n          <div className=\"px-3 py-2 bg-slate-50 dark:bg-slate-800 border-b\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <h4 className=\"text-xs font-medium text-slate-700 dark:text-slate-300\">{t('chatRules')}</h4>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setShowRules(false)}\n                className=\"h-4 w-4 p-0\"\n              >\n                <MessageCircleWarning className=\"w-3 h-3\" />\n              </Button>\n            </div>\n            <div className=\"text-xs text-slate-600 dark:text-slate-400 space-y-1\">\n              <div>• {t('chatRule1')}</div>\n              <div>• {t('chatRule2')}</div>\n              <div>• {t('chatRule3')}</div>\n              <div>• {t('chatRule4')}</div>\n              <div>• {t('chatRule5')}</div>\n            </div>\n          </div>\n        )}\n        \n        <CardContent className=\"p-0\">\n          {/* Pinned message */}\n          {pinnedData?.pinnedMessage && (\n            <div className=\"border-b bg-yellow-50 dark:bg-yellow-900/20 p-2\">\n              <div className=\"flex items-start gap-2\">\n                <span className=\"text-yellow-600 text-xs\">📌</span>\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"text-xs text-yellow-700 dark:text-yellow-300 font-medium\">\n                    Pinned by {pinnedData.pinnedMessage.pinnedBy}\n                  </div>\n                  <div className=\"text-sm text-yellow-800 dark:text-yellow-200 break-words\">\n                    <strong>{pinnedData.pinnedMessage.nickname}:</strong> {pinnedData.pinnedMessage.message}\n                  </div>\n                </div>\n                {user?.admin >= 2 && (\n                  <button\n                    onClick={() => handlePinMessage(pinnedData.pinnedMessage.id)}\n                    className=\"text-yellow-600 hover:text-yellow-800 transition-colors p-1\"\n                    title=\"Unpin message\"\n                  >\n                    <MessageCircleWarning className=\"w-3 h-3\" />\n                  </button>\n                )}\n              </div>\n            </div>\n          )}\n          \n          <div ref={chatMessagesRef} className={`${showRules ? (isMobile ? 'h-48' : 'h-64') : (isMobile ? 'h-60' : 'h-80')} ${pinnedData?.pinnedMessage ? 'h-56' : ''} overflow-y-auto p-3 space-y-2`}>\n            {chatData?.messages?.length === 0 ? (\n              <div className=\"text-center text-gray-500 text-sm py-8\">\n                {t('noMessages')}\n              </div>\n            ) : (\n              chatData?.messages?.map((message) => {\n                const userStatus = getUserStatus(message.userId)\n                return (\n                  <div key={message.id} className=\"group\">\n                    {message.deleted ? (\n                      <div className=\"text-xs text-slate-500 italic py-1 px-2 bg-slate-800/30 rounded\">\n                        {t('messageDeletedBy')?.replace('{admin}', message.deletedBy) || `Message deleted by ${message.deletedBy}`}\n                      </div>\n                    ) : message.isSystem || message.isWarning ? (\n                      <div className=\"flex items-start space-x-2 p-2\">\n                        <BotMessageSquare className=\"w-4 h-4 text-cyan-400 flex-shrink-0 mt-0.5\" />\n                        <div className=\"text-xs text-slate-400 italic py-1 px-2 bg-slate-800/20 rounded flex-1\">\n                          {message.message}\n                        </div>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-1\">\n                        <div className=\"flex items-center justify-between text-xs text-gray-500\">\n                          <div className=\"flex items-center gap-2\">\n                            {message.isSystem || message.nickname === 'System' ? (\n                              <span className=\"font-medium text-cyan-400\">\n                                {message.nickname}\n                              </span>\n                            ) : (\n                              <button\n                                onClick={() => setLocation(`/player/${message.nickname}`)}\n                                className=\"font-medium text-blue-600 hover:text-blue-500 hover:underline transition-colors\"\n                                data-testid={`link-profile-${message.nickname}`}\n                              >\n                                {message.nickname}\n                              </button>\n                            )}\n                            {message.nickname === 'Ca6aka' && (\n                              <span className=\"text-xs px-2 py-0.5 rounded-full bg-gradient-to-r from-red-500 to-red-600 text-white border border-red-500/50 animate-pulse shadow-lg shadow-red-500/20\">\n                                ADMIN\n                              </span>\n                            )}\n                            {message.adminLevel === 1 && message.nickname !== 'Ca6aka' && (\n                              <span className=\"text-xs px-2 py-0.5 rounded-full bg-gradient-to-r from-yellow-500 to-amber-500 text-white border border-yellow-500/50 shadow-lg shadow-yellow-500/20\">\n                                ADMIN\n                              </span>\n                            )}\n                            <ChatMessageBadge user={message} />\n                            {userStatus?.isMuted && (\n                              <VolumeX className=\"w-3 h-3 text-red-600\" />\n                            )}\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <span>{formatTime(message.timestamp)}</span>\n                          </div>\n                        </div>\n                        <div className=\"text-sm bg-gray-100 dark:bg-gray-800 rounded-lg px-3 py-2 relative group\">\n                          <div className=\"break-words\" style={{ wordWrap: 'break-word', overflowWrap: 'break-word' }}>\n                            {message.message}\n                          </div>\n                          {message.filtered && (\n                            <div className=\"text-xs text-yellow-600 mt-1 italic\">\n                              ⚠️ {language === 'ru' ? 'Сообщение было автоматически отфильтровано' :\n                                  language === 'uk' ? 'Повідомлення було автоматично відфільтровано' :\n                                  language === 'de' ? 'Nachricht wurde automatisch gefiltert' :\n                                  'Message was automatically filtered'}\n                            </div>\n                          )}\n                          \n                          {/* Reactions Display */}\n                          {message.reactions && Object.keys(message.reactions).length > 0 && (\n                            <div className=\"flex flex-wrap gap-1 mt-2\">\n                              {Object.entries(message.reactions).map(([emoji, users]) => (\n                                <button\n                                  key={emoji}\n                                  onClick={() => handleReaction(message.id, emoji)}\n                                  className={`px-2 py-1 rounded-full text-xs transition-colors ${\n                                    users.includes(user?.id) \n                                      ? 'bg-blue-500/20 text-blue-300 border border-blue-500/50' \n                                      : 'bg-slate-700/50 text-slate-300 hover:bg-slate-600/50'\n                                  }`}\n                                >\n                                  {emoji} {users.length}\n                                </button>\n                              ))}\n                            </div>\n                          )}\n                          \n                          {/* Message Controls - Visible on hover */}\n                          <div className=\"absolute right-2 top-2 flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-800/80 rounded px-1\">\n                            {/* Reaction Button for all users */}\n                            <Dialog>\n                              <DialogTrigger asChild>\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  className=\"h-6 w-6 p-0 text-slate-400 hover:text-slate-300\"\n                                >\n                                  😊\n                                </Button>\n                              </DialogTrigger>\n                              <DialogContent className=\"bg-slate-800 border-slate-700 max-w-xs\">\n                                <DialogHeader>\n                                  <DialogTitle className=\"text-white text-sm\">{t('addReaction') || 'Add Reaction'}</DialogTitle>\n                                </DialogHeader>\n                                <div className=\"flex gap-2 justify-center\">\n                                  <Button\n                                    onClick={() => {\n                                      handleReaction(message.id, '👍')\n                                      document.querySelector('[data-state=\"open\"]')?.click()\n                                    }}\n                                    className=\"text-2xl p-2 bg-slate-700 hover:bg-slate-600\"\n                                  >\n                                    👍\n                                  </Button>\n                                  <Button\n                                    onClick={() => {\n                                      handleReaction(message.id, '👎')\n                                      document.querySelector('[data-state=\"open\"]')?.click()\n                                    }}\n                                    className=\"text-2xl p-2 bg-slate-700 hover:bg-slate-600\"\n                                  >\n                                    👎\n                                  </Button>\n                                  <Button\n                                    onClick={() => {\n                                      handleReaction(message.id, '❤️')\n                                      document.querySelector('[data-state=\"open\"]')?.click()\n                                    }}\n                                    className=\"text-2xl p-2 bg-slate-700 hover:bg-slate-600\"\n                                  >\n                                    ❤️\n                                  </Button>\n                                </div>\n                              </DialogContent>\n                            </Dialog>\n                            \n                            {/* Admin Controls */}\n                            {user?.admin >= 1 && (\n                              <>\n                                {user?.admin >= 2 && (\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"ghost\"\n                                    className=\"h-6 w-6 p-0 text-red-400 hover:text-red-300\"\n                                    onClick={() => handlePinMessage(message.id)}\n                                    title={t('pinMessage') || 'Pin Message'}\n                                  >\n                                    📌\n                                  </Button>\n                                )}\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  className=\"h-6 w-6 p-0 text-red-400 hover:text-red-300\"\n                                  onClick={() => handleDeleteMessage(message.id)}\n                                >\n                                  <Trash2 className=\"w-3 h-3\" />\n                                </Button>\n                              </>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                )\n              })\n            )}\n          </div>\n          \n          {/* Admin Panel for money management - Only for super admin */}\n          {false && user?.nickname === 'Ca6aka' && rankings?.rankings && (\n            <div className=\"border-t p-3 bg-gray-50 dark:bg-gray-900\">\n              <div className=\"text-xs font-medium text-gray-600 dark:text-gray-400 mb-2\">\n                {t('playerManagement')}\n              </div>\n              <div className=\"space-y-2 max-h-32 overflow-y-auto\">\n                {rankings.rankings\n                  .filter(u => u.id !== user.id)\n                  .map(targetUser => (\n                  <div key={targetUser.id} className=\"flex items-center gap-1 text-xs\">\n                    <span className=\"flex-1 truncate\">{targetUser.nickname}</span>\n                    <div className=\"flex items-center gap-1\">\n                      {targetUser.admin >= 1 ? (\n                        <Badge variant=\"secondary\" className=\"text-xs px-1 py-0\">\n                          <Shield className=\"w-3 h-3\" />\n                        </Badge>\n                      ) : null}\n                      \n                      {user.nickname === 'Ca6aka' && (\n                        <>\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => handleAdminAction('addMoney', targetUser.id, 1000)}\n                            className=\"h-6 w-6 p-0\"\n                            disabled={adminMutation.isPending}\n                            data-testid={`add-money-${targetUser.id}`}\n                          >\n                            <Plus className=\"w-3 h-3\" />\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => handleAdminAction('removeMoney', targetUser.id, 1000)}\n                            className=\"h-6 w-6 p-0\"\n                            disabled={adminMutation.isPending}\n                            data-testid={`remove-money-${targetUser.id}`}\n                          >\n                            <Minus className=\"w-3 h-3\" />\n                          </Button>\n                        </>\n                      )}\n                      \n                      {(user.nickname === 'Ca6aka' || targetUser.admin === 0) && (\n                        <Button\n                          size=\"sm\"\n                          variant={targetUser.banned ? \"default\" : \"destructive\"}\n                          onClick={() => handleAdminAction(targetUser.banned ? 'unbanUser' : 'banUser', targetUser.id)}\n                          className=\"h-6 w-8 p-0 text-xs\"\n                          disabled={adminMutation.isPending}\n                          data-testid={`${targetUser.banned ? 'unban' : 'ban'}-${targetUser.id}`}\n                        >\n                          {targetUser.banned ? 'ON' : 'BAN'}\n                        </Button>\n                      )}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n          \n          <form onSubmit={handleSubmit} className=\"p-3 border-t flex gap-2\">\n            <div className=\"flex-1 relative\">\n              <Input\n                value={input}\n                onChange={(e) => setInput(e.target.value)}\n                placeholder={cooldownRemaining > 0 ? `Wait ${cooldownRemaining}s...` : (user?.muted ? t('youAreMuted') : t('typeMessage'))}\n                className=\"flex-1 text-sm pr-16\"\n                disabled={sendMessageMutation.isPending || user?.muted || cooldownRemaining > 0}\n                maxLength={200}\n                style={{ \n                  whiteSpace: 'pre-wrap',\n                  wordWrap: 'break-word',\n                  overflowWrap: 'break-word'\n                }}\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault()\n                    handleSubmit(e)\n                  }\n                }}\n              />\n              <div className=\"absolute right-2 top-1/2 transform -translate-y-1/2 text-xs text-gray-400\">\n                {input.length}/200\n              </div>\n            </div>\n            <Button\n              type=\"submit\"\n              size=\"sm\"\n              disabled={sendMessageMutation.isPending || !input.trim() || user?.muted || cooldownRemaining > 0}\n              className={cooldownRemaining > 0 ? 'opacity-50' : ''}\n            >\n              {cooldownRemaining > 0 ? cooldownRemaining : <Send className=\"w-4 h-4\" />}\n            </Button>\n          </form>\n          \n          {/* Chat achievements moved to main achievements tab */}\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\nexport default VirtualAssistant\n","size_bytes":35330},"client/src/contexts/game-context.jsx":{"content":"import { createContext, useContext, useReducer, useEffect } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\n\nconst GameContext = createContext(undefined);\n\nconst initialState = {\n  user: null,\n  servers: [],\n  activities: [],\n  jobCooldowns: {},\n  currentLearning: null,\n  totalIncomePerMinute: 0,\n  unlockedTabs: ['tutorial', ''],\n};\n\nfunction gameReducer(state, action) {\n  switch (action.type) {\n    case 'SET_USER':\n      const unlockedTabs = ['tutorial', 'achievements', 'quests', 'reports'];\n      // Only unlock servers, hosting, and learning tabs when tutorial is completed\n      if (action.payload?.tutorialCompleted) {\n        unlockedTabs.push('servers', 'hosting', 'learning');\n      }\n      return {\n        ...state,\n        user: action.payload,\n        unlockedTabs,\n      };\n\n    case 'SET_SERVERS':\n      const totalIncome = action.payload.reduce((sum, server) => {\n        if (!server.isOnline) return sum;\n        const baseIncome = server.incomePerMinute;\n        const loadPercentage = server.loadPercentage || 50;\n        const adjustedIncome = baseIncome * (1 + (loadPercentage - 50) / 100);\n        return sum + adjustedIncome;\n      }, 0);\n      return {\n        ...state,\n        servers: action.payload,\n        totalIncomePerMinute: totalIncome,\n      };\n\n    case 'SET_ACTIVITIES':\n      return {\n        ...state,\n        activities: action.payload,\n      };\n\n    case 'SET_COOLDOWNS':\n      return {\n        ...state,\n        jobCooldowns: action.payload,\n      };\n\n    case 'SET_LEARNING':\n      return {\n        ...state,\n        currentLearning: action.payload,\n      };\n\n    case 'UPDATE_INCOME':\n      return {\n        ...state,\n        user: action.payload.user,\n      };\n\n    case 'UPDATE_EXPERIENCE':\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          experience: action.payload.experience,\n          level: action.payload.level,\n          balance: action.payload.balance || state.user.balance\n        }\n      };\n\n    case 'UPDATE_USER_DATA':\n      return {\n        ...state,\n        user: {\n          ...state.user,\n          ...action.payload\n        }\n      };\n\n    case 'COMPLETE_LEARNING':\n      return {\n        ...state,\n        currentLearning: null,\n        user: {\n          ...state.user,\n          ...action.payload.user\n        }\n      };\n\n    case 'RESET':\n      return initialState;\n\n    default:\n      return state;\n  }\n}\n\nexport function GameProvider({ children }) {\n  const [gameState, dispatch] = useReducer(gameReducer, initialState);\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n  \n  // Level-up notification function\n  const showLevelUpNotification = (newLevel) => {\n    // Dispatch custom event for the new level-up notification component\n    window.dispatchEvent(new CustomEvent('levelUp', { \n      detail: { level: newLevel }\n    }));\n  };\n\n  // Fetch current user\n  const { data: userResponse, isLoading: isUserLoading } = useQuery({\n    queryKey: ['/api/auth/me'],\n    enabled: !gameState.user,\n    retry: false,\n  });\n\n  // Refetch user data periodically to catch balance/XP updates from external sources\n  const { data: userUpdateResponse } = useQuery({\n    queryKey: ['/api/auth/me'],\n    enabled: !!gameState.user,\n    refetchInterval: 5000, // Check every 5 seconds for balance/XP updates\n    retry: false,\n  });\n\n  // Fetch servers  \n  const { data: serversResponse } = useQuery({\n    queryKey: ['/api/servers'],\n    enabled: !!gameState.user,\n    refetchInterval: 5000, // Update every 5 seconds for real-time server status\n  });\n\n  // Fetch activities\n  const { data: activitiesResponse } = useQuery({\n    queryKey: ['/api/activities'],\n    enabled: !!gameState.user,\n    refetchInterval: 5000, // Update every 5 seconds for real-time activity updates\n  });\n\n  // Fetch job cooldowns\n  const { data: cooldownsResponse } = useQuery({\n    queryKey: ['/api/jobs/cooldowns'],\n    enabled: !!gameState.user,\n    refetchInterval: 1000,\n  });\n\n  // Fetch current learning\n  const { data: learningResponse } = useQuery({\n    queryKey: ['/api/learning/current'],\n    enabled: !!gameState.user,\n    refetchInterval: 1000,\n  });\n\n  // Income update mutation\n  const incomeUpdateMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('/api/income/update', {\n        method: 'POST'\n      });\n      return response;\n    },\n    onSuccess: (data) => {\n      dispatch({ type: 'UPDATE_INCOME', payload: data });\n      // Invalidate queries to ensure UI updates immediately\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/activities'] });\n    },\n  });\n\n  // Login mutation\n  const loginMutation = useMutation({\n    mutationFn: async ({ nickname, password }) => {\n      const response = await apiRequest('/api/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({ nickname, password })\n      });\n      return response;\n    },\n    onSuccess: (data) => {\n      dispatch({ type: 'SET_USER', payload: data.user });\n      queryClient.invalidateQueries();\n    },\n  });\n\n  // Register mutation\n  const registerMutation = useMutation({\n    mutationFn: async ({ nickname, password, confirmPassword }) => {\n      const response = await apiRequest('/api/auth/register', {\n        method: 'POST',\n        body: JSON.stringify({ nickname, password, confirmPassword })\n      });\n      return response;\n    },\n    onSuccess: (data) => {\n      dispatch({ type: 'SET_USER', payload: data.user });\n      queryClient.invalidateQueries();\n    },\n  });\n\n  // Logout mutation\n  const logoutMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('/api/auth/logout', {\n        method: 'POST'\n      });\n      return response;\n    },\n    onSuccess: () => {\n      dispatch({ type: 'RESET' });\n      queryClient.clear();\n      // Navigate to start page instead of reg\n      window.location.href = '/start';\n    },\n  });\n\n  // Job completion mutation\n  const jobMutation = useMutation({\n    mutationFn: async (jobType) => {\n      const response = await apiRequest(`/api/jobs/${jobType}/start`, {\n        method: 'POST'\n      });\n      return response;\n    },\n    onSuccess: (data) => {\n      dispatch({ type: 'SET_USER', payload: data.user });\n      queryClient.invalidateQueries({ queryKey: ['/api/activities'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/jobs/cooldowns'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/quests'] }); // Update quests after job completion\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      \n      // Show level-up notification if user leveled up\n      if (data.leveledUp && data.newLevel) {\n        showLevelUpNotification(data.newLevel);\n      }\n    },\n  });\n\n  // Server purchase mutation\n  const purchaseMutation = useMutation({\n    mutationFn: async (productId) => {\n      const response = await apiRequest('/api/servers/purchase', {\n        method: 'POST',\n        body: JSON.stringify({ productId })\n      });\n      return response;\n    },\n    onSuccess: (data) => {\n      dispatch({ type: 'SET_USER', payload: data.user });\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/activities'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n    },\n  });\n\n  // Server toggle mutation\n  const toggleMutation = useMutation({\n    mutationFn: async (serverId) => {\n      return await apiRequest(`/api/servers/${serverId}/toggle`, 'POST');\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n    },\n  });\n\n  // Server delete mutation\n  const deleteMutation = useMutation({\n    mutationFn: async (serverId) => {\n      return await apiRequest(`/api/servers/${serverId}`, 'DELETE');\n    },\n    onSuccess: (data) => {\n      if (data.user) {\n        dispatch({ type: 'SET_USER', payload: data.user });\n      }\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/activities'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n    },\n  });\n\n  // Tutorial completion mutation\n  const tutorialMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('/api/tutorial/complete', {\n        method: 'POST'\n      });\n      return response;\n    },\n    onSuccess: (data) => {\n      dispatch({ type: 'SET_USER', payload: data.user });\n    },\n  });\n\n  // Learning start mutation\n  const startLearningMutation = useMutation({\n    mutationFn: async (courseId) => {\n      const response = await apiRequest('/api/learning/start', {\n        method: 'POST',\n        body: JSON.stringify({ courseId })\n      });\n      return response;\n    },\n    onSuccess: (data) => {\n      if (data.user) {\n        dispatch({ type: 'SET_USER', payload: data.user });\n      }\n      queryClient.invalidateQueries({ queryKey: ['/api/learning/current'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n    },\n  });\n  \n  // Update state when data changes\n  useEffect(() => {\n    if (userResponse?.user) {\n      dispatch({ type: 'SET_USER', payload: userResponse.user });\n    }\n  }, [userResponse]);\n\n  // Handle periodic user updates for real-time balance/XP changes\n  useEffect(() => {\n    if (userUpdateResponse?.user) {\n      dispatch({ type: 'SET_USER', payload: userUpdateResponse.user });\n    }\n  }, [userUpdateResponse]);\n\n  useEffect(() => {\n    if (serversResponse?.servers) {\n      dispatch({ type: 'SET_SERVERS', payload: serversResponse.servers });\n    }\n  }, [serversResponse]);\n\n  useEffect(() => {\n    if (activitiesResponse?.activities) {\n      dispatch({ type: 'SET_ACTIVITIES', payload: activitiesResponse.activities });\n    }\n  }, [activitiesResponse]);\n\n  useEffect(() => {\n    if (cooldownsResponse?.cooldowns) {\n      dispatch({ type: 'SET_COOLDOWNS', payload: cooldownsResponse.cooldowns });\n    }\n  }, [cooldownsResponse]);\n\n  useEffect(() => {\n    if (learningResponse?.learning) {\n      dispatch({ type: 'SET_LEARNING', payload: learningResponse.learning });\n    } else if (learningResponse !== undefined && !learningResponse?.learning && gameState.currentLearning) {\n      // Learning completed - invalidate user data to get updated completed learning array\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      dispatch({ type: 'COMPLETE_LEARNING', payload: { user: gameState.user } });\n    }\n  }, [learningResponse, gameState.currentLearning, queryClient]);\n\n  // Income update interval\n  useEffect(() => {\n    if (gameState.user && gameState.servers.length > 0) {\n      const interval = setInterval(() => {\n        incomeUpdateMutation.mutate();\n      }, 60000);\n      return () => clearInterval(interval);\n    }\n  }, [gameState.user, gameState.servers.length]);\n\n  const contextValue = {\n    gameState,\n    login: async (nickname, password) => {\n      await loginMutation.mutateAsync({ nickname, password });\n    },\n    register: async (nickname, password, confirmPassword) => {\n      await registerMutation.mutateAsync({ nickname, password, confirmPassword });\n    },\n    logout: async () => {\n      await logoutMutation.mutateAsync();\n    },\n    completeJob: async (jobType) => {\n      await jobMutation.mutateAsync(jobType);\n    },\n    purchaseServer: async (productId) => {\n      await purchaseMutation.mutateAsync(productId);\n    },\n    toggleServer: async (serverId) => {\n      await toggleMutation.mutateAsync(serverId);\n    },\n    deleteServer: async (serverId) => {\n      await deleteMutation.mutateAsync(serverId);\n    },\n    completeTutorial: async () => {\n      await tutorialMutation.mutateAsync();\n    },\n    startLearning: async (courseId) => {\n      await startLearningMutation.mutateAsync(courseId);\n    },\n    isLoading: isUserLoading || loginMutation.isPending || registerMutation.isPending,\n  };\n\n  return (\n    <GameContext.Provider value={contextValue}>\n      {children}\n    </GameContext.Provider>\n  );\n}\n\nexport function useGame() {\n  const context = useContext(GameContext);\n  if (context === undefined) {\n    throw new Error('useGame must be used within a GameProvider');\n  }\n  return context;\n}\n","size_bytes":12544},"client/src/contexts/language-context.jsx":{"content":"import { createContext, useContext, useState } from 'react';\n\nconst newTranslations = {\n  // Hidden achievements\n  hiddenAchievements: { en: 'Hidden Achievements', ru: 'Скрытые достижения' },\n  unlocked: { en: 'unlocked', ru: 'открыто' },\n  hiddenRequirement: { en: 'Secret requirement', ru: 'Секретное требование' },\n  noHiddenAchievements: { en: 'No hidden achievements found', ru: 'Скрытых достижений не найдено' },\n  hiddenAchievementsDesc: { en: 'Complete special actions to unlock hidden rewards', ru: 'Выполняйте особые действия для получения скрытых наград' },\n  \n  // Hidden achievement names and descriptions\n  firstConnectionName: { en: 'First Connection', ru: 'Первое подключение' },\n  firstConnectionDesc: { en: 'Successfully establish your first server connection', ru: 'Успешно установите первое подключение к серверу' },\n  securityExpertName: { en: 'Security Expert', ru: 'Эксперт безопасности' },\n  securityExpertDesc: { en: 'Complete 50 security mini-games without errors', ru: 'Завершите 50 мини-игр по безопасности без ошибок' },\n  speedDemonName: { en: 'Speed Demon', ru: 'Демон скорости' },\n  speedDemonDesc: { en: 'Complete any mini-game in under 10 seconds', ru: 'Завершите любую мини-игру менее чем за 10 секунд' },\n  wealthAccumulatorName: { en: 'Wealth Accumulator', ru: 'Накопитель богатства' },\n  wealthAccumulatorDesc: { en: 'Accumulate $100,000 total earnings', ru: 'Накопите $100,000 общего дохода' },\n  \n  // Daily bonus\n  dailyBonus: { en: 'Daily Bonus', ru: 'Ежедневный бонус' },\n  dailyLoginBonus: { en: 'Daily Login Bonus', ru: 'Ежедневный бонус за вход', ua: 'Щоденний бонус за вхід', de: 'Täglicher Login-Bonus' },\n  claimBonus: { en: 'Claim Bonus', ru: 'Получить бонус', ua: 'Отримати бонус', de: 'Bonus abholen' },\n  claiming: { en: 'Claiming...', ru: 'Получение...', ua: 'Отримання...', de: 'Wird abgeholt...' },\n  dailyBonusClaimed: { en: 'Daily Bonus Claimed!', ru: 'Ежедневный бонус получен!', ua: 'Щоденний бонус отримано!', de: 'Täglicher Bonus erhalten!' },\n  streak: { en: 'Streak', ru: 'Серия', ua: 'Серія', de: 'Serie' },\n  weekStreak: { en: 'Week Streak!', ru: 'Недельная серия!', ua: 'Тижнева серія!', de: 'Wochenserie!' },\n  dailyBonusMessage: { en: 'Log in daily to maintain your streak and earn more rewards!', ru: 'Заходите каждый день, чтобы поддерживать серию и получать больше наград!', ua: 'Заходьте щодня, щоб підтримувати серію та отримувати більше нагород!', de: 'Melde dich täglich an, um deine Serie aufrechtzuerhalten und mehr Belohnungen zu erhalten!' },\n  hiddenAchievements: { en: 'Hidden Achievements', ru: 'Скрытые достижения', ua: 'Приховані досягнення', de: 'Versteckte Erfolge' },\n  hiddenRequirement: { en: 'Requirements hidden until unlocked', ru: 'Требования скрыты до получения', ua: 'Вимоги приховані до розблокування', de: 'Anforderungen bis zur Freischaltung verborgen' },\n  unlocked: { en: 'Unlocked', ru: 'Разблокировано', ua: 'Розблоковано', de: 'Freigeschaltet' },\n  todayBonus: { en: \"Today's Bonus\", ru: 'Сегодняшний бонус', ua: 'Сьогоднішній бонус', de: 'Heutiger Bonus' },\n  readyToClaim: { en: 'Ready to claim', ru: 'Готов к получению', ua: 'Готово до отримання', de: 'Bereit abzuholen' },\n  \n  // Hidden achievements names\n  midnight_worker: { en: 'Midnight Worker', ru: 'Полуночный работник', ua: 'Опівнічний працівник', de: 'Mitternachtsarbeiter' },\n  speed_demon: { en: 'Speed Demon', ru: 'Демон скорости', ua: 'Демон швидкості', de: 'Geschwindigkeitsdämon' },\n  chat_legend: { en: 'Chat Legend', ru: 'Легенда чата', ua: 'Легенда чату', de: 'Chat-Legende' },\n  server_master: { en: 'Server Master', ru: 'Мастер серверов', ua: 'Майстер серверів', de: 'Server-Meister' },\n  \n  // Hidden achievements descriptions\n  midnight_worker_desc: { en: 'Complete a job between 00:00 and 02:00', ru: 'Выполните работу между 00:00 и 02:00', ua: 'Виконайте роботу між 00:00 та 02:00', de: 'Erledige eine Aufgabe zwischen 00:00 und 02:00' },\n  speed_demon_desc: { en: 'Complete 10 jobs in one day', ru: 'Выполните 10 работ за один день', ua: 'Виконайте 10 робіт за один день', de: 'Erledige 10 Aufgaben an einem Tag' },\n  chat_legend_desc: { en: 'Send 1000 messages in chat', ru: 'Отправьте 1000 сообщений в чат', ua: 'Надішліть 1000 повідомлень у чат', de: 'Sende 1000 Nachrichten im Chat' },\n  server_master_desc: { en: 'Own 20 servers simultaneously', ru: 'Владейте 20 серверами одновременно', ua: 'Володійте 20 серверами одночасно', de: 'Besitze 20 Server gleichzeitig' },\n\n  // Donation system\n  donateTitle: { en: 'Support the Project', ru: 'Поддержать проект', ua: 'Підтримати проект', de: 'Projekt unterstützen' },\n  donateDescription: { en: 'Get exclusive perks and support the development', ru: 'Получите эксклюзивные привилегии и поддержите разработку', ua: 'Отримайте ексклюзивні привілеї та підтримайте розробку', de: 'Erhalten Sie exklusive Vorteile und unterstützen Sie die Entwicklung' },\n  securePayment: { en: 'Secure Payment', ru: 'Безопасная оплата', ua: 'Безпечна оплата', de: 'Sichere Zahlung' },\n  cryptoPaymentInfo: { en: 'Payment via cryptocurrency gateway. Your funds are securely processed and transferred directly to our wallet.', ru: 'Оплата через криптовалютный шлюз. Ваши средства безопасно обрабатываются и поступают напрямую на наш кошелек.', ua: 'Оплата через криптовалютний шлюз. Ваші кошти безпечно обробляються та поступають прямо на наш гаманець.', de: 'Zahlung über Kryptowährungs-Gateway. Ihre Gelder werden sicher verarbeitet und direkt an unsere Wallet überwiesen.' },\n  cardPaymentUnavailable: { en: 'Temporarily unavailable: Credit card payments not supported. Only cryptocurrency payments available.', ru: 'Временно недоступно: Оплата картой не поддерживается. Доступна только криптооплата.', ua: 'Тимчасово недоступно: Оплата картою не підтримується. Доступна лише криптооплата.', de: 'Vorübergehend nicht verfügbar: Kreditkartenzahlungen werden nicht unterstützt. Nur Kryptowährungszahlungen verfügbar.' },\n  useStablecoins: { en: '💡 Use USDT/USDC for dollar equivalent payments', ru: '💡 Используйте USDT/USDC для оплаты в долларовом эквиваленте', ua: '💡 Використовуйте USDT/USDC для оплати в доларовому еквіваленті', de: '💡 Verwenden Sie USDT/USDC für Dollar-Äquivalent-Zahlungen' },\n  unavailableCardPayment: { en: 'Unavailable: Credit Card Payment', ru: 'Недоступно: Оплата картой', ua: 'Недоступно: Оплата картою', de: 'Nicht verfügbar: Kreditkartenzahlung' },\n  payWithCrypto: { en: 'Pay with Cryptocurrency', ru: 'Оплата криптовалютой', ua: 'Оплата криптовалютою', de: 'Mit Kryptowährung bezahlen' },\n  selectCurrency: { en: 'Select currency', ru: 'Выберите валюту', ua: 'Оберіть валюту', de: 'Währung auswählen' },\n  paymentMethod: { en: 'Payment Method', ru: 'Способ оплаты', ua: 'Спосіб оплати', de: 'Zahlungsmethode' },\n  status: { en: 'Status', ru: 'Статус', ua: 'Статус', de: 'Status' },\n  month: { en: 'month', ru: 'месяц', ua: 'місяць', de: 'Monat' },\n  forever: { en: 'forever', ru: 'навсегда', ua: 'назавжди', de: 'für immer' },\n  currentStatus: { en: 'Current Status', ru: 'Текущий статус', ua: 'Поточний статус', de: 'Aktueller Status' },\n  vip: { en: 'VIP', ru: 'VIP', ua: 'VIP', de: 'VIP' },\n  premium: { en: 'PREMIUM', ru: 'ПРЕМИУМ', ua: 'ПРЕМІУМ', de: 'PREMIUM' },\n  \n  // VIP features\n  vipBadgeChat: { en: 'Blue VIP badge in chat and profile', ru: 'Синяя отметка VIP в чате и профиле', ua: 'Синя позначка VIP у чаті та профілі', de: 'Blaues VIP-Abzeichen in Chat und Profil' },\n  vipReducedCooldown: { en: 'Reduced job cooldowns: 2m/4m/6m instead of 3m/5m/7m', ru: 'Сокращенные КД работ: 2м/4м/6м вместо 3м/5м/7м', ua: 'Скорочені КД робіт: 2х/4х/6х замість 3х/5х/7х', de: 'Verkürzte Job-Abklingzeiten: 2m/4m/6m statt 3m/5m/7m' },\n  vipExperienceBoost: { en: 'x1.5 experience from jobs', ru: 'x1.5 опыта за работы', ua: 'x1.5 досвіду за роботи', de: 'x1.5 Erfahrung von Jobs' },\n  vipReportPriority: { en: 'Priority in reports with VIP mark', ru: 'Приоритет в отчетах с отметкой VIP', ua: 'Пріоритет у звітах з позначкою VIP', de: 'Priorität in Berichten mit VIP-Kennzeichnung' },\n  vipUniqueEmojis: { en: 'Unique VIP emojis for chat', ru: 'Уникальные VIP эмодзи для чата', ua: 'Унікальні VIP емодзі для чату', de: 'Einzigartige VIP-Emojis für Chat' },\n  vipDailyBonus: { en: 'Daily bonus +200 instead of +100', ru: 'Ежедневный бонус +200 вместо +100', ua: 'Щоденний бонус +200 замість +100', de: 'Täglicher Bonus +200 statt +100' },\n  \n  // Premium features\n  premiumBadgeChat: { en: 'Purple PREMIUM badge in chat and profile', ru: 'Фиолетовая отметка PREMIUM в чате и профиле', ua: 'Фіолетова позначка PREMIUM у чаті та профілі', de: 'Lila PREMIUM-Abzeichen in Chat und Profil' },\n  premiumReducedCooldown: { en: 'Reduced job cooldowns: 1.5m/2m/5m instead of 3m/5m/7m', ru: 'Сокращенные КД работ: 1.5м/2м/5м вместо 3м/5м/7м', ua: 'Скорочені КД робіт: 1.5х/2х/5х замість 3х/5х/7х', de: 'Verkürzte Job-Abklingzeiten: 1.5m/2m/5m statt 3m/5m/7m' },\n  premiumExperienceBoost: { en: 'x1.75 experience from jobs', ru: 'x1.75 опыта за работы', ua: 'x1.75 досвіду за роботи', de: 'x1.75 Erfahrung von Jobs' },\n  premiumReportPriority: { en: 'Priority in reports with PREMIUM mark', ru: 'Приоритет в отчетах с отметкой PREMIUM', ua: 'Пріоритет у звітах з позначкою PREMIUM', de: 'Priorität in Berichten mit PREMIUM-Kennzeichnung' },\n  premiumNoMinigameCooldown: { en: 'No cooldown on mini-games', ru: 'Отсутствие КД на мини-игры', ua: 'Відсутність КД на міні-ігри', de: 'Keine Abklingzeit für Mini-Spiele' },\n  premiumServerLimit: { en: 'Increased server limit from 25 to 30', ru: 'Увеличенный лимит серверов с 25 до 30', ua: 'Збільшений ліміт серверів з 25 до 30', de: 'Erhöhtes Serverlimit von 25 auf 30' },\n  premiumInstantServers: { en: 'No mini-game for server activation, instant online', ru: 'Отсутствие мини-игры для активации серверов, сразу онлайн', ua: 'Відсутність міні-гри для активації серверів, одразу онлайн', de: 'Keine Mini-Spiele für Serveraktivierung, sofort online' },\n  premiumUniqueEmojis: { en: 'Unique PREMIUM emojis for chat', ru: 'Уникальные PREMIUM эмодзи для чата', ua: 'Унікальні PREMIUM емодзі для чату', de: 'Einzigartige PREMIUM-Emojis für Chat' },\n  premiumSecretReactions: { en: 'Secret reactions visible only to admins', ru: 'Секретные реакции, видимые только админам', ua: 'Секретні реакції, видимі лише адмінам', de: 'Geheime Reaktionen, die nur für Admins sichtbar sind' },\n  premiumDailyBonus: { en: 'Daily bonus +500 instead of +100', ru: 'Ежедневный бонус +500 вместо +100', ua: 'Щоденний бонус +500 замість +100', de: 'Täglicher Bonus +500 statt +100' },\n  \n  // Purchase buttons and messages\n  purchaseVip: { en: 'Purchase VIP', ru: 'Купить VIP', ua: 'Купити VIP', de: 'VIP kaufen' },\n  purchasePremium: { en: 'Purchase PREMIUM', ru: 'Купить PREMIUM', ua: 'Купити PREMIUM', de: 'PREMIUM kaufen' },\n  extendVip: { en: 'Extend VIP (+1 month)', ru: 'Продлить VIP (+1 месяц)', ua: 'Продовжити VIP (+1 місяць)', de: 'VIP verlängern (+1 Monat)' },\n  alreadyHavePremium: { en: 'You already have this status', ru: 'У вас уже есть этот статус', ua: 'У вас уже є цей статус', de: 'Sie haben diesen Status bereits' },\n  premiumBlocksVip: { en: 'PREMIUM blocks VIP purchase', ru: 'PREMIUM блокирует покупку VIP', ua: 'PREMIUM блокує покупку VIP', de: 'PREMIUM blockiert VIP-Kauf' },\n  vipBlocksPremium: { en: 'VIP blocks PREMIUM purchase', ru: 'VIP блокирует покупку PREMIUM', ua: 'VIP блокує покупку PREMIUM', de: 'VIP blockiert PREMIUM-Kauf' },\n  processing: { en: 'Processing...', ru: 'Обработка...', ua: 'Обробка...', de: 'Verarbeitung...' },\n  paymentInitiated: { en: 'Payment Initiated', ru: 'Оплата инициирована', ua: 'Оплата ініційована', de: 'Zahlung eingeleitet' },\n  redirectedToPayment: { en: 'You will be redirected to payment gateway', ru: 'Вы будете перенаправлены на платежный шлюз', ua: 'Вас буде перенаправлено на платіжний шлюз', de: 'Sie werden zum Zahlungsgateway weitergeleitet' },\n  \n  // Admin subscription management\n  manageSubscriptions: { en: 'Manage Subscriptions', ru: 'Управление подписками', ua: 'Управління підписками', de: 'Abonnements verwalten' },\n  grantVip: { en: 'Grant VIP', ru: 'Выдать VIP', ua: 'Видати VIP', de: 'VIP gewähren' },\n  revokeVip: { en: 'Revoke VIP', ru: 'Отобрать VIP', ua: 'Відібрати VIP', de: 'VIP entziehen' },\n  grantPremium: { en: 'Grant Premium', ru: 'Выдать Premium', ua: 'Видати Premium', de: 'Premium gewähren' },\n  revokePremium: { en: 'Revoke Premium', ru: 'Отобрать Premium', ua: 'Відібрати Premium', de: 'Premium entziehen' },\n  subscriptionDays: { en: 'Days (for VIP)', ru: 'Дни (для VIP)', ua: 'Дні (для VIP)', de: 'Tage (für VIP)' },\n  claiming: { en: 'Claiming...', ru: 'Получаем...' },\n  alreadyClaimed: { en: 'Already claimed', ru: 'Уже получен' },\n  comeBackTomorrow: { en: 'Come back tomorrow for your next bonus', ru: 'Вернитесь завтра за следующим бонусом' },\n  nextBonus: { en: 'Tomorrow', ru: 'Завтра' },\n  loginStreak: { en: 'Login Streak', ru: 'Серия входов' },\n  dayStreak: { en: 'day streak', ru: 'день подряд' },\n  daysStreak: { en: 'days streak', ru: 'дней подряд' },\n  streakMultiplier: { en: 'Multiplier', ru: 'Множитель' },\n  maxMultiplier: { en: 'Maximum multiplier reached!', ru: 'Максимальный множитель достигнут!' },\n  streakProgress: { en: '{current}/20 days for max bonus', ru: '{current}/20 дней для максимального бонуса' },\n  bonusSchedule: { en: 'Bonus Schedule', ru: 'Расписание бонусов' },\n  day: { en: 'Day', ru: 'День' },\n  max: { en: 'MAX', ru: 'МАКС' },\n  note: { en: 'Note', ru: 'Примечание' },\n  bonusNote: { en: 'Login consecutively to maintain your streak. Missing a day resets it to 1.', ru: 'Заходите ежедневно подряд для сохранения серии. Пропуск дня сбрасывает её на 1.' },\n  bonusClaimed: { en: 'Bonus Claimed!', ru: 'Бонус получен!' },\n  bonusClaimedDesc: { en: 'You received ${amount}! Current streak: {streak} days', ru: 'Вы получили ${amount}! Текущая серия: {streak} дней' },\n  bonusClaimError: { en: 'Failed to claim bonus', ru: 'Не удалось получить бонус' },\n  \n  // Tutorial\n  tutorial: { en: 'Tutorial', ru: 'Обучение' },\n  welcomeToGame: { en: 'Welcome to the Server Management Game!', ru: 'Добро пожаловать в игру управления серверами!' },\n  tutorialStep1: { en: 'Learn how to earn money and manage your virtual servers', ru: 'Изучите как зарабатывать деньги и управлять виртуальными серверами' },\n  tutorialStep2: { en: 'Visit the shop to purchase your first server', ru: 'Посетите магазин чтобы купить свой первый сервер' },\n  tutorialStep3: { en: 'Manage your servers and generate income', ru: 'Управляйте серверами и генерируйте доход' },\n  tutorialStep4: { en: 'Complete learning courses to unlock new features', ru: 'Проходите курсы обучения для разблокировки новых функций' },\n  tutorialStep5: { en: 'Complete the tutorial and start playing!', ru: 'Завершите обучение и начните играть!' },\n  nextStep: { en: 'Next Step', ru: 'Следующий шаг' },\n  completeTutorial: { en: 'Complete Tutorial', ru: 'Завершить обучение' },\n  tutorialCompleted: { en: 'Tutorial completed!', ru: 'Обучение завершено!' },\n  tutorialCompletedDesc: { en: 'You can now use all game features', ru: 'Теперь вы можете использовать все функции игры' },\n  skipTutorial: { en: 'Skip', ru: 'Пропустить' },\n  updating: { en: 'Updating...', ru: 'Обновляем...' },\n  step: { en: 'Step', ru: 'Шаг' },\n  of: { en: 'of', ru: 'из' },\n  tutorialReward: { en: 'Tutorial reward', ru: 'Награда за обучение' },\n  earnMoney: { en: 'Earn Money', ru: 'Заработать деньги' },\n  visitShop: { en: 'Visit Shop', ru: 'Посетить магазин' },\n  manageServers: { en: 'Manage Servers', ru: 'Управление серверами' },\n  learningCenter: { en: 'Learning Center', ru: 'Центр обучения' },\n  activeServers: { en: 'Active Servers', ru: 'Активные сервера' }\n};\n\nconst translations = {\n  en: {\n    // Navigation\n    tutorial: 'Start',\n    servers: 'My Servers',\n    hosting: 'Server Store',\n    learning: 'Learning Center',\n    myServers: 'My Servers',\n    serverStore: 'Server Store',\n    learningCenter: 'Learning Center',\n    achievements: 'Achievements',\n    dailyQuests: 'Daily Quests',\n    reports: 'Reports',\n    \n    // Basic UI\n    balance: 'Balance',\n    income: 'Income/min',\n    serverLimit: 'Server Limit',\n    settings: 'Settings',\n    logout: 'Logout',\n    login: 'Login',\n    register: 'Register',\n    nickname: 'Nickname',\n    password: 'Password',\n    confirmPassword: 'Confirm Password',\n    loggingIn: 'Logging in...',\n    creatingAccount: 'Creating Account...',\n    loginFailed: 'Login Failed',\n    registrationFailed: 'Registration Failed',\n    passwordsDoNotMatch: 'Passwords do not match',\n    nicknameTooLong: 'Nickname must be 8 characters or less',\n    nicknameInvalidChars: 'Nickname can only contain letters, numbers, hyphens, and underscores',\n    nicknameMax8Chars: 'Max 8 characters, letters/numbers only',\n    \n    // Hero section\n    heroTitle: 'Build Your Server Empire',\n    heroSubtitle: 'Master the Art of Hosting',\n    heroDescription: 'Start with nothing and build the largest server hosting empire in the virtual world. Master economics, technology, and strategy.',\n    startPlaying: 'Start Playing',\n    learnMore: 'Learn More',\n    \n    // Statistics\n    totalPlayers: 'Total Players',\n    onlineNow: 'Online Now',\n    serversHosted: 'Servers Hosted',\n    totalBalance: 'Total Balance',\n    \n    // Features\n    gameFeatures: 'Game Features',\n    featuresDescription: 'Discover what makes our server hosting simulator unique',\n    feature1Title: 'Build Servers',\n    feature1Desc: 'Create and customize your own servers',\n    feature2Title: 'Global Network',\n    feature2Desc: 'Expand worldwide with data centers',\n    feature3Title: 'Grow Revenue',\n    feature3Desc: 'Optimize your business for maximum profit',\n    feature4Title: 'Fast Performance',\n    feature4Desc: 'Deliver lightning-fast hosting services',\n    \n    // Leaderboard\n    topPlayers: 'Top Players',\n    topPlayersDescription: 'See who\\'s dominating the hosting industry',\n    leaderboard: 'Leaderboard',\n    serversLowercase: 'servers',\n    joinCompetition: 'Join the Competition',\n    allRightsReserved: 'All rights reserved.',\n    loginRegister: 'Login / Register',\n    \n    // Error messages\n    errorNotFound: 'Not Found',\n    errorServerError: 'Server Error',\n    errorNetworkError: 'Network Error',\n    errorUnauthorized: 'Access Denied',\n    errorBadRequest: 'Invalid Request',\n    errorGeneric: 'Something went wrong',\n    pleaseRefresh: 'Please refresh the page and try again',\n    jobOnCooldown: 'Job is on cooldown for {seconds} seconds',\n    insufficientFunds: 'Insufficient funds',\n    errorjob: 'Error, work is not yet available',\n    \n    // Tutorial\n    tutorialProgress: 'Tutorial Progress',\n    hideProgress: 'Hide Progress',\n    tutorialCompleted: 'Tutorial Completed!',\n    tutorialCompletedDesc: 'Congratulations! You\\'ve unlocked all game features.',\n    completeTutorialUnlock: 'Complete Tutorial & Unlock All Features',\n    allFeaturesUnlocked: 'All features unlocked!',\n    tutorialCompletedTitle: 'Tutorial Completed!',\n    tutorialCompletedMessage: 'Congratulations! You\\'ve unlocked all game features.',\n    \n    // Interface states\n    start: 'Start',\n    inProgress: 'In Progress',\n    completed: 'Completed',\n    active: 'Active',\n    available: 'Available',\n    unavailable: 'Unavailable',\n    locked: 'Locked',\n    unlocked: 'Unlocked',\n    online: 'Online',\n    offline: 'Offline',\n    \n    // Jobs and actions\n    tutorialJobs: 'Remote work',\n    startJob: 'Start Job',\n    completeJob: 'Complete Job',\n    availableIn: 'Available in',\n    earnMoney: 'Earn {amount}',\n    cooldownTime: 'Cooldown: {time}',\n    jobStarted: 'Job done',\n    jobStartedDesc: '{jobName} is done! You have earned {reward}.',\n    \n    // Job types\n    serverMaintenance: 'Server Maintenance',\n    performanceOptimization: 'Performance Optimization',\n    securityAudit: 'Security Audit',\n    \n    // Tutorial tips\n    tutorialTips: 'Tutorial Tips',\n    tipCompleteJobs: 'With mini-games, you can get some experience',\n    tipJobCooldown: 'To open the rating and get into it - you need at least level 5',\n    tipEarnToUnlock: 'If you have a question or found any errors - go to the \"Report\" tab',\n    tipPurchaseServers: \"Buy servers for passive income, don't forget to keep an eye on them\",\n    tipTakeCourses: 'Take training courses to unlock more server slots and more',\n    browseServerStore: 'Browse Server Store',\n    browseLearningCourses: 'Browse Learning Courses',\n    \n    // Activities\n    recentActivities: 'Recent Activities',\n    \n    // Server management\n    deleteServer: 'Delete Server',\n    toggleServer: 'Toggle Server',\n    noServersYet: 'No Servers Yet',\n    purchaseServersFromStore: 'Purchase servers from the store to start hosting and earning passive income!',\n    visitServerStore: 'Visit Server Store',\n    serverSettings: 'Server Settings',\n    loadPercentage: 'Load Percentage',\n    currentLoad: 'Current Load',\n    overloadRisk: 'Overload Risk',\n    low: 'Low',\n    moderate: 'Moderate',\n    high: 'High',\n    veryHigh: 'Very High',\n    serverShutdownWarning: 'High load increases shutdown risk',\n    rentalCost: 'Rental Cost/min',\n    \n    // Server products\n    basicWebServer: 'Basic Web Server',\n    highPerformanceServer: 'High Performance Server',\n    databaseServer: 'Database Server',\n    cdnServer: 'CDN Server',\n    webHosting: 'Web Hosting',\n    gamingApps: 'Gaming/Apps',\n    storage: 'Storage',\n    contentDelivery: 'Content Delivery',\n    \n    // Learning courses\n    basicServerSetup: 'Basic Server Setup',\n    advancedServerManagement: 'Advanced Server Management',\n    securityProtocols: 'Security Protocols',\n    beginner: 'Beginner',\n    intermediate: 'Intermediate',\n    advanced: 'Advanced',\n    coursesGenitive: 'courses',\n    \n    // Quest system\n    dailyQuests: 'Daily Quests',\n    achievements: 'Achievements',\n    achievementsList: {\n      'first-steps': {\n        title: \"First Steps\",\n        description: \"Complete your first job\",\n      },\n      'first-server': {\n        title: \"First Server\",\n        description: \"Purchase your first server\",\n      },\n      'server-collection': {\n        title: \"Server Collector\",\n        description: \"Own 5 servers simultaneously\",\n      },\n      'millionaire': {\n        title: \"Millionaire\",\n        description: \"Accumulate $1,000,000 in balance\",\n      },\n      'job-master': {\n        title: \"Job Master\",\n        description: \"Complete 100 jobs\",\n      },\n      'learning-enthusiast': {\n        title: \"Learning Enthusiast\",\n        description: \"Complete all learning courses\",\n      },\n      'early-earner': {\n        title: \"Early Earner\",\n        description: \"Earn your first $10,000\",\n      },\n      'efficient-worker': {\n        title: \"Efficient Worker\",\n        description: \"Complete 10 jobs\",\n      },\n      'server-builder': {\n        title: \"Server Builder\",\n        description: \"Own 3 different types of servers\",\n      },\n      'security-expert': {\n        title: \"Security Expert\",\n        description: \"Complete 50 Security Audit jobs\",\n      },\n      'maintenance-guru': {\n        title: \"Maintenance Guru\",\n        description: \"Complete 75 Maintenance jobs\",\n      },\n      'optimization-master': {\n        title: \"Optimization Master\",\n        description: \"Complete 60 Optimization jobs\",\n      },\n      'wealthy-investor': {\n        title: \"Wealthy Investor\",\n        description: \"Accumulate $100,000 in balance\",\n      },\n      'server-mogul': {\n        title: \"Server Mogul\",\n        description: \"Own 10 servers simultaneously\",\n      },\n      'persistent-learner': {\n        title: \"Persistent Learner\",\n        description: \"Complete 3 learning courses\",\n      },\n      'speed-demon': {\n        title: \"Speed Demon\",\n        description: \"Complete 200 jobs total\",\n      },\n      'infrastructure-king': {\n        title: \"Infrastructure King\",\n        description: \"Own 15 servers simultaneously\",\n      },\n      'multi-millionaire': {\n        title: \"Multi-Millionaire\",\n        description: \"Accumulate $5,000,000 in balance\",\n      },\n      'course-completionist': {\n        title: \"Course Completionist\",\n        description: \"Complete all available learning courses\",\n      },\n      'workaholic': {\n        title: \"Workaholic\",\n        description: \"Complete 500 jobs total\",\n      },\n      'server-empire': {\n        title: \"Server Empire\",\n        description: \"Own 20 servers simultaneously\",\n      },\n      'financial-titan': {\n        title: \"Financial Titan\",\n        description: \"Accumulate $10,000,000 in balance\",\n      },\n      'legendary-worker': {\n        title: \"Legendary Worker\",\n        description: \"Complete 1000 jobs total\",\n      },\n      'server-overlord': {\n        title: \"Server Overlord\",\n        description: \"Own 30 servers simultaneously\",\n      },\n      'billionaire-club': {\n        title: \"Billionaire Club\",\n        description: \"Accumulate $100,000,000 in balance\",\n      },\n      'ultimate-legend': {\n        title: \"Ultimate Legend\",\n        description: \"Complete 2500 jobs total\",\n      }\n    },\n    rankings: 'Rankings',\n    claimReward: 'Claim Reward',\n    rewardClaimed: 'Reward Claimed',\n    questCompleted: 'Quest Completed',\n    reward: 'Reward',\n    progress: 'Progress',\n    claiming: 'Claiming...',\n    \n    // Daily quests\n    dailyQuestsList: {\n      'daily-maintenance': {\n        title: 'Daily Maintenance',\n        description: 'Complete 3 Server Maintenance jobs'\n      },\n      'daily-income': {\n        title: 'Passive Income',\n        description: 'Earn $5,000 from server income'\n      },\n      'daily-optimization': {\n        title: 'Server Optimization',\n        description: 'Complete 2 Performance Optimization jobs'\n      },\n      'daily-security': {\n        title: 'Security Check',\n        description: 'Complete 1 Security Audit job'\n      },\n      'daily-earnings': {\n        title: 'Daily Earnings',\n        description: 'Earn $10,000 from server income'\n      },\n      'daily-worker': {\n        title: 'Hard Worker',\n        description: 'Complete 5 jobs of any type'\n      },\n      'daily-mixed-jobs': {\n        title: 'Mixed Tasks',\n        description: 'Complete 2 Maintenance and 1 Optimization job'\n      },\n      'daily-income-boost': {\n        title: 'Income Boost',\n        description: 'Earn $20,000 from server income'\n      },\n      'daily-job-spree': {\n        title: 'Job Spree',\n        description: 'Complete 8 jobs of any type'\n      },\n      'daily-mega-earner': {\n        title: 'Mega Earner',\n        description: 'Earn $50,000 from server income'\n      }\n    },\n    \n    // Admin panel\n    adminManagement: 'Admin Management',\n    selectUser: 'Select User',\n    chooseUser: 'Choose User',\n    action: 'Action',\n    chooseAction: 'Choose Action',\n    executeAction: 'Execute Action',\n    giveAdmin: 'Give Admin',\n    removeAdmin: 'Remove Admin',\n    banUser: 'Ban User',\n    unbanUser: 'Unban User',\n    totalUsers: 'Total Users',\n    onlineUsers: 'Online Users',\n    totalAdmins: 'Total Admins',\n    userList: 'User List',\n    superAdminPanel: 'Super Admin Panel',\n    adminPanel: 'Admin Panel',\n    pleaseSelectUserAndAction: 'Please select user and action',\n    pleaseEnterValidAmount: 'Please enter a valid amount',\n    actionSuccessfullyCompleted: 'Action \"{action}\" successfully completed',\n    \n    // Chat system\n    generalChat: 'General Chat',\n    muteUser: 'Mute User',\n    unmute: 'Unmute',\n    playerManagement: 'Player Management',\n    enterMessage: 'Enter message...',\n    usefulTips: 'Useful Tips',\n    chatRules: 'Chat Rules',\n    chatRule1: \"Don't spam or flood - no caps, identical messages, meaningless symbols.\",\n    chatRule2: 'Respect other players - no insults, provocations and discrimination.',\n    chatRule3: 'No mat and profanity - the filter can automatically block such words..',\n    chatRule4: 'Advertising and links to third-party resources are prohibited.',\n    chatRule5: 'Administration always has the last word - moderator decisions are only discussed in support.',\n    achievementsLocked: 'Achievements Locked',\n    completeTutorialToUnlock: 'Complete the tutorial to unlock achievements',\n    mute: 'Mute',\n    activeMutes: 'Active Mutes',\n    noActiveMutes: 'No active mutes',\n    youAreMuted: 'You are muted',\n    noMessages: 'No messages yet...',\n    \n    // Server management additional\n    serverLimitNotice: 'Server Limit Notice',\n    serverLimitWarning: 'You\\'re using {currentServers} of {serverLimit} available server slots. Complete learning courses to increase your limit!',\n    purchaseFirstServer: 'Purchase your first server from the Server Store to start earning income.',\n    noServersYet: 'No Servers Yet',\n    addNewServer: 'Add New Server',\n    availableServerSlots: 'You have {availableSlots} server slot{plural} available. Visit the Server Store to purchase new servers.',\n    browseServerStore: 'Browse Server Store',\n    serverLoadUpdated: 'Server load updated successfully',\n    \n    // Learning progress\n    learningInProgress: 'Learning in Progress',\n    timeRemaining: 'remaining',\n    \n    // Common\n    success: 'Success',\n    error: 'Error',\n    \n    // Server actions\n    serverRepaired: 'Server Repaired',\n    serverRepairedDesc: 'Server repaired for ${cost}. Durability restored by {durability}%',\n    repairFailed: 'Repair Failed',\n    serverStatusUpdated: 'Server Status Updated',\n    serverStatusUpdatedDesc: 'Server status has been updated successfully',\n    deleteWarningTitle: 'Delete Server: {serverName}',\n    deleteWarningMessage: 'This action cannot be undone!',\n    deleteLastWarning: 'Are you absolutely sure you want to delete {serverName}?',\n    deleteFinalConfirm: 'Type \"DELETE\" to confirm deletion of {serverName}:',\n    deleteKeyword: 'DELETE',\n    serverDeleted: 'Server Deleted',\n    serverDeletedDesc: '{serverName} has been successfully deleted',\n    deleteCancelled: 'Deletion Cancelled',\n    deleteCancelledDesc: 'Server deletion was cancelled',\n    deleteServerTooltip: 'Delete Server',\n    \n    // Server details\n    durability: 'Durability',\n    serverCondition: 'Server Condition',\n    partialRepair: 'Partial Repair',\n    fullRepair: 'Full Repair',\n    repairCostInfo: 'Repair costs scale with server value and damage',\n    maintenanceRequired: 'Maintenance required - server may shutdown!',\n    \n    // Additional hosting translations\n    availableSlots: 'Available Slots',\n    needMoreMoney: 'You need {amount} to purchase this server',\n    serverAddedToYourServers: '{serverName} has been added to your servers!',\n    needLearningCourse: 'Need Learning Course',\n    monthlyCost: 'Monthly cost',\n    netProfitMonth: 'Net profit/month',\n    needMoreFunds: 'Need {amount} more',\n    wantMoreServers: 'Want More Servers?',\n    learningCoursesBenefit: 'Each completed course can unlock additional server slots and improve your server efficiency. Visit the Learning Center to start your next course!',\n    \n    // Learning tab specific\n    unknownReward: 'Unknown Reward',\n    serverSlotReward: '+{amount} Server Slot{plural}',\n    serverEfficiencyReward: '+{amount}% Server Efficiency',\n    unlockServerReward: 'Unlocks {serverType}',\n    gpuServer: 'GPU Server',\n    tpuServer: 'TPU Server', \n    specialServer: 'Special Server',\n    learningInProgressError: 'Learning in Progress',\n    oneCourseAtTime: 'You can only take one course at a time. Please wait for the current course to complete.',\n    needMoneyForCourse: 'You need {amount} to start this course.',\n    courseStarted: 'Course Started',\n    courseStartedDesc: 'You\\'ve started the {courseTitle} course. Check your progress in the servers tab!',\n    failedToStartCourse: 'Failed to Start Course',\n    learningCenter: 'Learning Center',\n    currentBalance: 'Current Balance',\n    currentCourse: 'Current Course',\n    progress: 'Progress',\n    remaining: 'remaining',\n    reward: 'Reward',\n    availableCourses: 'Available Courses',\n    duration: 'Duration',\n    requiresLevelX: 'Requires Level {level}',\n    unavailable: 'Unavailable',\n    completed: 'Completed',\n    inProgress: 'In Progress...',\n    completeCurrentFirst: 'Complete Current Course First',\n    startCourse: 'Start Course',\n    needMoreForCourse: 'Need {amount} more',\n    learningBenefits: 'Learning Benefits',\n    moreServers: 'More Servers',\n    unlockAdditionalServerSlots: 'Unlock additional server slots',\n    higherEfficiency: 'Higher Efficiency',\n    increaseServerIncomeRates: 'Increase server income rates',\n    betterRankings: 'Better Rankings',\n    climbTheLeaderboards: 'Climb the leaderboards',\n    \n    // Player profile\n    loadingPlayerProfile: 'Loading player profile...',\n    playerNotFound: 'Player not found',\n    playerNotFoundDesc: 'The player \"{nickname}\" doesn\\'t exist or the profile is private.',\n    goBack: 'Go Back',\n    back: 'Back',\n    playerProfile: 'Player Profile',\n    online: 'Online',\n    offline: 'Offline',\n    level: 'Level',\n    rank: 'Rank',\n    servers: 'servers',\n    totalBalance: 'Total Balance',\n    activeServers: 'Active Servers',\n    globalRank: 'Global Rank',\n    recentActivity: 'Recent Activity',\n    \n    giveMoney: 'Give Money',\n    takeMoney: 'Take Money',\n    deleteUser: 'Delete User Account',\n    amount: 'Amount',\n    enterAmount: 'Enter amount',\n    youAreMuted: 'You are muted and cannot send messages',\n    noMessages: 'No messages. Start chatting!',\n    messageDeleted: 'Message deleted',\n    messageDeletedBy: 'Message deleted by administrator {admin}',\n    selectMuteDuration: '5m',\n    mute: 'Mute',\n    activeMutes: 'Active Mutes',\n    noActiveMutes: 'No active mutes',\n    \n    // Chat achievements translations\n    first_message: {\n      title: 'First Message',\n      description: 'Send your first message in chat'\n    },\n    chatty: {\n      title: 'Chatty',\n      description: 'Send 25 messages'\n    },\n    social_butterfly: {\n      title: 'Social Butterfly',\n      description: 'Send 100 messages'\n    },\n    chat_master: {\n      title: 'Chat Master',\n      description: 'Send 500 messages'\n    },\n    \n    // Profile and level system\n    progressToLevel: 'Progress to Level',\n    registrationdate: 'Registration date: ',\n    xpNeeded: 'XP needed',\n    totalEarnings: 'Total Earnings',\n    totalSpent: 'Total Spent',\n    netProfit: 'Net Profit',\n    jobsCompleted: 'Jobs Completed',\n    coursesCompleted: 'Courses Completed',\n    achievement: 'Achievement',\n    noAchievementsYet: 'No achievements yet',\n    earnAchievementsDesc: 'Complete jobs and reach milestones to earn achievements!',\n    currentBalance: 'Current Balance',\n    levelUp: 'Level Up!',\n    levelUpCongrats: 'Congratulations! You\\'ve reached',\n    levelUpCongrats3: 'level',\n    levelUpCongrats2: 'To close the window, click somewhere',\n    newAbilitiesUnlocked: 'New abilities unlocked!',\n    \n    // Tooltips and hints\n    profileTooltip: 'Click on your avatar to see progress and other interesting information',\n    nicknameTooltip: 'Click on your nickname or someone else\\'s to view their profile',\n    adminControlsInfo: 'Avatar tooltip: Click on your avatar to see progress and other interesting information',\n    \n    // Theme system\n    darkTheme: 'Switch to Dark Theme',\n    lightTheme: 'Switch to Light Theme',\n    \n    // Server durability system\n    serverRepaired: 'Server Repaired',\n    serverRepairedDesc: 'Server repaired for ${cost}. Durability restored: {durability}%',\n    repairFailed: 'Repair Failed',\n    durability: 'Durability',\n    serverCondition: 'Server Condition',\n    partialRepair: 'Partial Repair',\n    fullRepair: 'Full Repair',\n    repairCostInfo: 'Repair cost depends on damage level and server income',\n    serverStatusUpdated: 'Server Status Updated',\n    serverStatusUpdatedDesc: 'Server status has been changed successfully.',\n    maintenanceRequired: 'Server requires maintenance before it can be turned on',\n    \n    // Server deletion confirmations\n    deleteWarningTitle: '⚠️ WARNING! Do you really want to DELETE server \"{serverName}\"?',\n    deleteWarningMessage: 'This action is IRREVERSIBLE!\\nIf you just want to turn off the server, use the \"Turn On/Off\" button instead of deleting.',\n    deleteLastWarning: '🚨 FINAL WARNING!\\nAre you sure you want to PERMANENTLY delete server \"{serverName}\"?\\nType \"DELETE\" to confirm:',\n    deleteFinalConfirm: 'Type \"DELETE\" to finally confirm deletion of server \"{serverName}\":',\n    deleteKeyword: 'DELETE',\n    serverDeleted: 'Server deleted',\n    serverDeletedDesc: 'Server \"{serverName}\" was successfully deleted.',\n    deleteCancelled: 'Deletion cancelled',\n    deleteCancelledDesc: 'Server was NOT deleted.',\n    deleteServerTooltip: '⚠️ DELETE SERVER FOREVER (IRREVERSIBLE!)',\n    \n    // Common UI elements\n    close: 'Close',\n    cancel: 'Cancel',\n    confirm: 'Confirm',\n    save: 'Save',\n    edit: 'Edit',\n    delete: 'Delete',\n    add: 'Add',\n    remove: 'Remove',\n    update: 'Update',\n    refresh: 'Refresh',\n    loading: 'Loading...',\n    success: 'Success',\n    error: 'Error',\n    \n    // Time formats\n    minutes: ' min.',\n    hours: ' hour.',\n    seconds: ' sec.',\n    secondsShort: 'sec',\n    until: 'until',\n    reset: 'reset',\n    resetAvailable: 'Reset available',\n    progressLabel: 'Progress',\n    earnedLabel: 'Earned',\n    completedTasks: 'quests',\n    \n    // Additional UI strings\n    serverLimitNotice: 'Server Limit Notice',\n    serverLimitWarning: 'You\\'re using {currentServers} of {serverLimit} available server slots. Complete learning courses to increase your limit!',\n    requiresLevel: 'Requires Level {level}',\n    purchaseFirstServer: 'Purchase your first server from the Server Store to start earning income.',\n    serverPurchased: 'Server Purchased',\n    purchaseFailed: 'Purchase Failed',\n    serverLimitReached: 'Server Limit Reached',\n    serverLimitReachedDesc: 'You can only have {serverLimit} servers. Complete learning courses to increase your limit.',\n    serverAlreadyOnline: 'Server Already Online',\n    serverAlreadyOnlineDesc: 'This server is already activated and running.',\n    purchaseServer: 'Purchase Server',\n    reachedServerLimit: 'You\\'ve reached your server limit of {serverLimit}. Complete learning courses to unlock more slots!',\n    completeLearningCoursesToIncrease: 'Complete learning courses to increase your server limit',\n    turnOnOff: 'Turn On/Off',\n    \n    // Reports system\n    reports: 'Reports',\n    createNewReport: 'Create New Report',\n    reportSubject: 'Report Subject',\n    reportCategory: 'Report Category',\n    initialMessage: 'Initial Message',\n    general: 'General',\n    technical: 'Technical',\n    createReport: 'Create Report',\n    reportSent: 'Report Sent',\n    reportSentDescription: 'Your report has been sent successfully.',\n    reportClosed: 'Report Closed',\n    reportClosedDescription: 'Report has been closed successfully.',\n    reportDeleted: 'Report Deleted',\n    reportDeletedDescription: 'Report has been deleted successfully.',\n    reportMarked: 'Report Marked',\n    reportUnmarked: 'Report Unmarked',\n    closeReport: 'Close Report',\n    markReport: 'Mark Report',\n    deleteReport: 'Delete Report',\n    sendMessage: 'Send Message',\n    typeMessage: 'Message...',\n    noReports: 'No reports yet',\n    createFirstReport: 'Create your first report using the button above.',\n    reportStatus: 'Status',\n    reportCreated: 'Created',\n    reportClosed: 'Closed',\n    reportMarked: 'Marked',\n    fillAllFields: 'Please fill all required fields',\n    subjectTooLong: 'Subject must be no more than 50 characters',\n    messageTooLong: 'Message must be no more than 500 characters',\n    characters: 'characters',\n    reportType: 'Report type',\n    reportTypeFeature: 'Function request',\n    reportTypeComplaint: 'Complaint',\n    reportTypeOther: 'Other',\n    reportMessage: 'Message',\n    submitReport: 'Send report',\n    \n    // Reports reopen functionality\n    reopenChat: 'Reopen chat',\n    reportReopened: 'Report reopened',\n    reportReopenedDescription: 'Report has been successfully reopened for further communication',\n    chatClosedByAdmin: 'Chat closed by administrator',\n    \n    // Additional reports translations\n    myReports: 'My Reports',\n    incomingReports: 'Incoming Reports',\n    newTicket: 'New Ticket',\n    createNewTicket: 'Create New Ticket',\n    subject: 'Subject',\n    category: 'Category',\n    description: 'Description',\n    selectCategory: 'Select category',\n    reportTypeBug: 'Bug or other error',\n    otherIssue: 'Other',\n    featureIssue: 'Feature request',\n    reportTypeComplaint: 'Complaint',\n    generalIssue: 'General Issue',\n    technicalIssue: 'Technical Issue',\n    startChat: 'Start Chat',\n    sending: 'Sending...',\n    activeReportExists: 'You already have an active report. Please wait for admin response.',\n    noIncomingReports: 'No incoming reports',\n    selectReportToView: 'Select a report to view the conversation',\n    closeChat: 'Close chat',\n    deleteChat: 'Delete chat',\n    markChat: 'Mark chat',\n    unmarkChat: 'Unmark chat',\n    admin: 'Admin',\n    open: 'Open',\n    closed: 'Closed',\n    \n    // Mini Games translations\n    miniGames: 'Mini Games',\n    miniGamesDesc: 'Test your skills with fun mini-games and earn XP!',\n    minigame1: 'DDoS Protection',\n    minigame1Desc: 'Defend your servers from incoming packet attacks',\n    minigame2: 'Firewall Filter',\n    minigame2Desc: 'Allow legitimate requests and block malicious ones',\n    requests: 'requests',\n    howToPlay: 'How to Play',\n    ddosInstructions: 'Click on the red packets to destroy them before they reach your server. The speed increases over time! For each destruction +1 experience.',\n    firewallInstructions: 'Review each request and choose to Allow safe requests or Block dangerous ones. Be quick and accurate! For each correct answer +1 XP.',\n    startGame: 'Start Game',\n    gameCompleted: 'Game Completed!',\n    earnedXP: 'You earned {amount} XP!',\n    packetsDestroyed: 'Packets Destroyed',\n    correct: 'Correct',\n    correct2: 'right',\n    packet: 'packet',\n    wrong: 'Wrong',\n    score: 'Score',\n    timeLeft: 'Time Left',\n    requestsLeft: 'Requests Left',\n    blockOrAllow: 'Block dangerous requests or Allow safe ones',\n    block: 'Block',\n    allow: 'Allow',\n    yourServer: 'Your Server',\n    medium: 'Medium',\n    \n    // Donate translations\n    donate: 'Donate',\n    donateDesc: 'Support the game development and get exclusive benefits!',\n    donate1: 'Starter Pack',\n    donate1Desc: 'Get started with basic benefits',\n    donate2: 'Premium Pack (Forever)',\n    donate2Desc: 'Advanced features for serious players',\n    donate3: 'Boost Pack',\n    donate3Desc: 'Accelerate your progress significantly',\n    donate4: 'Ultimate Pack',\n    donate4Desc: 'Maximum benefits and exclusive content',\n    donate5: 'Coin Pack',\n    donate5Desc: 'In-game currency for purchases',\n    donate6: 'Special Pack',\n    donate6Desc: 'Limited time offer with unique rewards',\n    feature1: 'Extra server slots',\n    feature2: 'Faster learning courses',\n    feature3: 'Bonus daily rewards',\n    feature4: 'VIP support priority',\n    feature5: 'Exclusive server types',\n    feature6: 'Double XP events',\n    feature7: 'Instant server repairs',\n    feature8: 'Advanced analytics',\n    feature9: 'Custom server themes',\n    feature10: 'Maximum server capacity',\n    feature11: 'Priority chat support',\n    feature12: 'Exclusive achievements',\n    feature13: '10,000 in-game coins',\n    feature14: 'No transaction fees',\n    feature15: 'Coin bonus multiplier',\n    feature16: 'Seasonal rewards',\n    feature17: 'Early access features',\n    feature18: 'Community events access',\n    popular: 'Popular',\n    purchase: 'Purchase',\n    confirmPurchase: 'Confirm Purchase',\n    included: 'Included',\n    paymentNotice: 'Payment Processing',\n    paymentNoticeDesc: 'This is a demo version. Real payments are not processed.',\n    buyNow: 'Buy Now',\n    purchaseNotAvailable: 'Purchase Not Available',\n    purchaseNotAvailableDesc: 'This is a demo version. Payment processing is not implemented.',\n    \n    // Server mini-game translations\n    serverminigame1: 'Server Connection',\n    serverminigame2: 'Connect all cables by colors to bring the server online. You have 30 seconds!',\n    serverminigame3: 'Wrong Connection',\n    serverminigame4: 'Make sure to connect cables of the same color!',\n    serverminigame5: 'Success!',\n    serverminigame6: 'Server is now online and ready to use.',\n    serverminigame7: 'Failed!',\n    serverminigame8: 'Time ran out! Server durability decreased by 1.',\n    serverminigame9: 'Connected:',\n    serverminigame10: 'Your server is now online and generating income.',\n    serverminigame11: 'Try again when your server is repaired.',\n    connectServer: 'Connect Server',\n    serverNowOnline: 'Server is now online and generating income.',\n    yourServer: 'Server',\n    timeLeft: 'Time Left',\n    startGame: 'Start Game',\n    close: 'Close',\n  },\n  \n  ru: {\n    // Navigation\n    tutorial: 'Старт',\n    servers: 'Мои серверы',\n    hosting: 'Магазин серверов',\n    learning: 'Центр обучения',\n    myServers: 'Мои серверы',\n    serverStore: 'Магазин серверов',\n    learningCenter: 'Центр обучения',\n    achievements: 'Достижения',\n    dailyQuests: 'Ежедневные задания',\n    reports: 'Репорты',\n    \n    // Basic UI\n    balance: 'Баланс',\n    income: 'Доход/мин',\n    monthlyCost: 'Месячная оплата',\n    netProfitMonth: 'Доход в месяц',\n    serverLimit: 'Лимит серверов',\n    settings: 'Настройки',\n    logout: 'Выйти',\n    login: 'Вход',\n    register: 'Регистрация',\n    nickname: 'Никнейм',\n    password: 'Пароль',\n    confirmPassword: 'Подтвердите пароль',\n    loggingIn: 'Вход...',\n    creatingAccount: 'Создание аккаунта...',\n    loginFailed: 'Ошибка входа',\n    registrationFailed: 'Ошибка регистрации',\n    passwordsDoNotMatch: 'Пароли не совпадают',\n    nicknameTooLong: 'Никнейм должен быть не более 8 символов',\n    nicknameInvalidChars: 'Никнейм может содержать только буквы, цифры, дефисы и подчеркивания',\n    nicknameMax8Chars: 'Макс 8 символов, только буквы/цифры',\n    \n    // Hero section\n    heroTitle: 'Создайте Свою Серверную Империю',\n    heroSubtitle: 'Освойте Искусство Хостинга',\n    heroDescription: 'Начните с нуля и постройте крупнейшую империю серверного хостинга в виртуальном мире. Изучите экономику, технологии и стратегию.',\n    startPlaying: 'Начать Играть',\n    learnMore: 'Узнать Больше',\n    \n    // Learning progress\n    learningInProgress: 'Обучение в процессе',\n    timeRemaining: 'осталось',\n    serverSlotReward: '+{amount} Серверный слот',\n\n    // Statistics\n    totalPlayers: 'Всего Игроков',\n    onlineNow: 'Сейчас Онлайн',\n    serversHosted: 'Серверов Размещено',\n    totalBalance: 'Общий Баланс',\n\n    // Additional hosting translations\n    availableSlots: 'Доступные слоты',\n    needMoreMoney: 'cДля покупки этого сервера вам потребуется {amount}',\n    serverAddedToYourServers: '{serverName} был добавлен к вашим серверам!',\n    needLearningCourse: 'Необходимый курс обучения',\n    monthlyCost: 'Ежемесячная стоимость',\n    netProfitMonth: 'Чистая прибыль/месяц',\n    needMoreFunds: 'Не хватает {amount}',\n    wantMoreServers: 'Хотите больше серверов?',\n    learningCoursesBenefit: 'Каждый пройденный курс позволяет разблокировать дополнительные серверные слоты и повысить эффективность работы сервера. Посетите Учебный центр, чтобы начать свой следующий курс!',\n    \n    // Features\n    gameFeatures: 'Особенности Игры',\n    featuresDescription: 'Узнайте, что делает наш симулятор хостинга уникальным',\n    feature1Title: 'Создавайте Серверы',\n    feature1Desc: 'Создавайте и настраивайте собственные серверы',\n    feature2Title: 'Глобальная Сеть',\n    feature2Desc: 'Расширяйтесь по всему миру с дата-центрами',\n    feature3Title: 'Увеличивайте Доход',\n    feature3Desc: 'Оптимизируйте бизнес для максимальной прибыли',\n    feature4Title: 'Высокая Производительность',\n    feature4Desc: 'Предоставляйте молниеносно быстрые услуги хостинга',\n    \n    // Leaderboard\n    topPlayers: 'Топ Игроков',\n    topPlayersDescription: 'Посмотрите, кто доминирует в индустрии хостинга',\n    leaderboard: 'Таблица Лидеров',\n    serversLowercase: 'серверов',\n    joinCompetition: 'Присоединиться к Соревнованию',\n    allRightsReserved: 'Все права защищены.',\n    loginRegister: 'Вход / Регистрация',\n    \n    // Error messages\n    errorNotFound: 'Не найдено',\n    errorServerError: 'Ошибка сервера',\n    errorNetworkError: 'Ошибка сети',\n    errorUnauthorized: 'Доступ запрещен',\n    errorBadRequest: 'Неверный запрос',\n    errorGeneric: 'Что-то пошло не так',\n    pleaseRefresh: 'Пожалуйста, обновите страницу и попробуйте снова',\n    jobOnCooldown: 'Работа недоступна {seconds} секунд',\n    insufficientFunds: 'Недостаточно средств',\n    serverLimitReached: 'Достигнут лимит серверов',\n    errorjob: 'Ошибка, работа пока еще недоступна',\n    \n    // Tutorial\n    tutorialProgress: 'Прогресс обучения',\n    hideProgress: 'Скрыть прогресс',\n    tutorialCompleted: 'Обучение завершено!',\n    tutorialCompletedDesc: 'Поздравляем! Вы разблокировали все возможности игры.',\n    completeTutorialUnlock: 'Завершить обучение и разблокировать все возможности',\n    allFeaturesUnlocked: 'Все возможности разблокированы!',\n    tutorialCompletedTitle: 'Обучение завершено!',\n    tutorialCompletedMessage: 'Поздравляем! Вы разблокировали все возможности игры.',\n    \n    // Interface states\n    start: 'Старт',\n    inProgress: 'В процессе',\n    completed: 'Завершено',\n    active: 'Активно',\n    available: 'Доступно',\n    unavailable: 'Недоступно',\n    locked: 'Заблокировано',\n    unlocked: 'Разблокировано',\n    online: 'Онлайн',\n    offline: 'Офлайн',\n    \n    // Jobs and actions\n    tutorialJobs: 'Удаленная работа',\n    startJob: 'Начать работу',\n    completeJob: 'Завершить работу',\n    availableIn: 'Доступно через',\n    earnMoney: 'Заработать {amount}',\n    cooldownTime: 'Перезарядка: {time}',\n    jobStarted: 'Работа выполнена',\n    jobStartedDesc: '{jobName} выполнена! Вы заработали {reward}.',\n    \n    // Job types\n    serverMaintenance: 'Обслуживание сервера',\n    performanceOptimization: 'Оптимизация производительности',\n    securityAudit: 'Аудит безопасности',\n    \n    // Tutorial tips\n    tutorialTips: 'Подсказки обучения',\n    tipCompleteJobs: 'С помощью мини-игр можно получить немного опыта',\n    tipJobCooldown: 'Чтобы открыть рейтинг и попасть в него - нужен как минимум 5 уровень',\n    tipEarnToUnlock: 'Если имеется вопрос или нашли какую-то ошибку - отправляйтесь во вкладку \"Репорт\"',\n    tipPurchaseServers: 'Покупайте серверы для получения пассивного дохода, не забывайте следить за ними',\n    tipTakeCourses: 'Проходите курсы обучения, чтобы разблокировать больше слотов для серверов и не только',\n    browseServerStore: 'Просмотреть магазин серверов',\n    browseLearningCourses: 'Просмотреть курсы обучения',\n    \n    // Activities\n    recentActivities: 'Недавние действия',\n    \n    // Server management\n    purchaseServer: 'Купить сервер',\n    deleteServer: 'Удалить сервер',\n    toggleServer: 'Переключить сервер',\n    noServersYet: 'Серверов пока нет',\n    addNewServer: 'Добавить новый сервер',\n    availableServerSlots: 'Доступно серверных слотов: {availableSlots}. Посетите магазин серверов, чтобы приобрести новые серверы.',\n    purchaseServersFromStore: 'Покупайте серверы в магазине, чтобы начать хостинг и получать пассивный доход!',\n    visitServerStore: 'Посетить магазин серверов',\n    serverSettings: 'Настройки сервера',\n    loadPercentage: 'Процент нагрузки',\n    currentLoad: 'Текущая нагрузка',\n    overloadRisk: 'Риск перегрузки',\n    low: 'Низкий',\n    moderate: 'Умеренный',\n    high: 'Высокий',\n    veryHigh: 'Очень высокий',\n    serverShutdownWarning: 'Высокая нагрузка увеличивает риск отключения',\n    rentalCost: 'Аренда/мин',\n    \n    // Server products\n    basicWebServer: 'Базовый веб-сервер',\n    highPerformanceServer: 'Высокопроизводительный сервер',\n    databaseServer: 'Сервер базы данных',\n    cdnServer: 'CDN сервер',\n    webHosting: 'Веб-хостинг',\n    gamingApps: 'Игры/Приложения',\n    storage: 'Хранилище',\n    contentDelivery: 'Доставка контента',\n    \n    // Learning courses\n    basicServerSetup: 'Базовая настройка сервера',\n    advancedServerManagement: 'Продвинутое управление сервером',\n    securityProtocols: 'Протоколы безопасности',\n    beginner: 'Начинающий',\n    intermediate: 'Средний',\n    advanced: 'Продвинутый',\n    coursesGenitive: 'курсов',\n    \n    // Quest system\n    dailyQuests: 'Ежедневные задания',\n    achievements: 'Достижения',\n    achievementsList: {\n      'first-steps': {\n        title: \"Первые шаги\",\n        description: \"Выполните свою первую работу\",\n      },\n      'first-server': {\n        title: \"Первый сервер\",\n        description: \"Купите свой первый сервер\",\n      },\n      'server-collection': {\n        title: \"Коллекционер серверов\",\n        description: \"Владейте 5 серверами одновременно\",\n      },\n      'millionaire': {\n        title: \"Миллионер\",\n        description: \"Достигните баланса $1.000.000\",\n      },\n      'job-master': {\n        title: \"Мастер заданий\",\n        description: \"Выполните 100 работ\",\n      },\n      'learning-enthusiast': {\n        title: \"Любитель учёбы\",\n        description: \"Пройти все обучающие курсы\",\n      },\n      'early-earner': {\n        title: \"Ранний заработок\",\n        description: \"Получить первые $10.000\",\n      },\n      'efficient-worker': {\n        title: \"Эффективный работник\",\n        description: \"Завершите 10 работ\",\n      },\n      'server-builder': {\n        title: \"Конструктор серверов\",\n        description: \"Владейте 3 различными типами серверов\",\n      },\n      'security-expert': {\n        title: \"Эксперт по безопасности\",\n        description: \"Выполнить 50 работ по аудиту безопасности\",\n      },\n      'maintenance-guru': {\n        title: \"Гуру технического обслуживания\",\n        description: \"Выполнить 75 работ по техническому обслуживанию\",\n      },\n      'optimization-master': {\n        title: \"Мастер оптимизации\",\n        description: \"Выполните 60 работ по оптимизации\",\n      },\n      'wealthy-investor': {\n        title: \"Богатый инвестор\",\n        description: \"Накопите на балансе $100.000\",\n      },\n      'server-mogul': {\n        title: \"Серверный магнат\",\n        description: \"Владейте 10 серверами одновременно\",\n      },\n      'persistent-learner': {\n        title: \"Настойчивый ученик\",\n        description: \"Пройдите 3 учебных курса\",\n      },\n      'speed-demon': {\n        title: \"Демон скорости\",\n        description: \"Выполните 200 работ\",\n      },\n      'infrastructure-king': {\n        title: \"Король инфраструктуры\",\n        description: \"Владейте 15 серверами одновременно\",\n      },\n      'multi-millionaire': {\n        title: \"Мультимиллионер\",\n        description: \"Накопите $5.000.000 на балансе\",\n      },\n      'course-completionist': {\n        title: \"Завершитель курсов\",\n        description: \"Пройдите все доступные учебные курсы\",\n      },\n      'workaholic': {\n        title: \"Трудоголик\",\n        description: \"Выполните в общей сложности 500 работ\",\n      },\n      'server-empire': {\n        title: \"Империя серверов\",\n        description: \"Владейте 20 серверами одновременно\",\n      },\n      'financial-titan': {\n        title: \"Финансовый титан\",\n        description: \"Накопите $10.000.000 на балансе\",\n      },\n      'legendary-worker': {\n        title: \"Легендарный работник\",\n        description: \"Выполните 1000 работ\",\n      },\n      'server-overlord': {\n        title: \"Повелитель серверов\",\n        description: \"Владейте 30 серверами одновременно\",\n      },\n      'billionaire-club': {\n        title: \"Клуб миллиардеров\",\n        description: \"Накопите $100.000.000 на балансе\",\n      },\n      'ultimate-legend': {\n        title: \"Абсолютная легенда\",\n        description: \"Выполните 2500 работ\",\n      }\n    },\n    rankings: 'Рейтинг',\n    claimReward: 'Забрать награду',\n    rewardClaimed: 'Награда получена',\n    questCompleted: 'Задание выполнено',\n    reward: 'Награда',\n    progress: 'Прогресс',\n    claiming: 'Получение...',\n    \n    // Daily quests\n    dailyQuestsList: {\n      'daily-maintenance': {\n        title: 'Ежедневное обслуживание',\n        description: 'Выполните 3 работы по обслуживанию серверов'\n      },\n      'daily-income': {\n        title: 'Пассивный доход',\n        description: 'Заработайте $5.000 от доходов серверов'\n      },\n      'daily-optimization': {\n        title: 'Оптимизация серверов',\n        description: 'Выполните 2 работы по оптимизации производительности'\n      },\n      'daily-security': {\n        title: 'Проверка безопасности',\n        description: 'Выполните 1 работу по аудиту безопасности'\n      },\n      'daily-earnings': {\n        title: 'Ежедневные доходы',\n        description: 'Заработайте $10.000 от доходов серверов'\n      },\n      'daily-worker': {\n        title: 'Трудяга',\n        description: 'Выполните 5 работ любого типа'\n      },\n      'daily-mixed-jobs': {\n        title: 'Смешанные задания',\n        description: 'Выполните 2 работы по обслуживанию и 1 по оптимизации'\n      },\n      'daily-income-boost': {\n        title: 'Ускорение дохода',\n        description: 'Заработайте $20.000 от доходов серверов'\n      },\n      'daily-job-spree': {\n        title: 'Череда работ',\n        description: 'Выполните 8 работ любого типа'\n      },\n      'daily-mega-earner': {\n        title: 'Кодер-магнат',\n        description: 'Заработайте $50.000 от доходов серверов'\n      }\n    },\n    \n    // Admin panel\n    adminManagement: 'Управление администраторами',\n    selectUser: 'Выберите пользователя',\n    chooseUser: 'Выберите пользователя',\n    action: 'Действие',\n    chooseAction: 'Выберите действие',\n    executeAction: 'Выполнить действие',\n    giveAdmin: 'Выдать администратора',\n    removeAdmin: 'Убрать администратора',\n    banUser: 'Забанить пользователя',\n    unbanUser: 'Разбанить пользователя',\n    totalUsers: 'Всего пользователей',\n    onlineUsers: 'Онлайн пользователей',\n    totalAdmins: 'Всего администраторов',\n    userList: 'Список пользователей',\n    superAdminPanel: 'Панель супер-администратора',\n    adminPanel: 'Панель администратора',\n    pleaseSelectUserAndAction: 'Пожалуйста, выберите пользователя и действие',\n    pleaseEnterValidAmount: 'Пожалуйста, введите корректную сумму',\n    actionSuccessfullyCompleted: 'Действие \"{action}\" успешно выполнено',\n    \n    // Chat system\n    generalChat: 'Общий чат',\n    muteUser: 'Заглушить пользователя',\n    unmute: 'Размут',\n    playerManagement: 'Управление игроками',\n    enterMessage: 'Введите сообщение...',\n    usefulTips: 'Полезные советы',\n    chatRules: 'Правила чата',\n    chatRule1: 'Не спамить и не флудить — без капса, одинаковых сообщений, бессмысленных символов.',\n    chatRule2: 'Уважай других игроков — никаких оскорблений, провокаций и дискриминации.',\n    chatRule3: 'Без мата и ненормативной лексики — фильтр может автоматически блокировать такие слова.',\n    chatRule4: 'Запрещена реклама и ссылки на сторонние ресурсы.',\n    chatRule5: 'Администрация всегда имеет последнее слово — решения модераторов обсуждаются только в поддержке.',\n    achievementsLocked: 'Достижения заблокированы',\n    completeTutorialToUnlock: 'Пройдите обучение для разблокировки достижений',\n    giveMoney: 'Выдать деньги',\n    takeMoney: 'Забрать деньги',\n    deleteUser: 'Удалить аккаунт игрока',\n    amount: 'Сумма',\n    enterAmount: 'Введите сумму',\n    youAreMuted: 'Вы заглушены и не можете отправлять сообщения',\n    noMessages: 'Нет сообщений. Начните общение!',\n    messageDeleted: 'Сообщение удалено',\n    messageDeletedBy: 'Сообщение удалено администратором {admin}',\n    selectMuteDuration: '5м',\n    mute: 'Мут',\n    activeMutes: 'Активные муты',\n    noActiveMutes: 'Нет активных мутов',\n    \n    // Chat achievements translations - Russian\n    first_message: {\n      title: 'Первое сообщение',\n      description: 'Отправить первое сообщение в чат'\n    },\n    chatty: {\n      title: 'Болтун',\n      description: 'Отправить 25 сообщений'\n    },\n    social_butterfly: {\n      title: 'Социальная бабочка',\n      description: 'Отправить 100 сообщений'\n    },\n    chat_master: {\n      title: 'Мастер чата',\n      description: 'Отправить 500 сообщений'\n    },\n    \n    // Profile and level system\n    progressToLevel: 'Прогресс до уровня',\n    registrationdate: 'Дата регистрации: ',\n    xpNeeded: 'нужно опыта',\n    totalEarnings: 'Общий доход',\n    totalSpent: 'Потрачено всего',\n    netProfit: 'Чистая прибыль',\n    jobsCompleted: 'Выполнено работ',\n    coursesCompleted: 'Пройдено курсов',\n    achievement: 'Достижение',\n    noAchievementsYet: 'Пока нет достижений',\n    earnAchievementsDesc: 'Выполняйте работы и достигайте целей, чтобы получить достижения!',\n    currentBalance: 'Текущий баланс',\n    levelUp: 'Повышение уровня!',\n    levelUpCongrats: 'Поздравляем! Вы достигли',\n    levelUpCongrats3: 'уровня',\n    levelUpCongrats2: 'Чтобы закрыть окно, нажмите куда-нибудь',\n    newAbilitiesUnlocked: 'Новые способности разблокированы!',\n    \n    // Tooltips and hints\n    profileTooltip: 'Нажмите на свою аватарку, чтобы увидеть прогресс и другую интересную информацию',\n    nicknameTooltip: 'Если нажать на свой ник или чужой, можно заглянуть на чей-то профиль',\n    adminControlsInfo: 'Нажав на свой аватар, можно узнать больше полезной информации',\n    \n    // Theme system\n    darkTheme: 'Переключить на темную тему',\n    lightTheme: 'Переключить на светлую тему',\n    \n    // Server durability system\n    serverRepaired: 'Сервер отремонтирован',\n    serverRepairedDesc: 'Сервер отремонтирован за ${cost}. Прочность восстановлена: {durability}%',\n    repairFailed: 'Ремонт не удался',\n    durability: 'Прочность',\n    serverCondition: 'Состояние сервера',\n    partialRepair: 'Частичный ремонт',\n    fullRepair: 'Полный ремонт',\n    repairCostInfo: 'Стоимость ремонта зависит от уровня повреждений и дохода сервера',\n    serverStatusUpdated: 'Статус сервера обновлен',\n    serverStatusUpdatedDesc: 'Статус сервера был успешно изменен.',\n    maintenanceRequired: 'Сервер требует обслуживания перед включением',\n    \n    // Server deletion confirmations\n    deleteWarningTitle: '⚠️ ВНИМАНИЕ! Вы действительно хотите УДАЛИТЬ сервер \"{serverName}\"?',\n    deleteWarningMessage: 'Это действие НЕОБРАТИМО!\\nЕсли вы хотите просто отключить сервер, используйте кнопку \"Включить/Выключить\" вместо удаления.',\n    deleteLastWarning: '🚨 ПОСЛЕДНЕЕ ПРЕДУПРЕЖДЕНИЕ!\\nВы уверены, что хотите НАВСЕГДА удалить сервер \"{serverName}\"?\\nНапишите \"УДАЛИТЬ\" чтобы подтвердить:',\n    deleteFinalConfirm: 'Введите \"УДАЛИТЬ\" чтобы окончательно подтвердить удаление сервера \"{serverName}\":',\n    deleteKeyword: 'УДАЛИТЬ',\n    serverDeleted: 'Сервер удален',\n    serverDeletedDesc: 'Сервер \"{serverName}\" был успешно удален.',\n    deleteCancelled: 'Удаление отменено',\n    deleteCancelledDesc: 'Сервер НЕ был удален.',\n    deleteServerTooltip: '⚠️ УДАЛИТЬ СЕРВЕР НАВСЕГДА (НЕОБРАТИМО!)',\n    \n    // Common UI elements\n    close: 'Закрыть',\n    cancel: 'Отмена',\n    confirm: 'Подтвердить',\n    save: 'Сохранить',\n    edit: 'Редактировать',\n    delete: 'Удалить',\n    add: 'Добавить',\n    remove: 'Удалить',\n    update: 'Обновить',\n    refresh: 'Обновить',\n    loading: 'Загрузка...',\n    success: 'Успешно',\n    error: 'Ошибка',\n    \n    // Time formats\n    minutes: ' мин.',\n    hours: ' час.',\n    seconds: ' сек.',\n    secondsShort: 'сек',\n    until: 'до',\n    reset: 'сброса',\n    resetAvailable: 'Сброс доступен',\n    progressLabel: 'Прогресс',\n    earnedLabel: 'Получено',\n    completedTasks: 'заданий',\n    \n    // Additional UI strings\n    serverLimitNotice: 'Уведомление о лимите серверов',\n    serverLimitWarning: 'Вы используете {currentServers} из {serverLimit} доступных слотов серверов. Пройдите курсы обучения, чтобы увеличить лимит!',\n    requiresLevel: 'Требуется уровень {level}',\n    purchaseFirstServer: 'Купите свой первый сервер в магазине серверов, чтобы начать получать доход.',\n    serverPurchased: 'Сервер куплен',\n    purchaseFailed: 'Покупка не удалась',\n    serverLimitReached: 'Лимит серверов достигнут',\n    serverLimitReachedDesc: 'У вас может быть только {serverLimit} серверов. Пройдите курсы обучения, чтобы увеличить лимит.',\n    serverAlreadyOnline: 'Сервер уже онлайн',\n    serverAlreadyOnlineDesc: 'Этот сервер уже активирован и работает.',\n    purchaseServer: 'Купить сервер',\n    reachedServerLimit: 'Вы достигли лимита серверов {serverLimit}. Пройдите курсы обучения, чтобы разблокировать больше слотов!',\n    completeLearningCoursesToIncrease: 'Пройдите курсы обучения, чтобы увеличить лимит серверов',\n    \n    // Learning Center specific translations\n    learningBenefits: 'Преимущества обучения',\n    moreServers: 'Больше серверов',\n    unlockAdditionalServerSlots: 'Разблокируйте дополнительные слоты серверов',\n    higherEfficiency: 'Высокая эффективность',\n    increaseServerIncomeRates: 'Увеличьте доходность серверов',\n    betterRankings: 'Лучший рейтинг',\n    climbTheLeaderboards: 'Поднимайтесь в таблице лидеров',\n    \n    // Learning tab specific\n    unknownReward: 'Неизвестная награда',\n    serverSlotReward: '+{amount} слот сервера',\n    serverEfficiencyReward: '+{amount}% эффективности серверов',\n    unlockServerReward: 'Разблокирует {serverType}',\n    gpuServer: 'GPU сервер',\n    tpuServer: 'TPU сервер', \n    specialServer: 'Специальный сервер',\n    learningInProgressError: 'Обучение в процессе',\n    oneCourseAtTime: 'Вы можете проходить только один курс за раз. Пожалуйста, дождитесь завершения текущего курса.',\n    needMoneyForCourse: 'Вам нужно {amount} для начала этого курса.',\n    courseStarted: 'Курс начат',\n    courseStartedDesc: 'Вы начали курс {courseTitle}. Проверьте свой прогресс во вкладке серверов!',\n    failedToStartCourse: 'Не удалось начать курс',\n    currentCourse: 'Текущий курс',\n    availableCourses: 'Доступные курсы',\n    duration: 'Длительность',\n    requiresLevelX: 'Требуется уровень {level}',\n    startCourse: 'Начать курс',\n    needMoreForCourse: 'Нужно еще {amount}',\n    completeCurrentFirst: 'Сначала завершите текущий курс',\n    \n    // Player profile\n    loadingPlayerProfile: 'Загрузка профиля игрока...',\n    playerNotFound: 'Игрок не найден',\n    playerNotFoundDesc: 'Игрок \"{nickname}\" не существует или профиль закрыт.',\n    goBack: 'Назад',\n    back: 'Назад',\n    playerProfile: 'Профиль игрока',\n    online: 'Онлайн',\n    offline: 'Офлайн',\n    level: 'Уровень',\n    rank: 'Место',\n    servers: 'серверов',\n    totalBalance: 'Общий баланс',\n    activeServers: 'Активные серверы',\n    globalRank: 'Глобальное место',\n    recentActivity: 'Недавняя активность',\n    turnOnOff: 'Включить/Выключить',\n    \n    // Reports system\n    reports: 'Репорты',\n    createNewReport: 'Создать новый репорт',\n    reportSubject: 'Тема репорта',\n    reportCategory: 'Категория репорта',\n    initialMessage: 'Начальное сообщение',\n    general: 'Общий',\n    technical: 'Технический',\n    createReport: 'Создать репорт',\n    reportSent: 'Репорт отправлен',\n    reportSentDescription: 'Ваш репорт был успешно отправлен.',\n    reportClosed: 'Репорт закрыт',\n    reportClosedDescription: 'Репорт был успешно закрыт.',\n    reportDeleted: 'Репорт удален',\n    reportDeletedDescription: 'Репорт был успешно удален.',\n    reportMarked: 'Репорт отмечен',\n    reportUnmarked: 'Репорт не отмечен',\n    closeReport: 'Закрыть репорт',\n    markReport: 'Отметить репорт',\n    deleteReport: 'Удалить репорт',\n    sendMessage: 'Отправить сообщение',\n    typeMessage: 'Сообщение...',\n    noReports: 'Репортов пока нет',\n    createFirstReport: 'Создайте ваш первый репорт, используя кнопку выше.',\n    reportStatus: 'Статус',\n    reportCreated: 'Создан',\n    reportClosed: 'Закрыт',\n    reportMarked: 'Отмечен',\n    fillAllFields: 'Пожалуйста, заполните все обязательные поля',\n    subjectTooLong: 'Тема не должна превышать 50 символов',\n    messageTooLong: 'Сообщение не должно превышать 500 символов',\n    characters: 'символов',\n    reportSubject: 'Тема отчета',\n    reportType: 'Тип отчета',\n    reportTypeFeature: 'Запрос функции',\n    reportTypeComplaint: 'Жалоба',\n    reportTypeOther: 'Другое',\n    reportMessage: 'Сообщение',\n    submitReport: 'Отправить отчет',\n    \n    // Reports reopen functionality\n    reopenChat: 'Переоткрыть чат',\n    reportReopened: 'Репорт переоткрыт',\n    reportReopenedDescription: 'Репорт был успешно переоткрыт для дальнейшего общения',\n    chatClosedByAdmin: 'Чат закрыт администратором',\n    \n    // Additional reports translations\n    myReports: 'Мои репорты',\n    incomingReports: 'Входящие репорты',\n    newTicket: 'Новый тикет',\n    createNewTicket: 'Создать новый тикет',\n    subject: 'Тема',\n    category: 'Категория',\n    description: 'Описание',\n    selectCategory: 'Выберите категорию',\n    reportTypeBug: 'Баг или другая ошибка',\n    generalIssue: 'Общая проблема',\n    technicalIssue: 'Техническая проблема',\n    otherIssue: 'Другое',\n    featureIssue: 'Запрос функции',\n    reportTypeComplaint: 'Жалоба',\n    startChat: 'Начать чат',\n    sending: 'Отправка...',\n    activeReportExists: 'У вас уже есть активный репорт. Дождитесь ответа администратора.',\n    noIncomingReports: 'Нет входящих репортов',\n    selectReportToView: 'Выберите репорт для просмотра беседы',\n    closeChat: 'Закрыть чат',\n    deleteChat: 'Удалить чат',\n    markChat: 'Отметить чат',\n    unmarkChat: 'Снять отметку с чата',\n    admin: 'Админ',\n    open: 'Открыт',\n    closed: 'Закрыт',\n    \n    // Mini Games translations\n    miniGames: 'Мини-игры',\n    miniGamesDesc: 'Проверьте свои навыки в веселых мини-играх и зарабатывайте опыт!',\n    minigame1: 'Защита от DDoS',\n    minigame1Desc: 'Защитите свои серверы от атак вредоносных пакетов',\n    minigame2: 'Фильтр Файрвола',\n    minigame2Desc: 'Разрешайте легальные запросы и блокируйте вредоносные',\n    requests: 'ответов',\n    howToPlay: 'Как играть',\n    ddosInstructions: 'Кликайте по красным пакетам, чтобы уничтожить их до того, как они достигнут вашего сервера. Скорость увеличивается со временем! За каждое уничтожение +1 опыт.',\n    firewallInstructions: 'Просматривайте каждый запрос и выбирайте Разрешить для безопасных запросов или Заблокировать для опасных. Будьте быстры и точны! За каждый правильный ответ +1 опыт.',\n    startGame: 'Начать игру',\n    gameCompleted: 'Игра завершена!',\n    earnedXP: 'Вы заработали {amount} опыта!',\n    packetsDestroyed: 'Пакетов уничтожено',\n    correct: 'Правильно',\n    correct2: 'правильный',\n    packet: 'пакет',\n    wrong: 'Неправильно',\n    score: 'Счет',\n    timeLeft: 'Осталось времени',\n    requestsLeft: 'Осталось запросов',\n    blockOrAllow: 'Блокируйте опасные запросы или разрешайте безопасные',\n    block: 'Заблокировать',\n    allow: 'Разрешить',\n    yourServer: 'Ваш сервер',\n    medium: 'Средний',\n    \n    // Donate translations\n    donate: 'Донат',\n    donateDesc: 'Поддержите разработку игры и получите эксклюзивные преимущества!',\n    donate1: 'Стартовый пакет',\n    donate1Desc: 'Начните с базовых преимуществ',\n    donate2: 'Премиум пакет (Навсегда)',\n    donate2Desc: 'Продвинутые функции для серьезных игроков',\n    donate3: 'Пакет ускорения',\n    donate3Desc: 'Значительно ускорьте свой прогресс',\n    donate4: 'Максимальный пакет',\n    donate4Desc: 'Максимальные преимущества и эксклюзивный контент',\n    donate5: 'Пакет монет',\n    donate5Desc: 'Внутриигровая валюта для покупок',\n    donate6: 'Специальный пакет',\n    donate6Desc: 'Ограниченное предложение с уникальными наградами',\n    feature1: 'Дополнительные слоты серверов',\n    feature2: 'Ускоренные курсы обучения',\n    feature3: 'Бонусные ежедневные награды',\n    feature4: 'VIP приоритет поддержки',\n    feature5: 'Эксклюзивные типы серверов',\n    feature6: 'События с двойным опытом',\n    feature7: 'Мгновенный ремонт серверов',\n    feature8: 'Продвинутая аналитика',\n    feature9: 'Пользовательские темы серверов',\n    feature10: 'Максимальная емкость серверов',\n    feature11: 'Приоритетная поддержка в чате',\n    feature12: 'Эксклюзивные достижения',\n    feature13: '10.000 внутриигровых монет',\n    feature14: 'Без комиссий за транзакции',\n    feature15: 'Множитель бонуса монет',\n    feature16: 'Сезонные награды',\n    feature17: 'Ранний доступ к функциям',\n    feature18: 'Доступ к событиям сообщества',\n    popular: 'Популярный',\n    purchase: 'Купить',\n    confirmPurchase: 'Подтвердить покупку',\n    included: 'Включено',\n    paymentNotice: 'Обработка платежа',\n    paymentNoticeDesc: 'Это демо версия. Реальные платежи не обрабатываются.',\n    buyNow: 'Купить сейчас',\n    purchaseNotAvailable: 'Покупка недоступна',\n    purchaseNotAvailableDesc: 'Это демо версия. Обработка платежей не реализована.',\n    \n    // Server mini-game translations\n    serverminigame1: 'Подключение сервера',\n    serverminigame2: 'Соедините все провода по цветам, чтобы включить сервер. У вас есть 30 секунд!',\n    serverminigame3: 'Неправильное подключение',\n    serverminigame4: 'Убедитесь, что соединяете провода одинакового цвета!',\n    serverminigame5: 'Успех!',\n    serverminigame6: 'Сервер теперь онлайн и готов к использованию.',\n    serverminigame7: 'Неудача!',\n    serverminigame8: 'Время вышло! Прочность сервера уменьшена на 1.',\n    serverminigame9: 'Подключено:',\n    serverminigame10: 'Ваш сервер теперь онлайн и генерирует доход.',\n    serverminigame11: 'Попробуйте снова, когда сервер будет отремонтирован.',\n    connectServer: 'Подключить сервер',\n    serverNowOnline: 'Сервер теперь онлайн и генерирует доход.',\n    yourServer: 'Сервер',\n    timeLeft: 'Осталось времени',\n    startGame: 'Начать игру',\n    close: 'Закрыть',\n  },\n  \n  ua: {\n    // Navigation\n    tutorial: 'Старт',\n    servers: 'Мої сервери',\n    hosting: 'Магазин серверів',\n    learning: 'Центр навчання',\n    myServers: 'Мої сервери',\n    serverStore: 'Магазин серверів',\n    learningCenter: 'Центр навчання',\n    \n    // Basic UI\n    balance: 'Баланс',\n    income: 'Дохід/хв',\n    monthlyCost: 'Місячна оплата',\n    netProfitMonth: 'Дохід на місяць',\n    serverLimit: 'Ліміт серверів',\n    settings: 'Налаштування',\n    logout: 'Вийти',\n    login: 'Вхід',\n    register: 'Реєстрація',\n    nickname: 'Нікнейм',\n    password: 'Пароль',\n    confirmPassword: 'Підтвердіть пароль',\n    loggingIn: 'Вхід...',\n    creatingAccount: 'Створення акаунту...',\n    loginFailed: 'Помилка входу',\n    registrationFailed: 'Помилка реєстрації',\n    passwordsDoNotMatch: 'Паролі не співпадають',\n    \n    // Hero section\n    heroTitle: 'Створіть Свою Серверну Імперію',\n    heroSubtitle: 'Опануйте Мистецтво Хостингу',\n    heroDescription: 'Почніть з нуля і збудуйте найбільшу імперію серверного хостингу у віртуальному світі. Вивчіть економіку, технології та стратегію.',\n    startPlaying: 'Почати Гру',\n    learnMore: 'Дізнатися Більше',\n    \n    // Learning progress\n    learningInProgress: 'Навчання в процесі',\n    timeRemaining: 'залишилося',\n    serverSlotReward: '+{amount} Серверний слот',\n\n    // Statistics\n    totalPlayers: 'Всього Гравців',\n    onlineNow: 'Зараз Онлайн',\n    serversHosted: 'Серверів Розміщено',\n    totalBalance: 'Загальний Баланс',\n\n    // Additional hosting translations\n    availableSlots: 'Доступні слоти',\n    needMoreMoney: 'Для купівлі цього сервера вам буде потрібно {amount}',\n    serverAddedToYourServers: '{serverName} був доданий до ваших серверів!',\n    needLearningCourse: 'Необхідний курс навчання',\n    monthlyCost: 'Щомісячна вартість',\n    netProfitMonth: 'Чистий прибуток/місяць',\n    needMoreFunds: 'Не вистачає {amount}',\n    wantMoreServers: 'Хочете більше серверів?',\n    learningCoursesBenefit: 'Кожен пройдений курс дає змогу розблокувати додаткові серверні слоти та підвищити ефективність роботи сервера. Відвідайте Навчальний центр, щоб почати свій наступний курс!',\n    \n    // Features\n    gameFeatures: 'Особливості Гри',\n    featuresDescription: 'Дізнайтеся, що робить наш симулятор хостингу унікальним',\n    feature1Title: 'Створюйте Сервери',\n    feature1Desc: 'Створюйте та налаштовуйте власні сервери',\n    feature2Title: 'Глобальна Мережа',\n    feature2Desc: 'Розширюйтеся по всьому світу з дата-центрами',\n    feature3Title: 'Збільшуйте Дохід',\n    feature3Desc: 'Оптимізуйте бізнес для максимального прибутку',\n    feature4Title: 'Висока Продуктивність',\n    feature4Desc: 'Надавайте блискавично швидкі послуги хостингу',\n    \n    // Leaderboard\n    topPlayers: 'Топ Гравців',\n    topPlayersDescription: 'Подивіться, хто домінує в індустрії хостингу',\n    leaderboard: 'Таблиця Лідерів',\n    serversLowercase: 'серверів',\n    joinCompetition: 'Приєднатися до Змагання',\n    allRightsReserved: 'Всі права захищені.',\n    loginRegister: 'Вхід / Реєстрація',\n    \n    // Error messages\n    errorNotFound: 'Не знайдено',\n    errorServerError: 'Помилка сервера',\n    errorNetworkError: 'Помилка мережі',\n    errorUnauthorized: 'Доступ заборонено',\n    errorBadRequest: 'Неправильний запит',\n    errorGeneric: 'Щось пішло не так',\n    pleaseRefresh: 'Будь ласка, оновіть сторінку та спробуйте знову',\n    jobOnCooldown: 'Робота недоступна {seconds} секунд',\n    insufficientFunds: 'Недостатньо коштів',\n    serverLimitReached: 'Досягнуто ліміт серверів',\n    errorjob: 'Помилка, робота поки що недоступна',\n    \n    // Tutorial\n    tutorialProgress: 'Прогрес навчання',\n    hideProgress: 'Приховати прогрес',\n    tutorialCompleted: 'Навчання завершено!',\n    tutorialCompletedDesc: 'Вітаємо! Ви розблокували всі можливості гри.',\n    completeTutorialUnlock: 'Завершити навчання та розблокувати всі можливості',\n    allFeaturesUnlocked: 'Всі можливості розблоковані!',\n    tutorialCompletedTitle: 'Навчання завершено!',\n    tutorialCompletedMessage: 'Вітаємо! Ви розблокували всі можливості гри.',\n    \n    // Interface states\n    start: 'Старт',\n    inProgress: 'В процесі',\n    completed: 'Завершено',\n    active: 'Активно',\n    available: 'Доступно',\n    unavailable: 'Недоступно',\n    locked: 'Заблоковано',\n    unlocked: 'Розблоковано',\n    online: 'Онлайн',\n    offline: 'Офлайн',\n    \n    // Jobs and actions\n    tutorialJobs: 'Дистанційна робота',\n    startJob: 'Почати роботу',\n    completeJob: 'Завершити роботу',\n    availableIn: 'Доступно через',\n    earnMoney: 'Заробити {amount}',\n    cooldownTime: 'Перезарядка: {time}',\n    jobStarted: 'Робота виконана',\n    jobStartedDesc: '{jobName} виконана! Ви отримали {reward}.',\n    \n    // Job types\n    serverMaintenance: 'Обслуговування сервера',\n    performanceOptimization: 'Оптимізація продуктивності',\n    securityAudit: 'Аудит безпеки',\n    \n    // Tutorial tips\n    tutorialTips: 'Підказки навчання',\n    tipCompleteJobs: 'За допомогою міні-ігор ви можете отримати певний досвід',\n    tipJobCooldown: 'Щоб відкрити рейтинг і потрапити до нього - потрібно мати хоча б 5 рівень',\n    tipEarnToUnlock: 'Якщо у вас є питання або ви знайшли помилку - перейдіть на вкладку \"Звіт\"',\n    tipPurchaseServers: \"Купуйте сервери для пасивного доходу, не забувайте стежити за ними\",\n    tipTakeCourses: 'Пройдіть навчальні курси, щоб розблокувати більше серверних слотів і не тільки',\n    browseServerStore: 'Переглянути магазин серверів',\n    browseLearningCourses: 'Переглянути курси навчання',\n    \n    // Activities\n    recentActivities: 'Нещодавні дії',\n    \n    // Server management\n    purchaseServer: 'Купити сервер',\n    deleteServer: 'Видалити сервер',\n    toggleServer: 'Перемкнути сервер',\n    noServersYet: 'Серверів поки немає',\n    addNewServer: 'Добавити новий сервер',\n    availableServerSlots: 'Доступно серверних слотів: {availableSlots}. Відвідайте магазин серверів, щоб придбати нові сервери.',\n    purchaseServersFromStore: 'Купуйте сервери в магазині, щоб почати хостинг та отримувати пасивний дохід!',\n    visitServerStore: 'Відвідати магазин серверів',\n    serverSettings: 'Налаштування сервера',\n    loadPercentage: 'Відсоток навантаження',\n    currentLoad: 'Поточне навантаження',\n    overloadRisk: 'Ризик перевантаження',\n    low: 'Низький',\n    moderate: 'Помірний',\n    high: 'Високий',\n    veryHigh: 'Дуже високий',\n    serverShutdownWarning: 'Високе навантаження збільшує ризик відключення',\n    rentalCost: 'Оренда/хв',\n    \n    // Server products\n    basicWebServer: 'Базовий веб-сервер',\n    highPerformanceServer: 'Високопродуктивний сервер',\n    databaseServer: 'Сервер бази даних',\n    cdnServer: 'CDN сервер',\n    webHosting: 'Веб-хостинг',\n    gamingApps: 'Ігри/Додатки',\n    storage: 'Сховище',\n    contentDelivery: 'Доставка контенту',\n    \n    // Learning courses\n    basicServerSetup: 'Базове налаштування сервера',\n    advancedServerManagement: 'Просунуте управління сервером',\n    securityProtocols: 'Протоколи безпеки',\n    beginner: 'Початківець',\n    intermediate: 'Середній',\n    advanced: 'Просунутий',\n    coursesGenitive: 'курсів',\n    \n    // Quest system\n    dailyQuests: 'Щоденні завдання',\n    achievements: 'Досягнення',\n    achievementsList: {\n      'first-steps': {\n        title: \"Першi кроки\",\n        description: \"Виконайте свою першу роботу\",\n      },\n      'first-server': {\n        title: \"Перший сервер\",\n        description: \"Купіть свій перший сервер\",\n      },\n      'server-collection': {\n        title: \"Колекціонер серверів\",\n        description: \"Володійте 5 серверами одночасно\",\n      },\n      'millionaire': {\n        title: \"Мільйонер\",\n        description: \"Досягніть балансу $1.000.000\",\n      },\n      'job-master': {\n        title: \"Майстер завдань\",\n        description: \"Виконайте загалом 100 робіт\",\n      },\n      'learning-enthusiast': {\n        title: \"Любитель навчання\",\n        description: \"Пройти всі навчальні курси\",\n      },\n      'early-earner': {\n        title: \"Ранній заробіток\",\n        description: \"Отримати перші $10.000\",\n      },\n      'efficient-worker': {\n        title: \"Ефективний працівник\",\n        description: \"Виконати 10 робіт\",\n      },\n      'server-builder': {\n        title: \"Конструктор серверів\",\n        description: \"Володійте 3 різними типами серверів\",\n      },\n      'security-expert': {\n        title: \"Експерт з безпеки\",\n        description: \"Виконати 50 робіт з аудиту безпеки\",\n      },\n      'maintenance-guru': {\n        title: \"Гуру технічного обслуговування\",\n        description: \"Виконати 75 робіт з технічного обслуговування\",\n      },\n      'optimization-master': {\n        title: \"Майстер оптимізації\",\n        description: \"Виконайте 60 робіт з оптимізації\",\n      },\n      'wealthy-investor': {\n        title: \"Багатий інвестор\",\n        description: \"Досягніть на балансі $100.000\",\n      },\n      'server-mogul': {\n        title: \"Серверний магнат\",\n        description: \"Володійте 10 серверами одночасно\",\n      },\n      'persistent-learner': {\n        title: \"Наполегливий учень\",\n        description: \"Пройдіть 3 навчальні курси\",\n      },\n      'speed-demon': {\n        title: \"Демон швидкості\",\n        description: \"Виконайте загалом 200 робіт\",\n      },\n      'infrastructure-king': {\n        title: \"Король інфраструктури\",\n        description: \"Володійте 15 серверами одночасно\",\n      },\n      'multi-millionaire': {\n        title: \"Мультимільйонер\",\n        description: \"Досягніть $5.000.000 на балансі\",\n      },\n      'course-completionist': {\n        title: \"Завершувач курсів\",\n        description: \"Пройдіть усі доступні навчальні курси\",\n      },\n      'workaholic': {\n        title: \"Трудоголік\",\n        description: \"Виконайте загалом 500 робіт\",\n      },\n      'server-empire': {\n        title: \"Імперія серверів\",\n        description: \"Володійте 20 серверами одночасно\",\n      },\n      'financial-titan': {\n        title: \"Фінансовий титан\",\n        description: \"Досягніть $10.000.000 на балансі\",\n      },\n      'legendary-worker': {\n        title: \"Легендарний працівник\",\n        description: \"Виконайте загалом 1000 робіт\",\n      },\n      'server-overlord': {\n        title: \"Володар серверів\",\n        description: \"Володійте 30 серверами одночасно\",\n      },\n      'billionaire-club': {\n        title: \"Клуб мільярдерів\",\n        description: \"Досягніть $100.000.000 на балансі\",\n      },\n      'ultimate-legend': {\n        title: \"Абсолютна легенда\",\n        description: \"Виконайте загалом 2500 робіт\",\n      }\n    },\n    rankings: 'Рейтинг',\n    claimReward: 'Забрати нагороду',\n    rewardClaimed: 'Нагорода отримана',\n    questCompleted: 'Завдання виконано',\n    reward: 'Нагорода',\n    progress: 'Прогрес',\n    claiming: 'Отримання...',\n    \n    // Daily quests\n    dailyQuestsList: {\n      'daily-maintenance': {\n        title: 'Щоденне обслуговування',\n        description: 'Виконайте 3 роботи з обслуговування серверів'\n      },\n      'daily-income': {\n        title: 'Пасивний дохід',\n        description: 'Заробіть $5.000 від доходів серверів'\n      },\n      'daily-optimization': {\n        title: 'Оптимізація серверів',\n        description: 'Виконайте 2 роботи з оптимізації продуктивності'\n      },\n      'daily-security': {\n        title: 'Перевірка безпеки',\n        description: 'Виконайте 1 роботу з аудиту безпеки'\n      },\n      'daily-earnings': {\n        title: 'Щоденні доходи',\n        description: 'Заробіть $10.000 від доходів серверів'\n      },\n      'daily-worker': {\n        title: 'Працьовитий',\n        description: 'Виконайте 5 робіт будь-якого типу'\n      },\n      'daily-mixed-jobs': {\n        title: 'Змішані завдання',\n        description: 'Виконайте 2 роботи з обслуговування та 1 з оптимізації'\n      },\n      'daily-income-boost': {\n        title: 'Прискорення доходу',\n        description: 'Заробіть $20.000 від доходів серверів'\n      },\n      'daily-job-spree': {\n        title: 'Серія робіт',\n        description: 'Виконайте 8 робіт будь-якого типу'\n      },\n      'daily-mega-earner': {\n        title: 'Кодер-магнат',\n        description: 'Заробіть $50.000 від доходів серверів'\n      }\n    },\n    \n    // Admin panel\n    adminManagement: 'Управління адміністраторами',\n    selectUser: 'Виберіть користувача',\n    chooseUser: 'Оберіть користувача',\n    action: 'Дія',\n    chooseAction: 'Оберіть дію',\n    executeAction: 'Виконати дію',\n    giveAdmin: 'Видати адміністратора',\n    removeAdmin: 'Забрати адміністратора',\n    banUser: 'Забанити користувача',\n    unbanUser: 'Розбанити користувача',\n    totalUsers: 'Всього користувачів',\n    onlineUsers: 'Онлайн користувачів',\n    totalAdmins: 'Всього адміністраторів',\n    userList: 'Список користувачів',\n    superAdminPanel: 'Панель супер-адміністратора',\n    adminPanel: 'Панель адміністратора',\n    pleaseSelectUserAndAction: 'Будь ласка, оберіть користувача та дію',\n    pleaseEnterValidAmount: 'Будь ласка, введіть коректну суму',\n    actionSuccessfullyCompleted: 'Дія \"{action}\" успішно виконана',\n    \n    // Chat system\n    generalChat: 'Загальний чат',\n    muteUser: 'Заглушити користувача',\n    unmute: 'Розглушити',\n    playerManagement: 'Управління гравцями',\n    enterMessage: 'Введіть повідомлення...',\n    usefulTips: 'Корисні поради',\n    chatRules: 'Правила чата',\n    chatRule1: 'Не спамити і не флудити - без капсу, однакових повідомлень, безглуздих символів.',\n    chatRule2: 'Поважай інших гравців - ніяких образ, провокацій і дискримінації.',\n    chatRule3: 'Без мату і ненормативної лексики - фільтр може автоматично блокувати такі слова.',\n    chatRule4: 'Заборонено рекламу та посилання на сторонні ресурси.',\n    chatRule5: 'Адміністрація завжди має останнє слово - рішення модераторів обговорюються тільки в підтримці.',\n    giveMoney: 'Видати гроші',\n    takeMoney: 'Забрати гроші',\n    deleteUser: 'Видалити аккаунт гравця',\n    amount: 'Сума',\n    enterAmount: 'Введіть суму',\n    youAreMuted: 'Вас заглушено і ви не можете надсилати повідомлення',\n    noMessages: 'Немає повідомлень. Почніть спілкування!',\n    messageDeleted: 'Повідомлення видалено',\n    messageDeletedBy: 'Повідомлення видалено адміністратором {admin}',\n    selectMuteDuration: '5хв',\n    mute: 'Заглушити',\n    activeMutes: 'Активні заглушення',\n    \n    // Profile and level system\n    progressToLevel: 'Прогрес до рівня',\n    registrationdate: 'Дата реєстрації: ',\n    xpNeeded: 'потрібно досвіду',\n    totalEarnings: 'Загальний дохід',\n    totalSpent: 'Витрачено загалом',\n    netProfit: 'Чистий прибуток',\n    jobsCompleted: 'Виконано робіт',\n    coursesCompleted: 'Пройдено курсів',\n    achievement: 'Досягнення',\n    noAchievementsYet: 'Поки немає досягнень',\n    earnAchievementsDesc: 'Виконуйте роботи та досягайте цілей, щоб отримати досягнення!',\n    currentBalance: 'Поточний баланс',\n    levelUp: 'Підвищення рівня!',\n    levelUpCongrats: 'Вітаємо! Ви досягли',\n    levelUpCongrats3: 'рівня',\n    levelUpCongrats2: 'Щоб закрити вікно, клацніть де-небудь',\n    newAbilitiesUnlocked: 'Нові можливості розблоковані!',\n    \n    // Tooltips and hints\n    profileTooltip: 'Натисніть на свою аватарку, щоб побачити прогрес та іншу цікаву інформацію',\n    nicknameTooltip: 'Якщо натиснути на свій нік або чужий, можна перейти на профіль гравця',\n    adminControlsInfo: 'Натиснувши на свій аватар, можна дізнатися більше корисної інформації',\n    \n    // Theme system\n    darkTheme: 'Переключити на темну тему',\n    lightTheme: 'Переключити на світлу тему',\n    \n    // Server durability system\n    serverRepaired: 'Сервер відремонтовано',\n    serverRepairedDesc: 'Сервер відремонтовано за ${cost}. Міцність відновлено: {durability}%',\n    repairFailed: 'Ремонт не вдався',\n    durability: 'Міцність',\n    serverCondition: 'Стан сервера',\n    partialRepair: 'Частковий ремонт',\n    fullRepair: 'Повний ремонт',\n    repairCostInfo: 'Вартість ремонту залежить від рівня пошкоджень і доходу сервера',\n    serverStatusUpdated: 'Статус сервера оновлено',\n    serverStatusUpdatedDesc: 'Статус сервера було успішно змінено.',\n    maintenanceRequired: 'Сервер потребує обслуговування перед увімкненням',\n    \n    // Server deletion confirmations\n    deleteWarningTitle: '⚠️ УВАГА! Ви дійсно хочете ВИДАЛИТИ сервер \"{serverName}\"?',\n    deleteWarningMessage: 'Ця дія НЕЗВОРОТНА!\\nЯкщо ви хочете просто вимкнути сервер, використовуйте кнопку \"Увімкнути/Вимкнути\" замість видалення.',\n    deleteLastWarning: '🚨 ОСТАННЄ ПОПЕРЕДЖЕННЯ!\\nВи впевнені, що хочете НАЗАВЖДИ видалити сервер \"{serverName}\"?\\nНапишіть \"ВИДАЛИТИ\" щоб підтвердити:',\n    deleteFinalConfirm: 'Введіть \"ВИДАЛИТИ\" щоб остаточно підтвердити видалення сервера \"{serverName}\":',\n    deleteKeyword: 'ВИДАЛИТИ',\n    serverDeleted: 'Сервер видалено',\n    serverDeletedDesc: 'Сервер \"{serverName}\" було успішно видалено.',\n    deleteCancelled: 'Видалення скасовано',\n    deleteCancelledDesc: 'Сервер НЕ було видалено.',\n    deleteServerTooltip: '⚠️ ВИДАЛИТИ СЕРВЕР НАЗАВЖДИ (НЕЗВОРОТНО!)',\n    \n    // Common UI elements\n    close: 'Закрити',\n    cancel: 'Скасувати',\n    confirm: 'Підтвердити',\n    save: 'Зберегти',\n    edit: 'Редагувати',\n    delete: 'Видалити',\n    add: 'Додати',\n    remove: 'Видалити',\n    update: 'Оновити',\n    refresh: 'Оновити',\n    loading: 'Завантаження...',\n    success: 'Успішно',\n    error: 'Помилка',\n    \n    // Time formats\n    minutes: ' хв.',\n    hours: ' год.',\n    seconds: ' сек.',\n    secondsShort: 'сек',\n    until: 'до',\n    reset: 'скидання',\n    resetAvailable: 'Скидання доступне',\n    progressLabel: 'Прогрес',\n    earnedLabel: 'Отримано',\n    completedTasks: 'завдань',\n    \n    // Additional UI strings\n    serverLimitNotice: 'Повідомлення про ліміт серверів',\n    serverLimitWarning: 'Ви використовуєте {currentServers} з {serverLimit} доступних слотів серверів. Пройдіть курси навчання, щоб збільшити ліміт!',\n    requiresLevel: 'Потрібен рівень {level}',\n    purchaseFirstServer: 'Купіть свій перший сервер у магазині серверів, щоб почати отримувати дохід.',\n    serverPurchased: 'Сервер куплено',\n    purchaseFailed: 'Покупка не вдалася',\n    serverLimitReached: 'Ліміт серверів досягнуто',\n    serverLimitReachedDesc: 'У вас може бути лише {serverLimit} серверів. Пройдіть курси навчання, щоб збільшити ліміт.',\n    purchaseServer: 'Купити сервер',\n    reachedServerLimit: 'Ви досягли ліміту серверів {serverLimit}. Пройдіть курси навчання, щоб розблокувати більше слотів!',\n    completeLearningCoursesToIncrease: 'Пройдіть курси навчання, щоб збільшити ліміт серверів',\n    \n    // Learning Center specific translations\n    learningBenefits: 'Переваги навчання',\n    moreServers: 'Більше серверів',\n    unlockAdditionalServerSlots: 'Розблокуйте додаткові слоти серверів',\n    higherEfficiency: 'Вища ефективність',\n    increaseServerIncomeRates: 'Збільште дохідність серверів',\n    betterRankings: 'Кращий рейтинг',\n    climbTheLeaderboards: 'Піднімайтеся в таблиці лідерів',\n    \n    // Learning tab specific\n    unknownReward: 'Невідома нагорода',\n    serverSlotReward: '+{amount} слот сервера',\n    serverEfficiencyReward: '+{amount}% ефективності серверiв',\n    unlockServerReward: 'Розблоковує {serverType}',\n    gpuServer: 'GPU сервер',\n    tpuServer: 'TPU сервер', \n    specialServer: 'Спеціальний сервер',\n    learningInProgressError: 'Навчання в процесі',\n    oneCourseAtTime: 'Ви можете проходити тільки один курс за раз. Будь ласка, дочекайтеся завершення поточного курсу.',\n    needMoneyForCourse: 'Вам потрібно {amount} для початку цього курсу.',\n    courseStarted: 'Курс розпочато',\n    courseStartedDesc: 'Ви розпочали курс {courseTitle}. Перевірте свій прогрес у вкладці серверів!',\n    failedToStartCourse: 'Не вдалося розпочати курс',\n    currentCourse: 'Поточний курс',\n    availableCourses: 'Доступні курси',\n    duration: 'Тривалість',\n    requiresLevelX: 'Потрібен рівень {level}',\n    startCourse: 'Розпочати курс',\n    needMoreForCourse: 'Потрібно ще {amount}',\n    completeCurrentFirst: 'Спочатку завершіть поточний курс',\n    \n    // Player profile\n    loadingPlayerProfile: 'Завантаження профілю гравця...',\n    playerNotFound: 'Гравця не знайдено',\n    playerNotFoundDesc: 'Гравець \"{nickname}\" не існує або профіль закритий.',\n    goBack: 'Назад',\n    back: 'Назад',\n    playerProfile: 'Профіль гравця',\n    online: 'Онлайн',\n    offline: 'Офлайн',\n    level: 'Рівень',\n    rank: 'Місце',\n    servers: 'серверів',\n    totalBalance: 'Загальний баланс',\n    activeServers: 'Активні сервери',\n    globalRank: 'Глобальне місце',\n    recentActivity: 'Нещодавня активність',\n    turnOnOff: 'Увімкнути/Вимкнути',\n    \n    // Reports system\n    reports: 'Звіти',\n    createNewReport: 'Створити новий звіт',\n    reportSubject: 'Тема звіту',\n    reportCategory: 'Категорія звіту',\n    initialMessage: 'Початкове повідомлення',\n    general: 'Загальні',\n    technical: 'Технічні',\n    createReport: 'Створити звіт',\n    reportSent: 'Звіт відправлено',\n    reportSentDescription: 'Ваш звіт успішно відправлено.',\n    reportClosed: 'Звіт закрито',\n    reportClosedDescription: 'Звіт успішно закрито.',\n    reportDeleted: 'Звіт видалено',\n    reportDeletedDescription: 'Звіт успішно видалено.',\n    reportMarked: 'Звіт позначено',\n    reportUnmarked: 'Звіт не позначено',\n    closeReport: 'Закрити звіт',\n    markReport: 'Позначити звіт',\n    deleteReport: 'Видалити звіт',\n    sendMessage: 'Надіслати повідомлення',\n    typeMessage: 'Повідомлення...',\n    noReports: 'Ще немає звітів',\n    createFirstReport: 'Створіть свій перший звіт за допомогою кнопки вище.',\n    reportStatus: 'Статус',\n    reportCreated: 'Створено',\n    reportClosed: 'Закрито',\n    reportMarked: 'Позначено',\n    fillAllFields: \"Будь ласка, заповніть всі обов'язкові поля\",\n    subjectTooLong: 'Тема не повинна перевищувати 50 символів',\n    messageTooLong: 'Повідомлення не повинно перевищувати 500 символів',\n    characters: 'символів',\n    reportType: 'Тип звіту',\n    reportTypeFeature: 'Функціональний запит',\n    reportTypeComplaint: 'Скарга',\n    reportTypeOther: 'Інше',\n    reportMessage: 'Повідомлення',\n    submitReport: 'Надіслати звіт',\n    \n    // Reports reopen functionality\n    reopenChat: 'Перезапустити чат',\n    reportReopened: 'Звіт перезапущено',\n    reportReopenedDescription: 'Звіт успішно перезапущено для подальшого спілкування',\n    chatClosedByAdmin: 'Чат закрито адміністратором',\n    \n    // Additional reports translations\n    myReports: 'Мої звіти',\n    incomingReports: 'Вхідні звіти',\n    newTicket: 'Новий тикет',\n    createNewTicket: 'Створити новий тикет',\n    subject: 'Тема',\n    category: 'Категорія',\n    description: 'Опис',\n    selectCategory: 'Вибрати категорію',\n    reportTypeBug: 'Баг або інша помилка',\n    otherIssue: 'Інше',\n    featureIssue: 'Запит функції',\n    reportTypeComplaint: 'Скарга',\n    generalIssue: 'Загальний випуск',\n    technicalIssue: 'Технічний випуск',\n    startChat: 'Почати чат',\n    sending: 'Надсилання...',\n    activeReportExists: 'Ви вже маєте активний звіт. Будь ласка, дочекайтеся відповіді адміністратора.',\n    noIncomingReports: 'Немає вхідних звітів',\n    selectReportToView: 'Виберіть звіт, щоб переглянути розмову',\n    closeChat: 'Закрити чат',\n    deleteChat: 'Видалити чат',\n    markChat: 'Позначити чат',\n    unmarkChat: 'Зняти позначку',\n    admin: 'Адміністратор',\n    open: 'Відкрито',\n    closed: 'Закрито',\n\n    // Мини-игры переводы\n    miniGames: 'Міні-ігри',\n    miniGamesDesc: 'Перевірте свої навички в захоплюючих міні-іграх та заробляйте досвід!',\n    minigame1: 'Захист від DDoS',\n    minigame1Desc: 'Захистіть свої сервери від вхідних пакетних атак',\n    minigame2: 'Фільтр Фаєрвола',\n    minigame2Desc: 'Дозволяйте легітимні запити та блокуйте шкідливі',\n    requests: 'відповідей',\n    howToPlay: 'Як грати',\n    ddosInstructions: 'Клікайте по червоних пакетах, щоб знищити їх до того, як вони досягнуть вашого сервера. Швидкість збільшується з часом! За кожне знищення +1 досвід.',\n    firewallInstructions: 'Переглядайте кожен запит та вибирайте дозволити безпечні запити або заблокувати небезпечні. Будьте швидкими та точними! За кожну правильну відповідь +1 досвід.',\n    gameCompleted: 'Гра завершена!',\n    earnedXP: 'Ви заробили {amount} досвіду!',\n    packetsDestroyed: 'Пакетів знищено',\n    correct: 'Правильно',\n    correct2: 'вірний',\n    packet: 'пакет',\n    wrong: 'Неправильно',\n    score: 'Рахунок',\n    timeLeft: 'Часу залишилось',\n    requestsLeft: 'Запитів залишилось',\n    blockOrAllow: 'Блокуйте небезпечні запити або дозволяйте безпечні',\n    block: 'Заблокувати',\n    allow: 'Дозволити',\n    yourServer: 'Ваш сервер',\n    medium: 'Середній',\n    \n    // Донат переводы\n    donate: 'Донат',\n    donateDesc: 'Підтримайте розробку гри та отримайте ексклюзивні переваги!',\n    donate1: 'Стартовий пакет',\n    donate1Desc: 'Почніть з базових переваг',\n    donate2: 'Преміум пакет (Навсегда)',\n    donate2Desc: 'Просунуті функції для серйозних гравців',\n    donate3: 'Пакет прискорення',\n    donate3Desc: 'Значно прискорте свій прогрес',\n    donate4: 'Максимальний пакет',\n    donate4Desc: 'Максимальні переваги та ексклюзивний контент',\n    donate5: 'Пакет монет',\n    donate5Desc: 'Внутрішньоігрова валюта для покупок',\n    donate6: 'Спеціальний пакет',\n    donate6Desc: 'Обмежена пропозиція з унікальними нагородами',\n    feature1: 'Додаткові слоти серверів',\n    feature2: 'Прискорені курси навчання',\n    feature3: 'Бонусні щоденні нагороди',\n    feature4: 'VIP пріоритет підтримки',\n    feature5: 'Ексклюзивні типи серверів',\n    feature6: 'Події з подвійним досвідом',\n    feature7: 'Миттєвий ремонт серверів',\n    feature8: 'Розширена аналітика',\n    feature9: 'Користувацькі теми серверів',\n    feature10: 'Максимальна ємність серверів',\n    feature11: 'Пріоритетна підтримка в чаті',\n    feature12: 'Ексклюзивні досягнення',\n    feature13: '10.000 внутрішньоігрових монет',\n    feature14: 'Без комісій за транзакції',\n    feature15: 'Множник бонусу монет',\n    feature16: 'Сезонні нагороди',\n    feature17: 'Ранній доступ до функцій',\n    feature18: 'Доступ до подій спільноти',\n    popular: 'Популярний',\n    purchase: 'Купити',\n    confirmPurchase: 'Підтвердити покупку',\n    included: 'Включено',\n    paymentNotice: 'Обробка платежу',\n    paymentNoticeDesc: 'Це демо версія. Реальні платежі не обробляються.',\n    buyNow: 'Купити зараз',\n    purchaseNotAvailable: 'Покупка недоступна',\n    purchaseNotAvailableDesc: 'Це демо версія. Обробка платежів не реалізована.',\n  },\n  \n  de: {\n    // Navigation\n    tutorial: 'Start',\n    servers: 'Meine Server',\n    hosting: 'Server Shop',\n    learning: 'Lernzentrum',\n    myServers: 'Meine Server',\n    serverStore: 'Server Shop',\n    learningCenter: 'Lernzentrum',\n    \n    // Basic UI\n    balance: 'Guthaben',\n    income: 'Einkommen/min',\n    monthlyCost: 'Monatliche Zahlung',\n    netProfitMonth: 'Einkommen pro Monat',\n    serverLimit: 'Server-Limit',\n    settings: 'Einstellungen',\n    logout: 'Abmelden',\n    login: 'Anmelden',\n    register: 'Registrieren',\n    nickname: 'Nickname',\n    password: 'Passwort',\n    confirmPassword: 'Passwort bestätigen',\n    loggingIn: 'Anmelden...',\n    creatingAccount: 'Konto erstellen...',\n    loginFailed: 'Anmeldung fehlgeschlagen',\n    registrationFailed: 'Registrierung fehlgeschlagen',\n    passwordsDoNotMatch: 'Passwörter stimmen nicht überein',\n    \n    // Hero section\n    heroTitle: 'Bauen Sie Ihr Server-Imperium',\n    heroSubtitle: 'Meistern Sie die Kunst des Hostings',\n    heroDescription: 'Beginnen Sie mit nichts und bauen Sie das größte Server-Hosting-Imperium in der virtuellen Welt. Meistern Sie Wirtschaft, Technologie und Strategie.',\n    startPlaying: 'Spielen Beginnen',\n    learnMore: 'Mehr Erfahren',\n    \n    // Learning progress\n    learningInProgress: 'Lernen im Prozess',\n    timeRemaining: 'verbleibende',\n\n    // Statistics\n    totalPlayers: 'Gesamtspieler',\n    onlineNow: 'Jetzt Online',\n    serversHosted: 'Gehostete Server',\n    totalBalance: 'Gesamtguthaben',\n\n    // Additional hosting translations\n    availableSlots: 'Verfügbare Slots',\n    needMoreMoney: 'Um diesen Server zu kaufen, benötigen Sie {amount}',\n    serverAddedToYourServers: '{serverName} wurde zu Ihren Servern hinzugefügt!',\n    needLearningCourse: 'Schulungskurs erforderlich',\n    needMoreFunds: 'Nicht genug {amount}',\n    wantMoreServers: 'Mehr Server gewünscht?',\n    learningCoursesBenefit: 'Jeder abgeschlossene Kurs schaltet zusätzliche Server-Slots frei und erhöht die Server-Effizienz. Besuchen Sie das Schulungszentrum, um Ihren nächsten Kurs zu beginnen!',\n    \n    // Features\n    gameFeatures: 'Spiel-Features',\n    featuresDescription: 'Entdecken Sie, was unseren Hosting-Simulator einzigartig macht',\n    feature1Title: 'Server Erstellen',\n    feature1Desc: 'Erstellen und anpassen Sie Ihre eigenen Server',\n    feature2Title: 'Globales Netzwerk',\n    feature2Desc: 'Erweitern Sie weltweit mit Rechenzentren',\n    feature3Title: 'Umsatz Steigern',\n    feature3Desc: 'Optimieren Sie Ihr Geschäft für maximalen Gewinn',\n    feature4Title: 'Hohe Leistung',\n    feature4Desc: 'Bieten Sie blitzschnelle Hosting-Services',\n    \n    // Leaderboard\n    topPlayers: 'Top-Spieler',\n    topPlayersDescription: 'Sehen Sie, wer die Hosting-Branche dominiert',\n    leaderboard: 'Rangliste',\n    serversLowercase: 'server',\n    joinCompetition: 'Am Wettbewerb Teilnehmen',\n    allRightsReserved: 'Alle Rechte vorbehalten.',\n    loginRegister: 'Anmelden / Registrieren',\n    \n    // Error messages\n    errorNotFound: 'Nicht gefunden',\n    errorServerError: 'Serverfehler',\n    errorNetworkError: 'Netzwerkfehler',\n    errorUnauthorized: 'Zugriff verweigert',\n    errorBadRequest: 'Ungültige Anfrage',\n    errorGeneric: 'Etwas ist schiefgelaufen',\n    pleaseRefresh: 'Bitte aktualisieren Sie die Seite und versuchen Sie es erneut',\n    jobOnCooldown: 'Job ist für {seconds} Sekunden gesperrt',\n    insufficientFunds: 'Unzureichende Mittel',\n    serverLimitReached: 'Server-Limit erreicht',\n    errorjob: 'Fehler, Arbeit ist noch nicht verfügbar',\n    \n    // Tutorial\n    tutorialProgress: 'Tutorial-Fortschritt',\n    hideProgress: 'Fortschritt ausblenden',\n    tutorialCompleted: 'Tutorial abgeschlossen!',\n    tutorialCompletedDesc: 'Herzlichen Glückwunsch! Sie haben alle Spiel-Features freigeschaltet.',\n    completeTutorialUnlock: 'Tutorial abschließen und alle Features freischalten',\n    allFeaturesUnlocked: 'Alle Features freigeschaltet!',\n    tutorialCompletedTitle: 'Tutorial abgeschlossen!',\n    tutorialCompletedMessage: 'Herzlichen Glückwunsch! Sie haben alle Spiel-Features freigeschaltet.',\n    \n    // Interface states\n    start: 'Start',\n    inProgress: 'In Bearbeitung',\n    completed: 'Abgeschlossen',\n    active: 'Aktiv',\n    available: 'Verfügbar',\n    unavailable: 'Nicht verfügbar',\n    locked: 'Gesperrt',\n    unlocked: 'Entsperrt',\n    online: 'Online',\n    offline: 'Offline',\n    \n    // Jobs and actions\n    tutorialJobs: 'Fernarbeit',\n    startJob: 'Job starten',\n    completeJob: 'Job abschließen',\n    availableIn: 'Verfügbar in',\n    earnMoney: '{amount} verdienen',\n    cooldownTime: 'Abklingzeit: {time}',\n    jobStarted: 'Auftrag erledigt',\n    jobStartedDesc: '{JobName} ist erledigt! Du hast {reward} verdient.',\n    \n    // Job types\n    serverMaintenance: 'Server-Wartung',\n    performanceOptimization: 'Leistungsoptimierung',\n    securityAudit: 'Sicherheitsaudit',\n    \n    // Tutorial tips\n    tutorialTips: 'Tutorial-Tipps',\n    tipCompleteJobs: 'Mit Minispielen können Sie Erfahrungen sammeln',\n    tipJobCooldown: 'Um die Bewertung zu öffnen und in sie einzusteigen, benötigen Sie mindestens Stufe 5',\n    tipEarnToUnlock: 'Wenn Sie eine Frage haben oder einen Fehler gefunden haben - gehen Sie auf die Registerkarte \"Bericht\"',\n    tipPurchaseServers: \"Kaufen Sie Server für passives Einkommen, vergessen Sie nicht, sie im Auge zu behalten\",\n    tipTakeCourses: 'Nehmen Sie an Schulungen teil, um mehr Serverplätze und mehr freizuschalten',\n    browseServerStore: 'Server Shop durchsuchen',\n    browseLearningCourses: 'Lernkurse durchsuchen',\n    \n    // Activities\n    recentActivities: 'Kürzliche Aktivitäten',\n    \n    // Server management\n    purchaseServer: 'Server kaufen',\n    deleteServer: 'Server löschen',\n    toggleServer: 'Server umschalten',\n    noServersYet: 'Noch keine Server',\n    addNewServer: 'Einen neuen Server hinzufügen',\n    availableServerSlots: 'Sie haben einen {availableSlots} Serverplatz zur Verfügung. Besuchen Sie den Serverladen, um neue Server zu kaufen.',\n    purchaseServersFromStore: 'Kaufen Sie Server im Shop, um mit dem Hosting zu beginnen und passives Einkommen zu erzielen!',\n    visitServerStore: 'Server Shop besuchen',\n    serverSettings: 'Server-Einstellungen',\n    loadPercentage: 'Auslastung in Prozent',\n    currentLoad: 'Aktuelle Auslastung',\n    overloadRisk: 'Überlastungsrisiko',\n    low: 'Niedrig',\n    moderate: 'Mäßig',\n    high: 'Hoch',\n    veryHigh: 'Sehr hoch',\n    serverShutdownWarning: 'Hohe Auslastung erhöht das Abschaltungsrisiko',\n    rentalCost: 'Mietkosten/min',\n    \n    // Server products\n    basicWebServer: 'Basic Web Server',\n    highPerformanceServer: 'Hochleistungsserver',\n    databaseServer: 'Datenbankserver',\n    cdnServer: 'CDN Server',\n    webHosting: 'Web-Hosting',\n    gamingApps: 'Gaming/Apps',\n    storage: 'Speicher',\n    contentDelivery: 'Content Delivery',\n    \n    // Learning courses\n    basicServerSetup: 'Grundlegende Server-Einrichtung',\n    advancedServerManagement: 'Erweiterte Server-Verwaltung',\n    securityProtocols: 'Sicherheitsprotokolle',\n    beginner: 'Anfänger',\n    intermediate: 'Fortgeschritten',\n    advanced: 'Experte',\n    coursesGenitive: 'kurse',\n    \n    // Quest system\n    dailyQuests: 'Tägliche Aufgaben',\n    achievements: 'Erfolge',\n    achievementsList: {\n      'first-steps': {\n        title: \"Erste Schritte\",\n        description: \"Erledigen Sie Ihren ersten Auftrag\",\n      },\n      'first-server': {\n        title: \"Erster Server\",\n        description: \"Kaufen Sie Ihren ersten Server\",\n      },\n      'server-collection': {\n        title: \"Server-Sammler\",\n        description: \"5 Server gleichzeitig besitzen\",\n      },\n      'millionaire': {\n        title: \"Millionär\",\n        description: \"1.000.000 $ Guthaben anhäufen\",\n      },\n      'job-master': {\n        title: \"Job Master\",\n        description: \"100 Jobs erledigen\",\n      },\n      'learning-enthusiast': {\n        title: \"Lernbegeisterter\",\n        description: \"Alle Lernkurse abschließen\",\n      },\n      'early-earner': {\n        title: \"Frühverdiener\",\n        description: \"Alle Lernkurse abschließen\",\n      },\n      'efficient-worker': {\n        title: \"Effizienter Arbeiter\",\n        description: \"10 Jobs abschließen\",\n      },\n      'server-builder': {\n        title: \"Server Builder\",\n        description: \"Besitze 3 verschiedene Servertypen\",\n      },\n      'security-expert': {\n        title: \"Sicherheitsexperte\",\n        description: \"Erledige 50 Sicherheitsprüfungsaufträge\",\n      },\n      'maintenance-guru': {\n        title: \"Wartungsguru\",\n        description: \"Erledige 75 Wartungsaufträge\",\n      },\n      'optimization-master': {\n        title: \"Optimierungsmeister\",\n        description: \"Erledige 60 Optimierungsaufträge\",\n      },\n      'wealthy-investor': {\n        title: \"Wohlhabender Investor\",\n        description: \"100.000 $ Guthaben anhäufen\",\n      },\n      'server-mogul': {\n        title: \"Server Mogul\",\n        description: \"10 Server gleichzeitig besitzen\",\n      },\n      'persistent-learner': {\n        title: \"Ausdauernder Lerner\",\n        description: \"3 Lernkurse abschließen\",\n      },\n      'speed-demon': {\n        title: \"Geschwindigkeitsdämon\",\n        description: \"Insgesamt 200 Jobs erledigen\",\n      },\n      'infrastructure-king': {\n        title: \"Infrastrukturkönig\",\n        description: \"15 Server gleichzeitig besitzen\",\n      },\n      'multi-millionaire': {\n        title: \"Multi-Millionär\",\n        description: \"5.000.000 $ Guthaben anhäufen\",\n      },\n      'course-completionist': {\n        title: \"Kursabsolvent\",\n        description: \"Alle verfügbaren Lernkurse abschließen\",\n      },\n      'workaholic': {\n        title: \"Workaholic\",\n        description: \"Insgesamt 500 Jobs abschließen\",\n      },\n      'server-empire': {\n        title: \"Server-Imperium\",\n        description: \"20 Server gleichzeitig besitzen\",\n      },\n      'financial-titan': {\n        title: \"Finanz-Titan\",\n        description: \"10.000.000 $ Guthaben anhäufen\",\n      },\n      'legendary-worker': {\n        title: \"Legendärer Arbeiter\",\n        description: \"Insgesamt 1000 Jobs erledigen\",\n      },\n      'server-overlord': {\n        title: \"Server-Overlord\",\n        description: \"30 Server gleichzeitig besitzen\",\n      },\n      'billionaire-club': {\n        title: \"Billionaire Club\",\n        description: \"100.000.000 $ Guthaben anhäufen\",\n      },\n      'ultimate-legend': {\n        title: \"Ultimative Legende\",\n        description: \"Insgesamt 2500 Jobs erledigen\",\n      }\n    },\n    rankings: 'Rangliste',\n    claimReward: 'Belohnung einfordern',\n    rewardClaimed: 'Belohnung erhalten',\n    questCompleted: 'Aufgabe abgeschlossen',\n    reward: 'Belohnung',\n    progress: 'Fortschritt',\n    claiming: 'Einfordern...',\n    \n    // Daily quests\n    dailyQuestsList: {\n      'daily-maintenance': {\n        title: 'Tägliche Wartung',\n        description: 'Führen Sie 3 Server-Wartungsaufgaben arbeit'\n      },\n      'daily-income': {\n        title: 'Passives Einkommen',\n        description: 'Verdienen Sie $5.000 aus Server-Einkommen'\n      },\n      'daily-optimization': {\n        title: 'Server-Optimierung',\n        description: 'Führen Sie 2 Leistungsoptimierungs-Aufgaben arbeit'\n      },\n      'daily-security': {\n        title: 'Sicherheitsprüfung',\n        description: 'Führen Sie 1 Sicherheitsaudit-Aufgabe arbeit'\n      },\n      'daily-earnings': {\n        title: 'Tägliche Einnahmen',\n        description: 'Verdienen Sie $10.000 aus Server-Einkommen'\n      },\n      'daily-worker': {\n        title: 'Fleißiger Arbeiter',\n        description: 'Führen Sie 5 Aufgaben beliebigen Typs arbeit'\n      },\n      'daily-mixed-jobs': {\n        title: 'Gemischte Aufgaben',\n        description: 'Führen Sie 2 Wartungs- und 1 Optimierungsaufgabe arbeit'\n      },\n      'daily-income-boost': {\n        title: 'Einkommens-Boost',\n        description: 'Verdienen Sie $20.000 aus Server-Einkommen'\n      },\n      'daily-job-spree': {\n        title: 'Aufgaben-Serie',\n        description: 'Führen Sie 8 Aufgaben beliebigen Typs arbeit'\n      },\n      'daily-mega-earner': {\n        title: 'Mega-Verdiener',\n        description: 'Verdienen Sie $50.000 aus Server-Einkommen'\n      }\n    },\n    \n    // Admin panel\n    adminManagement: 'Admin-Verwaltung',\n    selectUser: 'Benutzer auswählen',\n    chooseUser: 'Benutzer auswählen',\n    action: 'Aktion',\n    chooseAction: 'Aktion auswählen',\n    executeAction: 'Aktion ausführen',\n    giveAdmin: 'Admin geben',\n    removeAdmin: 'Admin entfernen',\n    banUser: 'Benutzer bannen',\n    unbanUser: 'Benutzer entbannen',\n    totalUsers: 'Gesamtbenutzer',\n    onlineUsers: 'Online-Benutzer',\n    totalAdmins: 'Gesamt-Admins',\n    userList: 'Benutzerliste',\n    superAdminPanel: 'Super-Admin-Panel',\n    adminPanel: 'Admin-Panel',\n    pleaseSelectUserAndAction: 'Bitte wählen Sie Benutzer und Aktion aus',\n    pleaseEnterValidAmount: 'Bitte geben Sie einen gültigen Betrag ein',\n    actionSuccessfullyCompleted: 'Aktion \"{action}\" erfolgreich ausgeführt',\n    \n    // Chat system\n    generalChat: 'Allgemeiner Chat',\n    muteUser: 'Benutzer stummschalten',\n    unmute: 'Stummschaltung aufheben',\n    playerManagement: 'Spielerverwaltung',\n    enterMessage: 'Nachricht eingeben...',\n    usefulTips: 'Nützliche Tipps',\n    chatRules: 'Chat-Regeln',\n    chatRule1: 'Kein Spamming oder Flooding - keine Großbuchstaben, keine identischen Nachrichten, keine sinnlosen Zeichen.',\n    chatRule2: 'Respektiere andere Spieler - keine Beleidigungen, Provokationen und Diskriminierungen.',\n    chatRule3: 'Keine matte und beleidigende Sprache - der Filter kann solche Wörter automatisch blockieren..',\n    chatRule4: 'Werbung und Links zu fremden Ressourcen sind verboten.',\n    chatRule5: 'Die Administration hat immer das letzte Wort - Entscheidungen der Moderatoren werden nur zur Unterstützung diskutiert.',\n    giveMoney: 'Geld geben',\n    takeMoney: 'Geld nehmen',\n    deleteUser: 'Benutzerkonto löschen',\n    amount: 'Betrag',\n    enterAmount: 'Betrag eingeben',\n    youAreMuted: 'Sie sind stummgeschaltet und können keine Nachrichten senden',\n    noMessages: 'Keine Nachrichten. Starten Sie ein Gespräch!',\n    messageDeleted: 'Nachricht gelöscht',\n    messageDeletedBy: 'Nachricht gelöscht von Administrator {admin}',\n    selectMuteDuration: '5m',\n    mute: 'Stumm',\n    activeMutes: 'Aktive Stummschaltungen',\n    \n    // Profile and level system\n    progressToLevel: 'Fortschritt zu Level',\n    registrationdate: 'Datum der Registrierung: ',\n    xpNeeded: 'XP benötigt',\n    totalEarnings: 'Gesamteinnahmen',\n    totalSpent: 'Gesamt ausgegeben',\n    netProfit: 'Nettogewinn',\n    jobsCompleted: 'Jobs abgeschlossen',\n    coursesCompleted: 'Kurse abgeschlossen',\n    achievement: 'Erfolg',\n    noAchievementsYet: 'Noch keine Erfolge',\n    earnAchievementsDesc: 'Schließen Sie Jobs ab und erreichen Sie Meilensteine, um Erfolge zu erhalten!',\n    currentBalance: 'Aktuelles Guthaben',\n    levelUp: 'Level aufgestiegen!',\n    levelUpCongrats: 'Herzlichen Glückwunsch! Sie haben erreicht',\n    levelUpCongrats3: 'Level',\n    levelUpCongrats2: 'Um das Fenster zu schließen, klicken Sie irgendwo',\n    newAbilitiesUnlocked: 'Neue Fähigkeiten freigeschaltet!',\n    \n    // Tooltips and hints\n    profileTooltip: 'Klicken Sie auf Ihren Avatar, um Fortschritt und andere interessante Informationen zu sehen',\n    nicknameTooltip: 'Klicken Sie auf Ihren oder einen anderen Nickname, um das Profil anzuzeigen',\n    adminControlsInfo: 'Avatar-Tooltip: Klicken Sie auf Ihren Avatar, um Fortschritt und andere interessante Informationen zu sehen',\n    \n    // Theme system\n    darkTheme: 'Zu dunklem Theme wechseln',\n    lightTheme: 'Zu hellem Theme wechseln',\n    \n    // Server durability system\n    serverRepaired: 'Server repariert',\n    serverRepairedDesc: 'Server repariert für ${cost}. Haltbarkeit wiederhergestellt: {durability}%',\n    repairFailed: 'Reparatur fehlgeschlagen',\n    durability: 'Haltbarkeit',\n    serverCondition: 'Server-Zustand',\n    partialRepair: 'Teilreparatur',\n    fullRepair: 'Vollreparatur',\n    repairCostInfo: 'Reparaturkosten hängen vom Schädigungsgrad und Server-Einkommen ab',\n    serverStatusUpdated: 'Server-Status aktualisiert',\n    serverStatusUpdatedDesc: 'Der Server-Status wurde erfolgreich geändert.',\n    maintenanceRequired: 'Server benötigt Wartung, bevor er eingeschaltet werden kann',\n    \n    // Server deletion confirmations\n    deleteWarningTitle: '⚠️ WARNUNG! Möchten Sie wirklich Server \"{serverName}\" LÖSCHEN?',\n    deleteWarningMessage: 'Diese Aktion ist IRREVERSIBEL!\\nWenn Sie den Server nur ausschalten möchten, verwenden Sie die \"Ein/Aus\"-Taste anstatt zu löschen.',\n    deleteLastWarning: '🚨 LETZTE WARNUNG!\\nSind Sie sicher, dass Sie Server \"{serverName}\" PERMANENT löschen möchten?\\nGeben Sie \"LÖSCHEN\" ein, um zu bestätigen:',\n    deleteFinalConfirm: 'Geben Sie \"LÖSCHEN\" ein, um die Löschung von Server \"{serverName}\" endgültig zu bestätigen:',\n    deleteKeyword: 'LÖSCHEN',\n    serverDeleted: 'Server gelöscht',\n    serverDeletedDesc: 'Server \"{serverName}\" wurde erfolgreich gelöscht.',\n    deleteCancelled: 'Löschung abgebrochen',\n    deleteCancelledDesc: 'Server wurde NICHT gelöscht.',\n    deleteServerTooltip: '⚠️ SERVER PERMANENT LÖSCHEN (IRREVERSIBEL!)',\n    \n    // Common UI elements\n    close: 'Schließen',\n    cancel: 'Abbrechen',\n    confirm: 'Bestätigen',\n    save: 'Speichern',\n    edit: 'Bearbeiten',\n    delete: 'Löschen',\n    add: 'Hinzufügen',\n    remove: 'Entfernen',\n    update: 'Aktualisieren',\n    refresh: 'Aktualisieren',\n    loading: 'Laden...',\n    success: 'Erfolg',\n    error: 'Fehler',\n    \n    // Time formats\n    minutes: ' Min.',\n    hours: ' St.',\n    seconds: ' Sek.',\n    secondsShort: 'Sek',\n    until: 'bis',\n    reset: 'zurücksetzen',\n    resetAvailable: 'Zurücksetzen verfügbar',\n    progressLabel: 'Fortschritt',\n    earnedLabel: 'Verdient',\n    completedTasks: 'Aufgaben',\n    \n    // Additional UI strings\n    serverLimitNotice: 'Server-Limit-Hinweis',\n    serverLimitWarning: 'Sie verwenden {currentServers} von {serverLimit} verfügbaren Server-Slots. Absolvieren Sie Lernkurse, um Ihr Limit zu erhöhen!',\n    requiresLevel: 'Benötigt Level {level}',\n    purchaseFirstServer: 'Kaufen Sie Ihren ersten Server aus dem Server-Shop, um Einkommen zu erzielen.',\n    serverPurchased: 'Server gekauft',\n    purchaseFailed: 'Kauf fehlgeschlagen',\n    reachedServerLimit: 'Sie haben Ihr Server-Limit von {serverLimit} erreicht. Absolvieren Sie Lernkurse, um mehr Slots freizuschalten!',\n    completeLearningCoursesToIncrease: 'Absolvieren Sie Lernkurse, um Ihr Server-Limit zu erhöhen',\n    \n    // Learning Center specific translations\n    learningBenefits: 'Lernvorteile',\n    moreServers: 'Mehr Server',\n    unlockAdditionalServerSlots: 'Schalten Sie zusätzliche Server-Slots frei',\n    higherEfficiency: 'Höhere Effizienz',\n    increaseServerIncomeRates: 'Erhöhen Sie die Server-Einnahmeraten',\n    betterRankings: 'Bessere Rankings',\n    climbTheLeaderboards: 'Steigen Sie in den Bestenlisten auf',\n    \n    // Learning tab specific\n    unknownReward: 'Unbekannte Belohnung',\n    serverSlotReward: '+{amount} Server-Slot{plural}',\n    serverEfficiencyReward: '+{amount}% Server-Effizienz',\n    unlockServerReward: 'Schaltet {serverType} frei',\n    gpuServer: 'GPU-Server',\n    tpuServer: 'TPU-Server', \n    specialServer: 'Spezial-Server',\n    learningInProgressError: 'Lernen läuft',\n    oneCourseAtTime: 'Sie können nur einen Kurs gleichzeitig belegen. Bitte warten Sie, bis der aktuelle Kurs abgeschlossen ist.',\n    needMoneyForCourse: 'Sie benötigen {amount}, um diesen Kurs zu starten.',\n    courseStarted: 'Kurs gestartet',\n    courseStartedDesc: 'Sie haben den Kurs {courseTitle} gestartet. Überprüfen Sie Ihren Fortschritt im Server-Tab!',\n    failedToStartCourse: 'Kurs konnte nicht gestartet werden',\n    currentCourse: 'Aktueller Kurs',\n    availableCourses: 'Verfügbare Kurse',\n    duration: 'Dauer',\n    requiresLevelX: 'Benötigt Level {level}',\n    startCourse: 'Kurs starten',\n    needMoreForCourse: 'Benötigen Sie noch {amount}',\n    completeCurrentFirst: 'Beenden Sie zuerst den aktuellen Kurs',\n    \n    // Player profile\n    loadingPlayerProfile: 'Spielerprofil wird geladen...',\n    playerNotFound: 'Spieler nicht gefunden',\n    playerNotFoundDesc: 'Der Spieler \"{nickname}\" existiert nicht oder das Profil ist privat.',\n    goBack: 'Zurück',\n    back: 'Zurück',\n    playerProfile: 'Spielerprofil',\n    activeServers: 'Aktive Server',\n    globalRank: 'Globaler Rang',\n    recentActivity: 'Kürzliche Aktivität',\n    turnOnOff: 'Ein/Aus',\n    \n    // Reports system\n    reports: 'Berichte',\n    createNewReport: 'Neuen Bericht erstellen',\n    reportSubject: 'Betreff des Berichts',\n    reportCategory: 'Berichtskategorie',\n    initialMessage: 'Erste Nachricht',\n    general: 'Allgemeines',\n    technical: 'Technisches',\n    createReport: 'Bericht erstellen',\n    reportSent: 'Bericht gesendet',\n    reportSentDescription: 'Ihr Bericht wurde erfolgreich gesendet.',\n    reportClosed: 'Bericht geschlossen',\n    reportClosedDescription: 'Bericht wurde erfolgreich geschlossen.',\n    reportDeleted: 'Bericht gelöscht',\n    reportDeletedDescription: 'Bericht wurde erfolgreich gelöscht.',\n    reportMarked: 'Markierter Bericht',\n    reportUnmarked: 'Unmarkierter Bericht',\n    closeReport: 'Bericht schließen',\n    markReport: 'Bericht markieren',\n    deleteReport: 'Bericht löschen',\n    sendMessage: 'Nachricht senden',\n    typeMessage: 'Nachricht...',\n    noReports: 'Noch keine Berichte',\n    createFirstReport: 'Erstellen Sie Ihren ersten Bericht über die Schaltfläche oben.',\n    reportStatus: 'Status',\n    reportCreated: 'Erstellt',\n    reportClosed: 'Abgeschlossen',\n    reportMarked: 'Markiert',\n    fillAllFields: 'Bitte füllen Sie alle erforderlichen Felder aus',\n    subjectTooLong: 'Der Betreff darf nicht länger als 50 Zeichen sein',\n    messageTooLong: 'Die Nachricht darf nicht länger als 500 Zeichen sein',\n    characters: 'Zeichen',\n    reportType: 'Berichtstyp',\n    reportTypeFeature: 'Funktionsanfrage',\n    reportTypeComplaint: 'Beschwerde',\n    reportTypeOther: 'Sonstiges',\n    reportMessage: 'Bericht',\n    submitReport: 'Einen Bericht einreichen',\n    \n    // Reports reopen functionality\n    reopenChat: 'Chat wiedereröffnen',\n    reportReopened: 'Bericht wiedereröffnet',\n    reportReopenedDescription: 'Bericht wurde erfolgreich für weitere Kommunikation wiedereröffnet',\n    chatClosedByAdmin: 'Chat vom Administrator geschlossen',\n    \n    // Additional reports translations\n    myReports: 'Meine Berichte',\n    incomingReports: 'Eingehende Berichte',\n    newTicket: 'Neues Ticket',\n    createNewTicket: 'Neues Ticket erstellen',\n    subject: 'Betreff',\n    category: 'Kategorie',\n    description: 'Beschreibung',\n    selectCategory: 'Kategorie auswählen',\n    reportTypeBug: 'Bug oder sonstiger Fehler',\n    otherIssue: 'Sonstiges',\n    featureIssue: 'Feature-Anfrage',\n    reportTypeComplaint: 'Reklamation',\n    generalIssue: 'Allgemeines Problem',\n    technicalIssue: 'Technisches Problem',\n    startChat: 'Chat starten',\n    sending: 'Senden...',\n    activeReportExists: 'Sie haben bereits einen aktiven Bericht. Bitte warten Sie auf die Antwort des Administrators.',\n    noIncomingReports: 'Keine eingehenden Berichte',\n    selectReportToView: 'Wählen Sie einen Bericht aus, um die Konversation anzuzeigen',\n    closeChat: 'Chat schließen',\n    deleteChat: 'Chat löschen',\n    markChat: 'Chat markieren',\n    unmarkChat: 'Chat entmarkieren',\n    admin: 'Admin',\n    open: 'Öffnen',\n    closed: 'Geschlossen',\n\n    // Mini-Spiele Übersetzungen\n    miniGames: 'Mini-Spiele',\n    miniGamesDesc: 'Testen Sie Ihre Fähigkeiten in unterhaltsamen Mini-Spielen und verdienen Sie XP!',\n    minigame1: 'DDoS-Schutz',\n    minigame1Desc: 'Verteidigen Sie Ihre Server vor eingehenden Paketangriffen',\n    minigame2: 'Firewall-Filter',\n    minigame2Desc: 'Erlauben Sie legitime Anfragen und blockieren Sie schädliche',\n    requests: 'antworten',\n    howToPlay: 'Wie man spielt',\n    ddosInstructions: 'Klicken Sie auf die roten Pakete, um sie zu zerstören, bevor sie Ihren Server erreichen. Die Geschwindigkeit steigt mit der Zeit! Für jede Zerstörung +1 Erfahrung.',\n    firewallInstructions: 'Überprüfen Sie jede Anfrage und wählen Sie sichere Anfragen zulassen oder gefährliche blockieren. Seien Sie schnell und genau! Für jede richtige Antwort gibt es +1 Erfahrung.',\n    gameCompleted: 'Spiel abgeschlossen!',\n    earnedXP: 'Sie haben {amount} XP verdient!',\n    packetsDestroyed: 'Pakete zerstört',\n    correct: 'Richtig',\n    correct2: 'rechts',\n    packet: 'Paket',\n    wrong: 'Falsch',\n    score: 'Punktzahl',\n    timeLeft: 'Zeit übrig',\n    requestsLeft: 'Anfragen übrig',\n    blockOrAllow: 'Blockieren Sie gefährliche Anfragen oder erlauben Sie sichere',\n    block: 'Blockieren',\n    allow: 'Erlauben',\n    yourServer: 'Ihr Server',\n    medium: 'Mittel',\n    \n    // Spenden Übersetzungen\n    donate: 'Spenden',\n    donateDesc: 'Unterstützen Sie die Spielentwicklung und erhalten Sie exklusive Vorteile!',\n    donate1: 'Starter-Paket',\n    donate1Desc: 'Beginnen Sie mit grundlegenden Vorteilen',\n    donate2: 'Premium-Paket (Für immer)',\n    donate2Desc: 'Erweiterte Funktionen für ernsthafte Spieler',\n    donate3: 'Boost-Paket',\n    donate3Desc: 'Beschleunigen Sie Ihren Fortschritt erheblich',\n    donate4: 'Ultimate-Paket',\n    donate4Desc: 'Maximale Vorteile und exklusiver Inhalt',\n    donate5: 'Münz-Paket',\n    donate5Desc: 'Spielwährung für Käufe',\n    donate6: 'Spezial-Paket',\n    donate6Desc: 'Zeitlich begrenztes Angebot mit einzigartigen Belohnungen',\n    feature1: 'Zusätzliche Server-Slots',\n    feature2: 'Beschleunigte Lernkurse',\n    feature3: 'Bonus-Tagesbelohnungen',\n    feature4: 'VIP-Support-Priorität',\n    feature5: 'Exklusive Server-Typen',\n    feature6: 'Doppel-XP-Events',\n    feature7: 'Sofortige Server-Reparaturen',\n    feature8: 'Erweiterte Analytik',\n    feature9: 'Benutzerdefinierte Server-Themes',\n    feature10: 'Maximale Server-Kapazität',\n    feature11: 'Priorität Chat-Support',\n    feature12: 'Exklusive Errungenschaften',\n    feature13: '10.000 Spielmünzen',\n    feature14: 'Keine Transaktionsgebühren',\n    feature15: 'Münz-Bonus-Multiplikator',\n    feature16: 'Saisonale Belohnungen',\n    feature17: 'Früher Zugang zu Features',\n    feature18: 'Zugang zu Community-Events',\n    popular: 'Beliebt',\n    purchase: 'Kaufen',\n    confirmPurchase: 'Kauf bestätigen',\n    included: 'Inbegriffen',\n    paymentNotice: 'Zahlungsabwicklung',\n    paymentNoticeDesc: 'Dies ist eine Demo-Version. Echte Zahlungen werden nicht verarbeitet.',\n    buyNow: 'Jetzt kaufen',\n    purchaseNotAvailable: 'Kauf nicht verfügbar',\n    purchaseNotAvailableDesc: 'Dies ist eine Demo-Version. Zahlungsabwicklung ist nicht implementiert.',\n  }\n};\n\n// Function to localize error messages based on language\nexport function localizeError(error, language = 'en') {\n  const t = (key) => {\n    // Check new translations first\n    if (newTranslations[key] && newTranslations[key][language]) {\n      return newTranslations[key][language];\n    }\n    // Fall back to old translations - but first check if key exists in current language\n    if (translations[language] && translations[language][key]) {\n      return translations[language][key];\n    }\n    // Try English as fallback\n    if (translations.en && translations.en[key]) {\n      return translations.en[key];\n    }\n    // Return key if not found\n    return key;\n  };\n  \n  if (typeof error === 'string') {\n    return error;\n  }\n  \n  if (error?.message) {\n    // Map common error types to translation keys\n    const errorMap = {\n      'Not Found': 'errorNotFound',\n      'Server Error': 'errorServerError', \n      'Network Error': 'errorNetworkError',\n      'Access Denied': 'errorUnauthorized',\n      'Invalid Request': 'errorBadRequest',\n      'Insufficient funds': 'insufficientFunds',\n      'Server limit reached': 'serverLimitReached'\n    };\n    \n    return errorMap[error.message] ? t(errorMap[error.message]) : error.message;\n  }\n  \n  return t('errorGeneric');\n}\n\nconst LanguageContext = createContext();\n\nexport function LanguageProvider({ children }) {\n  const [language, setLanguage] = useState(() => {\n    return localStorage.getItem('game-language') || 'en';\n  });\n\n  const t = (key) => {\n    return translations[language]?.[key] || translations.en[key] || key;\n  };\n\n  const changeLanguage = (newLanguage) => {\n    setLanguage(newLanguage);\n    localStorage.setItem('game-language', newLanguage);\n  };\n\n  const value = {\n    language,\n    t,\n    changeLanguage,\n    localizeError: (error) => localizeError(error, language),\n  };\n\n  return (\n    <LanguageContext.Provider value={value}>\n      {children}\n    </LanguageContext.Provider>\n  );\n}\n\nexport function useLanguage() {\n  const context = useContext(LanguageContext);\n  if (!context) {\n    throw new Error('useLanguage must be used within a LanguageProvider');\n  }\n  return context;\n}","size_bytes":155314},"client/src/hooks/use-mobile.jsx":{"content":"import { useState, useEffect } from \"react\";\n\nconst MOBILE_BREAKPOINT = 768;\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = useState(undefined);\n\n  useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`);\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);\n    };\n    mql.addEventListener(\"change\", onChange);\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT);\n    return () => mql.removeEventListener(\"change\", onChange);\n  }, []);\n\n  return !!isMobile;\n}\n","size_bytes":556},"client/src/hooks/use-toast.js":{"content":"import { useState, useEffect } from \"react\";\n\nconst TOAST_LIMIT = 1;\nconst TOAST_REMOVE_DELAY = 5000;\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n};\n\nlet count = 0;\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER;\n  return count.toString();\n}\n\nconst toastTimeouts = new Map();\n\nconst addToRemoveQueue = (toastId) => {\n  if (toastTimeouts.has(toastId)) {\n    return;\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId);\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    });\n  }, TOAST_REMOVE_DELAY);\n\n  toastTimeouts.set(toastId, timeout);\n};\n\nexport const reducer = (state, action) => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      };\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      };\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action;\n\n      if (toastId) {\n        addToRemoveQueue(toastId);\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id);\n        });\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      };\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        };\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      };\n  }\n};\n\nconst listeners = [];\n\nlet memoryState = { toasts: [] };\n\nfunction dispatch(action) {\n  memoryState = reducer(memoryState, action);\n  listeners.forEach((listener) => {\n    listener(memoryState);\n  });\n}\n\nfunction toast({ duration = 5000, ...props }) {\n  const id = genId();\n\n  const update = (props) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    });\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id });\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss();\n      },\n    },\n  });\n\n  // Auto-dismiss after specified duration\n  if (duration > 0) {\n    setTimeout(() => {\n      dismiss();\n    }, duration);\n  }\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  };\n}\n\nfunction useToast() {\n  const [state, setState] = useState(memoryState);\n\n  useEffect(() => {\n    listeners.push(setState);\n    return () => {\n      const index = listeners.indexOf(setState);\n      if (index > -1) {\n        listeners.splice(index, 1);\n      }\n    };\n  }, [state]);\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  };\n}\n\nexport { useToast, toast };\n","size_bytes":3100},"client/src/lib/constants.js":{"content":"export const TUTORIAL_UNLOCK_THRESHOLD = 15000;\n\nexport const SERVER_PRODUCTS = [\n  {\n    id: 'basic-web',\n    name: 'Basic Web Server',\n    type: 'Web Hosting',\n    price: 5000,\n    incomePerMinute: 15,\n    monthlyCost: 45,\n    icon: 'fas fa-globe',\n    requiredLevel: 1\n  },\n  {\n    id: 'database-server',\n    name: 'Database Server',\n    type: 'Storage',\n    price: 9000,\n    incomePerMinute: 25,\n    monthlyCost: 85,\n    icon: 'fas fa-database',\n    requiredLevel: 4\n  },\n  {\n    id: 'high-performance',\n    name: 'High Performance Server',\n    type: 'Gaming/Apps',\n    price: 12000,\n    incomePerMinute: 50,\n    monthlyCost: 120,\n    icon: 'fas fa-server',\n    requiredLevel: 8\n  },\n  {\n    id: 'cdn-server',\n    name: 'CDN Server',\n    type: 'Content Delivery',\n    price: 17000,\n    incomePerMinute: 100,\n    monthlyCost: 180,\n    icon: 'fas fa-cloud',\n    requiredLevel: 12\n  },\n  {\n    id: 'gpu-server',\n    name: 'GPU Server',\n    type: 'AI',\n    price: 30000,\n    incomePerMinute: 150,\n    monthlyCost: 250,\n    icon: 'fas fa-microchip',\n    requiredLevel: 25,\n    requiredLearning: 'ai-gpu-settings'\n  },\n  {\n    id: 'tpu-server',\n    name: 'TPU Server',\n    type: 'Computing',\n    price: 50000,\n    incomePerMinute: 200,\n    monthlyCost: 350,\n    icon: 'fas fa-brain',\n    requiredLevel: 45,\n    requiredLearning: 'tpu-settings-machine'\n  }\n];\n\nexport const LEARNING_COURSES = [\n  {\n    id: 'basic-setup',\n    title: 'Basic Server Setup',\n    description: 'Learn the fundamentals of server configuration and deployment',\n    difficulty: 'Beginner',\n    duration: 30 * 60 * 1000, // 30 minutes in milliseconds\n    reward: { type: 'serverSlots', amount: 1 },\n    price: 3500,\n    requiredLevel: 1\n  },\n  {\n    id: 'advanced-management',\n    title: 'Advanced Server Management',\n    description: 'Master advanced server optimization and scaling techniques',\n    difficulty: 'Advanced',\n    duration: 90 * 60 * 1000, // 2 hours in milliseconds\n    reward: { type: 'serverSlots', amount: 2 },\n    price: 8000,\n    requiredLevel: 5\n  },\n  {\n    id: 'security-protocols',\n    title: 'Security Protocols',\n    description: 'Implement robust security measures for your server infrastructure',\n    difficulty: 'Intermediate',\n    duration: 120 * 60 * 1000, // 1.5 hours in milliseconds\n    reward: { type: 'efficiency', amount: 15 },\n    price: 10000,\n    requiredLevel: 12\n  },\n  {\n    id: 'ai-gpu-settings',\n    title: 'AI GPU Settings',\n    description: 'Master GPU configuration for AI workloads and machine learning tasks',\n    difficulty: 'Expert',\n    duration: 4 * 60 * 60 * 1000, // 4 hours in milliseconds\n    reward: { type: 'serverUnlock', serverType: 'gpu-server' },\n    price: 20000,\n    requiredLevel: 25\n  },\n  {\n    id: 'tpu-settings-machine',\n    title: 'TPU Settings Machine',\n    description: 'Advanced TPU configuration for high-performance computing and neural networks',\n    difficulty: 'Master',\n    duration: 6 * 60 * 60 * 1000, // 6 hours in milliseconds\n    reward: { type: 'serverUnlock', serverType: 'tpu-server' },\n    price: 40000,\n    requiredLevel: 45\n  }\n];\n\nexport const JOB_TYPES = [\n  {\n    id: 'maintenance',\n    name: 'Server Maintenance',\n    reward: 150,\n    cooldown: 180000, // 5 minutes\n    icon: 'fas fa-wrench'\n  },\n  {\n    id: 'optimization',\n    name: 'Performance Optimization',\n    reward: 250,\n    cooldown: 300000, // 7.5 minutes\n    icon: 'fas fa-tachometer-alt'\n  },\n  {\n    id: 'security-audit',\n    name: 'Security Audit',\n    reward: 500,\n    cooldown: 420000, // 10 minutes\n    icon: 'fas fa-shield-alt'\n  }\n];\n\nexport const formatCurrency = (amount, compact = false) => {\n  if (!amount && amount !== 0) return '$0';\n  \n  if (compact && amount >= 1000) {\n    if (amount >= 1000000000) {\n      return '$' + (amount / 1000000000).toFixed(1) + 'B';\n    }\n    if (amount >= 1000000) {\n      return '$' + (amount / 1000000).toFixed(1) + 'M';\n    }\n    if (amount >= 1000) {\n      return '$' + (amount / 1000).toFixed(1) + 'K';\n    }\n  }\n  \n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  }).format(amount);\n};\n\nexport const formatTime = (milliseconds) => {\n  const seconds = Math.floor(milliseconds / 1000);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n  \n  if (hours > 0) {\n    return `${hours}h ${minutes % 60}m`;\n  } else if (minutes > 0) {\n    return `${minutes}m ${seconds % 60}s`;\n  } else {\n    return `${seconds}s`;\n  }\n};\n","size_bytes":4528},"client/src/lib/queryClient.js":{"content":"import { QueryClient } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    \n    // Create localized error message based on status code\n    let localizedError = '';\n    switch (res.status) {\n      case 400:\n        localizedError = 'errorBadRequest';\n        break;\n      case 401:\n        localizedError = 'errorUnauthorized';\n        break;\n      case 404:\n        localizedError = 'errorNotFound';\n        break;\n      case 500:\n        localizedError = 'errorServerError';\n        break;\n      default:\n        localizedError = 'errorGeneric';\n    }\n    \n    const error = new Error(`${res.status}: ${text}`);\n    error.localizedKey = localizedError;\n    error.statusCode = res.status;\n    throw error;\n  }\n}\n\nexport async function apiRequest(url, methodOrOptions = 'GET', data = null) {\n  let options;\n  \n  // Support both old format (url, options) and new format (url, method, data)\n  if (typeof methodOrOptions === 'string') {\n    // New format: apiRequest(url, method, data)\n    options = {\n      method: methodOrOptions,\n      headers: data ? { \"Content-Type\": \"application/json\" } : {},\n      credentials: \"include\",\n    };\n    \n    if (data) {\n      options.body = JSON.stringify(data);\n    }\n  } else {\n    // Old format: apiRequest(url, options)\n    options = {\n      headers: methodOrOptions.body ? { \"Content-Type\": \"application/json\" } : {},\n      credentials: \"include\",\n      ...methodOrOptions,\n    };\n  }\n\n  const res = await fetch(url, options);\n\n  await throwIfResNotOk(res);\n  return res.json();\n}\n\nexport const getQueryFn = ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\"), {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":2257},"client/src/lib/utils.js":{"content":"import { clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\n\nexport function cn(...inputs) {\n  return twMerge(clsx(inputs));\n}\n","size_bytes":138},"client/src/pages/dashboard.jsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { Lock } from 'lucide-react';\nimport { StatusBar } from '@/components/status-bar';\nimport { AdminPanel } from '@/components/admin-panel';\nimport VirtualAssistant from '@/components/virtual-assistant';\nimport { TutorialTab } from '@/components/tutorial-tab';\nimport { ServersTab } from '@/components/servers-tab';\nimport { HostingTab } from '@/components/hosting-tab';\nimport { LearningTab } from '@/components/learning-tab';\nimport { AchievementsTab } from '@/components/achievements-tab';\nimport { QuestsTab } from '@/components/quests-tab';\nimport MiniGamesTab from '@/components/minigames-tab';\nimport DonateTab from '@/components/donate-tab';\nimport { ReportsTab } from '@/components/reports-tab';\nimport { DailyBonusNotification } from '@/components/daily-bonus-notification';\nimport TutorialSystem from '@/components/tutorial-system';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { PlayerRankings, RankingsCountdown } from '@/components/player-rankings';\nimport { RankingsPopup } from '@/components/rankings-popup';\nimport { PlayerProfileBar } from '@/components/player-profile-bar';\nimport { LevelUpNotification } from '@/components/level-up-notification';\nimport SubscriptionStatusIcon from '@/components/subscription-status-icon';\nimport { ThemeToggle } from '@/components/theme-toggle';\nimport SubscriptionBadge from '@/components/subscription-badge';\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\nimport { TUTORIAL_UNLOCK_THRESHOLD, formatCurrency } from '@/lib/constants';\nimport { useQuery } from '@tanstack/react-query';\nimport { useRoute, useLocation } from 'wouter';\nimport { ShoppingCart, Server, Play, BookOpenText, Award, ClipboardList, Gamepad2, CreditCard, Bug, AlignJustify, Gift, Eye } from 'lucide-react';\n\nexport default function DashboardPage() {\n  const { gameState } = useGame();\n  const { t } = useLanguage();\n  const [, params] = useRoute('/game/:tab?');\n  const [, setLocation] = useLocation();\n  const [activeTab, setActiveTab] = useState(() => {\n    // Initialize from URL params or localStorage\n    if (params?.tab) return params.tab;\n    const lastTab = localStorage.getItem('lastGameTab');\n    if (lastTab && lastTab !== 'null') return lastTab;\n    return 'tutorial';\n  });\n  const [profileOpen, setProfileOpen] = useState(false);\n  const [levelUpNotification, setLevelUpNotification] = useState({ isOpen: false, level: null });\n\n  // Update active tab from URL parameter\n  useEffect(() => {\n    if (params?.tab && params.tab !== activeTab) {\n      setActiveTab(params.tab);\n    } else if (!params?.tab && activeTab !== 'tutorial') {\n      setLocation(`/game/${activeTab}`);\n    }\n  }, [params?.tab, activeTab, setLocation]);\n\n  // Tab change handler that updates URL and saves to localStorage\n  const handleTabChange = (tab) => {\n    setActiveTab(tab);\n    setLocation(`/game/${tab}`);\n    localStorage.setItem('lastGameTab', tab);\n  };\n\n  const [now, setNow] = useState(Date.now());\n\nuseEffect(() => {\n  const interval = setInterval(() => setNow(Date.now()), 5000);\n  return () => clearInterval(interval);\n}, []);\n\nconst ONE_DAY = 24 * 60 * 60 * 1000;\n\nconst hideAfter24h = now - gameState.user.registrationTime >= ONE_DAY;\n\n  const isTabUnlocked = (tab) => {\n    if (tab === 'tutorial' || tab === 'quests' || tab === 'minigames' || tab === 'donate' || tab === 'reports') return true;\n    // Require tutorial completion for servers, hosting, learning, and achievements tabs\n    return gameState.user && gameState.user.tutorialCompleted;\n  };\n\n  // Check for new notifications\n  const { data: reportsData } = useQuery({\n    queryKey: ['/api/reports'],\n    enabled: !!gameState.user && isTabUnlocked('reports'),\n    refetchInterval: 5000\n  });\n\n  const { data: questsData } = useQuery({\n    queryKey: ['/api/quests'],\n    enabled: !!gameState.user && isTabUnlocked('quests'),\n    refetchInterval: 5000\n  });\n\n  // Check if there are unread report messages\n  const hasUnreadReports = Array.isArray(reportsData) ? \n    reportsData.some(report => report.hasNewMessages && (gameState.user?.admin >= 1 || report.userId === gameState.user?.id)) :\n    false;\n\n  // Check if there are completed quests that can be claimed\n  const hasCompletedQuests = questsData?.quests?.some(quest => quest.completed && !quest.claimed) || false;\n\n  const getTabContent = () => {\n    switch (activeTab) {\n      case 'tutorial': return <TutorialTab gameState={gameState} setActiveTab={handleTabChange} />;\n      case 'servers': return <ServersTab onTabChange={handleTabChange} />;\n      case 'hosting': return <HostingTab onTabChange={handleTabChange} />;\n      case 'learning': return <LearningTab />;\n      case 'achievements': return <AchievementsTab />;\n      case 'quests': return <QuestsTab />;\n      case 'minigames': return <MiniGamesTab />;\n      case 'donate': return <DonateTab />;\n      case 'reports': return <ReportsTab />;\n      default: return <TutorialTab gameState={gameState} setActiveTab={handleTabChange} />;\n    }\n  };\n\n  // Listen for profile open events and level up notifications\n  useEffect(() => {\n    const handleOpenProfile = () => setProfileOpen(true);\n    const handleLevelUp = (event) => {\n      setLevelUpNotification({ isOpen: true, level: event.detail.level });\n    };\n    \n    window.addEventListener('openProfile', handleOpenProfile);\n    window.addEventListener('levelUp', handleLevelUp);\n    \n    return () => {\n      window.removeEventListener('openProfile', handleOpenProfile);\n      window.removeEventListener('levelUp', handleLevelUp);\n    };\n  }, []);\n\n  if (!gameState.user) return null;\n\n  const progressPercentage = Math.min((gameState.user.balance / TUTORIAL_UNLOCK_THRESHOLD) * 100, 100);\n\n  return (\n    <div className=\"min-h-screen relative bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900\">\n      {/* Enhanced background effects */}\n      <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0dGVybiBpZD0iZ3JpZCIgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBwYXR0ZXJuVW5pdHM9InVzZXJTcGFjZU9uVXNlIj48cGF0aCBkPSJNIDYwIDAgTCAwIDAgMCA2MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZ2JhKDk5LCAxMDIsIDI0MSwgMC4wNSkiIHN0cm9rZS13aWR0aD0iMSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNncmlkKSIvPjwvc3ZnPg==')] opacity-30\" />\n      <div className=\"absolute top-10 right-10 w-32 h-32 bg-blue-500/10 rounded-full blur-2xl animate-pulse\" />\n      <div className=\"absolute bottom-20 left-20 w-48 h-48 bg-purple-500/10 rounded-full blur-3xl animate-pulse\" style={{ animationDelay: '1s' }} />\n      \n      <div className=\"relative z-0\">\n        <StatusBar />\n        \n\n      \n      <div className=\"flex flex-col lg:flex-row h-[calc(100vh-80px)]\">\n        {/* Mobile Navigation */}\n        <div className=\"lg:hidden bg-slate-800/50 backdrop-blur-sm border-b border-slate-700 p-2\">\n          <div className=\"flex overflow-x-auto scrollbar-hide space-x-1\">\n            <Button\n              variant={activeTab === 'tutorial' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs ${\n                activeTab === 'tutorial'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : 'text-slate-300 hover:bg-slate-700/50'\n              }`}\n              onClick={() => handleTabChange('tutorial')}\n            >\n              <i className=\"fas fa-graduation-cap\"></i>\n              <Play className=\"w-3 h-3 text-white\" />\n              <span>{t('start')}</span>\n            </Button>\n            \n            <Button\n              variant={activeTab === 'servers' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs ${\n                activeTab === 'servers'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('servers')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked('servers') && handleTabChange('servers')}\n              disabled={!isTabUnlocked('servers')}\n            >\n              <i className=\"fas fa-server\"></i>\n              <Server className=\"w-3 h-3 text-white\" />\n              <span>{t('myServers')}</span>\n\n              {/* {gameState.servers && <span className=\"bg-secondary/20 text-secondary px-1 rounded text-xs\">{gameState.servers.length}</span>} */}\n            </Button>\n\n            <Button\n              variant={activeTab === 'hosting' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs ${\n                activeTab === 'hosting'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('hosting')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked('hosting') && handleTabChange('hosting')}\n              disabled={!isTabUnlocked('hosting')}\n            >\n              <i className=\"fas fa-store\"></i>\n              <ShoppingCart className=\"w-3 h-3 text-white\" />\n              <span>{t('serverStore')}</span>\n              {!isTabUnlocked('hosting') && <Lock className=\"w-3 h-3 ml-1\" />}\n            </Button>\n\n            <Button\n              variant={activeTab === 'learning' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs ${\n                activeTab === 'learning'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('learning')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked('learning') && handleTabChange('learning')}\n              disabled={!isTabUnlocked('learning')}\n            >\n              <i className=\"fas fa-book\"></i>\n              <BookOpenText className=\"w-3 h-3 text-white\" />\n              <span>{t('learningCenter')}</span>\n              {!isTabUnlocked('learning') && <Lock className=\"w-3 h-3 ml-1\" />}\n            </Button>\n            \n            <Button\n              variant={activeTab === 'achievements' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs ${\n                activeTab === 'achievements'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('achievements')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"achievements\") && handleTabChange(\"achievements\")}\n              disabled={!isTabUnlocked('achievements')}\n            >\n              <i className=\"fas fa-trophy\"></i>\n              <Award className=\"w-3 h-3 text-white\" />\n              <span>{t('achievements')}</span>\n              {!isTabUnlocked('achievements') && <Lock className=\"w-3 h-3 ml-1\" />}\n            </Button>\n            \n            <Button\n              variant={activeTab === 'quests' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs relative ${\n                activeTab === 'quests'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : 'text-slate-300 hover:bg-slate-700/50'\n              }`}\n              onClick={() => handleTabChange(\"quests\")}\n            >\n              <i className=\"fas fa-calendar\"></i>\n              <ClipboardList className=\"w-3 h-3 text-white\" />\n              <span>{t('dailyQuests')}</span>\n              {hasCompletedQuests && (\n                <div className=\"absolute top-1/2 right-0 transform -translate-y-1/2 translate-x-1/2 w-3 h-3 bg-yellow-500 rounded-full animate-pulse border-2 border-slate-800\"></div>\n              )}\n            </Button>\n\n            <Button\n              variant={activeTab === 'minigames' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs ${\n                activeTab === 'minigames'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('minigames')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"minigames\") && handleTabChange(\"minigames\")}\n              disabled={!isTabUnlocked('minigames')}\n            >\n              <i className=\"fas fa-gamepad\"></i>\n              <Gamepad2 className=\"w-3 h-3 text-white\" />\n              <span>{t('miniGames')}</span>\n              {!isTabUnlocked('minigames') && <Lock className=\"w-3 h-3 ml-1\" />}\n            </Button>\n\n            <Button\n              variant={activeTab === 'donate' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs ml-4 relative bg-gradient-to-r from-yellow-600/20 to-yellow-400/20 hover:from-yellow-600/30 hover:to-yellow-400/30 border border-yellow-500/30 ${\n                activeTab === 'donate'\n                  ? 'text-yellow-300 shadow-lg shadow-yellow-500/25'\n                  : 'text-yellow-400 hover:text-yellow-300'\n              }`}\n              onClick={() => isTabUnlocked(\"donate\") && handleTabChange(\"donate\")}\n              disabled={!isTabUnlocked('donate')}\n            >\n              <i className=\"fas fa-coins\"></i>\n              <CreditCard className=\"w-3 h-3 text-white\" />\n              <span>{t('donate')}</span>\n              {!isTabUnlocked('donate') && <Lock className=\"w-3 h-3 ml-1\" />}\n            </Button>\n\n            <Button\n              variant={activeTab === 'reports' ? 'default' : 'ghost'}\n              size=\"sm\"\n              className={`flex items-center space-x-1 px-2 py-1 whitespace-nowrap text-xs relative ${\n                activeTab === 'reports'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('reports')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"reports\") && handleTabChange(\"reports\")}\n              disabled={!isTabUnlocked('reports')}\n            >\n              <i className=\"fas fa-headset\"></i>\n              <Bug className=\"w-3 h-3 text-white\" />\n              <span>{t('reports')}</span>\n              {!isTabUnlocked('reports') && <Lock className=\"w-3 h-3 ml-1\" />}\n              {hasUnreadReports && (\n                <div className=\"absolute top-1/2 right-0 transform -translate-y-1/2 translate-x-1/2 w-3 h-3 bg-red-500 rounded-full animate-pulse border-2 border-slate-800\"></div>\n              )}\n            </Button>\n            \n          </div>\n        </div>\n        \n        {/* Desktop Sidebar Navigation */}\n        <aside className=\"hidden lg:block w-80 bg-slate-800/50 backdrop-blur-sm border-r border-slate-700 p-6\">\n          <nav className=\"space-y-2\">\n            {/* Tutorial Tab */}\n            <Button\n              variant={activeTab === 'tutorial' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 ${\n                activeTab === 'tutorial'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : 'text-slate-300 hover:bg-slate-700/50'\n              }`}\n              onClick={() => handleTabChange('tutorial')}\n            >\n              <i className=\"fas fa-graduation-cap text-lg\"></i>\n              <Play className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('tutorial')}</span>\n              {!gameState.user.tutorialCompleted && (\n                <span className=\"ml-auto bg-accent/20 text-accent text-xs px-2 py-1 rounded-full\">\n                  {t('active')}\n                </span>\n              )}\n            </Button>\n\n            {/* My Servers Tab */}\n            <Button\n              variant={activeTab === 'servers' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 ${\n                activeTab === 'servers'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('servers')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"servers\") && handleTabChange(\"servers\")}\n              disabled={!isTabUnlocked('servers')}\n            >\n              <i className=\"fas fa-server text-lg\"></i>\n              <Server className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('myServers')}</span>\n              {/* \n              \n              Display the number of servers near the tab\n              {gameState.servers && (\n                <span className=\"ml-auto bg-secondary/20 text-secondary text-xs px-2 py-1 rounded-full\">\n                  {gameState.servers.length}\n                </span>\n              )}\n\n              */}\n\n              {!isTabUnlocked('servers') && <Lock className=\"w-4 h-4 ml-auto\" />}\n            </Button>\n\n            {/* Server Store Tab */}\n            <Button\n              variant={activeTab === 'hosting' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 ${\n                activeTab === 'hosting'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('hosting')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"hosting\") && handleTabChange(\"hosting\")}\n              disabled={!isTabUnlocked('hosting')}\n            >\n              <i className=\"fas fa-shopping-cart text-lg\"></i>\n              <ShoppingCart className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('serverStore')}</span>\n              {!isTabUnlocked('hosting') && <Lock className=\"w-4 h-4 ml-auto\" />}\n            </Button>\n\n            {/* Learning Center Tab */}\n            <Button\n              variant={activeTab === 'learning' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 ${\n                activeTab === 'learning'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('learning')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"learning\") && handleTabChange(\"learning\")}\n              disabled={!isTabUnlocked('learning')}\n            >\n              <i className=\"fas fa-book text-lg\"></i>\n              <BookOpenText className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('learningCenter')}</span>\n              {!isTabUnlocked('learning') && <Lock className=\"w-4 h-4 ml-auto\" />}\n            </Button>\n\n            {/* Achievements Tab */}\n            <Button\n              variant={activeTab === 'achievements' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 ${\n                activeTab === 'achievements'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('achievements')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"achievements\") && handleTabChange(\"achievements\")}\n              disabled={!isTabUnlocked('achievements')}\n            >\n              <i className=\"fas fa-trophy text-lg\"></i>\n              <Award className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('achievements')}</span>\n              {!isTabUnlocked('achievements') && <Lock className=\"w-4 h-4 ml-auto\" />}\n            </Button>\n\n            {/* Daily Quests Tab */}\n            <Button\n              variant={activeTab === 'quests' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 relative ${\n                activeTab === 'quests'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : 'text-slate-300 hover:bg-slate-700/50'\n              }`}\n              onClick={() => handleTabChange(\"quests\")}\n            >\n              <i className=\"fas fa-calendar text-lg\"></i>\n              <ClipboardList className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('dailyQuests')}</span>\n              {hasCompletedQuests && (\n                <div className=\"absolute top-1/2 right-2 transform -translate-y-1/2 w-3 h-3 bg-yellow-500 rounded-full animate-pulse border border-slate-800\"></div>\n              )}\n            </Button>\n\n            {/* Mini Games Tab */}\n            <Button\n              variant={activeTab === 'minigames' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 ${\n                activeTab === 'minigames'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('minigames')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"minigames\") && handleTabChange(\"minigames\")}\n              disabled={!isTabUnlocked('minigames')}\n            >\n              <i className=\"fas fa-gamepad text-lg\"></i>\n              <Gamepad2 className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('miniGames')}</span>\n              {!isTabUnlocked('minigames') && <Lock className=\"w-4 h-4 ml-auto\" />}\n            </Button>\n\n            {/* Separator for different section */}\n            <div className=\"border-t border-slate-600 my-4\"></div>\n\n            {/* Donate Tab */}\n            <Button\n              variant={activeTab === 'donate' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 relative bg-gradient-to-r from-yellow-600/20 to-yellow-400/20 hover:from-yellow-600/30 hover:to-yellow-400/30 border border-yellow-500/30 ${\n                activeTab === 'donate'\n                  ? 'text-yellow-300 shadow-lg shadow-yellow-500/25'\n                  : 'text-yellow-400 hover:text-yellow-300'\n              }`}\n              onClick={() => isTabUnlocked(\"donate\") && handleTabChange(\"donate\")}\n              disabled={!isTabUnlocked('donate')}\n            >\n              <i className=\"fas fa-coins text-lg\"></i>\n              <CreditCard className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('donate')}</span>\n              {!isTabUnlocked('donate') && <Lock className=\"w-4 h-4 ml-auto\" />}\n            </Button>\n            \n            {/* Reports Tab */}\n            <Button\n              variant={activeTab === 'reports' ? 'default' : 'ghost'}\n              className={`w-full justify-start space-x-3 relative ${\n                activeTab === 'reports'\n                  ? 'bg-primary/20 text-primary border border-primary/30'\n                  : isTabUnlocked('reports')\n                  ? 'text-slate-300 hover:bg-slate-700/50'\n                  : 'text-slate-500 opacity-50 cursor-not-allowed'\n              }`}\n              onClick={() => isTabUnlocked(\"reports\") && handleTabChange(\"reports\")}\n              disabled={!isTabUnlocked('reports')}\n            >\n              <i className=\"fas fa-headset text-lg\"></i>\n              <Bug className=\"w-4 h-4 text-white\" />\n              <span className=\"font-medium\">{t('reports')}</span>\n              {!isTabUnlocked('reports') && <Lock className=\"w-4 h-4 ml-auto\" />}\n              {hasUnreadReports && (\n                <div className=\"absolute top-1/2 right-2 transform -translate-y-1/2 w-3 h-3 bg-red-500 rounded-full animate-pulse border border-slate-800\"></div>\n              )}\n            </Button>\n          </nav>\n          \n          {/* Player Rankings */}\n          <div className=\"mt-6\">\n            <h3 className=\"text-sm font-semibold text-slate-400 mb-3 px-3 flex items-center\">\n            <AlignJustify className=\"w-4 h-4 text-white\" />\n              {t('rankings')}\n              <RankingsCountdown />\n            </h3>\n            <PlayerRankings />\n          </div>\n\n          {/* Progress to unlock sections - only show if tutorial not completed AND balance under 15000 */}\n          {!gameState.user.tutorialCompleted && gameState.user.balance < TUTORIAL_UNLOCK_THRESHOLD && (\n            <div className=\"mt-8 p-4 bg-gradient-to-r from-primary/10 to-secondary/10 rounded-lg border border-primary/20\">\n              <h3 className=\"text-sm font-semibold text-primary mb-2\">\n                {t('tutorialProgress')}\n              </h3>\n              <Progress value={progressPercentage} className=\"mb-2\" />\n              <p className=\"text-xs text-slate-400\">\n                {formatCurrency(gameState.user.balance)} / {formatCurrency(TUTORIAL_UNLOCK_THRESHOLD)}\n              </p>\n            </div>\n          )}\n\n{gameState.user.tutorialCompleted && !hideAfter24h && (\n  <div className=\"mt-8 p-4 bg-gradient-to-r from-green-500/10 to-blue-500/10 rounded-lg border border-green-500/20\">\n    <h3 className=\"text-sm font-semibold text-green-400 mb-2\">\n      ✓ {t('tutorialCompleted')}\n    </h3>\n    <p className=\"text-xs text-slate-400\">\n      {t('allFeaturesUnlocked')}\n    </p>\n  </div>\n)}\n\n\n\n\n\n        </aside>\n\n        {/* Content Area */}\n        <main className=\"flex-1 overflow-auto\">\n          <div className=\"p-3 lg:p-6 h-full\">\n            {getTabContent()}\n          </div>\n        </main>\n      </div>\n\n      <VirtualAssistant hideOnReports={activeTab === 'reports'} />\n      <RankingsPopup />\n      \n      {/* Player Profile - rendered at top level */}\n      <PlayerProfileBar \n        isOpen={profileOpen} \n        onClose={() => setProfileOpen(false)} \n      />\n      \n      {/* Level Up Notification - rendered at top level */}\n      <LevelUpNotification\n        isOpen={levelUpNotification.isOpen}\n        level={levelUpNotification.level}\n        onClose={() => setLevelUpNotification({ isOpen: false, level: null })}\n      />\n      \n      {/* Automatic Daily Bonus Notification */}\n      <DailyBonusNotification />\n      </div>\n    </div>\n  );\n}\n","size_bytes":27249},"client/src/pages/home.jsx":{"content":"import { useState, useEffect } from 'react';\nimport { Link } from 'wouter';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Users, TrendingUp, Trophy, Zap, Server, Globe, ArrowRight } from 'lucide-react';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useQuery } from '@tanstack/react-query';\n\nexport default function HomePage() {\n  const { language, changeLanguage, t } = useLanguage();\n  const [stats, setStats] = useState({\n    totalPlayers: 0,\n    onlinePlayers: 0,\n    totalServers: 0,\n    totalBalance: 0\n  });\n\n  // Fetch general stats for landing page\n  const { data: statsResponse } = useQuery({\n    queryKey: ['/api/stats/general'],\n    retry: false,\n    refetchInterval: 30000, // Update every 30 seconds\n  });\n\n  const { data: rankingsResponse } = useQuery({\n    queryKey: ['/api/rankings'],\n    retry: false,\n    refetchInterval: 30000, // Update every 30 seconds\n  });\n\n  useEffect(() => {\n    if (statsResponse) {\n      setStats(statsResponse);\n    }\n  }, [statsResponse]);\n\n  const features = [\n    {\n      icon: <Server className=\"h-8 w-8 text-blue-400\" />,\n      title: t('feature1Title'),\n      description: t('feature1Desc')\n    },\n    {\n      icon: <Globe className=\"h-8 w-8 text-green-400\" />,\n      title: t('feature2Title'),\n      description: t('feature2Desc')\n    },\n    {\n      icon: <TrendingUp className=\"h-8 w-8 text-purple-400\" />,\n      title: t('feature3Title'),\n      description: t('feature3Desc')\n    },\n    {\n      icon: <Zap className=\"h-8 w-8 text-yellow-400\" />,\n      title: t('feature4Title'),\n      description: t('feature4Desc')\n    }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900\">\n      {/* Navigation Header */}\n      <header className=\"border-b border-slate-700 bg-slate-900/50 backdrop-blur-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center\">\n              <h1 className=\"text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent test-name-1\">\n                Root Tycoon\n              </h1>\n              <span className=\"ml-2 text-slate-400 text-sm\">Server Management Tycoon</span>\n            </div>\n            \n            <div className=\"flex items-center space-x-4\">\n              <Select value={language} onValueChange={changeLanguage}>\n                <SelectTrigger className=\"w-[100px] bg-slate-700 border-slate-600\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"en\">🇺🇸 EN</SelectItem>\n                  <SelectItem value=\"ru\">🇷🇺 RU</SelectItem>\n                  <SelectItem value=\"ua\">🇺🇦 UA</SelectItem>\n                  <SelectItem value=\"de\">🇩🇪 DE</SelectItem>\n                </SelectContent>\n              </Select>\n              \n              {/* Hide login button on mobile */}\n              <div className=\"hidden sm:block\">\n                <Link href=\"/reg\">\n                  <Button className=\"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700\">\n                    {t('loginRegister')}\n                    <ArrowRight className=\"ml-2 h-4 w-4\" />\n                  </Button>\n                </Link>\n              </div>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* Hero Section */}\n      <section className=\"py-12 sm:py-20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center\">\n          <h1 className=\"text-3xl sm:text-4xl lg:text-5xl font-bold text-white mb-4 sm:mb-6\">\n            {t('heroTitle')}\n            <span className=\"block text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-400\">\n              {t('heroSubtitle')}\n            </span>\n          </h1>\n          <p className=\"text-base sm:text-lg lg:text-xl text-slate-300 mb-6 sm:mb-8 max-w-3xl mx-auto px-4\">\n            {t('heroDescription')}\n          </p>\n          <div className=\"flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center items-center\">\n            <Link href=\"/reg\">\n              <Button size=\"lg\" className=\"w-full sm:w-auto bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700\">\n                {t('startPlaying')}\n                <ArrowRight className=\"ml-2 h-5 w-5\" />\n              </Button>\n            </Link>\n            <Button \n              size=\"lg\" \n              variant=\"outline\" \n              className=\"w-full sm:w-auto border-slate-600 text-slate-300 hover:bg-slate-800\"\n              onClick={() => document.getElementById('features-section')?.scrollIntoView({ behavior: 'smooth' })}\n            >\n              {t('learnMore')}\n            </Button>\n          </div>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"py-12 sm:py-16 bg-slate-800/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6\">\n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardContent className=\"p-4 sm:p-6 text-center\">\n                <Users className=\"h-6 w-6 sm:h-8 sm:w-8 text-blue-400 mx-auto mb-2\" />\n                <div className=\"text-xl sm:text-2xl font-bold text-white\">{stats.totalPlayers?.toLocaleString() || '0'}</div>\n                <div className=\"text-sm sm:text-base text-slate-400\">{t('totalPlayers')}</div>\n              </CardContent>\n            </Card>\n            \n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardContent className=\"p-4 sm:p-6 text-center\">\n                <div className=\"h-5 w-5 bg-green-400 rounded-full mx-auto mb-5 animate-pulse\"></div>\n                <div className=\"text-xl sm:text-2xl font-bold text-white\">{stats.onlinePlayers || '0'}</div>\n                <div className=\"text-sm sm:text-base text-slate-400\">{t('onlineNow')}</div>\n              </CardContent>\n            </Card>\n            \n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardContent className=\"p-4 sm:p-6 text-center\">\n                <Server className=\"h-6 w-6 sm:h-8 sm:w-8 text-purple-400 mx-auto mb-2\" />\n                <div className=\"text-xl sm:text-2xl font-bold text-white\">{stats.totalServers?.toLocaleString() || '0'}</div>\n                <div className=\"text-sm sm:text-base text-slate-400\">{t('serversHosted')}</div>\n              </CardContent>\n            </Card>\n            \n            <Card className=\"bg-slate-800/50 border-slate-700\">\n              <CardContent className=\"p-4 sm:p-6 text-center\">\n                <TrendingUp className=\"h-6 w-6 sm:h-8 sm:w-8 text-green-400 mx-auto mb-2\" />\n                <div className=\"text-xl sm:text-2xl font-bold text-white\">${stats.totalBalance?.toLocaleString() || '0'}</div>\n                <div className=\"text-sm sm:text-base text-slate-400\">{t('totalBalance')}</div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Features Section */}\n      <section className=\"py-12 sm:py-20\" id=\"features-section\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-12 sm:mb-16\">\n            <h2 className=\"text-2xl sm:text-3xl font-bold text-white mb-4\">{t('gameFeatures')}</h2>\n            <p className=\"text-base sm:text-lg text-slate-300 px-4\">{t('featuresDescription')}</p>\n          </div>\n          \n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 sm:gap-8\">\n            {features.map((feature, index) => (\n              <Card key={index} className=\"bg-slate-800/50 border-slate-700 hover:bg-slate-800/70 transition-colors\">\n                <CardContent className=\"p-4 sm:p-6 text-center\">\n                  <div className=\"mb-3 sm:mb-4\">{feature.icon}</div>\n                  <h3 className=\"text-base sm:text-lg font-semibold text-white mb-2\">{feature.title}</h3>\n                  <p className=\"text-sm sm:text-base text-slate-400\">{feature.description}</p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Top Players Section */}\n      <section className=\"py-12 sm:py-16 bg-slate-800/30\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-8 sm:mb-12\">\n            <h2 className=\"text-2xl sm:text-3xl font-bold text-white mb-4\">{t('topPlayers')}</h2>\n            <p className=\"text-base sm:text-lg text-slate-300 px-4\">{t('topPlayersDescription')}</p>\n          </div>\n          \n          <Card className=\"bg-slate-800/50 border-slate-700 max-w-4xl mx-auto\">\n            <CardHeader>\n              <CardTitle className=\"text-white flex items-center\">\n                <Trophy className=\"h-5 w-5 text-yellow-400 mr-2\" />\n                {t('leaderboard')}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {rankingsResponse?.rankings?.slice(0, 10).map((player, index) => (\n                  <div key={player.id} className=\"flex items-center justify-between p-3 sm:p-4 rounded-lg bg-slate-700/50 hover:bg-slate-700/70 transition-colors cursor-pointer group\">\n                    <div className=\"flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0\">\n                      <Badge variant=\"outline\" className=\"border-slate-600 text-slate-300 text-xs sm:text-sm\">\n                        #{index + 1}\n                      </Badge>\n                      <span \n                        className=\"text-white font-medium group-hover:text-blue-400 transition-colors truncate text-sm sm:text-base\"\n                        onClick={() => window.location.href = `/player/${player.nickname}`}\n                      >\n                        {player.nickname}\n                        {player.isOnline && <span className=\"ml-2 w-2 h-2 bg-green-400 rounded-full inline-block animate-pulse\"></span>}\n                      </span>\n                    </div>\n                    <div className=\"text-right flex-shrink-0\">\n                      <div className=\"text-green-400 font-bold text-sm sm:text-base\">${player.balance?.toLocaleString()}</div>\n                      <div className=\"text-slate-400 text-xs sm:text-sm\">{player.serverCount} {t('serversLowercase')}</div>\n                    </div>\n                  </div>\n                )) || []}\n              </div>\n              \n              <div className=\"mt-6 text-center\">\n                <Link href=\"/reg\">\n                  <Button className=\"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700\">\n                    {t('joinCompetition')}\n                  </Button>\n                </Link>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer className=\"border-t border-slate-700 bg-slate-900/50 py-6 sm:py-8\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center\">\n          <p className=\"text-slate-400 text-sm sm:text-base\">\n            © 2025 Root Tycoon. {t('allRightsReserved')}\n          </p>\n        </div>\n      </footer>\n    </div>\n  );\n}","size_bytes":11642},"client/src/pages/login.jsx":{"content":"import { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Label } from '@/components/ui/label';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useToast } from '@/hooks/use-toast';\n\nexport default function LoginPage() {\n  const [loginData, setLoginData] = useState({ nickname: '', password: '' });\n  const [registerData, setRegisterData] = useState({ \n    nickname: '', \n    password: '', \n    confirmPassword: '' \n  });\n  const { login, register, isLoading } = useGame();\n  const { language, changeLanguage, t } = useLanguage();\n  const { toast } = useToast();\n\n  const handleLogin = async (e) => {\n    e.preventDefault();\n    try {\n      await login(loginData.nickname, loginData.password);\n    } catch (error) {\n      toast({\n        title: t('loginFailed'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  // Validate nickname function\n  const validateNickname = (nickname) => {\n    if (nickname.length > 8) {\n      return t('nicknameTooLong') || 'Nickname must be 8 characters or less';\n    }\n    // Allow only letters, numbers, and limited safe characters\n    const validPattern = /^[a-zA-Z0-9_-]+$/;\n    if (!validPattern.test(nickname)) {\n      return t('nicknameInvalidChars') || 'Nickname can only contain letters, numbers, hyphens, and underscores';\n    }\n    return null;\n  };\n\n  const handleRegister = async (e) => {\n    e.preventDefault();\n    \n    // Validate nickname\n    const nicknameError = validateNickname(registerData.nickname);\n    if (nicknameError) {\n      toast({\n        title: t('registrationFailed'),\n        description: nicknameError,\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (registerData.password !== registerData.confirmPassword) {\n      toast({\n        title: t('registrationFailed'),\n        description: t('passwordsDoNotMatch'),\n        variant: \"destructive\",\n      });\n      return;\n    }\n    try {\n      await register(registerData.nickname, registerData.password, registerData.confirmPassword);\n    } catch (error) {\n      toast({\n        title: t('registrationFailed'),\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen relative overflow-hidden flex items-center justify-center p-4\">\n      {/* Animated Background */}\n      <div className=\"absolute inset-0 bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900\">\n        {/* Floating particles - reduced for mobile performance */}\n        <div className=\"absolute inset-0 hidden sm:block\">\n          {[...Array(8)].map((_, i) => (\n            <div\n              key={i}\n              className=\"absolute rounded-full bg-blue-400/10 animate-pulse\"\n              style={{\n                left: `${Math.random() * 100}%`,\n                top: `${Math.random() * 100}%`,\n                width: `${Math.random() * 4 + 1}px`,\n                height: `${Math.random() * 4 + 1}px`,\n                animationDelay: `${Math.random() * 3}s`,\n                animationDuration: `${Math.random() * 3 + 2}s`\n              }}\n            />\n          ))}\n        </div>\n        \n        {/* Grid pattern */}\n        <div className=\"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0dGVybiBpZD0iZ3JpZCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBwYXR0ZXJuVW5pdHM9InVzZXJTcGFjZU9uVXNlIj48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZ2JhKDk5LCAxMDIsIDI0MSwgMC4xKSIgc3Ryb2tlLXdpZHRoPSIxIi8+PC9wYXR0ZXJuPjwvZGVmcz48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ1cmwoI2dyaWQpIi8+PC9zdmc+')] opacity-20\" />\n        \n        {/* Glowing orbs - simpler on mobile */}\n        <div className=\"absolute top-1/4 left-1/4 w-32 sm:w-64 h-32 sm:h-64 bg-blue-500/20 rounded-full blur-xl sm:blur-3xl animate-pulse\" />\n        <div className=\"absolute bottom-1/4 right-1/4 w-48 sm:w-96 h-48 sm:h-96 bg-purple-500/20 rounded-full blur-xl sm:blur-3xl animate-pulse\" style={{ animationDelay: '1s' }} />\n        <div className=\"absolute top-3/4 left-1/2 w-24 sm:w-48 h-24 sm:h-48 bg-green-500/20 rounded-full blur-xl sm:blur-3xl animate-pulse\" style={{ animationDelay: '2s' }} />\n      </div>\n      \n      <Card className=\"w-full max-w-md bg-slate-800/90 backdrop-blur-lg border-slate-700/50 shadow-2xl relative z-10\">\n        <CardHeader className=\"text-center\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex-1\"></div>\n            <div className=\"flex-1 text-center\">\n              <CardTitle>\n                <span className=\"text-2xl font-bold text-primary bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent test-name-1\">\n                  Root Tycoon\n                </span>\n              </CardTitle>\n\n              <p className=\"text-slate-400 mt-1\">Server Hosting Simulator</p>\n            </div>\n            <div className=\"flex-1 flex justify-end\">\n              <Select value={language} onValueChange={changeLanguage}>\n                <SelectTrigger className=\"w-[100px] bg-slate-700 border-slate-600\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"en\">🇺🇸 EN</SelectItem>\n                  <SelectItem value=\"ru\">🇷🇺 RU</SelectItem>\n                  <SelectItem value=\"ua\">🇺🇦 UA</SelectItem>\n                  <SelectItem value=\"de\">🇩🇪 DE</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <Tabs defaultValue=\"login\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2\">\n              <TabsTrigger value=\"login\">{t('login')}</TabsTrigger>\n              <TabsTrigger value=\"register\">{t('register')}</TabsTrigger>\n            </TabsList>\n            \n            <TabsContent value=\"login\">\n              <form onSubmit={handleLogin} className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"login-nickname\">{t('nickname')}</Label>\n                  <Input\n                    id=\"login-nickname\"\n                    type=\"text\"\n                    value={loginData.nickname}\n                    onChange={(e) => setLoginData({ ...loginData, nickname: e.target.value })}\n                    required\n                    className=\"bg-slate-700 border-slate-600\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"login-password\">{t('password')}</Label>\n                  <Input\n                    id=\"login-password\"\n                    type=\"password\"\n                    value={loginData.password}\n                    onChange={(e) => setLoginData({ ...loginData, password: e.target.value })}\n                    required\n                    className=\"bg-slate-700 border-slate-600\"\n                  />\n                </div>\n                <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\n                  {isLoading ? t('loggingIn') : t('login')}\n                </Button>\n              </form>\n            </TabsContent>\n            \n            <TabsContent value=\"register\">\n              <form onSubmit={handleRegister} className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"register-nickname\">{t('nickname')}</Label>\n                  <Input\n                    id=\"register-nickname\"\n                    type=\"text\"\n                    value={registerData.nickname}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      // Limit input to 8 characters and filter special characters\n                      if (value.length <= 8 && /^[a-zA-Z0-9_-]*$/.test(value)) {\n                        setRegisterData({ ...registerData, nickname: value });\n                      }\n                    }}\n                    required\n                    maxLength={8}\n                    placeholder={t('nicknameMax8Chars') || 'Max 8 characters, letters/numbers only'}\n                    className=\"bg-slate-700 border-slate-600\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"register-password\">{t('password')}</Label>\n                  <Input\n                    id=\"register-password\"\n                    type=\"password\"\n                    value={registerData.password}\n                    onChange={(e) => setRegisterData({ ...registerData, password: e.target.value })}\n                    required\n                    className=\"bg-slate-700 border-slate-600\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"register-confirm\">{t('confirmPassword')}</Label>\n                  <Input\n                    id=\"register-confirm\"\n                    type=\"password\"\n                    value={registerData.confirmPassword}\n                    onChange={(e) => setRegisterData({ ...registerData, confirmPassword: e.target.value })}\n                    required\n                    className=\"bg-slate-700 border-slate-600\"\n                  />\n                </div>\n                <Button type=\"submit\" className=\"w-full\" disabled={isLoading}>\n                  {isLoading ? t('creatingAccount') : t('register')}\n                </Button>\n              </form>\n            </TabsContent>\n          </Tabs>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":10053},"client/src/pages/not-found.jsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n          Oh, we don't know that address, try entering /start\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":715},"client/src/pages/player-profile.jsx":{"content":"import { useParams, Link, useLocation } from 'wouter';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { ArrowLeft, Users, Server, TrendingUp, Trophy, Clock, Star, Crown } from 'lucide-react';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useGame } from '@/contexts/game-context';\nimport { PlayerAvatar } from '@/components/player-profile-bar';\nimport SubscriptionStatusIcon from '@/components/subscription-status-icon';\n\nexport default function PlayerProfilePage() {\n  const { nickname } = useParams();\n  const [, setLocation] = useLocation();\n  const { t } = useLanguage();\n  const { gameState } = useGame();\n\n  // Fetch player data\n  const { data: playerData, isLoading, error } = useQuery({\n    queryKey: ['/api/player', nickname],\n    retry: false,\n    enabled: !!nickname\n  });\n\n  // Fetch rankings to get player rank\n  const { data: rankingsData } = useQuery({\n    queryKey: ['/api/rankings'],\n    retry: false,\n  });\n\n  const handleBackClick = () => {\n    // Check if we came from the game (user is logged in) or from the homepage\n    if (gameState.user) {\n      setLocation('/game');\n    } else {\n      setLocation('/start');\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center\">\n        <div className=\"text-white text-xl\">{t('loadingPlayerProfile')}</div>\n      </div>\n    );\n  }\n\n  if (error || !playerData) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center\">\n        <Card className=\"bg-slate-800/50 border-slate-700 max-w-md mx-auto\">\n          <CardContent className=\"p-8 text-center\">\n            <div className=\"text-red-400 text-lg mb-4\">{t('playerNotFound')}</div>\n            <p className=\"text-slate-300 mb-6\">{t('playerNotFoundDesc').replace('{nickname}', nickname)}</p>\n            <Button onClick={handleBackClick} className=\"bg-blue-600 hover:bg-blue-700\">\n              <ArrowLeft className=\"w-4 h-4 mr-2\" />\n              {t('goBack')}\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  const player = playerData.player;\n  const playerRank = rankingsData?.rankings?.find(r => r.nickname === nickname)?.rank || '?';\n  const isOnline = playerData.isOnline;\n  \n  // Calculate level and experience using 60-level system (10% increase per level)\n  const calculateLevel = (experience) => {\n    let level = 1;\n    let requiredExp = 100;\n    let totalExp = 0;\n    \n    while (totalExp + requiredExp <= experience && level < 60) {\n      totalExp += requiredExp;\n      level++;\n      requiredExp = Math.floor(requiredExp * 1.1);\n    }\n    \n    return level;\n  };\n  const level = player.level || calculateLevel(player.experience || 0);\n  const experience = player.experience || 0;\n  \n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900\">\n  {/* Header */}\n  <header className=\"border-b border-slate-700 bg-slate-900/50 backdrop-blur-sm\">\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n      <div className=\"flex justify-between items-center h-16 overflow-hidden\">\n        <Button \n          variant=\"ghost\" \n          onClick={handleBackClick}\n          className=\"text-slate-300 hover:text-white hover:bg-slate-800 flex-shrink-0\"\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"w-4 h-4 mr-2\" />\n          <span className=\"hidden sm:inline\">{t('back')}</span>\n        </Button>\n\n        {/* Root Tycoon по центру */}\n        <h1 \n          className=\"text-lg sm:text-xl font-bold cursor-pointer bg-gradient-to-r from-blue-400 via-purple-400 to-blue-400 bg-clip-text text-transparent animate-gradient flex-shrink-0 truncate\"\n          onClick={() => setLocation('/start')}\n          data-testid=\"title-link-desktop\"\n        >\n          Root Tycoon\n        </h1>\n\n        {/* Player profile справа */}\n        <h1 className=\"text-sm sm:text-xl font-bold text-primary flex-shrink-0 truncate\">\n          {t('playerProfile')}\n        </h1>\n      </div>\n    </div>\n  </header>\n\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Player Info Card */}\n        <Card className=\"bg-slate-800/50 border-slate-700 mb-8\">\n          <CardContent className=\"p-4 sm:p-8\">\n            <div className=\"flex flex-col sm:flex-row items-center space-y-4 sm:space-y-0 sm:space-x-6\">\n              <div className=\"flex-shrink-0\">\n                <PlayerAvatar \n                  user={player} \n                  size=\"xl\" \n                  showLevel={true}\n                  showExperienceRing={false}\n                />\n              </div>\n              \n              <div className=\"flex-1\">\n              <div className=\"flex flex-col sm:flex-row items-center sm:items-start space-y-2 sm:space-y-0 sm:space-x-3 mb-2\">\n                <h1 className={`text-2xl sm:text-3xl font-bold text-center sm:text-left break-words ${\n                    player.nickname === 'Ca6aka'\n                      ? 'relative overflow-hidden animate-gradient-text'\n                      : 'text-white'\n                  }`} \n                  data-testid=\"text-nickname\"\n                >\n                  {player.nickname}\n                </h1>\n\n                <div className=\"flex flex-wrap items-center justify-center sm:justify-start gap-2\">\n                  {isOnline && (\n                    <Badge className=\"bg-green-500/20 text-green-400 border-green-500/30\">\n                      <div className=\"w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse\"></div>\n                      {t('online')}\n                    </Badge>\n                  )}\n\n                  {!isOnline && (\n                    <Badge variant=\"outline\" className=\"border-slate-600 text-slate-400\">\n                      <div className=\"w-2 h-2 bg-red-400 rounded-full mr-2\"></div>\n                      {t('offline')}\n                    </Badge>\n                  )}\n\n                  {/* VIP/Premium статусы */}\n                  {player.vipStatus === 'active' && player.vipExpiresAt && new Date(player.vipExpiresAt) > new Date() && (\n                    <Badge className=\"bg-blue-600 text-white flex items-center space-x-1\">\n                      <Star className=\"w-3 h-3\" />\n                      <span>VIP</span>\n                    </Badge>\n                  )}\n                  {player.premiumStatus === 'active' && (\n                    <Badge className=\"bg-purple-600 text-white flex items-center space-x-1\">\n                      <Crown className=\"w-3 h-3\" />\n                      <span>PREMIUM</span>\n                    </Badge>\n                  )}\n\n                  {player.admin >= 1 && (\n                    <Badge \n                      className={`${\n                        player.nickname === 'Ca6aka' \n                          ? 'bg-red-500/20 text-red-400 border-red-500/30 animate-pulse' \n                          : 'bg-purple-500/20 text-purple-400 border-purple-500/30'\n                      } relative overflow-hidden`}\n                    >\n                      <div className={`absolute inset-0 ${\n                        player.nickname === 'Ca6aka' \n                          ? 'bg-gradient-to-r from-red-500/10 to-red-600/10' \n                          : 'bg-gradient-to-r from-purple-500/10 to-purple-600/10'\n                      } animate-shimmer`}></div>\n                      <span className=\"relative z-10\">\n                        {player.nickname === 'Ca6aka' ? 'SUPER-ADMIN' : 'Admin'}\n                      </span>\n                    </Badge>\n                  )}\n                </div>\n              </div>\n\n                \n                <div className=\"flex flex-wrap items-center justify-center sm:justify-start gap-4 text-slate-300 mt-4\">\n                  <div className=\"flex items-center space-x-2\">\n                    <Star className=\"w-4 h-4 text-blue-400\" />\n                    <span className=\"text-sm\">{t('level')}: {level}</span>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Trophy className=\"w-4 h-4 text-yellow-400\" />\n                    <span className=\"text-sm\">{t('rank')} #{playerRank}</span>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <Server className=\"w-4 h-4 text-purple-400\" />\n                    <span className=\"text-sm\">{player.serverCount || 0} {t('servers')}</span>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <TrendingUp className=\"w-4 h-4 text-green-400\" />\n                    <span className=\"text-sm\">${player.balance?.toLocaleString() || '0'}</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Stats Grid */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          <Card className=\"bg-slate-800/50 border-slate-700\">\n            <CardContent className=\"p-6 text-center\">\n              <TrendingUp className=\"h-8 w-8 text-green-400 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold text-white\" data-testid=\"text-balance\">\n                ${player.balance?.toLocaleString() || '0'}\n              </div>\n              <div className=\"text-slate-400\">{t('totalBalance')}</div>\n            </CardContent>\n          </Card>\n          \n          <Card className=\"bg-slate-800/50 border-slate-700\">\n            <CardContent className=\"p-6 text-center\">\n              <Server className=\"h-8 w-8 text-purple-400 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold text-white\" data-testid=\"text-servers\">\n                {player.serverCount || 0}\n              </div>\n              <div className=\"text-slate-400\">{t('activeServers')}</div>\n            </CardContent>\n          </Card>\n          \n          <Card className=\"bg-slate-800/50 border-slate-700\">\n            <CardContent className=\"p-6 text-center\">\n              <Trophy className=\"h-8 w-8 text-yellow-400 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold text-white\" data-testid=\"text-rank\">\n                #{playerRank}\n              </div>\n              <div className=\"text-slate-400\">{t('globalRank')}</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Recent Activity */}\n        {player.activities && player.activities.length > 0 && (\n          <Card className=\"bg-slate-800/50 border-slate-700\">\n            <CardHeader>\n              <CardTitle className=\"text-white flex items-center\">\n                <Clock className=\"h-5 w-5 text-blue-400 mr-2\" />\n                {t('recentActivity')}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                {player.activities.slice(0, 5).map((activity, index) => (\n                  <div key={activity.id || index} className=\"flex justify-between items-center p-3 rounded-lg bg-slate-700/30\">\n                    <span className=\"text-slate-300\">{activity.description}</span>\n                    <span className=\"text-slate-500 text-sm\">{activity.timestamp}</span>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":11648},"client/src/components/ui/avatar.jsx":{"content":"import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = \"Avatar\"\n\nconst AvatarImage = React.forwardRef(({ className, ...props }, ref) => (\n  <img\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = \"AvatarImage\"\n\nconst AvatarFallback = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = \"AvatarFallback\"\n\nexport { Avatar, AvatarImage, AvatarFallback }","size_bytes":873},"client/src/components/ui/badge.jsx":{"content":"import * as React from \"react\"\nimport { cva } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  ...props\n}) {\n  return (<div className={cn(badgeVariants({ variant }), className)} {...props} />);\n}\n\nexport { Badge, badgeVariants }","size_bytes":975},"client/src/components/ui/button.jsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Button = React.forwardRef(({ className, variant, size, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n  return (\n    <Comp\n      className={cn(buttonVariants({ variant, size, className }))}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }","size_bytes":1610},"client/src/components/ui/card.jsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }","size_bytes":1494},"client/src/components/ui/input.jsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef(({ className, type, ...props }, ref) => {\n  return (\n    <input\n      type={type}\n      className={cn(\n        \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nInput.displayName = \"Input\"\n\nexport { Input }","size_bytes":679},"client/src/components/ui/label.jsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }","size_bytes":537},"client/src/components/ui/progress.jsx":{"content":"import * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }","size_bytes":658},"client/src/components/ui/select.jsx":{"content":"import * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}","size_bytes":4746},"client/src/components/ui/tabs.jsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }","size_bytes":1540},"client/src/components/ui/toast.jsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[999999999] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\nexport {\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}","size_bytes":3894},"client/src/components/ui/toaster.jsx":{"content":"import {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\nimport { useToast } from \"@/hooks/use-toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}","size_bytes":771},"client/src/components/ui/tooltip.jsx":{"content":"import * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }","size_bytes":1022},"client/src/components/ui/dialog.jsx":{"content":"import * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}","size_bytes":3274},".local/state/replit/agent/progress_tracker.md":{"content":"[x] 1. Install the required packages\n[x] 2. Restart the workflow to see if the project is working\n[x] 3. Verify the project is working using the feedback tool\n[x] 4. Inform user the import is completed and they can start building, mark the import as completed using the complete_project_import tool","size_bytes":298},"client/src/components/achievements-tab.jsx":{"content":"import { useQuery } from '@tanstack/react-query';\nimport { Eye } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { Trophy, Lock, CheckCircle } from 'lucide-react';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { formatCurrency } from '@/lib/constants';\n\nexport function AchievementsTab() {\n  const { gameState } = useGame();\n  const { t } = useLanguage();\n\n  // Check if user has completed tutorial\n  const hasCompletedTutorial = gameState.user?.tutorialCompleted;\n\n  if (!hasCompletedTutorial) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-[400px] text-center space-y-4\">\n        <Lock className=\"w-16 h-16 text-slate-500\" />\n        <h3 className=\"text-xl font-semibold text-slate-300\">{t('achievementsLocked')}</h3>\n        <p className=\"text-slate-400 max-w-md\">\n          {t('completeTutorialToUnlock')}\n        </p>\n      </div>\n    );\n  }\n\n  const { data: achievementsResponse } = useQuery({\n    queryKey: ['/api/achievements'],\n    enabled: !!gameState.user,\n    refetchInterval: 30000, // Update every 30 seconds\n  });\n\n  const { data: hiddenAchievementsResponse } = useQuery({\n    queryKey: ['/api/achievements/hidden'],\n    enabled: !!gameState.user,\n    refetchInterval: 30000,\n  });\n\n  const achievements = achievementsResponse?.achievements || [];\n  const hiddenAchievements = hiddenAchievementsResponse?.achievements || [];\n  const earnedCount = achievements.filter(a => a.earned).length;\n  const hiddenEarnedCount = hiddenAchievements.filter(a => a.earned).length;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-white flex items-center\">\n            <Trophy className=\"w-6 h-6 text-yellow-400 mr-2\" />\n{t('achievements')}\n          </h2>\n          <p className=\"text-slate-400\">\n{t('progressLabel')}: {earnedCount}/{achievements.length} {t('achievements')} | {hiddenEarnedCount}/{hiddenAchievements.length} {t('hiddenAchievements')}\n          </p>\n        </div>\n        <div className=\"text-right\">\n          <div className=\"text-sm text-slate-400\">{t('completed')}</div>\n          <Progress value={(earnedCount / achievements.length) * 100} className=\"w-32\" />\n        </div>\n      </div>\n\n      {/* Hidden Achievements Section */}\n      {hiddenAchievements.length > 0 && (\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center space-x-2\">\n            <Eye className=\"w-5 h-5 text-purple-400\" />\n            <h3 className=\"text-lg font-semibold text-purple-300\">{t('hiddenAchievements')}</h3>\n          </div>\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n            {hiddenAchievements.map((achievement) => (\n              <Card key={achievement.id} className=\"bg-slate-800/50 border-purple-900/50 relative overflow-hidden\">\n                <div className=\"absolute inset-0 bg-gradient-to-br from-purple-900/20 to-violet-900/20\" />\n                <CardHeader className=\"relative\">\n                  <CardTitle className=\"flex items-center text-white\">\n                    {achievement.earned ? (\n                      <CheckCircle className=\"w-5 h-5 text-purple-400 mr-2\" />\n                    ) : (\n                      <Eye className=\"w-5 h-5 text-slate-500 mr-2\" />\n                    )}\n                    <span className={achievement.earned ? 'text-purple-300' : 'text-slate-400'}>\n                      {achievement.earned ? t(achievement.id) : '???'}\n                    </span>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"relative space-y-3\">\n                  <p className={`text-sm ${achievement.earned ? 'text-slate-300' : 'text-slate-500'}`}>\n                    {achievement.earned ? t(`${achievement.id}_desc`) : t('hiddenRequirement')}\n                  </p>\n                  {achievement.earned && achievement.reward && (\n                    <div className=\"flex items-center justify-between\">\n                      <Badge variant=\"secondary\" className=\"bg-purple-900/50 text-purple-300\">\n                        {formatCurrency(achievement.reward)}\n                      </Badge>\n                      <Badge variant=\"outline\" className=\"border-purple-600 text-purple-400\">\n                        {t('unlocked')}\n                      </Badge>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {achievements.map((achievement) => (\n          <Card \n            key={achievement.id} \n            className={`bg-slate-800/50 border transition-all duration-200 ${\n              achievement.earned \n                ? 'border-yellow-500/50 bg-yellow-500/5' \n                : 'border-slate-700 hover:border-slate-600'\n            }`}\n          >\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"flex items-center justify-between text-lg\">\n                <div className=\"flex items-center space-x-2\">\n                  {achievement.earned ? (\n                    <CheckCircle className=\"w-5 h-5 text-yellow-400\" />\n                  ) : (\n                    <Lock className=\"w-5 h-5 text-slate-500\" />\n                  )}\n                  <span className={achievement.earned ? 'text-yellow-400' : 'text-slate-300'}>\n                    {t('achievementsList')?.[achievement.id]?.title || achievement.title}\n                  </span>\n                </div>\n                {achievement.earned && (\n                  <Badge variant=\"secondary\" className=\"bg-yellow-500/20 text-yellow-300\">\n                    {t('rewardClaimed')}\n                  </Badge>\n                )}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-slate-400 text-sm mb-4\">\n                {t('achievementsList')?.[achievement.id]?.description || achievement.description}\n              </p>\n              \n              {achievement.isChat && achievement.progress !== undefined && (\n                <div className=\"mb-3\">\n                  <div className=\"flex justify-between text-xs text-slate-400 mb-1\">\n                    <span>{t('progress')}</span>\n                    <span>{achievement.progress}/{achievement.requirement}</span>\n                  </div>\n                  <Progress value={(achievement.progress / achievement.requirement) * 100} className=\"h-2\" />\n                </div>\n              )}\n              \n              <div className=\"flex items-center justify-between\">\n                <div className=\"text-sm text-slate-500\">\n                  {achievement.isChat ? (\n                    <span className=\"text-blue-400\">{t('chatAchievement')}</span>\n                  ) : (\n                    <span>{t('reward')}: {formatCurrency(achievement.reward)}</span>\n                  )}\n                </div>\n                <div className=\"text-xs text-slate-500\">\n                  {!achievement.isChat && achievement.condition?.type === 'servers' && `${achievement.condition.count} ${t('serversLowercase')}`}\n                  {!achievement.isChat && achievement.condition?.type === 'balance' && `${formatCurrency(achievement.condition.amount)} ${t('balance').toLowerCase()}`}\n                  {!achievement.isChat && achievement.condition?.type === 'jobs' && `${achievement.condition.count} ${t('completedTasks')}`}\n                  {!achievement.isChat && achievement.condition?.type === 'courses' && `${achievement.condition.count} ${t('coursesGenitive')}`}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {achievements.length === 0 && (\n        <Card className=\"bg-slate-800/50 border-slate-700\">\n          <CardContent className=\"py-12 text-center\">\n            <Trophy className=\"w-12 h-12 text-slate-600 mx-auto mb-4\" />\n            <p className=\"text-slate-400\">{t('loading')}</p>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","size_bytes":8349},"client/src/components/quests-tab.jsx":{"content":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { Calendar, CheckCircle2, Clock, Gift } from 'lucide-react';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { formatCurrency } from '@/lib/constants';\nimport { apiRequest } from '@/lib/queryClient';\n\nexport function QuestsTab() {\n  const { gameState, dispatch } = useGame();\n  const { t } = useLanguage();\n  const queryClient = useQueryClient();\n\n  const { data: questsResponse } = useQuery({\n    queryKey: ['/api/quests'],\n    enabled: !!gameState.user,\n    refetchInterval: 30000, // Update every 30 seconds\n  });\n\n  const claimRewardMutation = useMutation({\n    mutationFn: (questId) => {\n      // Убираем двойное кодирование, так как apiRequest может дважды кодировать\n      const cleanQuestId = decodeURIComponent(questId);\n      return apiRequest(`/api/quests/${encodeURIComponent(cleanQuestId)}/claim`, 'POST');\n    },\n    onSuccess: (data, questId) => {\n      // Immediately update user balance in UI\n      if (data.user) {\n        dispatch({ \n          type: 'UPDATE_USER_DATA', \n          payload: {\n            balance: data.user.balance,\n            totalEarnings: data.user.totalEarnings\n          }\n        });\n      }\n      \n      // Optimistically update quest status\n      queryClient.setQueryData(['/api/quests'], (oldData) => {\n        if (!oldData) return oldData;\n        return {\n          ...oldData,\n          quests: oldData.quests.map(quest => \n            quest.id === questId ? { ...quest, claimed: true } : quest\n          )\n        };\n      });\n      \n      // Invalidate all related queries to update UI immediately\n      queryClient.invalidateQueries({ queryKey: ['/api/quests'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me', 'periodic'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/activities'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n    },\n  });\n\n  const quests = questsResponse?.quests || [];\n  const completedCount = quests.filter(q => q.completed).length;\n\n  // Calculate time until reset (24 hours from last reset)\n  const getTimeUntilReset = () => {\n    const lastReset = gameState.user?.lastQuestReset || Date.now();\n    const nextReset = lastReset + 24 * 60 * 60 * 1000; // 24 hours from last reset\n    const timeLeft = nextReset - Date.now();\n    \n    if (timeLeft <= 0) return { text: t('resetAvailable'), progressPercent: 100 };\n    \n    const hours = Math.floor(timeLeft / (60 * 60 * 1000));\n    const minutes = Math.floor((timeLeft % (60 * 60 * 1000)) / (60 * 1000));\n    \n    // Calculate progress: how much of the 24 hours has passed\n    const totalDayMs = 24 * 60 * 60 * 1000;\n    const elapsedMs = totalDayMs - timeLeft;\n    const progressPercent = Math.max(0, Math.min(100, (elapsedMs / totalDayMs) * 100));\n    \n    return { \n      text: `${hours}${t('hours')} ${minutes}${t('minutes')} ${t('until')} ${t('reset')}`,\n      progressPercent \n    };\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-2xl font-bold text-white flex items-center\">\n            <Calendar className=\"w-6 h-6 text-blue-400 mr-2\" />\n{t('dailyQuests')}\n          </h2>\n          <p className=\"text-slate-400\">\n{t('completed')}: {completedCount}/{quests.length} {t('completedTasks')}\n          </p>\n        </div>\n        <div className=\"text-right\">\n          <div className=\"text-sm text-slate-400 flex items-center\">\n            <Clock className=\"w-4 h-4 mr-1\" />\n            {getTimeUntilReset().text}\n          </div>\n          <div className=\"space-y-1 mt-1\">\n            <Progress value={getTimeUntilReset().progressPercent} className=\"w-33\" />\n          </div>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        {quests.map((quest) => (\n          <Card \n            key={quest.id} \n            className={`bg-slate-800/50 border transition-all duration-200 ${\n              quest.completed \n                ? 'border-green-500/50 bg-green-500/5' \n                : 'border-slate-700 hover:border-slate-600'\n            }`}\n          >\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-2\">\n                  {quest.completed ? (\n                    <CheckCircle2 className=\"w-5 h-5 text-green-400\" />\n                  ) : (\n                    <Calendar className=\"w-5 h-5 text-blue-400\" />\n                  )}\n                  <span className={quest.completed ? 'text-green-400' : 'text-white'}>\n                    {(() => {\n                      const questTranslations = t('dailyQuestsList');\n                      // Extract base quest ID (remove date suffix like \"-Sat Aug 16 2025\")\n                      const baseQuestId = quest.id.replace(/-[A-Z][a-z]{2}\\s[A-Z][a-z]{2}\\s\\d{1,2}\\s\\d{4}$/, '');\n                      const translatedTitle = questTranslations?.[baseQuestId]?.title;\n                      return translatedTitle || quest.title;\n                    })()}\n                  </span>\n                </div>\n                {quest.completed && (\n                  <Badge variant=\"secondary\" className=\"bg-green-500/20 text-green-300\">\n                    {t('completed')}\n                  </Badge>\n                )}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-slate-400 text-sm mb-4\">\n                {(() => {\n                  const questTranslations = t('dailyQuestsList');\n                  // Extract base quest ID (remove date suffix like \"-Sat Aug 16 2025\")\n                  const baseQuestId = quest.id.replace(/-[A-Z][a-z]{2}\\s[A-Z][a-z]{2}\\s\\d{1,2}\\s\\d{4}$/, '');\n                  const translatedDesc = questTranslations?.[baseQuestId]?.description;\n                  return translatedDesc || quest.description;\n                })()}\n              </p>\n              \n              <div className=\"space-y-3\">\n                {/* Progress bar */}\n                <div>\n                  <div className=\"flex justify-between text-xs text-slate-400 mb-1\">\n                    <span>{t('progress')}</span>\n                    <span>\n                      {quest.requirement?.type === 'job' && \n                        `${quest.progress}/${quest.requirement.count} ${t('completedTasks')}`\n                      }\n                      {quest.requirement?.type === 'income' && \n                        `${formatCurrency(quest.progress)}/${formatCurrency(quest.requirement.amount)}`\n                      }\n                    </span>\n                  </div>\n                  <Progress \n                    value={quest.requirement ? (quest.progress / (quest.requirement.count || quest.requirement.amount)) * 100 : 0} \n                    className=\"w-full\"\n                  />\n                </div>\n                \n                {/* Reward */}\n                <div className=\"flex justify-between items-center pt-2 border-t border-slate-700\">\n                  <div className=\"flex flex-col\">\n                    <span className=\"text-sm text-slate-500\">{t('reward')}:</span>\n                    <span className=\"text-sm font-medium text-yellow-400\">\n                      {formatCurrency(quest.reward)}\n                    </span>\n                  </div>\n                  {quest.completed && !quest.claimed && (\n                    <Button\n                      size=\"sm\"\n                      onClick={() => claimRewardMutation.mutate(quest.id)}\n                      disabled={claimRewardMutation.isPending}\n                      className=\"bg-green-600 hover:bg-green-700 text-white\"\n                    >\n                      <Gift className=\"w-4 h-4 mr-1\" />\n                      {claimRewardMutation.isPending && claimRewardMutation.variables === quest.id ? t('claiming') : t('claimReward')}\n                    </Button>\n                  )}\n                  {quest.completed && quest.claimed && (\n                    <Badge variant=\"secondary\" className=\"bg-green-500/20 text-green-300\">\n                      {t('rewardClaimed')}\n                    </Badge>\n                  )}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {quests.length === 0 && (\n        <Card className=\"bg-slate-800/50 border-slate-700\">\n          <CardContent className=\"py-12 text-center\">\n            <Calendar className=\"w-12 h-12 text-slate-600 mx-auto mb-4\" />\n            <p className=\"text-slate-400\">{t('loading')}</p>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","size_bytes":9143},"client/src/components/player-profile-bar.jsx":{"content":"import { useState } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { Badge } from '@/components/ui/badge';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { formatCurrency } from '@/lib/constants';\nimport { X, TrendingUp, TrendingDown, Star, Award } from 'lucide-react';\nimport SubscriptionStatusIcon from '@/components/subscription-status-icon';\n\n// Level and Experience System (60 levels, 10% increase per level)\nfunction calculateLevel(experience) {\n  let level = 1;\n  let requiredExp = 100;\n  let totalExp = 0;\n  \n  while (totalExp + requiredExp <= experience && level < 60) {\n    totalExp += requiredExp;\n    level++;\n    requiredExp = Math.floor(requiredExp * 1.1);\n  }\n  \n  return level;\n}\n\nfunction getExperienceForLevel(level) {\n  let totalExp = 0;\n  let currentExp = 100;\n  \n  for (let i = 1; i < level && i < 60; i++) {\n    totalExp += currentExp;\n    currentExp = Math.floor(currentExp * 1.1);\n  }\n  \n  return totalExp;\n}\n\nfunction getExperienceToNextLevel(experience) {\n  const currentLevel = calculateLevel(experience);\n  if (currentLevel >= 60) return 0;\n  const nextLevelExp = getExperienceForLevel(currentLevel + 1);\n  return nextLevelExp - experience;\n}\n\nfunction getExperienceProgress(experience) {\n  const currentLevel = calculateLevel(experience);\n  if (currentLevel >= 60) return 100;\n  const currentLevelStart = getExperienceForLevel(currentLevel);\n  const nextLevelStart = getExperienceForLevel(currentLevel + 1);\n  const currentExp = experience - currentLevelStart;\n  const neededExp = nextLevelStart - currentLevelStart;\n  return Math.floor((currentExp / neededExp) * 100);\n}\n\nfunction PlayerAvatar({ user, size = 'md', showLevel = true, showExperienceRing = true, onClick, className = \"\" }) {\n  if (!user?.avatar) return null;\n\n  const sizeClasses = {\n    sm: 'w-8 h-8',\n    md: 'w-10 h-10',\n    lg: 'w-12 h-12',\n    xl: 'w-16 h-16'\n  };\n\n  const avatarSizeClasses = {\n    sm: 'w-6 h-6',\n    md: 'w-8 h-8',\n    lg: 'w-10 h-10',\n    xl: 'w-14 h-14'\n  };\n\n  const textSizes = {\n    sm: 'text-xs',\n    md: 'text-sm',\n    lg: 'text-base',\n    xl: 'text-lg'\n  };\n\n  const level = user.level || calculateLevel(user.experience || 0);\n  const experience = user.experience || 0;\n  const expProgress = getExperienceProgress(experience);\n\n  return (\n    <div className={`relative ${className}`} onClick={onClick}>\n      {/* Avatar with experience ring */}\n      <div className={`${sizeClasses[size]} relative ${onClick ? 'cursor-pointer group' : ''} flex items-center justify-center`}>\n        {/* Experience ring (only show in game context) */}\n        {showLevel && showExperienceRing && (\n          <svg className=\"absolute inset-0 w-full h-full -rotate-90 opacity-80\">\n            <circle\n              cx=\"50%\"\n              cy=\"50%\"\n              r=\"45%\"\n              fill=\"transparent\"\n              stroke=\"rgba(59, 130, 246, 0.2)\"\n              strokeWidth=\"3\"\n            />\n            <circle\n              cx=\"50%\"\n              cy=\"50%\"\n              r=\"45%\"\n              fill=\"transparent\"\n              stroke=\"rgba(59, 130, 246, 0.8)\"\n              strokeWidth=\"3\"\n              strokeDasharray=\"100\"\n              strokeDashoffset={100 - expProgress}\n              className=\"transition-all duration-500 ease-out\"\n            />\n          </svg>\n        )}\n        \n{/* Avatar with fancy animated gradient */}\n<div \n  className={`${avatarSizeClasses[size]} rounded-full flex items-center justify-center text-white font-bold ${textSizes[size]} shadow-lg border-2 border-white/20 relative overflow-hidden ${user.nickname === 'Ca6aka' ? 'animate-avatar-fancy' : ''}`}\n>\n  {/* Static background for normal users */}\n  {user.nickname !== 'Ca6aka' && (\n    <div className=\"absolute inset-0 bg-gradient-to-r from-white/5 via-transparent to-white/5 opacity-40\"></div>\n  )}\n\n  {/* Special animated effect for super admin */}\n  {user.nickname === 'Ca6aka' && (\n    <div className=\"absolute inset-0 bg-gradient-to-r from-purple-500 via-pink-500 via-red-500 via-yellow-500 via-green-500 via-blue-500 to-purple-500 opacity-80 animate-avatar-fancy\"></div>\n  )}\n\n  <span className=\"relative z-10\">{user.nickname[0].toUpperCase()}</span>\n</div>\n\n\n        {/* Level badge */}\n        {showLevel && (\n          <div className=\"absolute -bottom-1 -right-1 bg-blue-600 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center border-2 border-white shadow-lg font-bold\">\n            {level}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function PlayerProfileBar({ isOpen, onClose }) {\n  const { gameState } = useGame();\n  const { t } = useLanguage();\n  \n  if (!gameState.user || !isOpen) return null;\n\n  const user = gameState.user;\n  const level = user.level || calculateLevel(user.experience || 0);\n  const experience = user.experience || 0;\n  const expProgress = getExperienceProgress(experience);\n  const expToNext = getExperienceToNextLevel(experience);\n  const totalEarnings = user.totalEarnings || 0;\n  const totalSpent = user.totalSpent || 0;\n  const netProfit = totalEarnings - totalSpent;\n\n  const achievements = user.achievements || [];\n  const completedJobs = user.completedJobsCount || 0;\n  const completedCourses = user.completedCoursesCount || 0;\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        className=\"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 overflow-hidden z-[999999]\"\n        style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0 }}\n        onClick={onClose}\n      >\n        <motion.div\n          initial={{ scale: 0.8, opacity: 0, y: 50 }}\n          animate={{ scale: 1, opacity: 1, y: 0 }}\n          exit={{ scale: 0.8, opacity: 0, y: 50 }}\n          transition={{ type: \"spring\", damping: 20, stiffness: 300 }}\n          className=\"bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto\"\n          onClick={(e) => e.stopPropagation()}\n        >\n<CardHeader className=\"relative pb-4\">\n  <Button\n    variant=\"ghost\"\n    size=\"sm\"\n    onClick={onClose}\n    className=\"absolute top-4 right-4 text-slate-400 hover:text-white\"\n  >\n    <X className=\"w-4 h-4\" />\n  </Button>\n\n  <div className=\"flex items-center space-x-6\">\n    <PlayerAvatar user={user} size=\"xl\" />\n    <div className=\"flex-1\">\n    <CardTitle className=\"text-xl sm:text-2xl font-bold text-white mb-2 flex items-center justify-between\">\n  <div className=\"flex items-center space-x-2\">\n    <span>{user.nickname}</span>\n    <SubscriptionStatusIcon user={user} size=\"lg\" />\n  </div>\n  <span\n    className=\"\n      text-xs sm:text-sm\n      px-2 sm:px-3 py-0.5 sm:py-1\n      text-green-700 border border-green-400 rounded-full\n      flex flex-col items-center text-center ml-auto\n    \"\n    style={{\n      background: 'linear-gradient(135deg, rgba(34,197,94,0.15), rgba(132,211,244,0.1))',\n    }}\n  >\n    <span>{t('registrationdate')}</span>\n    <span>\n      {new Date(user.registrationTime).toLocaleDateString('ru-RU', {\n        day: '2-digit',\n        month: '2-digit',\n        year: 'numeric',\n      })}\n    </span>\n  </span>\n</CardTitle>\n\n\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center space-x-2\">\n          <Star className=\"w-4 h-4 text-yellow-500\" />\n          <span className=\"text-slate-300\">{t('level')} {level}</span>\n          <Badge variant=\"outline\" className=\"border-blue-500 text-blue-400\">\n            {experience} XP\n          </Badge>\n        </div>\n        <div className=\"space-y-1\">\n          <div className=\"flex justify-between text-sm text-slate-400\">\n            <span>{t('progressToLevel')} {level + 1}</span>\n            <span>{expToNext} {t('xpNeeded')}</span>\n          </div>\n          <Progress value={expProgress} className=\"h-2\" />\n        </div>\n      </div>\n    </div>\n  </div>\n</CardHeader>\n\n\n          <CardContent className=\"space-y-6\">\n            {/* Financial Stats */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <Card className=\"bg-slate-700/50 border-slate-600\">\n                <CardContent className=\"p-4 text-center\">\n                  <TrendingUp className=\"w-6 h-6 text-green-500 mx-auto mb-2\" />\n                  <div className=\"text-lg font-bold text-white\">\n                    {formatCurrency(totalEarnings)}\n                  </div>\n                  <div className=\"text-sm text-slate-400\">{t('totalEarnings')}</div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"bg-slate-700/50 border-slate-600\">\n                <CardContent className=\"p-4 text-center\">\n                  <TrendingDown className=\"w-6 h-6 text-red-500 mx-auto mb-2\" />\n                  <div className=\"text-lg font-bold text-white\">\n                    {formatCurrency(totalSpent)}\n                  </div>\n                  <div className=\"text-sm text-slate-400\">{t('totalSpent')}</div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"bg-slate-700/50 border-slate-600\">\n                <CardContent className=\"p-4 text-center\">\n                  <Star className={`w-6 h-6 ${netProfit >= 0 ? 'text-yellow-500' : 'text-orange-500'} mx-auto mb-2`} />\n                  <div className={`text-lg font-bold ${netProfit >= 0 ? 'text-green-400' : 'text-red-400'}`}>\n                    {formatCurrency(netProfit)}\n                  </div>\n                  <div className=\"text-sm text-slate-400\">{t('netProfit')}</div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Statistics */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div className=\"bg-slate-700/30 rounded-lg p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-blue-400\">{completedJobs}</div>\n                  <div className=\"text-sm text-slate-400\">{t('jobsCompleted')}</div>\n                </div>\n              </div>\n\n              <div className=\"bg-slate-700/30 rounded-lg p-4\">\n                <div className=\"text-center\">\n                  <div className=\"text-2xl font-bold text-purple-400\">{completedCourses}</div>\n                  <div className=\"text-sm text-slate-400\">{t('coursesCompleted')}</div>\n                </div>\n              </div>\n            </div>\n\n            {/* Achievements */}\n            <div>\n              <h3 className=\"text-lg font-semibold text-white mb-3 flex items-center\">\n                <Award className=\"w-5 h-5 text-yellow-500 mr-2\" />\n                {t('achievements')} ({achievements.length})\n              </h3>\n              {achievements.length > 0 ? (\n                <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\n                  {achievements.slice(0, 6).map((achievementId, index) => (\n                    <Badge \n                      key={achievementId}\n                      variant=\"outline\" \n                      className=\"border-yellow-500 text-yellow-400 justify-center py-2\"\n                    >\n                      {t('achievement')} {index + 1}\n                    </Badge>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"text-center py-6 text-slate-400\">\n                  <Award className=\"w-8 h-8 mx-auto mb-2 opacity-50\" />\n                  <p>{t('noAchievementsYet')}</p>\n                  <p className=\"text-sm\">{t('earnAchievementsDesc')}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Current Balance */}\n            <div className=\"bg-gradient-to-r from-green-500/10 to-blue-500/10 rounded-lg p-4 border border-green-500/30\">\n              <div className=\"text-center\">\n                <div className=\"text-sm text-slate-400 mb-1\">{t('currentBalance')}</div>\n                <div className=\"text-3xl font-bold text-green-400\">\n                  {formatCurrency(user.balance)}\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </motion.div>\n      </motion.div>\n    </AnimatePresence>\n  );\n}\n\nexport { PlayerAvatar };","size_bytes":12405},"client/src/components/ui/slider.jsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-slate-700\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-gradient-to-r from-blue-500 to-purple-500\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-blue-500 bg-white ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }","size_bytes":991},"client/src/components/level-up-notification.jsx":{"content":"import { useState, useEffect, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Star, TrendingUp, Zap } from 'lucide-react';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useIsMobile } from '@/hooks/use-mobile';\n\nexport function LevelUpNotification({ isOpen, onClose, level }) {\n  const { t } = useLanguage();\n  const timerRef = useRef(null);\n  const isMobile = useIsMobile();\n\n  useEffect(() => {\n    // Clear any existing timer\n    if (timerRef.current) {\n      clearTimeout(timerRef.current);\n      timerRef.current = null;\n    }\n\n    if (isOpen && level) {\n      // Auto close after 5 seconds - using ref to ensure proper cleanup\n      timerRef.current = setTimeout(() => {\n        if (typeof onClose === 'function') {\n          onClose();\n        }\n      }, 5000);\n    }\n\n    // Cleanup function\n    return () => {\n      if (timerRef.current) {\n        clearTimeout(timerRef.current);\n        timerRef.current = null;\n      }\n    };\n  }, [isOpen, level, onClose]);\n\n  if (!isOpen || !level) return null;\n\n  return (\n    <AnimatePresence>\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        exit={{ opacity: 0 }}\n        className=\"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999999]\"\n        style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0 }}\n        onClick={(e) => {\n          // Close on overlay click (but not on modal click)\n          if (e.target === e.currentTarget) {\n            if (typeof onClose === 'function') {\n              onClose();\n            }\n          }\n        }}\n      >\n        <motion.div\n          initial={{ scale: 0.3, opacity: 0, rotateY: -180 }}\n          animate={{ scale: 1, opacity: 1, rotateY: 0 }}\n          exit={{ scale: 0.3, opacity: 0, rotateY: 180 }}\n          transition={{\n            type: \"spring\",\n            damping: 15,\n            stiffness: 300,\n            duration: 0.6\n          }}\n          className=\"relative bg-gradient-to-br from-yellow-500/20 to-orange-500/20 border-2 border-yellow-500/50 rounded-3xl shadow-2xl p-8 max-w-md w-full mx-4\"\n        >\n          {/* Background Glow Effect */}\n          <div className=\"absolute inset-0 bg-gradient-to-br from-yellow-500/10 to-orange-500/10 rounded-3xl blur-xl\" />\n          \n          {/* Floating particles effect - reduced for mobile performance */}\n          <div className=\"absolute inset-0 overflow-hidden rounded-3xl\">\n            {/* Reduce particles on mobile to prevent crashes */}\n            {[...Array(isMobile ? 4 : 8)].map((_, i) => (\n              <motion.div\n                key={i}\n                initial={{ \n                  opacity: 0, \n                  scale: 0,\n                  x: Math.random() * 200 - 100,\n                  y: Math.random() * 150 - 75\n                }}\n                animate={{ \n                  opacity: [0, 1, 0], \n                  scale: [0, 1, 0],\n                  x: Math.random() * 200 - 100,\n                  y: Math.random() * 150 - 75\n                }}\n                transition={{\n                  duration: 2,\n                  delay: i * 0.1,\n                  repeat: Infinity,\n                  repeatType: \"loop\",\n                  ease: \"linear\" // Simpler easing for better mobile performance\n                }}\n                className=\"absolute w-2 h-2 bg-yellow-400 rounded-full\"\n                style={{\n                  left: '50%',\n                  top: '50%',\n                  willChange: 'transform', // Optimize for animations\n                }}\n              />\n            ))}\n          </div>\n\n          <div className=\"relative z-10 text-center\">\n            {/* Level Up Icon with Animation */}\n            <motion.div\n              initial={{ scale: 0, rotate: -180 }}\n              animate={{ scale: 1, rotate: 0 }}\n              transition={{ delay: 0.2, type: \"spring\", stiffness: 200 }}\n              className=\"mb-4 flex justify-center\"\n            >\n              <div className=\"relative\">\n                <motion.div\n                  animate={{ rotate: 360 }}\n                  transition={{ duration: 3, repeat: Infinity, ease: \"linear\" }}\n                  className=\"absolute inset-0\"\n                >\n                  <Star className=\"w-16 h-16 text-yellow-400 drop-shadow-lg\" />\n                </motion.div>\n                <Star className=\"w-16 h-16 text-yellow-500\" />\n              </div>\n            </motion.div>\n\n            {/* Level Up Text */}\n            <motion.h2\n              initial={{ y: 20, opacity: 0 }}\n              animate={{ y: 0, opacity: 1 }}\n              transition={{ delay: 0.3 }}\n              className=\"text-3xl font-bold text-yellow-400 mb-2 drop-shadow-lg\"\n            >\n              🎉 {t('levelUp')}\n            </motion.h2>\n\n            {/* Level Number with Glow */}\n            <motion.div\n              initial={{ scale: 0 }}\n              animate={{ scale: 1 }}\n              transition={{ delay: 0.4, type: \"spring\", stiffness: 150 }}\n              className=\"mb-4\"\n            >\n              <div className=\"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full shadow-2xl mb-4\">\n                <span className=\"text-2xl font-bold text-white drop-shadow-lg\">{level}</span>\n              </div>\n            </motion.div>\n\n            {/* Congratulations Text */}\n            <motion.p\n              initial={{ y: 20, opacity: 0 }}\n              animate={{ y: 0, opacity: 1 }}\n              transition={{ delay: 0.5 }}\n              className=\"text-white text-lg mb-2 drop-shadow\"\n            >\n              <div>\n                {t('levelUpCongrats')} {level} {t('levelUpCongrats3')}!<br />\n                {t('levelUpCongrats2')}\n              </div>\n            </motion.p>\n\n            {/* New Abilities Text */}\n            <motion.div\n              initial={{ y: 20, opacity: 0 }}\n              animate={{ y: 0, opacity: 1 }}\n              transition={{ delay: 0.6 }}\n              className=\"flex items-center justify-center space-x-2 text-yellow-200\"\n            >\n              <Zap className=\"w-4 h-4\" />\n              <span className=\"text-sm\">{t('newAbilitiesUnlocked')}</span>\n              <TrendingUp className=\"w-4 h-4\" />\n            </motion.div>\n\n            {/* Progress indicator (5 second timer) */}\n            <motion.div\n              initial={{ width: \"100%\" }}\n              animate={{ width: \"0%\" }}\n              transition={{ duration: 5, ease: \"linear\" }}\n              className=\"absolute bottom-0 left-0 h-1 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full\"\n            />\n          </div>\n        </motion.div>\n      </motion.div>\n    </AnimatePresence>\n  );\n}","size_bytes":6782},"client/src/components/rankings-popup.jsx":{"content":"import { useState } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Button } from '@/components/ui/button';\nimport { useGame } from '@/contexts/game-context';\nimport { useLanguage } from '@/contexts/language-context';\nimport { formatCurrency } from '@/lib/constants';\nimport { Link } from 'wouter';\nimport { useIsMobile } from '@/hooks/use-mobile';\nimport { RankingsCountdown } from '@/components/player-rankings';\nimport { AlignJustify} from 'lucide-react';\n\nexport function RankingsPopup() {\n  const [isOpen, setIsOpen] = useState(false);\n  const { gameState } = useGame();\n  const { t } = useLanguage();\n  const isMobile = useIsMobile();\n  \n  const { data: rankingsData } = useQuery({\n    queryKey: ['/api/rankings'],\n    enabled: !!gameState.user,\n    refetchInterval: 30000, // Update every 30 seconds\n  });\n\n  if (!gameState.user || !isMobile) return null; // Only show on mobile\n\n  const rankings = rankingsData?.rankings || [];\n  const userRank = rankings.find(r => r.id === gameState.user?.id);\n\n  return (\n    <>\n      {/* Rankings Toggle Button */}\n      <div className=\"fixed bottom-4 left-4 z-[9999]\">\n        <Button\n          onClick={() => setIsOpen(!isOpen)}\n          className=\"w-12 h-12 rounded-full bg-gradient-to-br from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 shadow-lg border-2 border-yellow-400/30 text-white flex items-center justify-center\"\n          data-testid=\"rankings-toggle\"\n        ><AlignJustify className=\"w-4 h-4 text-white\" />\n          <i className=\"fas fa-crown text-lg\"></i>\n        </Button>\n      </div>\n\n      {/* Rankings Panel */}\n      {isOpen && (\n        <div className=\"fixed bottom-4 left-20 z-[9998] w-80 max-h-96 bg-slate-800/95 backdrop-blur-lg border border-slate-700/50 rounded-lg shadow-2xl overflow-hidden\">\n          <div className=\"bg-gradient-to-r from-yellow-500 to-amber-600 p-3 flex items-center justify-between\">\n            <div className=\"flex items-center space-x-2\">\n              <i className=\"fas fa-trophy text-white text-lg\"></i>\n              <h3 className=\"text-white font-bold flex items-center\">\n              <AlignJustify className=\"w-4 h-4 text-white\" />\n                {t('rankings')}\n                <span className=\"text-xs text-yellow-200 ml-2 opacity-80\">\n                  <RankingsCountdown />\n                </span>\n              </h3>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => setIsOpen(false)}\n              className=\"text-white hover:bg-white/20 w-6 h-6 p-0\"\n            >\n              <i className=\"fas fa-times text-sm\"></i>\n            </Button>\n          </div>\n          \n          <div className=\"p-4 max-h-80 overflow-y-auto\">\n            <div className=\"space-y-2\">\n              {rankings.slice(0, 10).map((player, index) => {\n                const isCurrentUser = player.id === gameState.user?.id;\n                \n                return (\n                  <div \n                    key={player.id}\n                    className={`flex items-center justify-between p-2 rounded-lg ${\n                      isCurrentUser \n                        ? 'bg-primary/20 border border-primary/30' \n                        : 'bg-slate-700/30 hover:bg-slate-700/50'\n                    }`}\n                  >\n                    <div className=\"flex items-center space-x-3\">\n                      <div className=\"flex items-center space-x-1\">\n                        <div className={`w-2 h-2 rounded-full ${\n                          player.isOnline ? 'bg-green-500' : 'bg-red-500'\n                        }`} />\n                        <span className={`font-bold text-sm ${\n                          index === 0 ? 'text-yellow-400' : \n                          index === 1 ? 'text-slate-300' : \n                          index === 2 ? 'text-amber-600' : \n                          isCurrentUser ? 'text-primary' : 'text-slate-400'\n                        }`}>\n                          #{player.rank}\n                        </span>\n                      </div>\n                      {isCurrentUser ? (\n                        <span className=\"text-sm text-primary font-medium\">You</span>\n                      ) : (\n                        <Link href={`/player/${player.nickname}`}>\n                          <span className=\"text-sm text-slate-300 hover:text-primary cursor-pointer transition-colors\">\n                            {player.nickname}\n                          </span>\n                        </Link>\n                      )}\n                    </div>\n                    <span className={`text-xs font-medium ${\n                      isCurrentUser ? 'text-primary' : 'text-slate-400'\n                    }`}>\n                      {formatCurrency(player.balance)}\n                    </span>\n                  </div>\n                );\n              })}\n              \n              {/* Show current user's rank if not in top 10 */}\n              {userRank && userRank.rank > 10 && (\n                <>\n                  <div className=\"text-center py-1\">\n                    <span className=\"text-xs text-slate-500\">...</span>\n                  </div>\n                  <div className=\"flex items-center justify-between p-2 bg-primary/20 rounded-lg border border-primary/30\">\n                    <div className=\"flex items-center space-x-3\">\n                      <span className=\"text-primary font-bold text-sm\">#{userRank.rank}</span>\n                      <span className=\"text-sm text-primary font-medium\">You</span>\n                    </div>\n                    <span className=\"text-xs text-primary font-medium\">\n                      {formatCurrency(userRank.balance)}\n                    </span>\n                  </div>\n                </>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Backdrop */}\n      {isOpen && (\n        <div \n          className=\"fixed inset-0 z-[9997]\" \n          onClick={() => setIsOpen(false)}\n        />\n      )}\n    </>\n  );\n}","size_bytes":6052},"client/src/components/theme-toggle.jsx":{"content":"import { useTheme } from '@/components/theme-provider';\nimport { useLanguage } from '@/contexts/language-context';\nimport { Button } from '@/components/ui/button';\nimport { useState } from 'react';\nimport { SunMoon } from 'lucide-react';\n\nexport function ThemeToggle({ variant = 'desktop' }) {\n  const { theme, setTheme } = useTheme();\n  const { t } = useLanguage();\n  const [isTransitioning, setIsTransitioning] = useState(false);\n  \n  const isDark = theme === 'dark';\n  \n  const toggleTheme = () => {\n    setIsTransitioning(true);\n    setTimeout(() => {\n      setTheme(isDark ? 'light' : 'dark');\n      setIsTransitioning(false);\n    }, 150);\n  };\n\n  if (variant === 'mobile') {\n    return (\n      <Button\n        variant=\"ghost\"\n        size=\"sm\"\n        onClick={toggleTheme}\n        className=\"h-6 w-8 p-0 rounded-full bg-slate-600 hover:bg-slate-500 transition-colors duration-300 flex items-center justify-center\"\n        disabled={isTransitioning}\n      >\n        <div\n          className={`transition-all duration-300 ${\n            isTransitioning ? 'scale-75' : 'scale-100'\n          }`}\n        >\n          {isDark ? (\n            <>\n              <i className=\"fas fa-moon text-xs text-slate-200\"></i>\n              <SunMoon className=\"w-5 h-5 text-white\" />\n            </>\n          ) : (\n            <>\n              <i className=\"fas fa-sun text-xs text-yellow-400\"></i>\n              <SunMoon className=\"w-5 h-5 text-black\" />\n            </>\n          )}\n        </div>\n      </Button>\n    );\n  }\n  \n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"sm\"\n      onClick={toggleTheme}\n      className=\"relative w-12 h-6 p-0 rounded-full bg-slate-600 hover:bg-slate-500 transition-colors duration-300\"\n      disabled={isTransitioning}\n      title={isDark ? t('lightTheme') : t('darkTheme')}\n    >\n      <div className={`absolute top-0.5 w-5 h-5 bg-grau rounded-full transition-all duration-300 ${\n        isDark ? 'left-0.5' : 'left-6'\n      } flex items-center justify-center shadow-sm`}>\n        <div className={`transition-all duration-300 ${\n          isDark ? 'opacity-100 scale-100' : 'opacity-0 scale-75'\n        }`}>\n        <SunMoon className=\"w-5 h-5 text-black\" />\n          <i className=\"fas fa-moon text-[10px] text-slate-600\"></i>\n        </div>\n        <div className={`absolute transition-all duration-300 ${\n          !isDark ? 'opacity-100 scale-100' : 'opacity-0 scale-75'\n        }`}>\n        <SunMoon className=\"w-5 h-5 text-white\" />\n          <i className=\"fas fa-sun text-[10px] text-yellow-500\"></i>\n        </div>\n      </div>\n    </Button>\n  );\n}","size_bytes":2596},"debug-income.js":{"content":"// Диагностика системы доходов\nimport storage from './server/storage.js';\n\nasync function diagnoseIncomeSystem() {\n  try {\n    console.log('=== ДИАГНОСТИКА СИСТЕМЫ ДОХОДОВ ===\\n');\n    \n    // Получаем всех пользователей\n    const allUsers = await storage.getAllUsers();\n    console.log(`Всего пользователей: ${allUsers.length}\\n`);\n    \n    // Получаем все серверы  \n    const allServers = await storage.getServers();\n    console.log(`Всего серверов: ${allServers.length}`);\n    console.log(`Включенных серверов: ${allServers.filter(s => s.isOnline).length}`);\n    console.log(`Выключенных серверов: ${allServers.filter(s => !s.isOnline).length}\\n`);\n    \n    // Анализируем каждого пользователя\n    for (const user of allUsers) {\n      console.log(`--- Пользователь: ${user.nickname} ---`);\n      console.log(`ID: ${user.id}`);\n      console.log(`Баланс: $${user.balance || 0}`);\n      console.log(`Уровень: ${user.level || 1}`);\n      \n      const lastUpdate = user.lastIncomeUpdate;\n      if (lastUpdate) {\n        const timeSinceUpdate = Date.now() - lastUpdate;\n        const minutesSinceUpdate = Math.floor(timeSinceUpdate / 60000);\n        console.log(`Последнее обновление дохода: ${new Date(lastUpdate).toLocaleString()}`);\n        console.log(`Время с последнего обновления: ${minutesSinceUpdate} минут`);\n      } else {\n        console.log(`Последнее обновление дохода: НИКОГДА`);\n      }\n      \n      // Получаем серверы пользователя\n      const userServers = allServers.filter(s => s.ownerId === user.id);\n      console.log(`Серверов: ${userServers.length}`);\n      \n      if (userServers.length > 0) {\n        const onlineServers = userServers.filter(s => s.isOnline);\n        const offlineServers = userServers.filter(s => !s.isOnline);\n        \n        console.log(`  - Включено: ${onlineServers.length}`);\n        console.log(`  - Выключено: ${offlineServers.length}`);\n        \n        if (onlineServers.length > 0) {\n          const totalIncomePerMinute = onlineServers.reduce((sum, server) => {\n            const baseIncome = server.incomePerMinute;\n            const loadPercentage = server.loadPercentage || 50;\n            const loadAdjustment = baseIncome * (1 + (loadPercentage - 50) / 100);\n            return sum + loadAdjustment;\n          }, 0);\n          \n          const rentalCost = totalIncomePerMinute * 0.1;\n          const netIncomePerMinute = totalIncomePerMinute - rentalCost;\n          \n          console.log(`  - Доход/мин: $${Math.floor(totalIncomePerMinute)}`);\n          console.log(`  - Аренда/мин: $${Math.floor(rentalCost)}`);\n          console.log(`  - Чистый доход/мин: $${Math.floor(netIncomePerMinute)}`);\n          \n          // Проверим потенциальный доход, если обновить сейчас\n          if (lastUpdate) {\n            const timeDiff = Date.now() - lastUpdate;\n            const potentialIncome = Math.floor((netIncomePerMinute * timeDiff) / 60000);\n            console.log(`  - ПОТЕНЦИАЛЬНЫЙ ДОХОД: $${potentialIncome}`);\n          }\n        }\n        \n        // Показываем проблемные серверы\n        const problematicServers = userServers.filter(s => s.durability <= 10 || (s.isOnline && s.durability <= 50));\n        if (problematicServers.length > 0) {\n          console.log(`  ⚠️  ПРОБЛЕМНЫЕ СЕРВЕРЫ:`);\n          problematicServers.forEach(s => {\n            console.log(`    - ${s.name}: ${s.isOnline ? 'ВКЛ' : 'ВЫКЛ'}, прочность ${s.durability}%`);\n          });\n        }\n      }\n      \n      console.log('');\n    }\n    \n    // Ищем пользователей с потенциально застрявшими доходами\n    console.log('=== ПОТЕНЦИАЛЬНЫЕ ПРОБЛЕМЫ ===');\n    const now = Date.now();\n    const problemUsers = [];\n    \n    for (const user of allUsers) {\n      const userServers = allServers.filter(s => s.ownerId === user.id && s.isOnline);\n      const lastUpdate = user.lastIncomeUpdate;\n      \n      if (userServers.length > 0 && lastUpdate) {\n        const timeSinceUpdate = now - lastUpdate;\n        const minutesSinceUpdate = Math.floor(timeSinceUpdate / 60000);\n        \n        // Если у пользователя есть активные серверы, но доходы не обновлялись больше 5 минут\n        if (minutesSinceUpdate > 5) {\n          problemUsers.push({\n            user,\n            minutesSinceUpdate,\n            activeServers: userServers.length\n          });\n        }\n      }\n    }\n    \n    if (problemUsers.length > 0) {\n      console.log('Пользователи с застрявшими доходами:');\n      problemUsers.forEach(({ user, minutesSinceUpdate, activeServers }) => {\n        console.log(`- ${user.nickname}: ${activeServers} активных серверов, не обновлялось ${minutesSinceUpdate} минут`);\n      });\n    } else {\n      console.log('Проблем с доходами не обнаружено.');\n    }\n    \n  } catch (error) {\n    console.error('Ошибка диагностики:', error);\n  }\n}\n\n// Функция для принудительного обновления доходов всех пользователей\nasync function forceUpdateAllIncomes() {\n  try {\n    console.log('\\n=== ПРИНУДИТЕЛЬНОЕ ОБНОВЛЕНИЕ ДОХОДОВ ===');\n    \n    const allUsers = await storage.getAllUsers();\n    const allServers = await storage.getServers();\n    \n    for (const user of allUsers) {\n      const userServers = allServers.filter(s => s.ownerId === user.id && s.isOnline);\n      \n      if (userServers.length > 0) {\n        console.log(`Обновляю доходы для ${user.nickname}...`);\n        try {\n          const result = await storage.updateIncome(user.id);\n          if (result.netIncome !== 0) {\n            console.log(`  ✓ Начислено: $${result.netIncome} (доход: $${result.incomeEarned}, аренда: $${result.rentalCost})`);\n          } else {\n            console.log(`  - Нет изменений в доходах`);\n          }\n        } catch (error) {\n          console.log(`  ✗ Ошибка: ${error.message}`);\n        }\n      }\n    }\n    \n    console.log('Обновление завершено.');\n    \n  } catch (error) {\n    console.error('Ошибка при обновлении доходов:', error);\n  }\n}\n\n// Запускаем диагностику\ndiagnoseIncomeSystem().then(() => {\n  console.log('\\n--- Хотите принудительно обновить доходы? (y/n) ---');\n  \n  // Для автоматического запуска в целях диагностики\n  if (process.argv.includes('--force-update')) {\n    return forceUpdateAllIncomes();\n  }\n}).catch(console.error);","size_bytes":7237},"client/src/components/reports-tab.jsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { Input } from '@/components/ui/input';\n\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Badge } from '@/components/ui/badge';\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from '@/components/ui/dropdown-menu';\nimport { MessageCircle, Plus, MoreHorizontal, X, Send, Clock, CheckCircle, Flag, RotateCcw, User } from 'lucide-react';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useGame } from '@/contexts/game-context';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { formatCurrency } from '@/lib/constants';\nimport { useToast } from '@/hooks/use-toast';\n\nexport function ReportsTab() {\n  const { t } = useLanguage();\n  const { gameState } = useGame();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedReport, setSelectedReport] = useState(null);\n  const [newMessage, setNewMessage] = useState('');\n  const [showNewReportDialog, setShowNewReportDialog] = useState(false);\n  const [newReportSubject, setNewReportSubject] = useState('');\n  const [newReportCategory, setNewReportCategory] = useState('');\n  const [newReportMessage, setNewReportMessage] = useState('');\n\n  const isAdmin = gameState.user?.admin >= 1;\n\n  // Fetch reports\n  const { data: reports = [], refetch: refetchReports } = useQuery({\n    queryKey: ['/api/reports'],\n    queryFn: () => fetch('/api/reports').then(res => res.json()),\n    refetchInterval: 5000, // Refresh every 5 seconds\n    onSuccess: (data) => {\n      // Check if currently selected report still exists\n      if (selectedReport && !data.find(report => report.id === selectedReport.id)) {\n        setSelectedReport(null);\n      }\n    }\n  });\n\n  // Fetch messages for selected report\n  const { data: messages = [], refetch: refetchMessages } = useQuery({\n    queryKey: ['/api/reports', selectedReport?.id, 'messages'],\n    queryFn: () => fetch(`/api/reports/${selectedReport.id}/messages`).then(res => {\n      if (!res.ok) {\n        throw new Error('Report not found');\n      }\n      return res.json();\n    }),\n    enabled: !!selectedReport,\n    refetchInterval: 2000, // Refresh every 2 seconds\n    onError: (error) => {\n      // If report was deleted, clear selection\n      if (error.message === 'Report not found') {\n        setSelectedReport(null);\n        toast({ title: t('error'), description: t('reportDeleted'), variant: 'destructive' });\n      }\n    }\n  });\n\n  // Create new report\n  const createReportMutation = useMutation({\n    mutationFn: async (data) => {\n      const response = await apiRequest('/api/reports', {\n        method: 'POST',\n        body: JSON.stringify(data)\n      });\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reports'] });\n      setShowNewReportDialog(false);\n      setNewReportSubject('');\n      setNewReportCategory('');\n      setNewReportMessage('');\n      toast({ title: t('reportSent'), description: t('reportSentDescription') });\n    },\n    onError: (error) => {\n      toast({ title: t('error'), description: error.message, variant: 'destructive' });\n    }\n  });\n\n  // Send message\n  const sendMessageMutation = useMutation({\n    mutationFn: async (message) => {\n      const response = await apiRequest(`/api/reports/${selectedReport.id}/messages`, {\n        method: 'POST',\n        body: JSON.stringify({ message })\n      });\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reports', selectedReport.id, 'messages'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/reports'] });\n      setNewMessage('');\n    },\n    onError: (error) => {\n      toast({ title: t('error'), description: error.message, variant: 'destructive' });\n    }\n  });\n\n  // Admin actions\n  const closeReportMutation = useMutation({\n    mutationFn: async (reportId) => {\n      const response = await apiRequest(`/api/reports/${reportId}/close`, {\n        method: 'POST'\n      });\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reports'] });\n      setSelectedReport(null);\n      toast({ title: t('reportClosed'), description: t('reportClosedDescription') });\n    }\n  });\n\n  const deleteReportMutation = useMutation({\n    mutationFn: async (reportId) => {\n      const response = await apiRequest(`/api/reports/${reportId}`, {\n        method: 'DELETE'\n      });\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reports'] });\n      setSelectedReport(null);\n      toast({ title: t('reportDeleted'), description: t('reportDeletedDescription') });\n    }\n  });\n\n  const markReportMutation = useMutation({\n    mutationFn: async (reportId) => {\n      const response = await apiRequest(`/api/reports/${reportId}/mark`, {\n        method: 'POST'\n      });\n      return response;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/reports'] });\n    }\n  });\n\n  const handleCreateReport = () => {\n    if (!newReportSubject.trim() || !newReportCategory || !newReportMessage.trim()) {\n      toast({ title: t('error'), description: t('fillAllFields'), variant: 'destructive' });\n      return;\n    }\n\n    // Validate character limits\n    if (newReportSubject.length > 50) {\n      toast({ title: t('error'), description: t('subjectTooLong'), variant: 'destructive' });\n      return;\n    }\n\n    if (newReportMessage.length > 500) {\n      toast({ title: t('error'), description: t('messageTooLong'), variant: 'destructive' });\n      return;\n    }\n\n    createReportMutation.mutate({\n      subject: newReportSubject,\n      category: newReportCategory,\n      message: newReportMessage\n    });\n  };\n\n  const handleSendMessage = () => {\n    if (!newMessage.trim()) return;\n    \n    // Validate message length\n    if (newMessage.length > 500) {\n      toast({ title: t('error'), description: t('messageTooLong'), variant: 'destructive' });\n      return;\n    }\n    \n    sendMessageMutation.mutate(newMessage);\n  };\n\n  const getStatusBadge = (status) => {\n    switch (status) {\n      case 'open':\n        return <Badge variant=\"default\" className=\"bg-blue-500/20 text-blue-400\">{t('open')}</Badge>;\n      case 'closed':\n        return <Badge variant=\"secondary\" className=\"bg-green-500/20 text-green-400\">{t('closed')}</Badge>;\n      default:\n        return <Badge variant=\"outline\">{status}</Badge>;\n    }\n  };\n\n  const getCategoryIcon = (category) => {\n    return category === 'technical' ? '🔧' : '💬';\n  };\n\n  // Check if user has active report\n  const hasActiveReport = reports.some(report => report.status === 'open' && !isAdmin);\n\n  return (\n    <div className=\"h-full flex flex-col lg:flex-row bg-slate-900/50 rounded-lg border border-slate-700 relative\">\n      {/* Left Panel - Reports List */}\n      <div className=\"w-full lg:w-1/3 border-b lg:border-b-0 lg:border-r border-slate-700 p-4 h-[40vh] lg:h-full lg:max-h-none\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-bold text-white\">{isAdmin ? t('incomingReports') : t('myReports')}</h2>\n          {!isAdmin && (\n            <Dialog open={showNewReportDialog} onOpenChange={setShowNewReportDialog}>\n              <DialogTrigger asChild>\n                <Button \n                  size=\"sm\" \n                  className=\"bg-blue-600 hover:bg-blue-700\"\n                  disabled={hasActiveReport}\n                >\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  {t('newTicket')}\n                </Button>\n              </DialogTrigger>\n              <DialogContent className=\"bg-slate-800 border-slate-700\">\n                <DialogHeader>\n                  <DialogTitle className=\"text-white\">{t('createNewTicket')}</DialogTitle>\n                </DialogHeader>\n                <div className=\"space-y-4\">\n                  <div>\n                    <label className=\"text-sm text-slate-300 mb-2 block\">{t('reportSubject')}</label>\n                    <Input\n                      value={newReportSubject}\n                      onChange={(e) => setNewReportSubject(e.target.value)}\n                      placeholder={t('reportSubject')}\n                      className=\"bg-slate-700 border-slate-600 text-white\"\n                      maxLength={50}\n                    />\n                    <div className=\"text-xs text-slate-400 mt-1\">\n                      {newReportSubject.length}/50 {t('characters')}\n                    </div>\n                  </div>\n                  <div>\n                    <label className=\"text-sm text-slate-300 mb-2 block\">{t('reportType')}</label>\n                    <Select value={newReportCategory} onValueChange={setNewReportCategory}>\n                      <SelectTrigger className=\"bg-slate-700 border-slate-600 text-white\">\n                        <SelectValue placeholder={t('selectCategory')} />\n                      </SelectTrigger>\n                      <SelectContent className=\"bg-slate-700 border-slate-600\">\n                        <SelectItem value={t('reportTypeBug')} className=\"text-white\">{t('reportTypeBug')}</SelectItem>\n                        <SelectItem value={t('reportTypeFeature')} className=\"text-white\">{t('reportTypeFeature')}</SelectItem>\n                        <SelectItem value={t('reportTypeComplaint')} className=\"text-white\">{t('reportTypeComplaint')}</SelectItem>\n                        <SelectItem value={t('reportTypeOther')} className=\"text-white\">{t('reportTypeOther')}</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div>\n                    <label className=\"text-sm text-slate-300 mb-2 block\">{t('reportMessage')}</label>\n                    <textarea\n                      value={newReportMessage}\n                      onChange={(e) => setNewReportMessage(e.target.value)}\n                      placeholder={t('reportMessage')}\n                      className=\"w-full p-3 bg-slate-700 border border-slate-600 text-white rounded-md min-h-[100px] resize-none focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                      maxLength={500}\n                    />\n                    <div className=\"text-xs text-slate-400 mt-1\">\n                      {newReportMessage.length}/500 {t('characters')}\n                    </div>\n                  </div>\n                  <Button \n                    onClick={handleCreateReport}\n                    disabled={createReportMutation.isPending}\n                    className=\"w-full bg-blue-600 hover:bg-blue-700\"\n                  >\n                    {createReportMutation.isPending ? t('sending') : t('submitReport')}\n                  </Button>\n                </div>\n              </DialogContent>\n            </Dialog>\n          )}\n        </div>\n\n        {hasActiveReport && !isAdmin && (\n          <div className=\"mb-4 p-3 bg-yellow-500/10 border border-yellow-500/30 rounded-lg\">\n            <p className=\"text-sm text-yellow-400\">{t('activeReportExists')}</p>\n          </div>\n        )}\n\n        <div className=\"space-y-2 h-[calc(100%-8rem)] overflow-y-auto\">\n          {reports.length === 0 ? (\n            <div className=\"text-center py-8 text-slate-400\">\n              <MessageCircle className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n              <p>{isAdmin ? t('noIncomingReports') : t('noReports')}</p>\n            </div>\n          ) : (\n            reports.map((report) => (\n              <Card \n                key={report.id}\n                className={`cursor-pointer transition-all border ${\n                  selectedReport?.id === report.id \n                    ? 'border-blue-500 bg-blue-500/10' \n                    : report.isMarked && isAdmin \n                      ? 'border-red-500/50 bg-red-500/5' \n                      : 'border-slate-600 bg-slate-700/50 hover:bg-slate-700'\n                }`}\n                onClick={() => setSelectedReport(report)}\n              >\n                <CardContent className=\"p-3\">\n                  <div className=\"flex items-start justify-between mb-2\">\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-lg\">{getCategoryIcon(report.category)}</span>\n                      <div>\n                        <h3 className=\"font-medium text-white text-sm truncate\">\n                          {isAdmin ? (\n                            <>\n                              <button \n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  window.open(`/player/${report.userNickname}`, '_blank');\n                                }}\n                                className=\"text-blue-400 hover:text-blue-300 hover:underline transition-colors\"\n                                data-testid={`link-player-${report.userNickname}`}\n                              >\n                                {report.userNickname}\n                              </button>\n                              : {report.subject}\n                            </>\n                          ) : report.subject}\n                        </h3>\n                        <p className=\"text-xs text-slate-400\">\n                          {new Date(report.createdAt).toLocaleDateString()}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-center space-x-1\">\n                      {report.hasNewMessages && !isAdmin && (\n                        <div className=\"w-2 h-2 bg-red-500 rounded-full animate-pulse\" />\n                      )}\n                      {report.hasNewMessages && isAdmin && (\n                        <div className=\"w-2 h-2 bg-red-500 rounded-full animate-pulse\" />\n                      )}\n                      {getStatusBadge(report.status)}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* Right Panel - Chat */}\n      <div className=\"flex-1 flex flex-col bg-slate-900/30 h-[60vh] lg:h-full relative\">\n        {selectedReport ? (\n          <>\n            {/* Chat Header */}\n            <div className=\"border-b border-slate-700 p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h3 className=\"font-semibold text-white\">{selectedReport.subject}</h3>\n                  <div className=\"text-sm text-slate-400 flex items-center space-x-2\">\n                    <span>{getCategoryIcon(selectedReport.category)} {t(selectedReport.category)}</span>\n                    <span>•</span>\n                    <span>{getStatusBadge(selectedReport.status)}</span>\n                  </div>\n                </div>\n                <div className=\"flex items-center space-x-2\">\n                  {isAdmin && (\n                    <DropdownMenu>\n                      <DropdownMenuTrigger asChild>\n                        <Button variant=\"ghost\" size=\"sm\">\n                          <MoreHorizontal className=\"w-4 h-4\" />\n                        </Button>\n                      </DropdownMenuTrigger>\n                      <DropdownMenuContent className=\"bg-slate-700 border-slate-600\">\n                        {selectedReport.status === 'open' ? (\n                          <DropdownMenuItem onClick={() => closeReportMutation.mutate(selectedReport.id)}>\n                            <CheckCircle className=\"w-4 h-4 mr-2\" />\n                            {t('closeChat')}\n                          </DropdownMenuItem>\n                        ) : (\n                          <DropdownMenuItem onClick={() => {\n                            // Reopen closed chat\n                            const response = apiRequest(`/api/reports/${selectedReport.id}/reopen`, {\n                              method: 'POST'\n                            });\n                            response.then(() => {\n                              queryClient.invalidateQueries({ queryKey: ['/api/reports'] });\n                              toast({ title: t('success'), description: t('reportReopened') });\n                            }).catch((error) => {\n                              toast({ title: t('error'), description: error.message, variant: 'destructive' });\n                            });\n                          }}>\n                            <RotateCcw className=\"w-4 h-4 mr-2\" />\n                            {t('reopenChat')}\n                          </DropdownMenuItem>\n                        )}\n                        <DropdownMenuItem onClick={() => deleteReportMutation.mutate(selectedReport.id)}>\n                          <X className=\"w-4 h-4 mr-2\" />\n                          {t('deleteChat')}\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => markReportMutation.mutate(selectedReport.id)}>\n                          <Flag className=\"w-4 h-4 mr-2\" />\n                          {selectedReport.isMarked ? t('unmarkChat') : t('markChat')}\n                        </DropdownMenuItem>\n                      </DropdownMenuContent>\n                    </DropdownMenu>\n                  )}\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedReport(null)}>\n                    <X className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n\n            {/* Messages */}\n            <div \n              className=\"flex-1 overflow-y-auto p-4 space-y-3 relative\"\n              style={{\n                background: `\n                  radial-gradient(circle at 20% 30%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),\n                  radial-gradient(circle at 80% 70%, rgba(147, 51, 234, 0.1) 0%, transparent 50%),\n                  radial-gradient(circle at 60% 10%, rgba(59, 130, 246, 0.05) 0%, transparent 50%),\n                  radial-gradient(circle at 40% 90%, rgba(168, 85, 247, 0.05) 0%, transparent 50%),\n                  linear-gradient(135deg, rgba(30, 41, 59, 0.9) 0%, rgba(51, 65, 85, 0.9) 100%)\n                `,\n                backgroundSize: '100% 100%, 100% 100%, 100% 100%, 100% 100%, 100% 100%'\n              }}\n            >\n              {messages.map((message) => (\n                <div\n                  key={message.id}\n                  className={`flex ${message.isFromAdmin ? 'justify-start' : 'justify-end'}`}\n                >\n                  <div\n                    className={`max-w-[80%] p-3 rounded-lg ${\n                      message.isFromAdmin\n                        ? 'bg-slate-700 text-white'\n                        : 'bg-blue-600 text-white'\n                    }`}\n                  >\n                    <div className=\"flex items-center space-x-2 mb-1\">\n                      {message.isFromAdmin ? (\n                        <span className=\"text-xs font-medium text-red-400\">\n                          {message.adminNickname ? `${t('admin')} ${message.adminNickname}` : t('admin')}\n                        </span>\n                      ) : (\n                        <button\n                          onClick={() => {\n                            window.open(`/player/${message.userNickname}`, '_blank');\n                          }}\n                          className=\"text-xs font-medium hover:underline text-blue-200 hover:text-blue-100 transition-colors\"\n                          data-testid={`link-profile-${message.userNickname}`}\n                        >\n                          <User className=\"w-3 h-3 inline mr-1\" />\n                          {message.userNickname}\n                        </button>\n                      )}\n                      <span className=\"text-xs opacity-70\">\n                        {new Date(message.createdAt).toLocaleTimeString()}\n                      </span>\n                    </div>\n                    <p className=\"text-sm\">{message.message}</p>\n                  </div>\n                </div>\n              ))}\n            </div>\n\n            {/* Message Input */}\n            {selectedReport.status === 'open' ? (\n              <div className=\"border-t border-slate-700 p-4 pb-6 lg:pb-4\">\n                <div className=\"flex space-x-2\">\n                  <div className=\"flex-1\">\n                    <Input\n                      value={newMessage}\n                      onChange={(e) => setNewMessage(e.target.value)}\n                      placeholder={t('typeMessage')}\n                      className=\"bg-slate-700 border-slate-600 text-white\"\n                      onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\n                      maxLength={500}\n                    />\n                    <div className=\"text-xs text-slate-400 mt-1\">\n                      {newMessage.length}/500 {t('characters')}\n                    </div>\n                  </div>\n                  <Button \n                    onClick={handleSendMessage}\n                    disabled={sendMessageMutation.isPending || !newMessage.trim()}\n                    size=\"sm\"\n                    className=\"self-start\"\n                  >\n                    <Send className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            ) : (\n              <div className=\"border-t border-slate-700 p-4 bg-slate-800/50\">\n                <p className=\"text-center text-slate-400 text-sm\">\n                  {t('chatClosedByAdmin')}\n                </p>\n              </div>\n            )}\n          </>\n        ) : (\n          <div className=\"flex-1 flex items-center justify-center text-slate-400\">\n            <div className=\"text-center\">\n              <MessageCircle className=\"w-16 h-16 mx-auto mb-4 opacity-50\" />\n              <p>{t('selectReportToView')}</p>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":22310},"client/src/components/ui/dropdown-menu.jsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}>\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n      className\n    )}\n    {...props} />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        className\n      )}\n      {...props} />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props} />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}>\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props} />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props} />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}) => {\n  return (\n    (<span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props} />)\n  );\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}","size_bytes":6072},"client/src/components/donate-tab.jsx":{"content":"import { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\n// Removed Select import since payment selection is removed\nimport { Crown, Star, Clock, Users, Shield, Zap, Trophy, Timer } from 'lucide-react';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useGame } from '@/contexts/game-context';\nimport { toast } from '@/hooks/use-toast';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\n// Removed VipPremiumTest import\nimport PurchaseDialog from './purchase-dialog';\n\nexport default function DonateTab() {\n  const { t } = useLanguage();\n  const { gameState } = useGame();\n  // Removed old payment system state\n  const queryClient = useQueryClient();\n\n\n\n  const user = gameState.user;\n  const hasVip = user?.vipStatus === 'active' && user?.vipExpiresAt && new Date(user.vipExpiresAt) > new Date();\n  const hasPremium = user?.premiumStatus === 'active';\n\n  const getStatusBadge = () => {\n    if (hasPremium) {\n      return <Badge className=\"bg-purple-600 text-white\">{t('premium')}</Badge>;\n    }\n    if (hasVip) {\n      return <Badge className=\"bg-blue-600 text-white\">{t('vip')}</Badge>;\n    }\n    return null;\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"text-center\">\n        <h2 className=\"text-2xl font-bold mb-2\">{t('donateTitle')}</h2>\n        <p className=\"text-muted-foreground\">{t('donateDescription')}</p>\n        {getStatusBadge() && (\n          <div className=\"mt-4\">\n            <span className=\"text-sm text-muted-foreground mr-2\">{t('currentStatus')}:</span>\n            {getStatusBadge()}\n          </div>\n        )}\n      </div>\n\n      {/* Crypto Payment Info */}\n      <Card className=\"border-green-500/30 bg-gradient-to-br from-green-600/10 to-emerald-800/10\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center text-green-400\">\n            <Shield className=\"w-5 h-5 mr-2\" />\n            {t('securePayment')}\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-slate-300\">\n            {t('cryptoPaymentInfo')}\n          </p>\n        </CardContent>\n      </Card>\n\n      {/* VIP Package */}\n      <Card className=\"border-2 border-blue-500/30 bg-gradient-to-br from-blue-600/20 to-blue-800/20 hover:shadow-2xl hover:shadow-blue-500/20 transition-all duration-300 group relative overflow-visible\">\n        <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/5 via-transparent to-blue-500/5 opacity-50 -z-10\"></div>\n        <CardHeader className=\"bg-gradient-to-r from-blue-500/10 to-cyan-500/10 relative z-10\">\n          <CardTitle className=\"flex items-center justify-between text-blue-300\">\n            <div className=\"flex items-center\">\n              <div className=\"p-2 bg-blue-500/20 rounded-full border border-blue-400/30 mr-3\">\n                <Star className=\"w-6 h-6 text-blue-400\" />\n              </div>\n              <div>\n                <div className=\"text-xl font-bold\">VIP {t('status')}</div>\n                <div className=\"text-blue-200/90 text-sm\">8 {t('month')} - $20 ($2.50/{t('month')})</div>\n              </div>\n            </div>\n            <Badge className=\"bg-blue-500/30 text-blue-200 border-blue-400/50 px-3 py-1 text-lg font-semibold\">\n              $20 - 8 {t('month')}\n            </Badge>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"pt-6\">\n          <div className=\"space-y-3 mb-6\">\n            <div className=\"bg-gradient-to-r from-blue-500/20 to-cyan-500/20 p-3 rounded-lg border border-blue-400/30\">\n              <h4 className=\"text-blue-300 font-semibold mb-2\">🎁 VIP ПАКЕТ БОНУСЫ:</h4>\n              <div className=\"space-y-1 text-sm\">\n                <div className=\"flex items-center\">\n                  <span className=\"text-green-400 font-semibold\">💰 +$10,000</span> стартового капитала\n                </div>\n                <div className=\"flex items-center\">\n                  <span className=\"text-purple-400 font-semibold\">⚡ +5,000</span> опыта\n                </div>\n                <div className=\"flex items-center\">\n                  <span className=\"text-blue-400 font-semibold\">🖥️ 30 слотов</span> серверов\n                </div>\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center\">\n                <Star className=\"w-4 h-4 text-blue-500 mr-2\" />\n                <span>{t('vipBadgeChat')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Timer className=\"w-4 h-4 text-blue-500 mr-2\" />\n                <span>{t('vipReducedCooldown')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Star className=\"w-4 h-4 text-blue-500 mr-2\" />\n                <span>{t('vipExperienceBoost')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Shield className=\"w-4 h-4 text-blue-500 mr-2\" />\n                <span>{t('vipReportPriority')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Trophy className=\"w-4 h-4 text-blue-500 mr-2\" />\n                <span>{t('vipDailyBonus')}</span>\n              </div>\n            </div>\n          </div>\n          <div className=\"relative z-10\">\n            <PurchaseDialog \n              type=\"vip\" \n              price=\"20\"\n              disabled={hasPremium || hasVip}\n            >\n              <Button \n                disabled={hasPremium || hasVip}\n                className=\"w-full bg-blue-600 hover:bg-blue-700 disabled:opacity-50 relative z-10\"\n              >\n                {hasPremium ? t('premiumBlocksVip') :\n                 hasVip ? t('alreadyHavePremium') : t('purchaseVip') + ' - $20 8 ' + t('month')}\n              </Button>\n            </PurchaseDialog>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Premium Package */}\n      <Card className=\"border-2 border-purple-500/30 bg-gradient-to-br from-purple-600/20 to-purple-800/20 hover:shadow-2xl hover:shadow-purple-500/20 transition-all duration-300 group relative overflow-visible\">\n        <div className=\"absolute inset-0 bg-gradient-to-r from-purple-500/5 via-transparent to-purple-500/5 opacity-50 -z-10\"></div>\n        <CardHeader className=\"bg-gradient-to-r from-purple-500/10 to-pink-500/10 relative z-10\">\n          <CardTitle className=\"flex items-center justify-between text-purple-300\">\n            <div className=\"flex items-center\">\n              <div className=\"p-2 bg-purple-500/20 rounded-full border border-purple-400/30 mr-3\">\n                <Crown className=\"w-6 h-6 text-purple-400\" />\n              </div>\n              <div>\n                <div className=\"text-xl font-bold\">PREMIUM {t('status')}</div>\n                <div className=\"text-purple-200/90 text-sm\">{t('forever')} - {t('premium')}</div>\n              </div>\n            </div>\n            <Badge className=\"bg-purple-500/30 text-purple-200 border-purple-400/50 px-3 py-1 text-lg font-semibold\">\n              $25 {t('forever')}\n            </Badge>\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"pt-6\">\n          <div className=\"space-y-3 mb-6\">\n            <div className=\"bg-gradient-to-r from-purple-500/20 to-pink-500/20 p-3 rounded-lg border border-purple-400/30\">\n              <h4 className=\"text-purple-300 font-semibold mb-2\">🎁 PREMIUM ПАКЕТ БОНУСЫ:</h4>\n              <div className=\"space-y-1 text-sm\">\n                <div className=\"flex items-center\">\n                  <span className=\"text-green-400 font-semibold\">💰 +$50,000</span> стартового капитала\n                </div>\n                <div className=\"flex items-center\">\n                  <span className=\"text-purple-400 font-semibold\">⚡ +15,000</span> опыта\n                </div>\n                <div className=\"flex items-center\">\n                  <span className=\"text-purple-400 font-semibold\">🖥️ 35 слотов</span> серверов\n                </div>\n              </div>\n            </div>\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center\">\n                <Crown className=\"w-4 h-4 text-purple-500 mr-2\" />\n                <span>{t('premiumBadgeChat')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Timer className=\"w-4 h-4 text-purple-500 mr-2\" />\n                <span>{t('premiumReducedCooldown')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Star className=\"w-4 h-4 text-purple-500 mr-2\" />\n                <span>{t('premiumExperienceBoost')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Shield className=\"w-4 h-4 text-purple-500 mr-2\" />\n                <span>{t('premiumReportPriority')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Zap className=\"w-4 h-4 text-purple-500 mr-2\" />\n                <span>{t('premiumNoMinigameCooldown')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Clock className=\"w-4 h-4 text-purple-500 mr-2\" />\n                <span>{t('premiumInstantServers')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Shield className=\"w-4 h-4 text-purple-500 mr-2\" />\n                <span>{t('premiumSecretReactions')}</span>\n              </div>\n              <div className=\"flex items-center\">\n                <Trophy className=\"w-4 h-4 text-purple-500 mr-2\" />\n                <span>{t('premiumDailyBonus')}</span>\n              </div>\n            </div>\n          </div>\n          <div className=\"relative z-10\">\n            <PurchaseDialog \n              type=\"premium\" \n              price=\"25\"\n              disabled={hasVip || hasPremium}\n            >\n              <Button \n                disabled={hasVip || hasPremium}\n                className=\"w-full bg-purple-600 hover:bg-purple-700 disabled:opacity-50 relative z-10\"\n              >\n                {hasPremium ? t('alreadyHavePremium') :\n                 hasVip ? t('vipBlocksPremium') : t('purchasePremium') + ' - $25 ' + t('forever')}\n              </Button>\n            </PurchaseDialog>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":10658},"client/src/components/minigames-tab.jsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '@/components/ui/dialog';\nimport { Progress } from '@/components/ui/progress';\nimport { Shield, Zap, X, Play, CheckCircle, XCircle, Lock } from 'lucide-react';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useGame } from '@/contexts/game-context';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useToast } from '@/hooks/use-toast';\n\nconst MiniGamesTab = () => {\n  const { t } = useLanguage();\n  const { gameState: globalGameState, dispatch } = useGame();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  // Level-up notification function\n  const showLevelUpNotification = (newLevel) => {\n    window.dispatchEvent(new CustomEvent('levelUp', { \n      detail: { level: newLevel }\n    }));\n  };\n  const [selectedGame, setSelectedGame] = useState(null);\n  const [miniGameState, setMiniGameState] = useState('menu'); // menu, tutorial, playing, results\n  const [hoveredGame, setHoveredGame] = useState(null);\n  const [gameCooldowns, setGameCooldowns] = useState({});\n  \n  // Game 1: DDoS Protection\n  const [ddosState, setDdosState] = useState({\n    packets: [],\n    score: 0,\n    timeLeft: 30,\n    speed: 1,\n    gameOver: false\n  });\n  \n  // Game 2: Firewall\n  const [firewallState, setFirewallState] = useState({\n    requests: [],\n    currentRequest: null,\n    score: 0,\n    requestsLeft: 15,\n    correctChoices: 0,\n    wrongChoices: 0,\n    gameOver: false\n  });\n\n  const updateExpMutation = useMutation({\n    mutationFn: (xpGained) => apiRequest('/api/users/add-xp', 'POST', { xp: xpGained }),\n    onSuccess: (data) => {\n      // Immediately update the UI with new XP and level\n      dispatch({ \n        type: 'UPDATE_EXPERIENCE', \n        payload: {\n          experience: data.experience,\n          level: data.level,\n          balance: data.balance\n        }\n      });\n      \n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me', 'periodic'] });\n      \n      toast({\n        title: t('gameCompleted'),\n        description: `+${data.xpGained} XP gained!`,\n        variant: 'default'\n      });\n\n      // Start 30-second cooldown for the completed game\n      if (selectedGame) {\n        const cooldownEnd = Date.now() + 30000; // 30 seconds\n        setGameCooldowns(prev => ({\n          ...prev,\n          [selectedGame.id]: cooldownEnd\n        }));\n      }\n\n      // Show level-up notification with delay for better UX\n      if (data.leveledUp && data.newLevel) {\n        setTimeout(() => {\n          showLevelUpNotification(data.newLevel);\n        }, 500);\n      }\n    },\n    onError: (error) => {\n      console.error('XP update error:', error);\n      // Only show error if response status indicates failure (not 2xx)\n      if (error?.status && error.status >= 400) {\n        toast({\n          title: t('error'),\n          description: t('failedToAddXp') || 'Failed to add XP',\n          variant: 'destructive'\n        });\n      }\n    }\n  });\n\n  // Check if a game is on cooldown\n  const isGameOnCooldown = (gameId) => {\n    return gameCooldowns[gameId] && gameCooldowns[gameId] > Date.now();\n  };\n\n  // Get remaining cooldown time in seconds\n  const getCooldownTime = (gameId) => {\n    if (!gameCooldowns[gameId]) return 0;\n    return Math.ceil((gameCooldowns[gameId] - Date.now()) / 1000);\n  };\n\n  // Track cooldowns and update them\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setGameCooldowns(prev => {\n        const updated = { ...prev };\n        Object.keys(updated).forEach(gameId => {\n          if (updated[gameId] <= Date.now()) {\n            delete updated[gameId];\n          }\n        });\n        return updated;\n      });\n    }, 1000);\n    \n    return () => clearInterval(interval);\n  }, []);\n\n  const miniGames = [\n    {\n      id: 'ddos-protection',\n      title: t('minigame1'),\n      description: t('minigame1Desc'),\n      icon: Shield,\n      difficulty: t('medium'),\n      duration: '30s',\n      reward: '+1 XP',\n      reward2: t('packet')\n    },\n    {\n      id: 'firewall-filter',\n      title: t('minigame2'),\n      description: t('minigame2Desc'),\n      icon: Zap,\n      difficulty: t('medium'),\n      duration: '10',\n      duration2: t('requests'),\n      reward: '+1 XP',\n      reward2: t('correct2')\n    }\n  ];\n\n  const requestTypes = [\n    { type: 'User login', safe: true },\n    { type: 'Backup', safe: true },\n    { type: 'System update', safe: true },\n    { type: 'File download', safe: true },\n    { type: 'Email sync', safe: true },\n    { type: 'Brute Force Attack', safe: false },\n    { type: 'Malware', safe: false },\n    { type: 'SQL Injection', safe: false },\n    { type: 'Virus Download', safe: false },\n    { type: 'Data Breach Attempt', safe: false }\n  ];\n\n  // DDoS Game Logic\n  const startDdosGame = () => {\n    setMiniGameState('playing');\n    const numPackets = Math.floor(Math.random() * 15) + 25; // 25-40 packets\n    setDdosState({\n      packets: [],\n      score: 0,\n      timeLeft: 30,\n      speed: 2,\n      gameOver: false,\n      totalPackets: numPackets,\n      packetsSpawned: 0\n    });\n  };\n\n  useEffect(() => {\n    if (miniGameState === 'playing' && selectedGame?.id === 'ddos-protection' && ddosState.timeLeft > 0) {\n      const gameInterval = setInterval(() => {\n        setDdosState(prev => {\n          if (prev.timeLeft <= 0) return { ...prev, gameOver: true };\n          \n          const newPackets = [...prev.packets];\n          \n          // Add new packets faster\n          if (prev.packetsSpawned < prev.totalPackets && Math.random() < 0.7) {\n            newPackets.push({\n              id: Date.now() + Math.random(),\n              x: Math.random() * 360 + 20,\n              y: 0,\n              speed: prev.speed\n            });\n            prev.packetsSpawned++;\n          }\n          \n          // Move packets faster\n          newPackets.forEach(packet => {\n            packet.y += packet.speed * 3;\n          });\n          \n          // Remove packets that reached bottom\n          const filteredPackets = newPackets.filter(packet => packet.y < 400);\n          const reachedBottom = newPackets.length - filteredPackets.length;\n          \n          // Increase speed every 5 seconds\n          const newSpeed = prev.speed + (30 - prev.timeLeft) * 0.2;\n          \n          return {\n            ...prev,\n            packets: filteredPackets,\n            timeLeft: prev.timeLeft - 1,\n            speed: newSpeed,\n            gameOver: prev.timeLeft <= 1 || reachedBottom > 15\n          };\n        });\n      }, 1000);\n\n      return () => clearInterval(gameInterval);\n    }\n  }, [miniGameState, selectedGame, ddosState.timeLeft]);\n\n  // Firewall Game Logic\n  const startFirewallGame = () => {\n    setMiniGameState('playing');\n    const shuffledRequests = [...requestTypes].sort(() => Math.random() - 0.5);\n    setFirewallState({\n      requests: shuffledRequests.slice(0, 10),\n      currentRequest: shuffledRequests[0],\n      score: 0,\n      requestsLeft: 10,\n      correctChoices: 0,\n      wrongChoices: 0,\n      currentIndex: 0,\n      gameOver: false\n    });\n  };\n\n  const handleFirewallChoice = (choice) => {\n    if (firewallState.gameOver) return; // Prevent clicks after game over\n    \n    const currentReq = firewallState.currentRequest;\n    const correct = (choice === 'allow' && currentReq.safe) || (choice === 'block' && !currentReq.safe);\n    \n    setFirewallState(prev => {\n      const newRequestsLeft = prev.requestsLeft - 1;\n      const newIndex = prev.currentIndex + 1;\n      const nextRequest = newIndex < prev.requests.length ? prev.requests[newIndex] : null;\n      \n      return {\n        ...prev,\n        currentRequest: nextRequest,\n        requestsLeft: newRequestsLeft,\n        currentIndex: newIndex,\n        correctChoices: prev.correctChoices + (correct ? 1 : 0),\n        wrongChoices: prev.wrongChoices + (correct ? 0 : 1),\n        score: prev.score + (correct ? 1 : 0),\n        gameOver: newRequestsLeft <= 0\n      };\n    });\n  };\n\n  const finishGame = () => {\n    let scoreToAdd = 0;\n    if (selectedGame?.id === 'ddos-protection') {\n      scoreToAdd = ddosState.score;\n    } else if (selectedGame?.id === 'firewall-filter') {\n      scoreToAdd = firewallState.score;\n    }\n    \n    if (scoreToAdd > 0) {\n      updateExpMutation.mutate(scoreToAdd);\n    }\n    \n    // Set 30-second cooldown for this game\n    const cooldownEnd = Date.now() + 30000; // 30 seconds\n    setGameCooldowns(prev => ({\n      ...prev,\n      [selectedGame.id]: cooldownEnd\n    }));\n    \n    setMiniGameState('results');\n  };\n\n  const destroyPacket = (packetId) => {\n    setDdosState(prev => ({\n      ...prev,\n      packets: prev.packets.filter(p => p.id !== packetId),\n      score: prev.score + 1\n    }));\n  };\n\n  useEffect(() => {\n    if ((ddosState.gameOver && selectedGame?.id === 'ddos-protection') || \n        (firewallState.gameOver && selectedGame?.id === 'firewall-filter')) {\n      finishGame();\n    }\n  }, [ddosState.gameOver, firewallState.gameOver]);\n\n  const closeGame = () => {\n    setSelectedGame(null);\n    setMiniGameState('menu');\n    setDdosState({ packets: [], score: 0, timeLeft: 30, speed: 1, gameOver: false });\n    setFirewallState({ requests: [], currentRequest: null, score: 0, requestsLeft: 15, correctChoices: 0, wrongChoices: 0, currentIndex: 0, gameOver: false });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"text-center\">\n        <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n          {t('miniGames')}\n        </h2>\n        <p className=\"text-gray-600 dark:text-gray-400\">\n          {t('miniGamesDesc')}\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n        {miniGames.map((game) => {\n          const IconComponent = game.icon;\n          const isOnCooldown = isGameOnCooldown(game.id);\n          const cooldownTime = getCooldownTime(game.id);\n          \n          return (\n            <Card\n              key={game.id}\n              className={`relative overflow-hidden cursor-pointer transition-all duration-300 hover:shadow-lg hover:scale-105 group ${isOnCooldown ? 'opacity-60' : ''}`}\n              onMouseEnter={() => setHoveredGame(game.id)}\n              onMouseLeave={() => setHoveredGame(null)}\n              onClick={() => {\n                if (!isOnCooldown) {\n                  setSelectedGame(game);\n                }\n              }}\n              data-testid={`minigame-${game.id}`}\n            >\n              {hoveredGame === game.id && (\n                <div className=\"absolute inset-0 bg-gradient-to-r from-blue-500/20 to-purple-500/20 animate-pulse\" />\n              )}\n              \n              <CardHeader className=\"relative z-10\">\n                <div className=\"flex items-center justify-between\">\n                  <IconComponent className=\"w-8 h-8 text-blue-600 dark:text-blue-400\" />\n                  <Badge variant=\"secondary\">{game.difficulty}</Badge>\n                </div>\n                <CardTitle className=\"text-lg\">{game.title}</CardTitle>\n              </CardHeader>\n              \n              <CardContent className=\"relative z-10\">\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-4\">\n                  {game.description}\n                </p>\n                <div className=\"space-y-2 text-xs\">\n                  <div className=\"flex justify-between\">\n                    <span>{t('duration')}:</span>\n                    <span className=\"font-medium\">{game.duration} {game.duration2}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>{t('reward')}:</span>\n                    <span className=\"font-medium text-green-600\">{game.reward}/{game.reward2}</span>\n                  </div>\n                </div>\n                {isOnCooldown ? (\n                  <Button className=\"w-full mt-4\" disabled>\n                    <Lock className=\"w-4 h-4 mr-2\" />\n                    {cooldownTime}s\n                  </Button>\n                ) : (\n                  <Button className=\"w-full mt-4\" data-testid={`start-${game.id}`}>\n                    <Play className=\"w-4 h-4 mr-2\" />\n                    {t('startPlaying')}\n                  </Button>\n                )}\n              </CardContent>\n            </Card>\n          );\n        })}\n      </div>\n\n      {/* Game Dialog */}\n      <Dialog open={selectedGame !== null} onOpenChange={() => closeGame()}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              {selectedGame && React.createElement(selectedGame.icon, { className: \"w-6 h-6\" })}\n              {selectedGame?.title}\n            </DialogTitle>\n            <DialogDescription>\n              {selectedGame?.description || 'Play mini-games to earn XP and improve your skills'}\n            </DialogDescription>\n          </DialogHeader>\n\n          {miniGameState === 'menu' && selectedGame && (\n            <div className=\"space-y-6\">\n              <div className=\"text-center\">\n                <p className=\"text-lg mb-4\">{selectedGame.description}</p>\n                <div className=\"grid grid-cols-2 gap-4 max-w-md mx-auto\">\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-blue-600\">{selectedGame.duration}</div>\n                    <div className=\"text-sm text-gray-600\">{t('duration')}</div>\n                  </div>\n                  <div className=\"text-center\">\n                    <div className=\"text-2xl font-bold text-green-600\">{selectedGame.reward}</div>\n                    <div className=\"text-sm text-gray-600\">{t('reward')}</div>\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\n                <h3 className=\"font-medium mb-2\">{t('howToPlay')}</h3>\n                <p className=\"text-sm\">\n                  {selectedGame.id === 'ddos-protection' ? t('ddosInstructions') : t('firewallInstructions')}\n                </p>\n              </div>\n\n              <Button\n                onClick={() => selectedGame.id === 'ddos-protection' ? startDdosGame() : startFirewallGame()}\n                className=\"w-full\"\n                data-testid=\"start-game\"\n              >\n                {t('startGame')}\n              </Button>\n            </div>\n          )}\n\n          {miniGameState === 'playing' && selectedGame?.id === 'ddos-protection' && (\n            <div className=\"space-y-4\">\n              <div className=\"flex justify-between items-center\">\n                <div className=\"text-lg font-bold\">{t('score')}: {ddosState.score}</div>\n                <div className=\"text-lg\">{t('timeLeft')}: {ddosState.timeLeft}s</div>\n              </div>\n              \n              <div \n                className=\"relative bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden\"\n                style={{ height: '400px', width: '100%' }}\n              >\n                {!ddosState.gameOver && ddosState.packets.map(packet => (\n                  <div\n                    key={packet.id}\n                    className=\"absolute bg-red-500 text-white rounded p-2 cursor-pointer hover:bg-red-600 transition-colors\"\n                    style={{\n                      left: `${packet.x}px`,\n                      top: `${packet.y}px`,\n                      transform: 'translate(-50%, -50%)'\n                    }}\n                    onClick={() => destroyPacket(packet.id)}\n                    data-testid={`packet-${packet.id}`}\n                  >\n                    📦\n                  </div>\n                ))}\n                \n                <div className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-center\">\n                  <Shield className=\"w-12 h-12 text-blue-600 mx-auto\" />\n                  <div className=\"text-sm mt-2\">{t('yourServer')}</div>\n                </div>\n                \n                {ddosState.gameOver && miniGameState === 'playing' && (\n                  <div className=\"absolute inset-0 bg-black bg-opacity-75 flex items-center justify-center\">\n                    <div className=\"bg-white dark:bg-gray-800 p-8 rounded-lg text-center space-y-4\">\n                      <div className=\"text-2xl font-bold text-green-600\">{t('gameCompleted')}</div>\n                      <div className=\"text-lg\">\n                        {t('packetsDestroyed')}: {ddosState.score}\n                      </div>\n                      <div className=\"text-lg text-green-600\">+{ddosState.score} XP</div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {miniGameState === 'playing' && selectedGame?.id === 'firewall-filter' && (\n            <div className=\"space-y-6\">\n              <div className=\"flex justify-between items-center\">\n                <div className=\"text-lg font-bold\">{t('score')}: {firewallState.score}</div>\n                <div className=\"text-lg\">{t('requestsLeft')}: {firewallState.requestsLeft}</div>\n              </div>\n              \n              <Progress value={(10 - firewallState.requestsLeft) / 10 * 100} className=\"w-full\" />\n              \n              {firewallState.currentRequest && !firewallState.gameOver && (\n                <div className=\"text-center space-y-6\">\n                  <div className=\"bg-gray-100 dark:bg-gray-800 p-8 rounded-lg\">\n                    <div className=\"text-2xl font-bold mb-4\">\n                      {firewallState.currentRequest.type}\n                    </div>\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                      {t('blockOrAllow')}\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex gap-4 justify-center\">\n                    <Button\n                      onClick={() => handleFirewallChoice('block')}\n                      variant=\"destructive\"\n                      size=\"lg\"\n                      data-testid=\"block-request\"\n                      disabled={firewallState.gameOver}\n                    >\n                      <XCircle className=\"w-6 h-6 mr-2\" />\n                      {t('block')}\n                    </Button>\n                    <Button\n                      onClick={() => handleFirewallChoice('allow')}\n                      variant=\"default\"\n                      size=\"lg\"\n                      data-testid=\"allow-request\"\n                      disabled={firewallState.gameOver}\n                    >\n                      <CheckCircle className=\"w-6 h-6 mr-2\" />\n                      {t('allow')}\n                    </Button>\n                  </div>\n                </div>\n              )}\n\n              {firewallState.gameOver && miniGameState === 'playing' && (\n                <div className=\"text-center space-y-4\">\n                  <div className=\"text-2xl font-bold text-green-600\">{t('gameCompleted')}</div>\n                  <div className=\"text-lg\">\n                    {t('score')}: {firewallState.score}/10\n                  </div>\n                  <div className=\"text-lg text-green-600\">+{firewallState.score} XP</div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {miniGameState === 'results' && (\n            <div className=\"text-center space-y-6\">\n              <div className=\"text-3xl font-bold text-green-600\">{t('gameCompleted')}</div>\n              \n              {selectedGame?.id === 'ddos-protection' && (\n                <div className=\"space-y-4\">\n                  <div className=\"text-xl\">{t('packetsDestroyed')}: {ddosState.score}</div>\n                  <div className=\"text-lg text-green-600\">+{ddosState.score} XP</div>\n                </div>\n              )}\n              \n              {selectedGame?.id === 'firewall-filter' && (\n                <div className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4 max-w-md mx-auto\">\n                    <div>\n                      <div className=\"text-2xl font-bold text-green-600\">{firewallState.correctChoices}</div>\n                      <div className=\"text-sm\">{t('correct')}</div>\n                    </div>\n                    <div>\n                      <div className=\"text-2xl font-bold text-red-600\">{firewallState.wrongChoices}</div>\n                      <div className=\"text-sm\">{t('wrong')}</div>\n                    </div>\n                  </div>\n                  <div className=\"text-lg text-green-600\">+{firewallState.score} XP</div>\n                </div>\n              )}\n\n              <Button onClick={closeGame} className=\"w-full\" data-testid=\"close-results\">\n                {t('close')}\n              </Button>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n};\n\nexport default MiniGamesTab;","size_bytes":21316},"client/src/components/server-connection-game.jsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Progress } from '@/components/ui/progress';\nimport { X, Zap } from 'lucide-react';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useToast } from '@/hooks/use-toast';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\n\nconst ServerConnectionGame = ({ isOpen, onClose, server, onSuccess }) => {\n  const { t } = useLanguage();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [gameState, setGameState] = useState('instructions'); // instructions, playing, success, failed\n  const [gameCompleted, setGameCompleted] = useState(false);\n  const [timeLeft, setTimeLeft] = useState(30);\n  const [connections, setConnections] = useState([]);\n  const [draggedCable, setDraggedCable] = useState(null);\n  const [cables, setCables] = useState([]);\n  const [ports, setPorts] = useState([]);\n\n  const updateServerMutation = useMutation({\n    mutationFn: async (serverId) => {\n      console.log(`[MINI-GAME] Activating server ${serverId}`);\n      \n      try {\n        const response = await fetch(`/api/servers/${serverId}/toggle`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          credentials: 'include'\n        });\n        \n        console.log(`[MINI-GAME] Response status: ${response.status}`);\n        console.log(`[MINI-GAME] Response headers:`, Object.fromEntries(response.headers));\n        \n        const responseText = await response.text();\n        console.log(`[MINI-GAME] Response text:`, responseText);\n        \n        if (!response.ok) {\n          throw new Error(`HTTP ${response.status}: ${responseText}`);\n        }\n        \n        let responseData;\n        try {\n          responseData = JSON.parse(responseText);\n        } catch (jsonError) {\n          console.error('[MINI-GAME] JSON parse error:', jsonError);\n          throw new Error(`Invalid JSON response: ${responseText.substring(0, 100)}`);\n        }\n        \n        console.log(`[MINI-GAME] Server activation response:`, responseData);\n        return responseData;\n      } catch (error) {\n        console.error('[MINI-GAME] Server activation error:', error);\n        throw error;\n      }\n    },\n    onSuccess: (data) => {\n      console.log('[MINI-GAME] Server activated successfully:', data);\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      if (onSuccess) onSuccess();\n    },\n    onError: (error) => {\n      console.error('[MINI-GAME] Failed to activate server:', error);\n      toast({\n        title: t('error'),\n        description: 'Failed to activate server: ' + error.message,\n        variant: 'destructive'\n      });\n    }\n  });\n\n  const damageServerMutation = useMutation({\n    mutationFn: (serverId) => apiRequest(`/api/servers/${serverId}/damage`, 'POST'),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/servers'] });\n    }\n  });\n\n  const updateExpMutation = useMutation({\n    mutationFn: (xpGained) => apiRequest('/api/users/add-xp', 'POST', { xp: xpGained }),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n    },\n    onError: (error) => {\n      console.error('Failed to add XP:', error);\n    }\n  });\n\n  const colors = ['#ff4444', '#44ff44', '#4444ff', '#ffff44', '#ff44ff', '#44ffff'];\n\n  useEffect(() => {\n    if (isOpen && gameState === 'instructions') {\n      // Reset game state when opening\n      setGameCompleted(false);\n      initializeGame();\n    }\n  }, [isOpen]);\n\n  useEffect(() => {\n    if (gameState === 'playing' && timeLeft > 0) {\n      const timer = setTimeout(() => {\n        setTimeLeft(timeLeft - 1);\n      }, 1000);\n      return () => clearTimeout(timer);\n    } else if (gameState === 'playing' && timeLeft <= 0) {\n      handleGameFailed();\n    }\n  }, [timeLeft, gameState]);\n\n  const generateCables = (numConnections) => {\n    const gameColors = colors.slice(0, numConnections);\n    \n    // Create cables (left side) - improved spacing for mobile\n    const shuffledIndexes = Array.from({length: numConnections}, (_, i) => i).sort(() => Math.random() - 0.5);\n    return gameColors.map((color, index) => ({\n      id: `cable-${index}`,\n      color,\n      x: 40,\n      y: 50 + shuffledIndexes[index] * 60, // Increased spacing and Y offset\n      connected: false\n    }));\n  };\n\n  const generatePorts = (numConnections) => {\n    const gameColors = colors.slice(0, numConnections);\n    \n    // Create ports (right side) - improved spacing for mobile\n    const shuffledColors = [...gameColors].sort(() => Math.random() - 0.5);\n    const shuffledPortIndexes = Array.from({length: numConnections}, (_, i) => i).sort(() => Math.random() - 0.5);\n    return shuffledColors.map((color, index) => ({\n      id: `port-${index}`,\n      color,\n      x: 320,\n      y: 50 + shuffledPortIndexes[index] * 60, // Increased spacing and Y offset\n      connected: false\n    }));\n  };\n\n  const initializeGame = () => {\n    // Generate same number of connections for both cables and ports\n    const numConnections = Math.floor(Math.random() * 3) + 4; // 4-6 connections\n    const newCables = generateCables(numConnections);\n    const newPorts = generatePorts(numConnections);\n    \n    setCables(newCables);\n    setPorts(newPorts);\n    setConnections([]);\n    setDraggedCable(null);\n    setTimeLeft(30);\n  };\n\n  const startGame = () => {\n    setGameState('playing');\n  };\n\n  const handleCableMouseDown = (cable) => {\n    if (!cable.connected) {\n      setDraggedCable(cable);\n    }\n  };\n\n  const handlePortClick = (port) => {\n    if (draggedCable && !port.connected && draggedCable.color === port.color) {\n      // Correct connection\n      const newConnection = {\n        from: draggedCable,\n        to: port,\n        id: `connection-${draggedCable.id}-${port.id}`\n      };\n\n      setConnections(prev => [...prev, newConnection]);\n      setCables(prev => prev.map(c => c.id === draggedCable.id ? {...c, connected: true} : c));\n      setPorts(prev => prev.map(p => p.id === port.id ? {...p, connected: true} : p));\n      setDraggedCable(null);\n\n      // Check if all connections are made\n      if (connections.length + 1 === cables.length) {\n        handleGameSuccess();\n      }\n    } else if (draggedCable && !port.connected) {\n      // Wrong connection\n      setDraggedCable(null);\n      toast({\n        title: t('serverminigame3'),\n        description: t('serverminigame4'),\n        variant: 'destructive'\n      });\n    }\n  };\n\n  const handleGameSuccess = () => {\n    if (gameCompleted) return; // Prevent multiple executions\n    \n    setGameCompleted(true);\n    // Immediately activate server\n    updateServerMutation.mutate(server.id);\n    \n    // Show toast notification and close game\n    toast({\n      title: t('serverminigame5'),\n      description: t('serverminigame6'),\n    });\n    \n    // Close game after brief delay\n    setTimeout(() => {\n      closeGame();\n    }, 500);\n  };\n\n  const handleGameFailed = () => {\n    if (gameCompleted) return; // Prevent multiple executions\n    \n    setGameCompleted(true);\n    // Immediately damage server\n    damageServerMutation.mutate(server.id);\n    \n    // Add 1 second delay before showing result window\n    setTimeout(() => {\n      setGameState('failed');\n      toast({\n        title: t('serverminigame7'),\n        description: t('serverminigame8'),\n        variant: 'destructive'\n      });\n    }, 1000);\n  };\n\n  const closeGame = () => {\n    setGameState('instructions');\n    setGameCompleted(false);\n    setConnections([]);\n    setTimeLeft(30);\n    setDraggedCable(null);\n    onClose();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <Dialog open={isOpen} onOpenChange={closeGame}>\n      <DialogContent className=\"max-w-2xl\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Zap className=\"w-6 h-6 text-yellow-500\" />\n            {t('serverminigame1')}\n          </DialogTitle>\n          <DialogDescription>\n            {t('serverminigame2') || 'Connect the cables to their matching ports to activate the server'}\n          </DialogDescription>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            className=\"absolute right-4 top-4\"\n            onClick={closeGame}\n            data-testid=\"button-close-game\"\n          >\n            <X className=\"w-4 h-4\" />\n          </Button>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {gameState === 'instructions' && (\n            <div className=\"text-center space-y-4\">\n              <div className=\"text-lg text-gray-600 dark:text-gray-300\">\n                {t('serverminigame2')}\n              </div>\n              <Button onClick={startGame} className=\"bg-green-600 hover:bg-green-700\">\n                {t('startGame')}\n              </Button>\n            </div>\n          )}\n\n          {gameState === 'playing' && (\n            <div className=\"space-y-4\">\n              <div className=\"flex justify-between items-center\">\n                <div className=\"text-lg font-bold\">{t('timeLeft')}: {timeLeft}s</div>\n                <Progress value={(30 - timeLeft) / 30 * 100} className=\"w-32\" />\n              </div>\n\n              <div className=\"relative bg-gray-100 dark:bg-gray-800 rounded-lg p-4 overflow-hidden\" style={{ height: '400px', minWidth: '360px' }}>\n\n                {/* Cables (left side) */}\n                {cables.map((cable) => (\n                  <div\n                    key={cable.id}\n                    className={`absolute w-5 h-5 rounded-full cursor-pointer transition-transform hover:scale-110 ${\n                      cable.connected ? 'opacity-50' : ''\n                    }`}\n                    style={{\n                      backgroundColor: cable.color,\n                      left: `${cable.x}px`,\n                      top: `${cable.y}px`,\n                      border: draggedCable?.id === cable.id ? '3px solid white' : '2px solid #333'\n                    }}\n                    onMouseDown={() => handleCableMouseDown(cable)}\n                    data-testid={`cable-${cable.id}`}\n                  />\n                ))}\n\n                {/* Ports (right side) */}\n                {ports.map((port) => (\n                  <div\n                    key={port.id}\n                    className={`absolute w-5 h-5 cursor-pointer transition-transform hover:scale-110 ${\n                      port.connected ? 'opacity-50' : ''\n                    }`}\n                    style={{\n                      backgroundColor: port.color,\n                      left: `${port.x}px`,\n                      top: `${port.y}px`,\n                      border: '2px solid #333',\n                      clipPath: 'polygon(0 0, 100% 50%, 0 100%)'\n                    }}\n                    onClick={() => handlePortClick(port)}\n                    data-testid={`port-${port.id}`}\n                  />\n                ))}\n\n                {/* Connection lines */}\n                {connections.map((connection) => (\n                  <svg\n                    key={connection.id}\n                    className=\"absolute inset-0 pointer-events-none\"\n                    style={{ width: '100%', height: '100%' }}\n                  >\n                    <line\n                      x1={connection.from.x + 8}\n                      y1={connection.from.y + 8}\n                      x2={connection.to.x + 8}\n                      y2={connection.to.y + 8}\n                      stroke={connection.from.color}\n                      strokeWidth=\"3\"\n                    />\n                  </svg>\n                ))}\n\n                {/* Dragged cable line */}\n                {draggedCable && (\n                  <svg\n                    className=\"absolute inset-0 pointer-events-none\"\n                    style={{ width: '100%', height: '100%' }}\n                  >\n                    <line\n                      x1={draggedCable.x + 8}\n                      y1={draggedCable.y + 8}\n                      x2={draggedCable.x + 100}\n                      y2={draggedCable.y + 8}\n                      stroke={draggedCable.color}\n                      strokeWidth=\"3\"\n                      strokeDasharray=\"5,5\"\n                    />\n                  </svg>\n                )}\n              </div>\n\n              <div className=\"text-center\">\n                <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  {t('serverminigame9')} {connections.length}/{cables.length}\n                </div>\n              </div>\n            </div>\n          )}\n\n\n\n          {gameState === 'failed' && (\n            <div className=\"text-center space-y-4\">\n              <div className=\"text-2xl font-bold text-red-600\">{t('serverminigame7')}</div>\n              <div className=\"text-gray-600 dark:text-gray-300\">{t('serverminigame11')}</div>\n              <Button \n                onClick={closeGame} \n                variant=\"destructive\"\n                data-testid=\"button-close-failed\"\n              >\n                {t('close')}\n              </Button>\n            </div>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default ServerConnectionGame;","size_bytes":13453},"client/src/lib/security.js":{"content":"// Security utilities for production environment\n\n// Override console methods in production to prevent sensitive data exposure\nexport const secureConsole = () => {\n  if (import.meta.env.MODE === 'production') {\n    const noop = () => {};\n    \n    // Override console methods that could expose sensitive data\n    console.log = noop;\n    console.info = noop;\n    console.warn = noop;\n    console.error = noop;\n    console.debug = noop;\n    console.trace = noop;\n    console.table = noop;\n    console.group = noop;\n    console.groupCollapsed = noop;\n    console.groupEnd = noop;\n    console.time = noop;\n    console.timeEnd = noop;\n    console.timeLog = noop;\n    console.count = noop;\n    console.countReset = noop;\n    console.clear = noop;\n    console.dir = noop;\n    console.dirxml = noop;\n    console.assert = noop;\n    \n    // Hide React DevTools and other debugging tools\n    if (window.__REACT_DEVTOOLS_GLOBAL_HOOK__) {\n      window.__REACT_DEVTOOLS_GLOBAL_HOOK__.isDisabled = true;\n    }\n    \n    // Prevent right-click context menu in production\n    document.addEventListener('contextmenu', (e) => {\n      e.preventDefault();\n      return false;\n    });\n    \n    // Prevent F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U\n    document.addEventListener('keydown', (e) => {\n      if (\n        e.key === 'F12' ||\n        (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J')) ||\n        (e.ctrlKey && e.key === 'U')\n      ) {\n        e.preventDefault();\n        return false;\n      }\n    });\n    \n    // Clear sensitive data from localStorage/sessionStorage\n    const sensitiveKeys = ['auth_token', 'user_session', 'password'];\n    sensitiveKeys.forEach(key => {\n      if (localStorage.getItem(key)) {\n        localStorage.removeItem(key);\n      }\n      if (sessionStorage.getItem(key)) {\n        sessionStorage.removeItem(key);\n      }\n    });\n  }\n};\n\n// Initialize security measures when module is imported\nif (typeof window !== 'undefined') {\n  secureConsole();\n}","size_bytes":1969},"client/src/components/chat-message-badge.jsx":{"content":"import { Badge } from '@/components/ui/badge';\nimport { Crown, Star, Shield } from 'lucide-react';\nimport { motion } from 'framer-motion';\n\nexport default function ChatMessageBadge({ user }) {\n  const hasVip = user?.vipExpires && new Date(user.vipExpires) > new Date();\n  const hasPremium = user?.premiumActive;\n  const isAdmin = user?.role === 'admin';\n  const isSuperAdmin = user?.role === 'superadmin';\n  \n  // Priority: Super Admin > Admin > Premium > VIP\n  if (isSuperAdmin) {\n    return (\n      <motion.div\n        animate={{ \n          background: [\n            'linear-gradient(45deg, #ef4444, #f97316, #eab308, #22c55e, #3b82f6, #8b5cf6, #ef4444)',\n            'linear-gradient(45deg, #f97316, #eab308, #22c55e, #3b82f6, #8b5cf6, #ef4444, #f97316)',\n            'linear-gradient(45deg, #eab308, #22c55e, #3b82f6, #8b5cf6, #ef4444, #f97316, #eab308)'\n          ]\n        }}\n        transition={{ duration: 3, repeat: Infinity, ease: \"linear\" }}\n        className=\"px-2 py-0.5 rounded text-white text-xs font-bold shadow-lg\"\n      >\n        <div className=\"flex items-center space-x-1\">\n          <Shield className=\"w-3 h-3\" />\n          <span>SUPER ADMIN</span>\n        </div>\n      </motion.div>\n    );\n  }\n  \n  if (isAdmin) {\n    return (\n      <Badge className=\"bg-gradient-to-r from-yellow-600 to-orange-600 text-white text-xs font-bold\">\n        <Shield className=\"w-3 h-3 mr-1\" />\n        ADMIN\n      </Badge>\n    );\n  }\n  \n  if (hasPremium) {\n    return (\n      <motion.div\n        animate={{ \n          boxShadow: [\n            '0 0 5px rgba(147, 51, 234, 0.5)',\n            '0 0 15px rgba(147, 51, 234, 0.8)',\n            '0 0 5px rgba(147, 51, 234, 0.5)'\n          ]\n        }}\n        transition={{ duration: 2, repeat: Infinity }}\n        className=\"px-2 py-0.5 rounded text-white text-xs font-bold bg-gradient-to-r from-purple-600 to-pink-600\"\n      >\n        <div className=\"flex items-center space-x-1\">\n          <Crown className=\"w-3 h-3\" />\n          <span>PREMIUM</span>\n        </div>\n      </motion.div>\n    );\n  }\n  \n  if (hasVip) {\n    return (\n      <motion.div\n        animate={{ \n          opacity: [1, 0.8, 1],\n          scale: [1, 1.05, 1]\n        }}\n        transition={{ duration: 1.5, repeat: Infinity }}\n        className=\"px-2 py-0.5 rounded text-white text-xs font-bold bg-gradient-to-r from-blue-600 to-cyan-600\"\n      >\n        <div className=\"flex items-center space-x-1\">\n          <Star className=\"w-3 h-3\" />\n          <span>VIP</span>\n        </div>\n      </motion.div>\n    );\n  }\n  \n  return null;\n}","size_bytes":2549},"client/src/components/subscription-status-icon.jsx":{"content":"import { Crown, Star, AlertCircle } from 'lucide-react'\nimport { motion } from 'framer-motion'\nimport { useState } from 'react'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog'\nimport { Badge } from '@/components/ui/badge'\nimport { formatDistanceToNow } from 'date-fns'\nimport { Avatar, AvatarFallback } from '@/components/ui/avatar'\n\nconst SubscriptionStatusIcon = ({ \n  user, \n  size = 'md',\n  showInProfile = false \n}) => {\n  const [isOpen, setIsOpen] = useState(false)\n  \n  if (!user) return null\n\n  const hasPremium = user.premiumStatus === 'active'\n  const hasVip = user.vipStatus === 'active' && user.vipExpiresAt && new Date(user.vipExpiresAt) > new Date()\n  \n  if (!hasPremium && !hasVip) return null\n\n  const iconSize = {\n    sm: 'w-3 h-3',\n    md: 'w-4 h-4',\n    lg: 'w-5 h-5'\n  }[size]\n\n  const getStatusInfo = () => {\n    if (hasPremium) {\n      return {\n        icon: Crown,\n        color: 'text-purple-500',\n        bgColor: 'bg-purple-500/10 border-purple-500/20',\n        title: 'PREMIUM',\n        description: 'Навсегда активен',\n        benefits: [\n          'Фиолетовая отметка PREMIUM в чате',\n          'Сокращенный КД: 1.5м/2м/5м вместо 3м/5м/7м',\n          'x1.75 опыта за работу',\n          'Приоритет в репортах',\n          'Без КД на мини-игры',\n          'Лимит серверов: 30 вместо 25',\n          'Мгновенная активация серверов',\n          'Премиум эмодзи для чата',\n          'Секретные реакции на сообщения',\n          'Ежедневный бонус: +500 вместо +100'\n        ]\n      }\n    } else {\n      return {\n        icon: Star,\n        color: 'text-blue-500',\n        bgColor: 'bg-blue-500/10 border-blue-500/20',\n        title: 'VIP',\n        description: user.vipExpiresAt ? `Истекает ${formatDistanceToNow(new Date(user.vipExpiresAt), { addSuffix: true })}` : 'Активен',\n        benefits: [\n          'Синяя отметка VIP в чате',\n          'Сокращенный КД: 2м/4м/6м вместо 3м/5м/7м',\n          'x1.5 опыта за работу',\n          'Приоритет в репортах',\n          'Уникальные эмодзи для чата',\n          'Ежедневный бонус: +200 вместо +100'\n        ]\n      }\n    }\n  }\n\n  const statusInfo = getStatusInfo()\n  const IconComponent = statusInfo.icon\n\n  if (showInProfile) {\n    return (\n      <Dialog open={isOpen} onOpenChange={setIsOpen}>\n        <DialogTrigger asChild>\n          <motion.button\n            className={`inline-flex items-center justify-center rounded-full p-1 ${statusInfo.bgColor} border cursor-pointer hover:scale-110 transition-transform`}\n            animate={{ \n              rotate: [0, 5, -5, 0],\n              scale: [1, 1.05, 1]\n            }}\n            transition={{ \n              duration: 3,\n              repeat: Infinity,\n              repeatType: \"reverse\"\n            }}\n          >\n            <IconComponent className={`${iconSize} ${statusInfo.color}`} />\n          </motion.button>\n        </DialogTrigger>\n        <DialogContent className=\"bg-slate-800 border-slate-700 max-w-md\">\n          <DialogHeader>\n            <DialogTitle className=\"text-white flex items-center gap-2\">\n              <IconComponent className={`w-5 h-5 ${statusInfo.color}`} />\n              {statusInfo.title}\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-3\">\n              <Avatar className=\"w-12 h-12\">\n                <AvatarFallback className=\"bg-gradient-to-r from-blue-500 to-purple-500 text-white font-bold\">\n                  {user.nickname[0].toUpperCase()}\n                </AvatarFallback>\n              </Avatar>\n              <div>\n                <h3 className=\"text-white font-medium\">{user.nickname}</h3>\n                <p className=\"text-slate-400 text-sm\">{statusInfo.description}</p>\n              </div>\n            </div>\n            \n            <div>\n              <h4 className=\"text-white font-medium mb-2\">Привилегии:</h4>\n              <div className=\"space-y-1\">\n                {statusInfo.benefits.map((benefit, index) => (\n                  <div key={index} className=\"text-slate-300 text-sm flex items-center gap-2\">\n                    <div className={`w-1 h-1 rounded-full ${statusInfo.color.replace('text-', 'bg-')}`} />\n                    {benefit}\n                  </div>\n                ))}\n              </div>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    )\n  }\n\n  return (\n    <motion.div\n      className=\"inline-flex items-center cursor-pointer\"\n      animate={{ \n        rotate: [0, 5, -5, 0],\n        scale: [1, 1.1, 1]\n      }}\n      transition={{ \n        duration: 2,\n        repeat: Infinity,\n        repeatType: \"reverse\"\n      }}\n    >\n      <IconComponent className={`${iconSize} ${statusInfo.color}`} />\n    </motion.div>\n  )\n}\n\nexport default SubscriptionStatusIcon","size_bytes":5211},"client/src/components/purchase-dialog.jsx":{"content":"import React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Star, Crown, CreditCard, FileText, Loader2, Coins } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\nimport { useLanguage } from '@/contexts/language-context';\n\n// Список доступных криптовалют с названиями\nconst cryptocurrencies = [\n  { code: 'usdttrc20', name: 'USDT (TRC20)', description: 'Tether USD on Tron' },\n  { code: 'usdterc20', name: 'USDT (ERC20)', description: 'Tether USD on Ethereum' },\n  { code: 'usdc', name: 'USDC', description: 'USD Coin' },\n  { code: 'ltc', name: 'Litecoin (LTC)', description: 'Litecoin' },\n  { code: 'trx', name: 'Tron (TRX)', description: 'Tron' },\n  { code: 'btc', name: 'Bitcoin (BTC)', description: 'Bitcoin' },\n  { code: 'eth', name: 'Ethereum (ETH)', description: 'Ethereum' },\n];\n\nexport default function PurchaseDialog({ type, price, children, disabled }) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [selectedCrypto, setSelectedCrypto] = useState('usdttrc20'); // По умолчанию USDT TRC20\n  const { toast } = useToast();\n  const { t } = useLanguage();\n  const queryClient = useQueryClient();\n\n  const purchaseMutation = useMutation({\n    mutationFn: ({ type, crypto }) => apiRequest('/api/card-crypto-purchase', 'POST', { type, crypto }),\n    onSuccess: (data) => {\n      if (data.paymentUrl) {\n        window.open(data.paymentUrl, '_blank');\n        toast({\n          title: t('paymentInitiated'),\n          description: t('redirectedToPayment'),\n          duration: 8000,\n        });\n      }\n      setIsOpen(false);\n      // Reload user data after payment\n      setTimeout(() => {\n        queryClient.invalidateQueries(['/api/auth/me']);\n      }, 3000);\n    },\n    onError: (error) => {\n      toast({\n        title: 'Ошибка создания платежа',\n        description: error.message || 'Попробуйте снова',\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const fiatPurchaseMutation = useMutation({\n    mutationFn: ({ type }) => apiRequest('/api/donate/fiat', 'POST', { type }),\n    onSuccess: (data) => {\n      if (data.paymentUrl) {\n        window.open(data.paymentUrl, '_blank');\n        toast({\n          title: 'Переход к оплате',\n          description: 'На странице оплаты выберите USD, затем оплачивайте картой. Ваши доллары конвертируются в крипту автоматически.',\n          duration: 10000,\n        });\n      }\n      setIsOpen(false);\n      // Reload user data after payment\n      setTimeout(() => {\n        queryClient.invalidateQueries(['/api/auth/me']);\n      }, 3000);\n    },\n    onError: (error) => {\n      toast({\n        title: 'Ошибка создания fiat-платежа',\n        description: error.message || 'Попробуйте снова',\n        variant: 'destructive',\n      });\n    },\n  });\n\n  const handlePurchase = () => {\n    if (disabled) {\n      toast({\n        title: 'Недоступно',\n        description: 'У вас уже есть активный статус',\n        variant: 'destructive',\n      });\n      return;\n    }\n    \n    purchaseMutation.mutate({ type, crypto: selectedCrypto });\n  };\n\n  const handleFiatPurchase = () => {\n    if (disabled) {\n      toast({\n        title: 'Недоступно',\n        description: 'У вас уже есть активный статус',\n        variant: 'destructive',\n      });\n      return;\n    }\n    fiatPurchaseMutation.mutate({ type });\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\n      <DialogTrigger asChild>\n        <div>\n          {children}\n        </div>\n      </DialogTrigger>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            {type === 'vip' ? (\n              <>\n                <Star className=\"w-5 h-5 text-blue-400\" />\n                VIP {t('status')}\n              </>\n            ) : (\n              <>\n                <Crown className=\"w-5 h-5 text-purple-400\" />\n                PREMIUM {t('status')}\n              </>\n            )}\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          <div className=\"text-center p-4 bg-slate-800 rounded-lg\">\n            <div className=\"text-2xl font-bold text-green-400\">${price}</div>\n            <div className=\"text-sm text-slate-400\">\n              {type === 'vip' ? t('month') : t('forever')}\n            </div>\n          </div>\n\n          <div className=\"bg-slate-800 p-3 rounded-lg\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <FileText className=\"w-4 h-4 text-green-400\" />\n              <span className=\"font-medium\">Документ об оплате</span>\n            </div>\n            <p className=\"text-sm text-slate-400\">\n              После успешной оплаты вы сможете скачать PDF документ с подтверждением покупки и деталями заказа.\n            </p>\n          </div>\n\n          <div className=\"bg-yellow-900/20 border border-yellow-500/30 p-3 rounded-lg\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <CreditCard className=\"w-4 h-4 text-yellow-400\" />\n              <span className=\"font-medium text-yellow-300\">{t('unavailableCardPayment')}</span>\n            </div>\n            <p className=\"text-sm text-yellow-200\">\n              {t('cardPaymentUnavailable')}\n            </p>\n            <p className=\"text-xs text-yellow-300 mt-2\">\n              {t('useStablecoins')}\n            </p>\n          </div>\n\n          <div className=\"space-y-3\">\n            <Button \n              disabled={true}\n              className=\"w-full bg-gray-600 text-gray-400 cursor-not-allowed opacity-50\"\n            >\n              <CreditCard className=\"w-4 h-4 mr-2\" />\n              {t('unavailableCardPayment')} ${price} USD\n            </Button>\n\n            {/* Crypto Currency Selector */}\n            <div className=\"space-y-2\">\n              <label className=\"text-sm font-medium\">{t('selectCurrency')}</label>\n              <Select value={selectedCrypto} onValueChange={setSelectedCrypto}>\n                <SelectTrigger className=\"w-full\">\n                  <SelectValue placeholder={t('selectCurrency')} />\n                </SelectTrigger>\n                <SelectContent>\n                  {cryptocurrencies.map((crypto) => (\n                    <SelectItem key={crypto.code} value={crypto.code}>\n                      <div className=\"flex items-center gap-2\">\n                        <Coins className=\"w-4 h-4\" />\n                        <div>\n                          <div className=\"font-medium\">{crypto.name}</div>\n                          <div className=\"text-xs text-muted-foreground\">{crypto.description}</div>\n                        </div>\n                      </div>\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <Button \n              onClick={handlePurchase}\n              disabled={purchaseMutation.isPending}\n              className=\"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700\"\n            >\n              {purchaseMutation.isPending ? (\n                <>\n                  <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                  {t('processing')}\n                </>\n              ) : (\n                <>\n                  <Coins className=\"w-4 h-4 mr-2\" />\n                  {t('payWithCrypto')} ${price}\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":8231},"EMAIL_SETUP.md":{"content":"# Настройка Email уведомлений для VIP/Premium платежей\n\n## SendGrid Setup\n\n### 1. Создание аккаунта SendGrid\n1. Зарегистрируйтесь на https://sendgrid.com/\n2. Подтвердите email адрес\n3. Пройдите верификацию аккаунта\n\n### 2. Получение API ключа\n1. Перейдите в Settings → API Keys\n2. Создайте новый API Key\n3. Выберите \"Full Access\" или \"Restricted Access\" с правами Mail Send\n4. Сохраните ключ (он показывается только один раз)\n\n### 3. Настройка в проекте\nДобавьте в переменные окружения:\n```\nSENDGRID_API_KEY=SG.ваш-api-ключ-здесь\nSENDGRID_FROM_EMAIL=noreply@yourdomain.com\n```\n\n### 4. Верификация отправителя\n1. В SendGrid перейдите в Settings → Sender Authentication\n2. Верифицируйте email домен или single sender\n3. Используйте верифицированный email в SENDGRID_FROM_EMAIL\n\n## Шаблон письма\n\nСистема будет отправлять письма с подтверждением платежа содержащие:\n- Статус заказа (VIP/Premium)\n- Номер заказа\n- Сумму платежа\n- Дату активации\n- Ссылку для возврата в игру\n\n## Использование\n\nПосле настройки переменных окружения, система автоматически будет отправлять email уведомления при успешных платежах через webhook `/api/payment-webhook`.\n\n## Тестирование\n\nДля тестирования email системы можно использовать эндпоинт:\n```bash\nPOST /api/test-email\n{\n  \"email\": \"test@example.com\",\n  \"orderId\": \"test_123\",\n  \"type\": \"vip\",\n  \"amount\": 2.5\n}\n```","size_bytes":2012},"PAYMENT_SETUP.md":{"content":"# Настройка системы платежей VIP/Premium с NOWPayments\n\n## Требуемые переменные окружения\n\n### 1. NOWPayments API ключ\n```\nNOWPAYMENTS_API_KEY=0BYBCND-44G4DAZ-K5FPR03-WQKCRAF\n```\nВаш рабочий API ключ уже настроен в системе\n\n### 2. Email настройки для уведомлений\n```\nGAME_EMAIL=noreply@yourgame.com\nADMIN_EMAIL=admin@yourgame.com\n```\n\n### 3. SendGrid для email (опционально)\n```\nSENDGRID_API_KEY=SG.ваш_sendgrid_ключ\n```\n\n## Как работает система с NOWPayments\n\n1. **Пользователь нажимает \"Купить VIP/Premium\"**\n2. **Вводит email для подтверждения**\n3. **Система создает инвойс через NOWPayments API**\n4. **Пользователь перенаправляется на NOWPayments**\n5. **Платит банковской картой или любой из 300+ криптовалют**\n6. **NOWPayments автоматически конвертирует в USDT TRC20**\n7. **USDT поступают на ваш кошелек в NOWPayments**\n8. **Webhook активирует статус в игре**\n9. **Email уведомление отправляется пользователю**\n\n## Настройка NOWPayments\n\n1. **Регистрация**: https://nowpayments.io/\n2. **Создание API ключа** в панели управления\n3. **Настройка webhook** для автоматического подтверждения платежей:\n   - Webhook URL: `https://ваш-домен.replit.app/api/payment-webhook`\n   - Если используете Replit: `https://your-repl-name.your-username.replit.app/api/payment-webhook`\n   - Events: выберите \"invoice.paid\" и \"payment.finished\"\n4. **Выбор USDT TRC20** как основной валюты для получения\n\n## Преимущества NOWPayments\n\n- **300+ криптовалют** для оплаты\n- **Банковские карты** поддерживаются\n- **Низкие комиссии** (особенно USDT TRC20)\n- **Автоматические конвертации** в вашу валюту\n- **Webhook система** для мгновенного подтверждения\n- **КYC не требуется** для большинства транзакций\n\n## Цены\n- VIP: $2.50/месяц  \n- Premium: $10 навсегда\n\n## Настройка через админ-панель\nСуперадмин может настроить все параметры через игровую админ-панель:\n- NOWPayments API ключ\n- Email для уведомлений\n- Тестирование подключения","size_bytes":2809},"test-vip-payment.js":{"content":"// Тестируем активацию VIP статуса\nconst fs = require('fs');\n\n// Активируем VIP статус у testuser123\nconst testUserFile = './users/testuser123.json';\nlet testUser = JSON.parse(fs.readFileSync(testUserFile, 'utf8'));\n\nconsole.log('Before VIP activation:');\nconsole.log('VIP Until:', testUser.vipUntil);\nconsole.log('Premium Until:', testUser.premiumUntil);\n\n// Активируем VIP на месяц (30 дней)\nconst now = Date.now();\nconst oneMonth = 30 * 24 * 60 * 60 * 1000;\ntestUser.vipUntil = now + oneMonth;\n\nfs.writeFileSync(testUserFile, JSON.stringify(testUser, null, 2));\n\nconsole.log('After VIP activation:');\nconsole.log('VIP Until:', testUser.vipUntil, '(', new Date(testUser.vipUntil).toLocaleString('ru-RU'), ')');\nconsole.log('VIP Active:', Date.now() < testUser.vipUntil);\n\n// Также обновим Ca6aka файл с правильным dailyLoginBonus\nconst ca6akaFile = './users/Ca6aka.json';\nlet ca6aka = JSON.parse(fs.readFileSync(ca6akaFile, 'utf8'));\n\nconst berlinTime = new Date(new Date().toLocaleString(\"en-US\", {timeZone: \"Europe/Berlin\"}));\nconst today = berlinTime.toDateString();\nconsole.log('Current Berlin date:', today);\nconsole.log('Ca6aka dailyLoginBonus before:', ca6aka.dailyLoginBonus);\n\nca6aka.dailyLoginBonus = today;\nfs.writeFileSync(ca6akaFile, JSON.stringify(ca6aka, null, 2));\n\nconsole.log('Ca6aka dailyLoginBonus after:', ca6aka.dailyLoginBonus);\nconsole.log('Should be able to claim bonus:', ca6aka.dailyLoginBonus !== today);","size_bytes":1524},"FIAT_CRYPTO_SETUP.md":{"content":"# Fiat-to-Crypto Payment Integration ✅\n\n## Обзор\nУспешно реализована интеграция NOWPayments Invoice API для fiat-to-crypto конвертации, позволяющая пользователям оплачивать банковскими картами в USD и автоматически получать криптовалюту.\n\n## Ключевые особенности:\n- **Прямые картовые платежи**: Пользователи платят Visa/Mastercard в USD через Mercuryo\n- **Автоматическая конвертация**: Фиатные деньги конвертируются в TRX криптовалюту\n- **Пакетная система**: Улучшенные VIP/Premium пакеты обходят минимум $19.22\n- **Реальная интеграция API**: Протестировано с живым NOWPayments API\n\n## Пакетные цены (Обход минимума $19.22):\n\n### VIP Пакет - $20 за 8 месяцев\n**Включает:**\n- ✅ VIP статус на 8 месяцев\n- 💰 +$10,000 стартового капитала\n- ⚡ +5,000 опыта\n- 🖥️ 30 слотов серверов (вместо 25)\n- 🎯 Сниженные кулдауны (2м/4м/6м)\n- ⭐ Множитель опыта x1.5\n- 🏆 Множитель ежедневного бонуса x2 (+200)\n- 💎 VIP бейдж в чате\n- 🚀 Приоритет в поддержке\n\n### Premium Пакет - $25 навсегда\n**Включает:**\n- ✅ Premium статус навсегда\n- 💰 +$50,000 стартового капитала\n- ⚡ +15,000 опыта\n- 🖥️ 35 слотов серверов (вместо 25)\n- 🎯 Сниженные кулдауны (1.5м/2м/5м)\n- ⭐ Множитель опыта x1.75\n- 🏆 Множитель ежедневного бонуса x5 (+500)\n- 👑 Premium бейдж в чате\n- ⚡ Без кулдаунов мини-игр\n- 🏗️ Мгновенное строительство серверов\n- 🔒 Секретные админские реакции\n- 🚀 Высший приоритет в поддержке\n\n## Статус реализации:\n\n✅ **API Endpoint** (`/api/donate/fiat`) - Создает fiat платежи\n✅ **Улучшенные пакетные бонусы** с слотами серверов и стартовым капиталом  \n✅ **Двойные опции платежа** (fiat и crypto) в диалоге покупки\n✅ **Обработчик webhook** для подтверждения платежей\n✅ **Живое тестирование API** успешно\n\n## Тестирование API:\n\n```bash\n# Тест создания fiat-to-crypto инвойса (✅ Работает)\ncurl -H \"x-api-key: 0BYBCND-44G4DAZ-K5FPR03-WQKCRAF\" \\\n     -H \"Content-Type: application/json\" \\\n     -X POST https://api.nowpayments.io/v1/invoice \\\n     -d '{\n       \"price_amount\": 20, \n       \"price_currency\": \"usd\", \n       \"pay_currency\": \"trx\", \n       \"order_id\": \"test_001\", \n       \"order_description\": \"Test Payment\"\n     }'\n\n# Успешный ответ:\n{\n  \"id\": \"4339756194\",\n  \"invoice_url\": \"https://nowpayments.io/payment/?iid=4339756194\",\n  \"order_id\": \"test_001\",\n  \"price_amount\": \"20\",\n  \"price_currency\": \"USD\",\n  \"pay_currency\": \"TRX\"\n}\n```\n\n## Пользовательский процесс:\n\n1. **Пользователь выбирает VIP/Premium** в интерфейсе игры\n2. **Нажимает \"Оплата картой (fiat → crypto)\"** - зеленая кнопка\n3. **Система создает Invoice** через NOWPayments API\n4. **Открывается NOWPayments** в новой вкладке\n5. **Пользователь вводит данные карты** через Mercuryo\n6. **Оплачивает в USD** (Visa/Mastercard/Apple Pay/Google Pay)\n7. **NOWPayments конвертирует в TRX** автоматически\n8. **Webhook активирует статус** с бонусами мгновенно\n9. **Пользователь получает все бонусы** сразу после оплаты\n\n## Технические детали:\n\n### Frontend (purchase-dialog.jsx):\n- Две кнопки: \"Fiat → Crypto\" (зеленая) и \"Прямой крипто\" (синяя)\n- Отдельные mutation для каждого типа платежа\n- Toast уведомления с инструкциями\n\n### Backend (server/routes.js):\n- `/api/donate/fiat` - создание fiat инвойсов\n- `/api/card-crypto-purchase` - прямые крипто платежи  \n- `/api/payment-webhook` - обработка всех webhook\n- Автоматическое начисление бонусов при подтверждении\n\n### Bonuses Logic:\n```javascript\n// VIP бонусы\n{\n  money: 10000,      // +$10,000\n  experience: 5000,  // +5,000 XP\n  serverSlots: 30    // 30 слотов (было 25)\n}\n\n// Premium бонусы  \n{\n  money: 50000,      // +$50,000\n  experience: 15000, // +15,000 XP\n  serverSlots: 35    // 35 слотов (было 25)\n}\n```\n\n## Преимущества решения:\n\n✅ **Обход минимума** - пакеты $20/$25 вместо $19.22 на каждый платеж\n✅ **Дополнительная ценность** - бонусы делают покупку выгоднее\n✅ **Простота для пользователей** - одна кнопка, автоматическая конвертация\n✅ **Безопасность** - Mercuryo обрабатывает картовые данные\n✅ **Гибкость** - две опции оплаты (fiat и crypto)\n\n## Готово к использованию! 🚀\n\nСистема полностью реализована и протестирована. Пользователи могут сразу покупать VIP/Premium пакеты как картами, так и криптовалютой.","size_bytes":6091},"server/email.js":{"content":"const sgMail = require('@sendgrid/mail');\n\nif (process.env.SENDGRID_API_KEY) {\n  sgMail.setApiKey(process.env.SENDGRID_API_KEY);\n} else {\n  console.log('SendGrid API key not found - email notifications disabled');\n}\n\nconst gameEmail = process.env.GAME_EMAIL || 'noreply@yourgame.com';\n\nasync function sendEmail(to, subject, html, text) {\n  if (!process.env.SENDGRID_API_KEY) {\n    console.log('Email sending skipped - no SendGrid API key');\n    return false;\n  }\n\n  try {\n    await sgMail.send({\n      to,\n      from: gameEmail,\n      subject,\n      html,\n      text\n    });\n    console.log(`Email sent successfully to ${to}`);\n    return true;\n  } catch (error) {\n    console.error('Email sending failed:', error);\n    return false;\n  }\n}\n\n// Email templates\nconst emailTemplates = {\n  vipPurchase: (nickname, orderId) => ({\n    subject: 'VIP статус - подтверждение покупки',\n    html: `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; background: #1a1a1a; color: #ffffff; padding: 20px; border-radius: 8px;\">\n        <div style=\"text-align: center; margin-bottom: 30px;\">\n          <h1 style=\"color: #3b82f6; margin: 0;\">🌟 VIP статус активирован!</h1>\n        </div>\n        \n        <div style=\"background: #2a2a2a; padding: 20px; border-radius: 6px; margin-bottom: 20px;\">\n          <h2 style=\"color: #3b82f6; margin-top: 0;\">Добро пожаловать в VIP клуб, ${nickname}!</h2>\n          <p>Ваша покупка VIP статуса успешно обработана.</p>\n          <p><strong>Номер заказа:</strong> ${orderId}</p>\n          <p><strong>Стоимость:</strong> $2.50/месяц</p>\n        </div>\n\n        <div style=\"background: #1e3a8a; padding: 20px; border-radius: 6px; margin-bottom: 20px;\">\n          <h3 style=\"color: #60a5fa; margin-top: 0;\">🎁 Ваши VIP привилегии:</h3>\n          <ul style=\"color: #cbd5e1; line-height: 1.6;\">\n            <li>🔥 <strong>1.5x опыт</strong> за все работы</li>\n            <li>⚡ <strong>Ускоренные кулдауны:</strong> 2м/4м/6м вместо 3м/5м/7м</li>\n            <li>💰 <strong>2x ежедневный бонус:</strong> +$200 вместо +$100</li>\n            <li>🎯 <strong>25 слотов</strong> для серверов</li>\n            <li>💎 <strong>VIP значок</strong> в чате</li>\n            <li>🔧 <strong>Приоритет</strong> в технической поддержке</li>\n          </ul>\n        </div>\n\n        <div style=\"text-align: center; margin-top: 30px;\">\n          <p style=\"color: #64748b;\">Спасибо за поддержку проекта!</p>\n          <p style=\"color: #64748b; font-size: 14px;\">Команда Server Simulation Game</p>\n        </div>\n      </div>\n    `,\n    text: `VIP статус активирован! Добро пожаловать в VIP клуб, ${nickname}! Заказ: ${orderId}`\n  }),\n\n  premiumPurchase: (nickname, orderId) => ({\n    subject: 'PREMIUM статус - подтверждение покупки',\n    html: `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; background: #1a1a1a; color: #ffffff; padding: 20px; border-radius: 8px;\">\n        <div style=\"text-align: center; margin-bottom: 30px;\">\n          <h1 style=\"color: #a855f7; margin: 0;\">👑 PREMIUM статус активирован!</h1>\n        </div>\n        \n        <div style=\"background: #2a2a2a; padding: 20px; border-radius: 6px; margin-bottom: 20px;\">\n          <h2 style=\"color: #a855f7; margin-top: 0;\">Поздравляем с PREMIUM статусом, ${nickname}!</h2>\n          <p>Ваша покупка PREMIUM статуса успешно обработана.</p>\n          <p><strong>Номер заказа:</strong> ${orderId}</p>\n          <p><strong>Стоимость:</strong> $10.00 (навсегда!)</p>\n        </div>\n\n        <div style=\"background: #7c2d92; padding: 20px; border-radius: 6px; margin-bottom: 20px;\">\n          <h3 style=\"color: #c084fc; margin-top: 0;\">🚀 Ваши PREMIUM привилегии:</h3>\n          <ul style=\"color: #cbd5e1; line-height: 1.6;\">\n            <li>🎯 <strong>1.75x опыт</strong> за все работы</li>\n            <li>⚡ <strong>Супер кулдауны:</strong> 1.5м/2м/5м вместо 3м/5м/7м</li>\n            <li>💎 <strong>5x ежедневный бонус:</strong> +$500 вместо +$100</li>\n            <li>🏗️ <strong>30 слотов</strong> для серверов</li>\n            <li>🔥 <strong>Мгновенное строительство</strong> серверов</li>\n            <li>🎮 <strong>Без кулдаунов</strong> мини-игр</li>\n            <li>👑 <strong>PREMIUM значок</strong> в чате</li>\n            <li>🎭 <strong>Секретные админ реакции</strong></li>\n            <li>🔧 <strong>Высший приоритет</strong> в поддержке</li>\n          </ul>\n        </div>\n\n        <div style=\"background: #f59e0b; color: #000; padding: 15px; border-radius: 6px; margin-bottom: 20px;\">\n          <p style=\"margin: 0; font-weight: bold;\">💡 PREMIUM статус действует навсегда - никаких ежемесячных платежей!</p>\n        </div>\n\n        <div style=\"text-align: center; margin-top: 30px;\">\n          <p style=\"color: #64748b;\">Спасибо за вашу щедрую поддержку!</p>\n          <p style=\"color: #64748b; font-size: 14px;\">Команда Server Simulation Game</p>\n        </div>\n      </div>\n    `,\n    text: `PREMIUM статус активирован навсегда! Поздравляем, ${nickname}! Заказ: ${orderId}`\n  }),\n\n  paymentConfirmation: (nickname, type, orderId, amount) => ({\n    subject: `${type === 'vip' ? 'VIP' : 'PREMIUM'} - платеж получен`,\n    html: `\n      <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; background: #1a1a1a; color: #ffffff; padding: 20px; border-radius: 8px;\">\n        <div style=\"text-align: center; margin-bottom: 30px;\">\n          <h1 style=\"color: #22c55e; margin: 0;\">✅ Платеж успешно обработан!</h1>\n        </div>\n        \n        <div style=\"background: #2a2a2a; padding: 20px; border-radius: 6px;\">\n          <p>Здравствуйте, <strong>${nickname}</strong>!</p>\n          <p>Ваш платеж за <strong>${type === 'vip' ? 'VIP' : 'PREMIUM'}</strong> статус успешно получен и обработан.</p>\n          \n          <hr style=\"border: 1px solid #404040; margin: 20px 0;\">\n          \n          <p><strong>Детали платежа:</strong></p>\n          <ul>\n            <li>Заказ: ${orderId}</li>\n            <li>Сумма: $${amount}</li>\n            <li>Статус: ${type === 'vip' ? 'VIP (месячная подписка)' : 'PREMIUM (навсегда)'}</li>\n            <li>Дата: ${new Date().toLocaleString('ru-RU')}</li>\n          </ul>\n          \n          <p style=\"color: #22c55e; font-weight: bold;\">Ваш новый статус уже активирован в игре!</p>\n        </div>\n\n        <div style=\"text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #404040;\">\n          <p style=\"color: #64748b;\">Спасибо за поддержку проекта!</p>\n        </div>\n      </div>\n    `,\n    text: `Платеж за ${type === 'vip' ? 'VIP' : 'PREMIUM'} статус успешно получен! Заказ: ${orderId}`\n  })\n};\n\nmodule.exports = {\n  sendEmail,\n  emailTemplates\n};","size_bytes":7747},"client/src/components/daily-bonus-notification.jsx":{"content":"import { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Gift, Flame, X } from 'lucide-react';\nimport { useLanguage } from '@/contexts/language-context';\nimport { useGame } from '@/contexts/game-context';\nimport { formatCurrency } from '@/lib/constants';\nimport { toast } from '@/hooks/use-toast';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\n\nexport function DailyBonusNotification() {\n  const { t } = useLanguage();\n  const { gameState } = useGame();\n  const [showBonus, setShowBonus] = useState(false);\n  const queryClient = useQueryClient();\n\n  // Check for daily bonus after login\n  const { data: bonusData } = useQuery({\n    queryKey: ['/api/daily-bonus'],\n    enabled: !!gameState.user,\n    refetchInterval: 60000, // Check every minute\n  });\n\n  const claimBonusMutation = useMutation({\n    mutationFn: () => apiRequest('/api/daily-bonus/claim', 'POST'),\n    onSuccess: (data) => {\n      toast({\n        title: t('dailyBonusClaimed'),\n        description: `+${formatCurrency(data.amount)} | ${t('streak')}: ${data.streak}`,\n        duration: 5000,\n      });\n      setShowBonus(false);\n      // Invalidate user data to update balance\n      queryClient.invalidateQueries(['/api/auth/me']);\n      queryClient.invalidateQueries(['/api/daily-bonus']);\n    },\n    onError: (error) => {\n      toast({\n        title: t('error'),\n        description: error.message,\n        variant: 'destructive',\n      });\n    }\n  });\n\n  // Show bonus notification when available\n  useEffect(() => {\n    if (bonusData?.canClaim && gameState.user) {\n      // Check if user logged in after midnight (Berlin time)\n      const now = new Date();\n      const berlinTime = new Date(now.toLocaleString(\"en-US\", {timeZone: \"Europe/Berlin\"}));\n      const lastLogin = new Date(gameState.user.lastLogin);\n      const lastLoginBerlin = new Date(lastLogin.toLocaleString(\"en-US\", {timeZone: \"Europe/Berlin\"}));\n      \n      // Check if it's a new day\n      const isNewDay = berlinTime.getDate() !== lastLoginBerlin.getDate() || \n                       berlinTime.getMonth() !== lastLoginBerlin.getMonth() ||\n                       berlinTime.getFullYear() !== lastLoginBerlin.getFullYear();\n      \n      if (isNewDay && bonusData.canClaim) {\n        setShowBonus(true);\n      }\n    }\n  }, [bonusData, gameState.user]);\n\n  if (!showBonus || !bonusData?.canClaim) return null;\n\n  const handleClaim = () => {\n    claimBonusMutation.mutate();\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <Card className=\"bg-gradient-to-br from-purple-900/90 to-blue-900/90 border-purple-500/50 max-w-md w-full\">\n        <CardHeader className=\"text-center relative\">\n          <Button\n            variant=\"ghost\" \n            size=\"sm\"\n            className=\"absolute top-2 right-2 text-purple-300 hover:text-white\"\n            onClick={() => setShowBonus(false)}\n          >\n            <X className=\"w-4 h-4\" />\n          </Button>\n          <div className=\"flex justify-center mb-2\">\n            <Gift className=\"w-12 h-12 text-yellow-400 animate-bounce\" />\n          </div>\n          <CardTitle className=\"text-2xl font-bold text-white\">\n            {t('dailyLoginBonus')}\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4 text-center\">\n          <div className=\"space-y-2\">\n            <div className=\"text-3xl font-bold text-yellow-400\">\n              +{formatCurrency(bonusData.amount)}\n            </div>\n            <div className=\"flex items-center justify-center space-x-2\">\n              <Flame className=\"w-5 h-5 text-orange-400\" />\n              <span className=\"text-purple-200\">{t('streak')}: {bonusData.streak}</span>\n            </div>\n            {bonusData.streak >= 7 && (\n              <Badge variant=\"secondary\" className=\"bg-yellow-900/50 text-yellow-300\">\n                {t('weekStreak')}\n              </Badge>\n            )}\n          </div>\n          <p className=\"text-purple-200 text-sm\">\n            {t('dailyBonusMessage')}\n          </p>\n          <Button \n            onClick={handleClaim}\n            disabled={claimBonusMutation.isPending}\n            className=\"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white font-semibold py-2 px-4 rounded-lg\"\n          >\n            {claimBonusMutation.isPending ? t('claiming') : t('claimBonus')}\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":4712},"client/src/components/daily-bonus-tab.jsx":{"content":"import React from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\nimport { Gift, Calendar, Flame, Clock } from 'lucide-react';\nimport { useLanguage } from '../contexts/language-context';\nimport { useToast } from '../hooks/use-toast';\nimport { apiRequest } from '../lib/queryClient';\n\nconst DailyBonusTab = () => {\n  const { t } = useLanguage();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: bonusData, isLoading } = useQuery({\n    queryKey: ['/api/daily-bonus'],\n    refetchInterval: 30000,\n  });\n\n  const claimMutation = useMutation({\n    mutationFn: () => apiRequest('/api/daily-bonus/claim', { method: 'POST' }),\n    onSuccess: (data) => {\n      if (data.success) {\n        toast({\n          title: t('bonusClaimed'),\n          description: t('bonusClaimedDesc').replace('{amount}', data.amount).replace('{streak}', data.streak),\n        });\n        queryClient.invalidateQueries({ queryKey: ['/api/daily-bonus'] });\n        queryClient.invalidateQueries({ queryKey: ['/api/auth/me'] });\n      } else {\n        toast({\n          title: t('error'),\n          description: data.message || t('bonusClaimError'),\n          variant: 'destructive',\n        });\n      }\n    },\n    onError: () => {\n      toast({\n        title: t('error'),\n        description: t('bonusClaimError'),\n        variant: 'destructive',\n      });\n    },\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6 max-w-4xl mx-auto\">\n        <div className=\"text-center text-slate-400\">Loading...</div>\n      </div>\n    );\n  }\n\n  const { canClaim, streak, amount, nextAmount } = bonusData || {};\n  const currentStreak = streak || 0;\n\n  return (\n    <div className=\"p-6 max-w-4xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h2 className=\"text-2xl font-bold text-slate-100 flex items-center gap-2\">\n          <Gift className=\"w-6 h-6 text-yellow-400\" />\n          {t('dailyBonus')}\n        </h2>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        {/* Main Bonus Card */}\n        <Card className=\"border-2 border-yellow-500 bg-gradient-to-br from-yellow-900/30 to-yellow-800/20\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-yellow-300\">\n              <Calendar className=\"w-5 h-5\" />\n              {t('todayBonus')}\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {canClaim ? (\n              <>\n                <div className=\"text-center\">\n                  <div className=\"text-3xl font-bold text-yellow-400 mb-2\">\n                    ${amount}\n                  </div>\n                  <p className=\"text-sm text-slate-300\">{t('readyToClaim')}</p>\n                </div>\n                \n                <Button \n                  onClick={() => claimMutation.mutate()}\n                  disabled={claimMutation.isPending}\n                  className=\"w-full bg-yellow-600 hover:bg-yellow-700 text-white\"\n                >\n                  {claimMutation.isPending ? t('claiming') : t('claimBonus')}\n                </Button>\n              </>\n            ) : (\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-slate-400 mb-2\">\n                  {t('alreadyClaimed')}\n                </div>\n                <p className=\"text-sm text-slate-500\">{t('comeBackTomorrow')}</p>\n                \n                <div className=\"mt-4 p-3 bg-slate-800/50 rounded-lg\">\n                  <div className=\"flex items-center gap-2 text-sm text-slate-300\">\n                    <Clock className=\"w-4 h-4\" />\n                    {t('nextBonus')}: ${nextAmount}\n                  </div>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Streak Card */}\n        <Card className=\"border-2 border-orange-500 bg-gradient-to-br from-orange-900/30 to-orange-800/20\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2 text-orange-300\">\n              <Flame className=\"w-5 h-5\" />\n              {t('loginStreak')}\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"text-center\">\n              <div className=\"text-3xl font-bold text-orange-400 mb-2\">\n                {currentStreak}\n              </div>\n              <p className=\"text-sm text-slate-300\">\n                {currentStreak === 1 ? t('dayStreak') : t('daysStreak')}\n              </p>\n            </div>\n\n            {currentStreak > 0 && (\n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between text-sm\">\n                  <span className=\"text-slate-400\">{t('streakMultiplier')}</span>\n                  <span className=\"text-orange-400\">{Math.min(currentStreak, 20)}x</span>\n                </div>\n                \n                <div className=\"w-full bg-slate-700 rounded-full h-2\">\n                  <div \n                    className=\"bg-gradient-to-r from-orange-600 to-orange-400 h-2 rounded-full transition-all\"\n                    style={{ width: `${Math.min((currentStreak / 20) * 100, 100)}%` }}\n                  />\n                </div>\n                \n                <p className=\"text-xs text-slate-500\">\n                  {currentStreak >= 20 ? t('maxMultiplier') : t('streakProgress').replace('{current}', currentStreak).replace('{max}', 20)}\n                </p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Bonus Schedule */}\n      <Card className=\"mt-6 border-slate-600\">\n        <CardHeader>\n          <CardTitle className=\"text-slate-100\">{t('bonusSchedule')}</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3\">\n            {[1, 2, 3, 4, 5, 6, 7, 10, 15, 20].map((day) => {\n              const bonus = Math.min(100 * day, 2000);\n              const isActive = currentStreak >= day;\n              \n              return (\n                <div \n                  key={day}\n                  className={`p-3 rounded-lg text-center border-2 transition-all ${\n                    isActive \n                      ? 'border-green-500 bg-green-900/30' \n                      : 'border-slate-600 bg-slate-800/50'\n                  }`}\n                >\n                  <div className={`text-sm font-medium ${\n                    isActive ? 'text-green-400' : 'text-slate-400'\n                  }`}>\n                    {t('day')} {day}\n                  </div>\n                  <div className={`text-lg font-bold ${\n                    isActive ? 'text-green-300' : 'text-slate-500'\n                  }`}>\n                    ${bonus}\n                  </div>\n                  {day === 20 && (\n                    <Badge variant=\"secondary\" className=\"text-xs mt-1\">\n                      {t('max')}\n                    </Badge>\n                  )}\n                </div>\n              );\n            })}\n          </div>\n          \n          <div className=\"mt-4 p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg\">\n            <p className=\"text-sm text-blue-300\">\n              <strong>{t('note')}:</strong> {t('bonusNote')}\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default DailyBonusTab;","size_bytes":7593},"client/src/components/hidden-achievements-tab.jsx":{"content":"import React from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Badge } from './ui/badge';\nimport { Lock, Eye, Award } from 'lucide-react';\nimport { useLanguage } from '../contexts/language-context';\n\nconst HiddenAchievementsTab = () => {\n  const { t } = useLanguage();\n\n  const { data: hiddenAchievementsData, isLoading } = useQuery({\n    queryKey: ['/api/hidden-achievements'],\n    refetchInterval: 5000,\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"p-6 max-w-6xl mx-auto\">\n        <div className=\"text-center text-slate-400\">Loading...</div>\n      </div>\n    );\n  }\n\n  const achievements = hiddenAchievementsData?.achievements || [];\n\n  return (\n    <div className=\"p-6 max-w-6xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h2 className=\"text-2xl font-bold text-slate-100 flex items-center gap-2\">\n          <Eye className=\"w-6 h-6 text-purple-400\" />\n          {t('hiddenAchievements')}\n        </h2>\n        <Badge variant=\"outline\" className=\"text-purple-400 border-purple-400\">\n          {achievements.filter(a => !a.isLocked).length} / {achievements.length} {t('unlocked')}\n        </Badge>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n        {achievements.map((achievement) => (\n          <Card key={achievement.id} className={`border-2 transition-all ${\n            achievement.isLocked \n              ? 'border-slate-600 bg-slate-800/50 opacity-60' \n              : 'border-purple-500 bg-gradient-to-br from-purple-900/30 to-purple-800/20'\n          }`}>\n            <CardHeader className=\"pb-2\">\n              <CardTitle className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  {achievement.isLocked ? (\n                    <Lock className=\"w-5 h-5 text-slate-400\" />\n                  ) : (\n                    <Award className=\"w-5 h-5 text-purple-400\" />\n                  )}\n                  <span className={`text-sm ${\n                    achievement.isLocked ? 'text-slate-400' : 'text-purple-300'\n                  }`}>\n                    {achievement.name}\n                  </span>\n                </div>\n                {!achievement.isLocked && achievement.reward && (\n                  <Badge variant=\"secondary\" className=\"text-xs bg-purple-600/30 text-purple-200\">\n                    +${achievement.reward}\n                  </Badge>\n                )}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <p className={`text-xs ${\n                achievement.isLocked ? 'text-slate-500' : 'text-slate-300'\n              }`}>\n                {achievement.description}\n              </p>\n              \n              {achievement.isLocked && (\n                <div className=\"mt-2 flex items-center gap-1 text-xs text-slate-500\">\n                  <Eye className=\"w-3 h-3\" />\n                  {t('hiddenRequirement')}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {achievements.length === 0 && (\n        <div className=\"text-center py-12\">\n          <Eye className=\"w-16 h-16 text-slate-600 mx-auto mb-4\" />\n          <h3 className=\"text-lg font-medium text-slate-400 mb-2\">{t('noHiddenAchievements')}</h3>\n          <p className=\"text-slate-500\">{t('hiddenAchievementsDesc')}</p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default HiddenAchievementsTab;","size_bytes":3562},"client/src/components/subscription-badge.jsx":{"content":"import { Badge } from '@/components/ui/badge';\nimport { Crown, Star } from 'lucide-react';\n\nexport default function SubscriptionBadge({ user, size = 'sm' }) {\n  const hasVip = user?.vipExpires && new Date(user.vipExpires) > new Date();\n  const hasPremium = user?.premiumActive;\n\n  if (hasPremium) {\n    return (\n      <Badge className=\"bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold animate-pulse\">\n        <Star className={`${size === 'sm' ? 'w-3 h-3' : 'w-4 h-4'} mr-1`} />\n        PREMIUM\n      </Badge>\n    );\n  }\n\n  if (hasVip) {\n    return (\n      <Badge className=\"bg-gradient-to-r from-blue-600 to-cyan-600 text-white font-bold\">\n        <Crown className={`${size === 'sm' ? 'w-3 h-3' : 'w-4 h-4'} mr-1`} />\n        VIP\n      </Badge>\n    );\n  }\n\n  return null;\n}","size_bytes":790},"client/src/components/tutorial-system.jsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\nimport { Progress } from './ui/progress';\nimport { BookOpen, CheckCircle, ArrowRight, Gift, Coins, Server, GraduationCap, X } from 'lucide-react';\nimport { useLanguage } from '../contexts/language-context';\nimport { useToast } from '../hooks/use-toast';\nimport { apiRequest } from '../lib/queryClient';\n\nconst TutorialSystem = ({ onComplete }) => {\n  const { t } = useLanguage();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [currentStep, setCurrentStep] = useState(0);\n  const [isVisible, setIsVisible] = useState(true);\n\n  const { data: tutorialData, isLoading } = useQuery({\n    queryKey: ['/api/tutorial'],\n    refetchInterval: 5000,\n  });\n\n  const updateProgressMutation = useMutation({\n    mutationFn: (step) => apiRequest('/api/tutorial/progress', { \n      method: 'POST', \n      body: JSON.stringify({ step }) \n    }),\n    onSuccess: (data) => {\n      if (data.completed) {\n        toast({\n          title: t('tutorialCompleted'),\n          description: t('tutorialCompletedDesc'),\n        });\n        setIsVisible(false);\n        if (onComplete) onComplete();\n      }\n      queryClient.invalidateQueries({ queryKey: ['/api/tutorial'] });\n    },\n  });\n\n  useEffect(() => {\n    if (tutorialData && !tutorialData.completed) {\n      setCurrentStep(tutorialData.currentStep || 0);\n    } else if (tutorialData?.completed) {\n      setIsVisible(false);\n    }\n  }, [tutorialData]);\n\n  if (isLoading || !isVisible || tutorialData?.completed) {\n    return null;\n  }\n\n  const steps = [\n    {\n      id: 'welcome',\n      title: t('welcomeToGame'),\n      description: t('tutorialStep1'),\n      icon: BookOpen,\n      color: 'blue',\n      reward: 15000\n    },\n    {\n      id: 'earning',\n      title: t('earnMoney'),\n      description: t('tutorialStep2'),\n      icon: Coins,\n      color: 'yellow',\n      reward: 0\n    },\n    {\n      id: 'shop',\n      title: t('visitShop'),\n      description: t('tutorialStep3'),\n      icon: Gift,\n      color: 'green',\n      reward: 0\n    },\n    {\n      id: 'servers',\n      title: t('manageServers'),\n      description: t('tutorialStep4'),\n      icon: Server,\n      color: 'purple',\n      reward: 0\n    },\n    {\n      id: 'learning',\n      title: t('learningCenter'),\n      description: t('tutorialStep5'),\n      icon: GraduationCap,\n      color: 'red',\n      reward: 0\n    }\n  ];\n\n  const currentStepData = steps[currentStep];\n  const progress = ((currentStep + 1) / steps.length) * 100;\n\n  const handleNextStep = () => {\n    const nextStep = currentStep + 1;\n    \n    if (nextStep >= steps.length) {\n      updateProgressMutation.mutate(steps.length - 1);\n    } else {\n      setCurrentStep(nextStep);\n      updateProgressMutation.mutate(nextStep);\n    }\n  };\n\n  const handleSkip = () => {\n    updateProgressMutation.mutate(steps.length - 1);\n  };\n\n  const IconComponent = currentStepData.icon;\n  const colorClasses = {\n    blue: 'border-blue-500 bg-gradient-to-br from-blue-900/30 to-blue-800/20 text-blue-300',\n    yellow: 'border-yellow-500 bg-gradient-to-br from-yellow-900/30 to-yellow-800/20 text-yellow-300',\n    green: 'border-green-500 bg-gradient-to-br from-green-900/30 to-green-800/20 text-green-300',\n    purple: 'border-purple-500 bg-gradient-to-br from-purple-900/30 to-purple-800/20 text-purple-300',\n    red: 'border-red-500 bg-gradient-to-br from-red-900/30 to-red-800/20 text-red-300'\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n      <Card className={`max-w-2xl w-full border-2 ${colorClasses[currentStepData.color]}`}>\n        <CardHeader className=\"pb-4\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className={`p-3 rounded-full bg-${currentStepData.color}-600/30`}>\n                <IconComponent className=\"w-6 h-6\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-xl\">{currentStepData.title}</CardTitle>\n                <Badge variant=\"outline\" className=\"mt-1\">\n                  {t('step')} {currentStep + 1} {t('of')} {steps.length}\n                </Badge>\n              </div>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={handleSkip}\n              className=\"text-slate-400 hover:text-slate-200\"\n            >\n              <X className=\"w-4 h-4\" />\n            </Button>\n          </div>\n          \n          <Progress value={progress} className=\"w-full h-2\" />\n        </CardHeader>\n        \n        <CardContent className=\"space-y-6\">\n          <div>\n            <p className=\"text-slate-300 text-lg leading-relaxed\">\n              {currentStepData.description}\n            </p>\n            \n            {currentStepData.reward > 0 && (\n              <div className=\"mt-4 p-3 bg-green-900/20 border border-green-500/30 rounded-lg\">\n                <div className=\"flex items-center gap-2 text-green-300\">\n                  <Gift className=\"w-4 h-4\" />\n                  <span className=\"font-medium\">{t('tutorialReward')}: ${currentStepData.reward}</span>\n                </div>\n              </div>\n            )}\n          </div>\n\n          <div className=\"flex items-center justify-between pt-4\">\n            <div className=\"flex items-center gap-2\">\n              {steps.map((step, index) => (\n                <div\n                  key={step.id}\n                  className={`w-3 h-3 rounded-full transition-all ${\n                    index <= currentStep\n                      ? `bg-${currentStepData.color}-500`\n                      : 'bg-slate-600'\n                  }`}\n                />\n              ))}\n            </div>\n            \n            <div className=\"flex items-center gap-3\">\n              <Button\n                variant=\"outline\"\n                onClick={handleSkip}\n                className=\"text-slate-400 border-slate-600 hover:bg-slate-700\"\n              >\n                {t('skipTutorial')}\n              </Button>\n              \n              <Button\n                onClick={handleNextStep}\n                disabled={updateProgressMutation.isPending}\n                className={`bg-${currentStepData.color}-600 hover:bg-${currentStepData.color}-700 text-white`}\n              >\n                {updateProgressMutation.isPending ? (\n                  t('updating')\n                ) : currentStep >= steps.length - 1 ? (\n                  t('completeTutorial')\n                ) : (\n                  <>\n                    {t('nextStep')}\n                    <ArrowRight className=\"w-4 h-4 ml-2\" />\n                  </>\n                )}\n              </Button>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default TutorialSystem;","size_bytes":7079},"client/src/components/vip-premium-test.jsx":{"content":"import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Star, Crown, TestTube } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\n\nexport default function VipPremiumTest({ user }) {\n  const [loading, setLoading] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const testPurchase = async (type) => {\n    try {\n      setLoading(true);\n      \n      const response = await fetch('/api/purchase', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ type, gateway: 'fondy' })\n      });\n\n      const data = await response.json();\n      \n      if (!response.ok) {\n        throw new Error(data.message);\n      }\n\n      toast({\n        title: 'Тест платежа запущен',\n        description: data.message,\n        duration: 5000,\n      });\n\n      // Обновить данные пользователя через 3 секунды\n      setTimeout(() => {\n        queryClient.invalidateQueries(['/api/auth/me']);\n      }, 3000);\n\n    } catch (error) {\n      toast({\n        title: 'Ошибка тестирования',\n        description: error.message,\n        variant: 'destructive',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const hasVip = user?.vipStatus === 'active' && user?.vipExpiresAt && new Date(user.vipExpiresAt) > new Date();\n  const hasPremium = user?.premiumStatus === 'active';\n\n  return (\n    <Card className=\"border-orange-500/30 bg-gradient-to-br from-orange-600/20 to-orange-800/20\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center text-orange-300\">\n          <TestTube className=\"w-5 h-5 mr-2\" />\n          Тестирование VIP/Premium\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <span>Текущий статус:</span>\n          <div className=\"flex gap-2\">\n            {hasVip && (\n              <Badge className=\"bg-blue-600 text-white\">\n                <Star className=\"w-3 h-3 mr-1\" />\n                VIP\n              </Badge>\n            )}\n            {hasPremium && (\n              <Badge className=\"bg-purple-600 text-white\">\n                <Crown className=\"w-3 h-3 mr-1\" />\n                PREMIUM\n              </Badge>\n            )}\n            {!hasVip && !hasPremium && (\n              <Badge variant=\"outline\">Обычный пользователь</Badge>\n            )}\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-4\">\n          <Button \n            onClick={() => testPurchase('vip')}\n            disabled={loading || hasVip || hasPremium}\n            variant=\"outline\"\n            className=\"border-blue-500 text-blue-400 hover:bg-blue-500/10\"\n          >\n            <Star className=\"w-4 h-4 mr-2\" />\n            Тест VIP ($2.50)\n          </Button>\n          \n          <Button \n            onClick={() => testPurchase('premium')}\n            disabled={loading || hasPremium || hasVip}\n            variant=\"outline\" \n            className=\"border-purple-500 text-purple-400 hover:bg-purple-500/10\"\n          >\n            <Crown className=\"w-4 h-4 mr-2\" />\n            Тест Premium ($10)\n          </Button>\n        </div>\n\n        <div className=\"text-xs text-muted-foreground\">\n          Это демо-версия платежной системы с украинскими шлюзами Fondy и WayForPay.\n          В реальной версии будут настоящие платежи.\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":3930}}}